/*!
 * jQuery JavaScript Library v1.6.2
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Thu Jun 30 14:16:56 2011 -0400
 */
(function(ba,L){var ar=ba.document,bs=ba.navigator,bj=ba.location;var b=(function(){var bE=function(bZ,b0){return new bE.fn.init(bZ,b0,bC)},bU=ba.jQuery,bG=ba.$,bC,bY=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,bM=/\S/,bI=/^\s+/,bD=/\s+$/,bH=/\d/,bz=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,bN=/^[\],:{}\s]*$/,bW=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,bP=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,bJ=/(?:^|:|,)(?:\s*\[)+/g,bx=/(webkit)[ \/]([\w.]+)/,bR=/(opera)(?:.*version)?[ \/]([\w.]+)/,bQ=/(msie) ([\w.]+)/,bS=/(mozilla)(?:.*? rv:([\w.]+))?/,bA=/-([a-z])/ig,bT=function(bZ,b0){return b0.toUpperCase()},bX=bs.userAgent,bV,bB,bt,bL=Object.prototype.toString,bF=Object.prototype.hasOwnProperty,by=Array.prototype.push,bK=Array.prototype.slice,bO=String.prototype.trim,bu=Array.prototype.indexOf,bw={};bE.fn=bE.prototype={constructor:bE,init:function(bZ,b3,b2){var b1,b4,b0,b5;if(!bZ){return this}if(bZ.nodeType){this.context=this[0]=bZ;this.length=1;return this}if(bZ==="body"&&!b3&&ar.body){this.context=ar;this[0]=ar.body;this.selector=bZ;this.length=1;return this}if(typeof bZ==="string"){if(bZ.charAt(0)==="<"&&bZ.charAt(bZ.length-1)===">"&&bZ.length>=3){b1=[null,bZ,null]}else{b1=bY.exec(bZ)}if(b1&&(b1[1]||!b3)){if(b1[1]){b3=b3 instanceof bE?b3[0]:b3;b5=(b3?b3.ownerDocument||b3:ar);b0=bz.exec(bZ);if(b0){if(bE.isPlainObject(b3)){bZ=[ar.createElement(b0[1])];bE.fn.attr.call(bZ,b3,true)}else{bZ=[b5.createElement(b0[1])]}}else{b0=bE.buildFragment([b1[1]],[b5]);bZ=(b0.cacheable?bE.clone(b0.fragment):b0.fragment).childNodes}return bE.merge(this,bZ)}else{b4=ar.getElementById(b1[2]);if(b4&&b4.parentNode){if(b4.id!==b1[2]){return b2.find(bZ)}this.length=1;this[0]=b4}this.context=ar;this.selector=bZ;return this}}else{if(!b3||b3.jquery){return(b3||b2).find(bZ)}else{return this.constructor(b3).find(bZ)}}}else{if(bE.isFunction(bZ)){return b2.ready(bZ)}}if(bZ.selector!==L){this.selector=bZ.selector;this.context=bZ.context}return bE.makeArray(bZ,this)},selector:"",jquery:"1.6.2",length:0,size:function(){return this.length},toArray:function(){return bK.call(this,0)},get:function(bZ){return bZ==null?this.toArray():(bZ<0?this[this.length+bZ]:this[bZ])},pushStack:function(b0,b2,bZ){var b1=this.constructor();if(bE.isArray(b0)){by.apply(b1,b0)}else{bE.merge(b1,b0)}b1.prevObject=this;b1.context=this.context;if(b2==="find"){b1.selector=this.selector+(this.selector?" ":"")+bZ}else{if(b2){b1.selector=this.selector+"."+b2+"("+bZ+")"}}return b1},each:function(b0,bZ){return bE.each(this,b0,bZ)},ready:function(bZ){bE.bindReady();bB.done(bZ);return this},eq:function(bZ){return bZ===-1?this.slice(bZ):this.slice(bZ,+bZ+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(bK.apply(this,arguments),"slice",bK.call(arguments).join(","))},map:function(bZ){return this.pushStack(bE.map(this,function(b1,b0){return bZ.call(b1,b0,b1)}))},end:function(){return this.prevObject||this.constructor(null)},push:by,sort:[].sort,splice:[].splice};bE.fn.init.prototype=bE.fn;bE.extend=bE.fn.extend=function(){var b8,b1,bZ,b0,b5,b6,b4=arguments[0]||{},b3=1,b2=arguments.length,b7=false;if(typeof b4==="boolean"){b7=b4;b4=arguments[1]||{};b3=2}if(typeof b4!=="object"&&!bE.isFunction(b4)){b4={}}if(b2===b3){b4=this;--b3}for(;b3<b2;b3++){if((b8=arguments[b3])!=null){for(b1 in b8){bZ=b4[b1];b0=b8[b1];if(b4===b0){continue}if(b7&&b0&&(bE.isPlainObject(b0)||(b5=bE.isArray(b0)))){if(b5){b5=false;b6=bZ&&bE.isArray(bZ)?bZ:[]}else{b6=bZ&&bE.isPlainObject(bZ)?bZ:{}}b4[b1]=bE.extend(b7,b6,b0)}else{if(b0!==L){b4[b1]=b0}}}}}return b4};bE.extend({noConflict:function(bZ){if(ba.$===bE){ba.$=bG}if(bZ&&ba.jQuery===bE){ba.jQuery=bU}return bE},isReady:false,readyWait:1,holdReady:function(bZ){if(bZ){bE.readyWait++}else{bE.ready(true)}},ready:function(bZ){if((bZ===true&&!--bE.readyWait)||(bZ!==true&&!bE.isReady)){if(!ar.body){return setTimeout(bE.ready,1)}bE.isReady=true;if(bZ!==true&&--bE.readyWait>0){return}bB.resolveWith(ar,[bE]);if(bE.fn.trigger){bE(ar).trigger("ready").unbind("ready")}}},bindReady:function(){if(bB){return}bB=bE._Deferred();if(ar.readyState==="complete"){return setTimeout(bE.ready,1)}if(ar.addEventListener){ar.addEventListener("DOMContentLoaded",bt,false);ba.addEventListener("load",bE.ready,false)}else{if(ar.attachEvent){ar.attachEvent("onreadystatechange",bt);ba.attachEvent("onload",bE.ready);var bZ=false;try{bZ=ba.frameElement==null}catch(b0){}if(ar.documentElement.doScroll&&bZ){bv()}}}},isFunction:function(bZ){return bE.type(bZ)==="function"},isArray:Array.isArray||function(bZ){return bE.type(bZ)==="array"},isWindow:function(bZ){return bZ&&typeof bZ==="object"&&"setInterval" in bZ},isNaN:function(bZ){return bZ==null||!bH.test(bZ)||isNaN(bZ)},type:function(bZ){return bZ==null?String(bZ):bw[bL.call(bZ)]||"object"},isPlainObject:function(b0){if(!b0||bE.type(b0)!=="object"||b0.nodeType||bE.isWindow(b0)){return false}if(b0.constructor&&!bF.call(b0,"constructor")&&!bF.call(b0.constructor.prototype,"isPrototypeOf")){return false}var bZ;for(bZ in b0){}return bZ===L||bF.call(b0,bZ)},isEmptyObject:function(b0){for(var bZ in b0){return false}return true},error:function(bZ){throw bZ},parseJSON:function(bZ){if(typeof bZ!=="string"||!bZ){return null}bZ=bE.trim(bZ);if(ba.JSON&&ba.JSON.parse){return ba.JSON.parse(bZ)}if(bN.test(bZ.replace(bW,"@").replace(bP,"]").replace(bJ,""))){return(new Function("return "+bZ))()}bE.error("Invalid JSON: "+bZ)},parseXML:function(b1,bZ,b0){if(ba.DOMParser){b0=new DOMParser();bZ=b0.parseFromString(b1,"text/xml")}else{bZ=new ActiveXObject("Microsoft.XMLDOM");bZ.async="false";bZ.loadXML(b1)}b0=bZ.documentElement;if(!b0||!b0.nodeName||b0.nodeName==="parsererror"){bE.error("Invalid XML: "+b1)}return bZ},noop:function(){},globalEval:function(bZ){if(bZ&&bM.test(bZ)){(ba.execScript||function(b0){ba["eval"].call(ba,b0)})(bZ)}},camelCase:function(bZ){return bZ.replace(bA,bT)},nodeName:function(b0,bZ){return b0.nodeName&&b0.nodeName.toUpperCase()===bZ.toUpperCase()},each:function(b2,b5,b1){var b0,b3=0,b4=b2.length,bZ=b4===L||bE.isFunction(b2);if(b1){if(bZ){for(b0 in b2){if(b5.apply(b2[b0],b1)===false){break}}}else{for(;b3<b4;){if(b5.apply(b2[b3++],b1)===false){break}}}}else{if(bZ){for(b0 in b2){if(b5.call(b2[b0],b0,b2[b0])===false){break}}}else{for(;b3<b4;){if(b5.call(b2[b3],b3,b2[b3++])===false){break}}}}return b2},trim:bO?function(bZ){return bZ==null?"":bO.call(bZ)}:function(bZ){return bZ==null?"":bZ.toString().replace(bI,"").replace(bD,"")},makeArray:function(b2,b0){var bZ=b0||[];if(b2!=null){var b1=bE.type(b2);if(b2.length==null||b1==="string"||b1==="function"||b1==="regexp"||bE.isWindow(b2)){by.call(bZ,b2)}else{bE.merge(bZ,b2)}}return bZ},inArray:function(b1,b2){if(bu){return bu.call(b2,b1)}for(var bZ=0,b0=b2.length;bZ<b0;bZ++){if(b2[bZ]===b1){return bZ}}return -1},merge:function(b3,b1){var b2=b3.length,b0=0;if(typeof b1.length==="number"){for(var bZ=b1.length;b0<bZ;b0++){b3[b2++]=b1[b0]}}else{while(b1[b0]!==L){b3[b2++]=b1[b0++]}}b3.length=b2;return b3},grep:function(b0,b5,bZ){var b1=[],b4;bZ=!!bZ;for(var b2=0,b3=b0.length;b2<b3;b2++){b4=!!b5(b0[b2],b2);if(bZ!==b4){b1.push(b0[b2])}}return b1},map:function(bZ,b6,b7){var b4,b5,b3=[],b1=0,b0=bZ.length,b2=bZ instanceof bE||b0!==L&&typeof b0==="number"&&((b0>0&&bZ[0]&&bZ[b0-1])||b0===0||bE.isArray(bZ));if(b2){for(;b1<b0;b1++){b4=b6(bZ[b1],b1,b7);if(b4!=null){b3[b3.length]=b4}}}else{for(b5 in bZ){b4=b6(bZ[b5],b5,b7);if(b4!=null){b3[b3.length]=b4}}}return b3.concat.apply([],b3)},guid:1,proxy:function(b3,b2){if(typeof b2==="string"){var b1=b3[b2];b2=b3;b3=b1}if(!bE.isFunction(b3)){return L}var bZ=bK.call(arguments,2),b0=function(){return b3.apply(b2,bZ.concat(bK.call(arguments)))};b0.guid=b3.guid=b3.guid||b0.guid||bE.guid++;return b0},access:function(bZ,b7,b5,b1,b4,b6){var b0=bZ.length;if(typeof b7==="object"){for(var b2 in b7){bE.access(bZ,b2,b7[b2],b1,b4,b5)}return bZ}if(b5!==L){b1=!b6&&b1&&bE.isFunction(b5);for(var b3=0;b3<b0;b3++){b4(bZ[b3],b7,b1?b5.call(bZ[b3],b3,b4(bZ[b3],b7)):b5,b6)}return bZ}return b0?b4(bZ[0],b7):L},now:function(){return(new Date()).getTime()},uaMatch:function(b0){b0=b0.toLowerCase();var bZ=bx.exec(b0)||bR.exec(b0)||bQ.exec(b0)||b0.indexOf("compatible")<0&&bS.exec(b0)||[];return{browser:bZ[1]||"",version:bZ[2]||"0"}},sub:function(){function bZ(b2,b3){return new bZ.fn.init(b2,b3)}bE.extend(true,bZ,this);bZ.superclass=this;bZ.fn=bZ.prototype=this();bZ.fn.constructor=bZ;bZ.sub=this.sub;bZ.fn.init=function b1(b2,b3){if(b3&&b3 instanceof bE&&!(b3 instanceof bZ)){b3=bZ(b3)}return bE.fn.init.call(this,b2,b3,b0)};bZ.fn.init.prototype=bZ.fn;var b0=bZ(ar);return bZ},browser:{}});bE.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b0,bZ){bw["[object "+bZ+"]"]=bZ.toLowerCase()});bV=bE.uaMatch(bX);if(bV.browser){bE.browser[bV.browser]=true;bE.browser.version=bV.version}if(bE.browser.webkit){bE.browser.safari=true}if(bM.test("\xA0")){bI=/^[\s\xA0]+/;bD=/[\s\xA0]+$/}bC=bE(ar);if(ar.addEventListener){bt=function(){ar.removeEventListener("DOMContentLoaded",bt,false);bE.ready()}}else{if(ar.attachEvent){bt=function(){if(ar.readyState==="complete"){ar.detachEvent("onreadystatechange",bt);bE.ready()}}}}function bv(){if(bE.isReady){return}try{ar.documentElement.doScroll("left")}catch(bZ){setTimeout(bv,1);return}bE.ready()}return bE})();var a="done fail isResolved isRejected promise then always pipe".split(" "),aG=[].slice;b.extend({_Deferred:function(){var bw=[],bx,bu,bv,bt={done:function(){if(!bv){var bz=arguments,bA,bD,bC,bB,by;if(bx){by=bx;bx=0}for(bA=0,bD=bz.length;bA<bD;bA++){bC=bz[bA];bB=b.type(bC);if(bB==="array"){bt.done.apply(bt,bC)}else{if(bB==="function"){bw.push(bC)}}}if(by){bt.resolveWith(by[0],by[1])}}return this},resolveWith:function(bz,by){if(!bv&&!bx&&!bu){by=by||[];bu=1;try{while(bw[0]){bw.shift().apply(bz,by)}}finally{bx=[bz,by];bu=0}}return this},resolve:function(){bt.resolveWith(this,arguments);return this},isResolved:function(){return !!(bu||bx)},cancel:function(){bv=1;bw=[];return this}};return bt},Deferred:function(bu){var bt=b._Deferred(),bw=b._Deferred(),bv;b.extend(bt,{then:function(by,bx){bt.done(by).fail(bx);return this},always:function(){return bt.done.apply(bt,arguments).fail.apply(this,arguments)},fail:bw.done,rejectWith:bw.resolveWith,reject:bw.resolve,isRejected:bw.isResolved,pipe:function(by,bx){return b.Deferred(function(bz){b.each({done:[by,"resolve"],fail:[bx,"reject"]},function(bB,bE){var bA=bE[0],bD=bE[1],bC;if(b.isFunction(bA)){bt[bB](function(){bC=bA.apply(this,arguments);if(bC&&b.isFunction(bC.promise)){bC.promise().then(bz.resolve,bz.reject)}else{bz[bD](bC)}})}else{bt[bB](bz[bD])}})}).promise()},promise:function(by){if(by==null){if(bv){return bv}bv=by={}}var bx=a.length;while(bx--){by[a[bx]]=bt[a[bx]]}return by}});bt.done(bw.cancel).fail(bt.cancel);delete bt.cancel;if(bu){bu.call(bt,bt)}return bt},when:function(bz){var bu=arguments,bv=0,by=bu.length,bx=by,bt=by<=1&&bz&&b.isFunction(bz.promise)?bz:b.Deferred();function bw(bA){return function(bB){bu[bA]=arguments.length>1?aG.call(arguments,0):bB;if(!(--bx)){bt.resolveWith(bt,aG.call(bu,0))}}}if(by>1){for(;bv<by;bv++){if(bu[bv]&&b.isFunction(bu[bv].promise)){bu[bv].promise().then(bw(bv),bt.reject)}else{--bx}}if(!bx){bt.resolveWith(bt,bu)}}else{if(bt!==bz){bt.resolveWith(bt,by?[bz]:[])}}return bt.promise()}});b.support=(function(){var bD=ar.createElement("div"),bK=ar.documentElement,bw,bL,bE,bu,bC,bx,bA,bt,bB,bF,bz,bJ,bH,bv,by,bG,bM;bD.setAttribute("className","t");bD.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";bw=bD.getElementsByTagName("*");bL=bD.getElementsByTagName("a")[0];if(!bw||!bw.length||!bL){return{}}bE=ar.createElement("select");bu=bE.appendChild(ar.createElement("option"));bC=bD.getElementsByTagName("input")[0];bA={leadingWhitespace:(bD.firstChild.nodeType===3),tbody:!bD.getElementsByTagName("tbody").length,htmlSerialize:!!bD.getElementsByTagName("link").length,style:/top/.test(bL.getAttribute("style")),hrefNormalized:(bL.getAttribute("href")==="/a"),opacity:/^0.55$/.test(bL.style.opacity),cssFloat:!!bL.style.cssFloat,checkOn:(bC.value==="on"),optSelected:bu.selected,getSetAttribute:bD.className!=="t",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};bC.checked=true;bA.noCloneChecked=bC.cloneNode(true).checked;bE.disabled=true;bA.optDisabled=!bu.disabled;try{delete bD.test}catch(bI){bA.deleteExpando=false}if(!bD.addEventListener&&bD.attachEvent&&bD.fireEvent){bD.attachEvent("onclick",function(){bA.noCloneEvent=false});bD.cloneNode(true).fireEvent("onclick")}bC=ar.createElement("input");bC.value="t";bC.setAttribute("type","radio");bA.radioValue=bC.value==="t";bC.setAttribute("checked","checked");bD.appendChild(bC);bt=ar.createDocumentFragment();bt.appendChild(bD.firstChild);bA.checkClone=bt.cloneNode(true).cloneNode(true).lastChild.checked;bD.innerHTML="";bD.style.width=bD.style.paddingLeft="1px";bB=ar.getElementsByTagName("body")[0];bz=ar.createElement(bB?"div":"body");bJ={visibility:"hidden",width:0,height:0,border:0,margin:0};if(bB){b.extend(bJ,{position:"absolute",left:-1000,top:-1000})}for(bG in bJ){bz.style[bG]=bJ[bG]}bz.appendChild(bD);bF=bB||bK;bF.insertBefore(bz,bF.firstChild);bA.appendChecked=bC.checked;bA.boxModel=bD.offsetWidth===2;if("zoom" in bD.style){bD.style.display="inline";bD.style.zoom=1;bA.inlineBlockNeedsLayout=(bD.offsetWidth===2);bD.style.display="";bD.innerHTML="<div style='width:4px;'></div>";bA.shrinkWrapBlocks=(bD.offsetWidth!==2)}bD.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";bH=bD.getElementsByTagName("td");bM=(bH[0].offsetHeight===0);bH[0].style.display="";bH[1].style.display="none";bA.reliableHiddenOffsets=bM&&(bH[0].offsetHeight===0);bD.innerHTML="";if(ar.defaultView&&ar.defaultView.getComputedStyle){bx=ar.createElement("div");bx.style.width="0";bx.style.marginRight="0";bD.appendChild(bx);bA.reliableMarginRight=(parseInt((ar.defaultView.getComputedStyle(bx,null)||{marginRight:0}).marginRight,10)||0)===0}bz.innerHTML="";bF.removeChild(bz);if(bD.attachEvent){for(bG in {submit:1,change:1,focusin:1}){by="on"+bG;bM=(by in bD);if(!bM){bD.setAttribute(by,"return;");bM=(typeof bD[by]==="function")}bA[bG+"Bubbles"]=bM}}bz=bt=bE=bu=bB=bx=bD=bC=null;return bA})();b.boxModel=b.support.boxModel;var aN=/^(?:\{.*\}|\[.*\])$/,ax=/([a-z])([A-Z])/g;b.extend({cache:{},uuid:0,expando:"jQuery"+(b.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(bt){bt=bt.nodeType?b.cache[bt[b.expando]]:bt[b.expando];return !!bt&&!U(bt)},data:function(bw,bu,by,bx){if(!b.acceptData(bw)){return}var bB=b.expando,bA=typeof bu==="string",bz,bC=bw.nodeType,bt=bC?b.cache:bw,bv=bC?bw[b.expando]:bw[b.expando]&&b.expando;if((!bv||(bx&&bv&&!bt[bv][bB]))&&bA&&by===L){return}if(!bv){if(bC){bw[b.expando]=bv=++b.uuid}else{bv=b.expando}}if(!bt[bv]){bt[bv]={};if(!bC){bt[bv].toJSON=b.noop}}if(typeof bu==="object"||typeof bu==="function"){if(bx){bt[bv][bB]=b.extend(bt[bv][bB],bu)}else{bt[bv]=b.extend(bt[bv],bu)}}bz=bt[bv];if(bx){if(!bz[bB]){bz[bB]={}}bz=bz[bB]}if(by!==L){bz[b.camelCase(bu)]=by}if(bu==="events"&&!bz[bu]){return bz[bB]&&bz[bB].events}return bA?bz[b.camelCase(bu)]||bz[bu]:bz},removeData:function(bx,bv,by){if(!b.acceptData(bx)){return}var bA=b.expando,bB=bx.nodeType,bu=bB?b.cache:bx,bw=bB?bx[b.expando]:b.expando;if(!bu[bw]){return}if(bv){var bz=by?bu[bw][bA]:bu[bw];if(bz){delete bz[bv];if(!U(bz)){return}}}if(by){delete bu[bw][bA];if(!U(bu[bw])){return}}var bt=bu[bw][bA];if(b.support.deleteExpando||bu!=ba){delete bu[bw]}else{bu[bw]=null}if(bt){bu[bw]={};if(!bB){bu[bw].toJSON=b.noop}bu[bw][bA]=bt}else{if(bB){if(b.support.deleteExpando){delete bx[b.expando]}else{if(bx.removeAttribute){bx.removeAttribute(b.expando)}else{bx[b.expando]=null}}}}},_data:function(bu,bt,bv){return b.data(bu,bt,bv,true)},acceptData:function(bu){if(bu.nodeName){var bt=b.noData[bu.nodeName.toLowerCase()];if(bt){return !(bt===true||bu.getAttribute("classid")!==bt)}}return true}});b.fn.extend({data:function(bx,bz){var by=null;if(typeof bx==="undefined"){if(this.length){by=b.data(this[0]);if(this[0].nodeType===1){var bt=this[0].attributes,bv;for(var bw=0,bu=bt.length;bw<bu;bw++){bv=bt[bw].name;if(bv.indexOf("data-")===0){bv=b.camelCase(bv.substring(5));a3(this[0],bv,by[bv])}}}}return by}else{if(typeof bx==="object"){return this.each(function(){b.data(this,bx)})}}var bA=bx.split(".");bA[1]=bA[1]?"."+bA[1]:"";if(bz===L){by=this.triggerHandler("getData"+bA[1]+"!",[bA[0]]);if(by===L&&this.length){by=b.data(this[0],bx);by=a3(this[0],bx,by)}return by===L&&bA[1]?this.data(bA[0]):by}else{return this.each(function(){var bC=b(this),bB=[bA[0],bz];bC.triggerHandler("setData"+bA[1]+"!",bB);b.data(this,bx,bz);bC.triggerHandler("changeData"+bA[1]+"!",bB)})}},removeData:function(bt){return this.each(function(){b.removeData(this,bt)})}});function a3(bv,bu,bw){if(bw===L&&bv.nodeType===1){var bt="data-"+bu.replace(ax,"$1-$2").toLowerCase();bw=bv.getAttribute(bt);if(typeof bw==="string"){try{bw=bw==="true"?true:bw==="false"?false:bw==="null"?null:!b.isNaN(bw)?parseFloat(bw):aN.test(bw)?b.parseJSON(bw):bw}catch(bx){}b.data(bv,bu,bw)}else{bw=L}}return bw}function U(bu){for(var bt in bu){if(bt!=="toJSON"){return false}}return true}function bf(bx,bw,bz){var bv=bw+"defer",bu=bw+"queue",bt=bw+"mark",by=b.data(bx,bv,L,true);if(by&&(bz==="queue"||!b.data(bx,bu,L,true))&&(bz==="mark"||!b.data(bx,bt,L,true))){setTimeout(function(){if(!b.data(bx,bu,L,true)&&!b.data(bx,bt,L,true)){b.removeData(bx,bv,true);by.resolve()}},0)}}b.extend({_mark:function(bu,bt){if(bu){bt=(bt||"fx")+"mark";b.data(bu,bt,(b.data(bu,bt,L,true)||0)+1,true)}},_unmark:function(bx,bw,bu){if(bx!==true){bu=bw;bw=bx;bx=false}if(bw){bu=bu||"fx";var bt=bu+"mark",bv=bx?0:((b.data(bw,bt,L,true)||1)-1);if(bv){b.data(bw,bt,bv,true)}else{b.removeData(bw,bt,true);bf(bw,bu,"mark")}}},queue:function(bu,bt,bw){if(bu){bt=(bt||"fx")+"queue";var bv=b.data(bu,bt,L,true);if(bw){if(!bv||b.isArray(bw)){bv=b.data(bu,bt,b.makeArray(bw),true)}else{bv.push(bw)}}return bv||[]}},dequeue:function(bw,bv){bv=bv||"fx";var bt=b.queue(bw,bv),bu=bt.shift(),bx;if(bu==="inprogress"){bu=bt.shift()}if(bu){if(bv==="fx"){bt.unshift("inprogress")}bu.call(bw,function(){b.dequeue(bw,bv)})}if(!bt.length){b.removeData(bw,bv+"queue",true);bf(bw,bv,"queue")}}});b.fn.extend({queue:function(bt,bu){if(typeof bt!=="string"){bu=bt;bt="fx"}if(bu===L){return b.queue(this[0],bt)}return this.each(function(){var bv=b.queue(this,bt,bu);if(bt==="fx"&&bv[0]!=="inprogress"){b.dequeue(this,bt)}})},dequeue:function(bt){return this.each(function(){b.dequeue(this,bt)})},delay:function(bu,bt){bu=b.fx?b.fx.speeds[bu]||bu:bu;bt=bt||"fx";return this.queue(bt,function(){var bv=this;setTimeout(function(){b.dequeue(bv,bt)},bu)})},clearQueue:function(bt){return this.queue(bt||"fx",[])},promise:function(bC,bv){if(typeof bC!=="string"){bv=bC;bC=L}bC=bC||"fx";var bt=b.Deferred(),bu=this,bx=bu.length,bA=1,by=bC+"defer",bz=bC+"queue",bB=bC+"mark",bw;function bD(){if(!(--bA)){bt.resolveWith(bu,[bu])}}while(bx--){if((bw=b.data(bu[bx],by,L,true)||(b.data(bu[bx],bz,L,true)||b.data(bu[bx],bB,L,true))&&b.data(bu[bx],by,b._Deferred(),true))){bA++;bw.done(bD)}}bD();return bt.promise()}});var aL=/[\n\t\r]/g,ad=/\s+/,aP=/\r/g,g=/^(?:button|input)$/i,E=/^(?:button|input|object|select|textarea)$/i,l=/^a(?:rea)?$/i,al=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,a6=/\:|^on/,a1,aV;b.fn.extend({attr:function(bt,bu){return b.access(this,bt,bu,true,b.attr)},removeAttr:function(bt){return this.each(function(){b.removeAttr(this,bt)})},prop:function(bt,bu){return b.access(this,bt,bu,true,b.prop)},removeProp:function(bt){bt=b.propFix[bt]||bt;return this.each(function(){try{this[bt]=L;delete this[bt]}catch(bu){}})},addClass:function(bx){var bz,bv,bu,bw,by,bA,bt;if(b.isFunction(bx)){return this.each(function(bB){b(this).addClass(bx.call(this,bB,this.className))})}if(bx&&typeof bx==="string"){bz=bx.split(ad);for(bv=0,bu=this.length;bv<bu;bv++){bw=this[bv];if(bw.nodeType===1){if(!bw.className&&bz.length===1){bw.className=bx}else{by=" "+bw.className+" ";for(bA=0,bt=bz.length;bA<bt;bA++){if(!~by.indexOf(" "+bz[bA]+" ")){by+=bz[bA]+" "}}bw.className=b.trim(by)}}}}return this},removeClass:function(by){var bz,bv,bu,bx,bw,bA,bt;if(b.isFunction(by)){return this.each(function(bB){b(this).removeClass(by.call(this,bB,this.className))})}if((by&&typeof by==="string")||by===L){bz=(by||"").split(ad);for(bv=0,bu=this.length;bv<bu;bv++){bx=this[bv];if(bx.nodeType===1&&bx.className){if(by){bw=(" "+bx.className+" ").replace(aL," ");for(bA=0,bt=bz.length;bA<bt;bA++){bw=bw.replace(" "+bz[bA]+" "," ")}bx.className=b.trim(bw)}else{bx.className=""}}}}return this},toggleClass:function(bw,bu){var bv=typeof bw,bt=typeof bu==="boolean";if(b.isFunction(bw)){return this.each(function(bx){b(this).toggleClass(bw.call(this,bx,this.className,bu),bu)})}return this.each(function(){if(bv==="string"){var bz,by=0,bx=b(this),bA=bu,bB=bw.split(ad);while((bz=bB[by++])){bA=bt?bA:!bx.hasClass(bz);bx[bA?"addClass":"removeClass"](bz)}}else{if(bv==="undefined"||bv==="boolean"){if(this.className){b._data(this,"__className__",this.className)}this.className=this.className||bw===false?"":b._data(this,"__className__")||""}}})},hasClass:function(bt){var bw=" "+bt+" ";for(var bv=0,bu=this.length;bv<bu;bv++){if((" "+this[bv].className+" ").replace(aL," ").indexOf(bw)>-1){return true}}return false},val:function(bw){var bt,bu,bv=this[0];if(!arguments.length){if(bv){bt=b.valHooks[bv.nodeName.toLowerCase()]||b.valHooks[bv.type];if(bt&&"get" in bt&&(bu=bt.get(bv,"value"))!==L){return bu}bu=bv.value;return typeof bu==="string"?bu.replace(aP,""):bu==null?"":bu}return L}var bx=b.isFunction(bw);return this.each(function(bz){var by=b(this),bA;if(this.nodeType!==1){return}if(bx){bA=bw.call(this,bz,by.val())}else{bA=bw}if(bA==null){bA=""}else{if(typeof bA==="number"){bA+=""}else{if(b.isArray(bA)){bA=b.map(bA,function(bB){return bB==null?"":bB+""})}}}bt=b.valHooks[this.nodeName.toLowerCase()]||b.valHooks[this.type];if(!bt||!("set" in bt)||bt.set(this,bA,"value")===L){this.value=bA}})}});b.extend({valHooks:{option:{get:function(bt){var bu=bt.attributes.value;return !bu||bu.specified?bt.value:bt.text}},select:{get:function(bt){var bz,bx=bt.selectedIndex,bA=[],bB=bt.options,bw=bt.type==="select-one";if(bx<0){return null}for(var bu=bw?bx:0,by=bw?bx+1:bB.length;bu<by;bu++){var bv=bB[bu];if(bv.selected&&(b.support.optDisabled?!bv.disabled:bv.getAttribute("disabled")===null)&&(!bv.parentNode.disabled||!b.nodeName(bv.parentNode,"optgroup"))){bz=b(bv).val();if(bw){return bz}bA.push(bz)}}if(bw&&!bA.length&&bB.length){return b(bB[bx]).val()}return bA},set:function(bu,bv){var bt=b.makeArray(bv);b(bu).find("option").each(function(){this.selected=b.inArray(b(this).val(),bt)>=0});if(!bt.length){bu.selectedIndex=-1}return bt}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attrFix:{tabindex:"tabIndex"},attr:function(bz,bw,bA,by){var bu=bz.nodeType;if(!bz||bu===3||bu===8||bu===2){return L}if(by&&bw in b.attrFn){return b(bz)[bw](bA)}if(!("getAttribute" in bz)){return b.prop(bz,bw,bA)}var bv,bt,bx=bu!==1||!b.isXMLDoc(bz);if(bx){bw=b.attrFix[bw]||bw;bt=b.attrHooks[bw];if(!bt){if(al.test(bw)){bt=aV}else{if(a1&&bw!=="className"&&(b.nodeName(bz,"form")||a6.test(bw))){bt=a1}}}}if(bA!==L){if(bA===null){b.removeAttr(bz,bw);return L}else{if(bt&&"set" in bt&&bx&&(bv=bt.set(bz,bA,bw))!==L){return bv}else{bz.setAttribute(bw,""+bA);return bA}}}else{if(bt&&"get" in bt&&bx&&(bv=bt.get(bz,bw))!==null){return bv}else{bv=bz.getAttribute(bw);return bv===null?L:bv}}},removeAttr:function(bu,bt){var bv;if(bu.nodeType===1){bt=b.attrFix[bt]||bt;if(b.support.getSetAttribute){bu.removeAttribute(bt)}else{b.attr(bu,bt,"");bu.removeAttributeNode(bu.getAttributeNode(bt))}if(al.test(bt)&&(bv=b.propFix[bt]||bt) in bu){bu[bv]=false}}},attrHooks:{type:{set:function(bt,bu){if(g.test(bt.nodeName)&&bt.parentNode){b.error("type property can't be changed")}else{if(!b.support.radioValue&&bu==="radio"&&b.nodeName(bt,"input")){var bv=bt.value;bt.setAttribute("type",bu);if(bv){bt.value=bv}return bu}}}},tabIndex:{get:function(bu){var bt=bu.getAttributeNode("tabIndex");return bt&&bt.specified?parseInt(bt.value,10):E.test(bu.nodeName)||l.test(bu.nodeName)&&bu.href?0:L}},value:{get:function(bu,bt){if(a1&&b.nodeName(bu,"button")){return a1.get(bu,bt)}return bt in bu?bu.value:null},set:function(bu,bv,bt){if(a1&&b.nodeName(bu,"button")){return a1.set(bu,bv,bt)}bu.value=bv}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(by,bw,bz){var bu=by.nodeType;if(!by||bu===3||bu===8||bu===2){return L}var bv,bt,bx=bu!==1||!b.isXMLDoc(by);if(bx){bw=b.propFix[bw]||bw;bt=b.propHooks[bw]}if(bz!==L){if(bt&&"set" in bt&&(bv=bt.set(by,bz,bw))!==L){return bv}else{return(by[bw]=bz)}}else{if(bt&&"get" in bt&&(bv=bt.get(by,bw))!==L){return bv}else{return by[bw]}}},propHooks:{}});aV={get:function(bu,bt){return b.prop(bu,bt)?bt.toLowerCase():L},set:function(bu,bw,bt){var bv;if(bw===false){b.removeAttr(bu,bt)}else{bv=b.propFix[bt]||bt;if(bv in bu){bu[bv]=true}bu.setAttribute(bt,bt.toLowerCase())}return bt}};if(!b.support.getSetAttribute){b.attrFix=b.propFix;a1=b.attrHooks.name=b.attrHooks.title=b.valHooks.button={get:function(bv,bu){var bt;bt=bv.getAttributeNode(bu);return bt&&bt.nodeValue!==""?bt.nodeValue:L},set:function(bv,bw,bu){var bt=bv.getAttributeNode(bu);if(bt){bt.nodeValue=bw;return bw}}};b.each(["width","height"],function(bu,bt){b.attrHooks[bt]=b.extend(b.attrHooks[bt],{set:function(bv,bw){if(bw===""){bv.setAttribute(bt,"auto");return bw}}})})}if(!b.support.hrefNormalized){b.each(["href","src","width","height"],function(bu,bt){b.attrHooks[bt]=b.extend(b.attrHooks[bt],{get:function(bw){var bv=bw.getAttribute(bt,2);return bv===null?L:bv}})})}if(!b.support.style){b.attrHooks.style={get:function(bt){return bt.style.cssText.toLowerCase()||L},set:function(bt,bu){return(bt.style.cssText=""+bu)}}}if(!b.support.optSelected){b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(bu){var bt=bu.parentNode;if(bt){bt.selectedIndex;if(bt.parentNode){bt.parentNode.selectedIndex}}}})}if(!b.support.checkOn){b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(bt){return bt.getAttribute("value")===null?"on":bt.value}}})}b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(bt,bu){if(b.isArray(bu)){return(bt.checked=b.inArray(b(bt).val(),bu)>=0)}}})});var aX=/\.(.*)$/,bc=/^(?:textarea|input|select)$/i,O=/\./g,bg=/ /g,aD=/[^\w\s.|`]/g,H=function(bt){return bt.replace(aD,"\\$&")};b.event={add:function(bw,bA,bF,by){if(bw.nodeType===3||bw.nodeType===8){return}if(bF===false){bF=bi}else{if(!bF){return}}var bu,bE;if(bF.handler){bu=bF;bF=bu.handler}if(!bF.guid){bF.guid=b.guid++}var bB=b._data(bw);if(!bB){return}var bG=bB.events,bz=bB.handle;if(!bG){bB.events=bG={}}if(!bz){bB.handle=bz=function(bH){return typeof b!=="undefined"&&(!bH||b.event.triggered!==bH.type)?b.event.handle.apply(bz.elem,arguments):L}}bz.elem=bw;bA=bA.split(" ");var bD,bx=0,bt;while((bD=bA[bx++])){bE=bu?b.extend({},bu):{handler:bF,data:by};if(bD.indexOf(".")>-1){bt=bD.split(".");bD=bt.shift();bE.namespace=bt.slice(0).sort().join(".")}else{bt=[];bE.namespace=""}bE.type=bD;if(!bE.guid){bE.guid=bF.guid}var bv=bG[bD],bC=b.event.special[bD]||{};if(!bv){bv=bG[bD]=[];if(!bC.setup||bC.setup.call(bw,by,bt,bz)===false){if(bw.addEventListener){bw.addEventListener(bD,bz,false)}else{if(bw.attachEvent){bw.attachEvent("on"+bD,bz)}}}}if(bC.add){bC.add.call(bw,bE);if(!bE.handler.guid){bE.handler.guid=bF.guid}}bv.push(bE);b.event.global[bD]=true}bw=null},global:{},remove:function(bI,bD,bv,bz){if(bI.nodeType===3||bI.nodeType===8){return}if(bv===false){bv=bi}var bL,by,bA,bF,bG=0,bw,bB,bE,bx,bC,bt,bK,bH=b.hasData(bI)&&b._data(bI),bu=bH&&bH.events;if(!bH||!bu){return}if(bD&&bD.type){bv=bD.handler;bD=bD.type}if(!bD||typeof bD==="string"&&bD.charAt(0)==="."){bD=bD||"";for(by in bu){b.event.remove(bI,by+bD)}return}bD=bD.split(" ");while((by=bD[bG++])){bK=by;bt=null;bw=by.indexOf(".")<0;bB=[];if(!bw){bB=by.split(".");by=bB.shift();bE=new RegExp("(^|\\.)"+b.map(bB.slice(0).sort(),H).join("\\.(?:.*\\.)?")+"(\\.|$)")}bC=bu[by];if(!bC){continue}if(!bv){for(bF=0;bF<bC.length;bF++){bt=bC[bF];if(bw||bE.test(bt.namespace)){b.event.remove(bI,bK,bt.handler,bF);bC.splice(bF--,1)}}continue}bx=b.event.special[by]||{};for(bF=bz||0;bF<bC.length;bF++){bt=bC[bF];if(bv.guid===bt.guid){if(bw||bE.test(bt.namespace)){if(bz==null){bC.splice(bF--,1)}if(bx.remove){bx.remove.call(bI,bt)}}if(bz!=null){break}}}if(bC.length===0||bz!=null&&bC.length===1){if(!bx.teardown||bx.teardown.call(bI,bB)===false){b.removeEvent(bI,by,bH.handle)}bL=null;delete bu[by]}}if(b.isEmptyObject(bu)){var bJ=bH.handle;if(bJ){bJ.elem=null}delete bH.events;delete bH.handle;if(b.isEmptyObject(bH)){b.removeData(bI,L,true)}}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(bt,bA,by,bF){var bD=bt.type||bt,bv=[],bu;if(bD.indexOf("!")>=0){bD=bD.slice(0,-1);bu=true}if(bD.indexOf(".")>=0){bv=bD.split(".");bD=bv.shift();bv.sort()}if((!by||b.event.customEvent[bD])&&!b.event.global[bD]){return}bt=typeof bt==="object"?bt[b.expando]?bt:new b.Event(bD,bt):new b.Event(bD);bt.type=bD;bt.exclusive=bu;bt.namespace=bv.join(".");bt.namespace_re=new RegExp("(^|\\.)"+bv.join("\\.(?:.*\\.)?")+"(\\.|$)");if(bF||!by){bt.preventDefault();bt.stopPropagation()}if(!by){b.each(b.cache,function(){var bH=b.expando,bG=this[bH];if(bG&&bG.events&&bG.events[bD]){b.event.trigger(bt,bA,bG.handle.elem)}});return}if(by.nodeType===3||by.nodeType===8){return}bt.result=L;bt.target=by;bA=bA!=null?b.makeArray(bA):[];bA.unshift(bt);var bE=by,bw=bD.indexOf(":")<0?"on"+bD:"";do{var bB=b._data(bE,"handle");bt.currentTarget=bE;if(bB){bB.apply(bE,bA)}if(bw&&b.acceptData(bE)&&bE[bw]&&bE[bw].apply(bE,bA)===false){bt.result=false;bt.preventDefault()}bE=bE.parentNode||bE.ownerDocument||bE===bt.target.ownerDocument&&ba}while(bE&&!bt.isPropagationStopped());if(!bt.isDefaultPrevented()){var bx,bC=b.event.special[bD]||{};if((!bC._default||bC._default.call(by.ownerDocument,bt)===false)&&!(bD==="click"&&b.nodeName(by,"a"))&&b.acceptData(by)){try{if(bw&&by[bD]){bx=by[bw];if(bx){by[bw]=null}b.event.triggered=bD;by[bD]()}}catch(bz){}if(bx){by[bw]=bx}b.event.triggered=L}}return bt.result},handle:function(bA){bA=b.event.fix(bA||ba.event);var bu=((b._data(this,"events")||{})[bA.type]||[]).slice(0),bz=!bA.exclusive&&!bA.namespace,bx=Array.prototype.slice.call(arguments,0);bx[0]=bA;bA.currentTarget=this;for(var bw=0,bt=bu.length;bw<bt;bw++){var by=bu[bw];if(bz||bA.namespace_re.test(by.namespace)){bA.handler=by.handler;bA.data=by.data;bA.handleObj=by;var bv=by.handler.apply(this,bx);if(bv!==L){bA.result=bv;if(bv===false){bA.preventDefault();bA.stopPropagation()}}if(bA.isImmediatePropagationStopped()){break}}}return bA.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(bx){if(bx[b.expando]){return bx}var bu=bx;bx=b.Event(bu);for(var bv=this.props.length,bz;bv;){bz=this.props[--bv];bx[bz]=bu[bz]}if(!bx.target){bx.target=bx.srcElement||ar}if(bx.target.nodeType===3){bx.target=bx.target.parentNode}if(!bx.relatedTarget&&bx.fromElement){bx.relatedTarget=bx.fromElement===bx.target?bx.toElement:bx.fromElement}if(bx.pageX==null&&bx.clientX!=null){var bw=bx.target.ownerDocument||ar,by=bw.documentElement,bt=bw.body;bx.pageX=bx.clientX+(by&&by.scrollLeft||bt&&bt.scrollLeft||0)-(by&&by.clientLeft||bt&&bt.clientLeft||0);bx.pageY=bx.clientY+(by&&by.scrollTop||bt&&bt.scrollTop||0)-(by&&by.clientTop||bt&&bt.clientTop||0)}if(bx.which==null&&(bx.charCode!=null||bx.keyCode!=null)){bx.which=bx.charCode!=null?bx.charCode:bx.keyCode}if(!bx.metaKey&&bx.ctrlKey){bx.metaKey=bx.ctrlKey}if(!bx.which&&bx.button!==L){bx.which=(bx.button&1?1:(bx.button&2?3:(bx.button&4?2:0)))}return bx},guid:100000000,proxy:b.proxy,special:{ready:{setup:b.bindReady,teardown:b.noop},live:{add:function(bt){b.event.add(this,p(bt.origType,bt.selector),b.extend({},bt,{handler:aj,guid:bt.handler.guid}))},remove:function(bt){b.event.remove(this,p(bt.origType,bt.selector),bt)}},beforeunload:{setup:function(bv,bu,bt){if(b.isWindow(this)){this.onbeforeunload=bt}},teardown:function(bu,bt){if(this.onbeforeunload===bt){this.onbeforeunload=null}}}}};b.removeEvent=ar.removeEventListener?function(bu,bt,bv){if(bu.removeEventListener){bu.removeEventListener(bt,bv,false)}}:function(bu,bt,bv){if(bu.detachEvent){bu.detachEvent("on"+bt,bv)}};b.Event=function(bu,bt){if(!this.preventDefault){return new b.Event(bu,bt)}if(bu&&bu.type){this.originalEvent=bu;this.type=bu.type;this.isDefaultPrevented=(bu.defaultPrevented||bu.returnValue===false||bu.getPreventDefault&&bu.getPreventDefault())?i:bi}else{this.type=bu}if(bt){b.extend(this,bt)}this.timeStamp=b.now();this[b.expando]=true};function bi(){return false}function i(){return true}b.Event.prototype={preventDefault:function(){this.isDefaultPrevented=i;var bt=this.originalEvent;if(!bt){return}if(bt.preventDefault){bt.preventDefault()}else{bt.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=i;var bt=this.originalEvent;if(!bt){return}if(bt.stopPropagation){bt.stopPropagation()}bt.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i;this.stopPropagation()},isDefaultPrevented:bi,isPropagationStopped:bi,isImmediatePropagationStopped:bi};var ac=function(bv){var bw=bv.relatedTarget,bt=false,bu=bv.type;bv.type=bv.data;if(bw!==this){if(bw){bt=b.contains(this,bw)}if(!bt){b.event.handle.apply(this,arguments);bv.type=bu}}},aS=function(bt){bt.type=bt.data;b.event.handle.apply(this,arguments)};b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(bu,bt){b.event.special[bu]={setup:function(bv){b.event.add(this,bt,bv&&bv.selector?aS:ac,bu)},teardown:function(bv){b.event.remove(this,bt,bv&&bv.selector?aS:ac)}}});if(!b.support.submitBubbles){b.event.special.submit={setup:function(bu,bt){if(!b.nodeName(this,"form")){b.event.add(this,"click.specialSubmit",function(bx){var bw=bx.target,bv=bw.type;if((bv==="submit"||bv==="image")&&b(bw).closest("form").length){aU("submit",this,arguments)}});b.event.add(this,"keypress.specialSubmit",function(bx){var bw=bx.target,bv=bw.type;if((bv==="text"||bv==="password")&&b(bw).closest("form").length&&bx.keyCode===13){aU("submit",this,arguments)}})}else{return false}},teardown:function(bt){b.event.remove(this,".specialSubmit")}}}if(!b.support.changeBubbles){var bl,k=function(bu){var bt=bu.type,bv=bu.value;if(bt==="radio"||bt==="checkbox"){bv=bu.checked}else{if(bt==="select-multiple"){bv=bu.selectedIndex>-1?b.map(bu.options,function(bw){return bw.selected}).join("-"):""}else{if(b.nodeName(bu,"select")){bv=bu.selectedIndex}}}return bv},aa=function aa(bv){var bt=bv.target,bu,bw;if(!bc.test(bt.nodeName)||bt.readOnly){return}bu=b._data(bt,"_change_data");bw=k(bt);if(bv.type!=="focusout"||bt.type!=="radio"){b._data(bt,"_change_data",bw)}if(bu===L||bw===bu){return}if(bu!=null||bw){bv.type="change";bv.liveFired=L;b.event.trigger(bv,arguments[1],bt)}};b.event.special.change={filters:{focusout:aa,beforedeactivate:aa,click:function(bv){var bu=bv.target,bt=b.nodeName(bu,"input")?bu.type:"";if(bt==="radio"||bt==="checkbox"||b.nodeName(bu,"select")){aa.call(this,bv)}},keydown:function(bv){var bu=bv.target,bt=b.nodeName(bu,"input")?bu.type:"";if((bv.keyCode===13&&!b.nodeName(bu,"textarea"))||(bv.keyCode===32&&(bt==="checkbox"||bt==="radio"))||bt==="select-multiple"){aa.call(this,bv)}},beforeactivate:function(bu){var bt=bu.target;b._data(bt,"_change_data",k(bt))}},setup:function(bv,bu){if(this.type==="file"){return false}for(var bt in bl){b.event.add(this,bt+".specialChange",bl[bt])}return bc.test(this.nodeName)},teardown:function(bt){b.event.remove(this,".specialChange");return bc.test(this.nodeName)}};bl=b.event.special.change.filters;bl.focus=bl.beforeactivate}function aU(bu,bw,bt){var bv=b.extend({},bt[0]);bv.type=bu;bv.originalEvent={};bv.liveFired=L;b.event.handle.call(bw,bv);if(bv.isDefaultPrevented()){bt[0].preventDefault()}}if(!b.support.focusinBubbles){b.each({focus:"focusin",blur:"focusout"},function(bw,bt){var bu=0;b.event.special[bt]={setup:function(){if(bu++===0){ar.addEventListener(bw,bv,true)}},teardown:function(){if(--bu===0){ar.removeEventListener(bw,bv,true)}}};function bv(bx){var by=b.event.fix(bx);by.type=bt;by.originalEvent={};b.event.trigger(by,null,by.target);if(by.isDefaultPrevented()){bx.preventDefault()}}})}b.each(["bind","one"],function(bu,bt){b.fn[bt]=function(bA,bB,bz){var by;if(typeof bA==="object"){for(var bx in bA){this[bt](bx,bB,bA[bx],bz)}return this}if(arguments.length===2||bB===false){bz=bB;bB=L}if(bt==="one"){by=function(bC){b(this).unbind(bC,by);return bz.apply(this,arguments)};by.guid=bz.guid||b.guid++}else{by=bz}if(bA==="unload"&&bt!=="one"){this.one(bA,bB,bz)}else{for(var bw=0,bv=this.length;bw<bv;bw++){b.event.add(this[bw],bA,by,bB)}}return this}});b.fn.extend({unbind:function(bx,bw){if(typeof bx==="object"&&!bx.preventDefault){for(var bv in bx){this.unbind(bv,bx[bv])}}else{for(var bu=0,bt=this.length;bu<bt;bu++){b.event.remove(this[bu],bx,bw)}}return this},delegate:function(bt,bu,bw,bv){return this.live(bu,bw,bv,bt)},undelegate:function(bt,bu,bv){if(arguments.length===0){return this.unbind("live")}else{return this.die(bu,null,bv,bt)}},trigger:function(bt,bu){return this.each(function(){b.event.trigger(bt,bu,this)})},triggerHandler:function(bt,bu){if(this[0]){return b.event.trigger(bt,bu,this[0],true)}},toggle:function(bw){var bu=arguments,bt=bw.guid||b.guid++,bv=0,bx=function(by){var bz=(b.data(this,"lastToggle"+bw.guid)||0)%bv;b.data(this,"lastToggle"+bw.guid,bz+1);by.preventDefault();return bu[bz].apply(this,arguments)||false};bx.guid=bt;while(bv<bu.length){bu[bv++].guid=bt}return this.click(bx)},hover:function(bt,bu){return this.mouseenter(bt).mouseleave(bu||bt)}});var aQ={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};b.each(["live","die"],function(bu,bt){b.fn[bt]=function(bE,bB,bG,bx){var bF,bC=0,bD,bw,bI,bz=bx||this.selector,bv=bx?this:b(this.context);if(typeof bE==="object"&&!bE.preventDefault){for(var bH in bE){bv[bt](bH,bB,bE[bH],bz)}return this}if(bt==="die"&&!bE&&bx&&bx.charAt(0)==="."){bv.unbind(bx);return this}if(bB===false||b.isFunction(bB)){bG=bB||bi;bB=L}bE=(bE||"").split(" ");while((bF=bE[bC++])!=null){bD=aX.exec(bF);bw="";if(bD){bw=bD[0];bF=bF.replace(aX,"")}if(bF==="hover"){bE.push("mouseenter"+bw,"mouseleave"+bw);continue}bI=bF;if(aQ[bF]){bE.push(aQ[bF]+bw);bF=bF+bw}else{bF=(aQ[bF]||bF)+bw}if(bt==="live"){for(var bA=0,by=bv.length;bA<by;bA++){b.event.add(bv[bA],"live."+p(bF,bz),{data:bB,selector:bz,handler:bG,origType:bF,origHandler:bG,preType:bI})}}else{bv.unbind("live."+p(bF,bz),bG)}}return this}});function aj(bE){var bB,bw,bK,by,bt,bG,bD,bF,bC,bJ,bA,bz,bI,bH=[],bx=[],bu=b._data(this,"events");if(bE.liveFired===this||!bu||!bu.live||bE.target.disabled||bE.button&&bE.type==="click"){return}if(bE.namespace){bz=new RegExp("(^|\\.)"+bE.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")}bE.liveFired=this;var bv=bu.live.slice(0);for(bD=0;bD<bv.length;bD++){bt=bv[bD];if(bt.origType.replace(aX,"")===bE.type){bx.push(bt.selector)}else{bv.splice(bD--,1)}}by=b(bE.target).closest(bx,bE.currentTarget);for(bF=0,bC=by.length;bF<bC;bF++){bA=by[bF];for(bD=0;bD<bv.length;bD++){bt=bv[bD];if(bA.selector===bt.selector&&(!bz||bz.test(bt.namespace))&&!bA.elem.disabled){bG=bA.elem;bK=null;if(bt.preType==="mouseenter"||bt.preType==="mouseleave"){bE.type=bt.preType;bK=b(bE.relatedTarget).closest(bt.selector)[0];if(bK&&b.contains(bG,bK)){bK=bG}}if(!bK||bK!==bG){bH.push({elem:bG,handleObj:bt,level:bA.level})}}}}for(bF=0,bC=bH.length;bF<bC;bF++){by=bH[bF];if(bw&&by.level>bw){break}bE.currentTarget=by.elem;bE.data=by.handleObj.data;bE.handleObj=by.handleObj;bI=by.handleObj.origHandler.apply(by.elem,arguments);if(bI===false||bE.isPropagationStopped()){bw=by.level;if(bI===false){bB=false}if(bE.isImmediatePropagationStopped()){break}}}return bB}function p(bu,bt){return(bu&&bu!=="*"?bu+".":"")+bt.replace(O,"`").replace(bg,"&")}b.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error").split(" "),function(bu,bt){b.fn[bt]=function(bw,bv){if(bv==null){bv=bw;bw=null}return arguments.length>0?this.bind(bt,bw,bv):this.trigger(bt)};if(b.attrFn){b.attrFn[bt]=true}});
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var bD=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,bE=0,bH=Object.prototype.toString,by=false,bx=true,bF=/\\/g,bL=/\W/;[0,0].sort(function(){bx=false;return 0});var bv=function(bR,bM,bU,bV){bU=bU||[];bM=bM||ar;var bX=bM;if(bM.nodeType!==1&&bM.nodeType!==9){return[]}if(!bR||typeof bR!=="string"){return bU}var bO,bZ,b2,bN,bY,b1,b0,bT,bQ=true,bP=bv.isXML(bM),bS=[],bW=bR;do{bD.exec("");bO=bD.exec(bW);if(bO){bW=bO[3];bS.push(bO[1]);if(bO[2]){bN=bO[3];break}}}while(bO);if(bS.length>1&&bz.exec(bR)){if(bS.length===2&&bA.relative[bS[0]]){bZ=bI(bS[0]+bS[1],bM)}else{bZ=bA.relative[bS[0]]?[bM]:bv(bS.shift(),bM);while(bS.length){bR=bS.shift();if(bA.relative[bR]){bR+=bS.shift()}bZ=bI(bR,bZ)}}}else{if(!bV&&bS.length>1&&bM.nodeType===9&&!bP&&bA.match.ID.test(bS[0])&&!bA.match.ID.test(bS[bS.length-1])){bY=bv.find(bS.shift(),bM,bP);bM=bY.expr?bv.filter(bY.expr,bY.set)[0]:bY.set[0]}if(bM){bY=bV?{expr:bS.pop(),set:bB(bV)}:bv.find(bS.pop(),bS.length===1&&(bS[0]==="~"||bS[0]==="+")&&bM.parentNode?bM.parentNode:bM,bP);bZ=bY.expr?bv.filter(bY.expr,bY.set):bY.set;if(bS.length>0){b2=bB(bZ)}else{bQ=false}while(bS.length){b1=bS.pop();b0=b1;if(!bA.relative[b1]){b1=""}else{b0=bS.pop()}if(b0==null){b0=bM}bA.relative[b1](b2,b0,bP)}}else{b2=bS=[]}}if(!b2){b2=bZ}if(!b2){bv.error(b1||bR)}if(bH.call(b2)==="[object Array]"){if(!bQ){bU.push.apply(bU,b2)}else{if(bM&&bM.nodeType===1){for(bT=0;b2[bT]!=null;bT++){if(b2[bT]&&(b2[bT]===true||b2[bT].nodeType===1&&bv.contains(bM,b2[bT]))){bU.push(bZ[bT])}}}else{for(bT=0;b2[bT]!=null;bT++){if(b2[bT]&&b2[bT].nodeType===1){bU.push(bZ[bT])}}}}}else{bB(b2,bU)}if(bN){bv(bN,bX,bU,bV);bv.uniqueSort(bU)}return bU};bv.uniqueSort=function(bN){if(bG){by=bx;bN.sort(bG);if(by){for(var bM=1;bM<bN.length;bM++){if(bN[bM]===bN[bM-1]){bN.splice(bM--,1)}}}}return bN};bv.matches=function(bM,bN){return bv(bM,null,null,bN)};bv.matchesSelector=function(bM,bN){return bv(bN,null,null,[bM]).length>0};bv.find=function(bT,bM,bU){var bS;if(!bT){return[]}for(var bP=0,bO=bA.order.length;bP<bO;bP++){var bQ,bR=bA.order[bP];if((bQ=bA.leftMatch[bR].exec(bT))){var bN=bQ[1];bQ.splice(1,1);if(bN.substr(bN.length-1)!=="\\"){bQ[1]=(bQ[1]||"").replace(bF,"");bS=bA.find[bR](bQ,bM,bU);if(bS!=null){bT=bT.replace(bA.match[bR],"");break}}}}if(!bS){bS=typeof bM.getElementsByTagName!=="undefined"?bM.getElementsByTagName("*"):[]}return{set:bS,expr:bT}};bv.filter=function(bX,bW,b0,bQ){var bS,bM,bO=bX,b2=[],bU=bW,bT=bW&&bW[0]&&bv.isXML(bW[0]);while(bX&&bW.length){for(var bV in bA.filter){if((bS=bA.leftMatch[bV].exec(bX))!=null&&bS[2]){var b1,bZ,bN=bA.filter[bV],bP=bS[1];bM=false;bS.splice(1,1);if(bP.substr(bP.length-1)==="\\"){continue}if(bU===b2){b2=[]}if(bA.preFilter[bV]){bS=bA.preFilter[bV](bS,bU,b0,b2,bQ,bT);if(!bS){bM=b1=true}else{if(bS===true){continue}}}if(bS){for(var bR=0;(bZ=bU[bR])!=null;bR++){if(bZ){b1=bN(bZ,bS,bR,bU);var bY=bQ^!!b1;if(b0&&b1!=null){if(bY){bM=true}else{bU[bR]=false}}else{if(bY){b2.push(bZ);bM=true}}}}}if(b1!==L){if(!b0){bU=b2}bX=bX.replace(bA.match[bV],"");if(!bM){return[]}break}}}if(bX===bO){if(bM==null){bv.error(bX)}else{break}}bO=bX}return bU};bv.error=function(bM){throw"Syntax error, unrecognized expression: "+bM};var bA=bv.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(bM){return bM.getAttribute("href")},type:function(bM){return bM.getAttribute("type")}},relative:{"+":function(bS,bN){var bP=typeof bN==="string",bR=bP&&!bL.test(bN),bT=bP&&!bR;if(bR){bN=bN.toLowerCase()}for(var bO=0,bM=bS.length,bQ;bO<bM;bO++){if((bQ=bS[bO])){while((bQ=bQ.previousSibling)&&bQ.nodeType!==1){}bS[bO]=bT||bQ&&bQ.nodeName.toLowerCase()===bN?bQ||false:bQ===bN}}if(bT){bv.filter(bN,bS,true)}},">":function(bS,bN){var bR,bQ=typeof bN==="string",bO=0,bM=bS.length;if(bQ&&!bL.test(bN)){bN=bN.toLowerCase();for(;bO<bM;bO++){bR=bS[bO];if(bR){var bP=bR.parentNode;bS[bO]=bP.nodeName.toLowerCase()===bN?bP:false}}}else{for(;bO<bM;bO++){bR=bS[bO];if(bR){bS[bO]=bQ?bR.parentNode:bR.parentNode===bN}}if(bQ){bv.filter(bN,bS,true)}}},"":function(bP,bN,bR){var bQ,bO=bE++,bM=bJ;if(typeof bN==="string"&&!bL.test(bN)){bN=bN.toLowerCase();bQ=bN;bM=bt}bM("parentNode",bN,bO,bP,bQ,bR)},"~":function(bP,bN,bR){var bQ,bO=bE++,bM=bJ;if(typeof bN==="string"&&!bL.test(bN)){bN=bN.toLowerCase();bQ=bN;bM=bt}bM("previousSibling",bN,bO,bP,bQ,bR)}},find:{ID:function(bN,bO,bP){if(typeof bO.getElementById!=="undefined"&&!bP){var bM=bO.getElementById(bN[1]);return bM&&bM.parentNode?[bM]:[]}},NAME:function(bO,bR){if(typeof bR.getElementsByName!=="undefined"){var bN=[],bQ=bR.getElementsByName(bO[1]);for(var bP=0,bM=bQ.length;bP<bM;bP++){if(bQ[bP].getAttribute("name")===bO[1]){bN.push(bQ[bP])}}return bN.length===0?null:bN}},TAG:function(bM,bN){if(typeof bN.getElementsByTagName!=="undefined"){return bN.getElementsByTagName(bM[1])}}},preFilter:{CLASS:function(bP,bN,bO,bM,bS,bT){bP=" "+bP[1].replace(bF,"")+" ";if(bT){return bP}for(var bQ=0,bR;(bR=bN[bQ])!=null;bQ++){if(bR){if(bS^(bR.className&&(" "+bR.className+" ").replace(/[\t\n\r]/g," ").indexOf(bP)>=0)){if(!bO){bM.push(bR)}}else{if(bO){bN[bQ]=false}}}}return false},ID:function(bM){return bM[1].replace(bF,"")},TAG:function(bN,bM){return bN[1].replace(bF,"").toLowerCase()},CHILD:function(bM){if(bM[1]==="nth"){if(!bM[2]){bv.error(bM[0])}bM[2]=bM[2].replace(/^\+|\s*/g,"");var bN=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(bM[2]==="even"&&"2n"||bM[2]==="odd"&&"2n+1"||!/\D/.test(bM[2])&&"0n+"+bM[2]||bM[2]);bM[2]=(bN[1]+(bN[2]||1))-0;bM[3]=bN[3]-0}else{if(bM[2]){bv.error(bM[0])}}bM[0]=bE++;return bM},ATTR:function(bQ,bN,bO,bM,bR,bS){var bP=bQ[1]=bQ[1].replace(bF,"");if(!bS&&bA.attrMap[bP]){bQ[1]=bA.attrMap[bP]}bQ[4]=(bQ[4]||bQ[5]||"").replace(bF,"");if(bQ[2]==="~="){bQ[4]=" "+bQ[4]+" "}return bQ},PSEUDO:function(bQ,bN,bO,bM,bR){if(bQ[1]==="not"){if((bD.exec(bQ[3])||"").length>1||/^\w/.test(bQ[3])){bQ[3]=bv(bQ[3],null,null,bN)}else{var bP=bv.filter(bQ[3],bN,bO,true^bR);if(!bO){bM.push.apply(bM,bP)}return false}}else{if(bA.match.POS.test(bQ[0])||bA.match.CHILD.test(bQ[0])){return true}}return bQ},POS:function(bM){bM.unshift(true);return bM}},filters:{enabled:function(bM){return bM.disabled===false&&bM.type!=="hidden"},disabled:function(bM){return bM.disabled===true},checked:function(bM){return bM.checked===true},selected:function(bM){if(bM.parentNode){bM.parentNode.selectedIndex}return bM.selected===true},parent:function(bM){return !!bM.firstChild},empty:function(bM){return !bM.firstChild},has:function(bO,bN,bM){return !!bv(bM[3],bO).length},header:function(bM){return(/h\d/i).test(bM.nodeName)},text:function(bO){var bM=bO.getAttribute("type"),bN=bO.type;return bO.nodeName.toLowerCase()==="input"&&"text"===bN&&(bM===bN||bM===null)},radio:function(bM){return bM.nodeName.toLowerCase()==="input"&&"radio"===bM.type},checkbox:function(bM){return bM.nodeName.toLowerCase()==="input"&&"checkbox"===bM.type},file:function(bM){return bM.nodeName.toLowerCase()==="input"&&"file"===bM.type},password:function(bM){return bM.nodeName.toLowerCase()==="input"&&"password"===bM.type},submit:function(bN){var bM=bN.nodeName.toLowerCase();return(bM==="input"||bM==="button")&&"submit"===bN.type},image:function(bM){return bM.nodeName.toLowerCase()==="input"&&"image"===bM.type},reset:function(bN){var bM=bN.nodeName.toLowerCase();return(bM==="input"||bM==="button")&&"reset"===bN.type},button:function(bN){var bM=bN.nodeName.toLowerCase();return bM==="input"&&"button"===bN.type||bM==="button"},input:function(bM){return(/input|select|textarea|button/i).test(bM.nodeName)},focus:function(bM){return bM===bM.ownerDocument.activeElement}},setFilters:{first:function(bN,bM){return bM===0},last:function(bO,bN,bM,bP){return bN===bP.length-1},even:function(bN,bM){return bM%2===0},odd:function(bN,bM){return bM%2===1},lt:function(bO,bN,bM){return bN<bM[3]-0},gt:function(bO,bN,bM){return bN>bM[3]-0},nth:function(bO,bN,bM){return bM[3]-0===bN},eq:function(bO,bN,bM){return bM[3]-0===bN}},filter:{PSEUDO:function(bO,bT,bS,bU){var bM=bT[1],bN=bA.filters[bM];if(bN){return bN(bO,bS,bT,bU)}else{if(bM==="contains"){return(bO.textContent||bO.innerText||bv.getText([bO])||"").indexOf(bT[3])>=0}else{if(bM==="not"){var bP=bT[3];for(var bR=0,bQ=bP.length;bR<bQ;bR++){if(bP[bR]===bO){return false}}return true}else{bv.error(bM)}}}},CHILD:function(bM,bP){var bS=bP[1],bN=bM;switch(bS){case"only":case"first":while((bN=bN.previousSibling)){if(bN.nodeType===1){return false}}if(bS==="first"){return true}bN=bM;case"last":while((bN=bN.nextSibling)){if(bN.nodeType===1){return false}}return true;case"nth":var bO=bP[2],bV=bP[3];if(bO===1&&bV===0){return true}var bR=bP[0],bU=bM.parentNode;if(bU&&(bU.sizcache!==bR||!bM.nodeIndex)){var bQ=0;for(bN=bU.firstChild;bN;bN=bN.nextSibling){if(bN.nodeType===1){bN.nodeIndex=++bQ}}bU.sizcache=bR}var bT=bM.nodeIndex-bV;if(bO===0){return bT===0}else{return(bT%bO===0&&bT/bO>=0)}}},ID:function(bN,bM){return bN.nodeType===1&&bN.getAttribute("id")===bM},TAG:function(bN,bM){return(bM==="*"&&bN.nodeType===1)||bN.nodeName.toLowerCase()===bM},CLASS:function(bN,bM){return(" "+(bN.className||bN.getAttribute("class"))+" ").indexOf(bM)>-1},ATTR:function(bR,bP){var bO=bP[1],bM=bA.attrHandle[bO]?bA.attrHandle[bO](bR):bR[bO]!=null?bR[bO]:bR.getAttribute(bO),bS=bM+"",bQ=bP[2],bN=bP[4];return bM==null?bQ==="!=":bQ==="="?bS===bN:bQ==="*="?bS.indexOf(bN)>=0:bQ==="~="?(" "+bS+" ").indexOf(bN)>=0:!bN?bS&&bM!==false:bQ==="!="?bS!==bN:bQ==="^="?bS.indexOf(bN)===0:bQ==="$="?bS.substr(bS.length-bN.length)===bN:bQ==="|="?bS===bN||bS.substr(0,bN.length+1)===bN+"-":false},POS:function(bQ,bN,bO,bR){var bM=bN[2],bP=bA.setFilters[bM];if(bP){return bP(bQ,bO,bN,bR)}}}};var bz=bA.match.POS,bu=function(bN,bM){return"\\"+(bM-0+1)};for(var bw in bA.match){bA.match[bw]=new RegExp(bA.match[bw].source+(/(?![^\[]*\])(?![^\(]*\))/.source));bA.leftMatch[bw]=new RegExp(/(^(?:.|\r|\n)*?)/.source+bA.match[bw].source.replace(/\\(\d+)/g,bu))}var bB=function(bN,bM){bN=Array.prototype.slice.call(bN,0);if(bM){bM.push.apply(bM,bN);return bM}return bN};try{Array.prototype.slice.call(ar.documentElement.childNodes,0)[0].nodeType}catch(bK){bB=function(bQ,bP){var bO=0,bN=bP||[];if(bH.call(bQ)==="[object Array]"){Array.prototype.push.apply(bN,bQ)}else{if(typeof bQ.length==="number"){for(var bM=bQ.length;bO<bM;bO++){bN.push(bQ[bO])}}else{for(;bQ[bO];bO++){bN.push(bQ[bO])}}}return bN}}var bG,bC;if(ar.documentElement.compareDocumentPosition){bG=function(bN,bM){if(bN===bM){by=true;return 0}if(!bN.compareDocumentPosition||!bM.compareDocumentPosition){return bN.compareDocumentPosition?-1:1}return bN.compareDocumentPosition(bM)&4?-1:1}}else{bG=function(bU,bT){if(bU===bT){by=true;return 0}else{if(bU.sourceIndex&&bT.sourceIndex){return bU.sourceIndex-bT.sourceIndex}}var bR,bN,bO=[],bM=[],bQ=bU.parentNode,bS=bT.parentNode,bV=bQ;if(bQ===bS){return bC(bU,bT)}else{if(!bQ){return -1}else{if(!bS){return 1}}}while(bV){bO.unshift(bV);bV=bV.parentNode}bV=bS;while(bV){bM.unshift(bV);bV=bV.parentNode}bR=bO.length;bN=bM.length;for(var bP=0;bP<bR&&bP<bN;bP++){if(bO[bP]!==bM[bP]){return bC(bO[bP],bM[bP])}}return bP===bR?bC(bU,bM[bP],-1):bC(bO[bP],bT,1)};bC=function(bN,bM,bO){if(bN===bM){return bO}var bP=bN.nextSibling;while(bP){if(bP===bM){return -1}bP=bP.nextSibling}return 1}}bv.getText=function(bM){var bN="",bP;for(var bO=0;bM[bO];bO++){bP=bM[bO];if(bP.nodeType===3||bP.nodeType===4){bN+=bP.nodeValue}else{if(bP.nodeType!==8){bN+=bv.getText(bP.childNodes)}}}return bN};(function(){var bN=ar.createElement("div"),bO="script"+(new Date()).getTime(),bM=ar.documentElement;bN.innerHTML="<a name='"+bO+"'/>";bM.insertBefore(bN,bM.firstChild);if(ar.getElementById(bO)){bA.find.ID=function(bQ,bR,bS){if(typeof bR.getElementById!=="undefined"&&!bS){var bP=bR.getElementById(bQ[1]);return bP?bP.id===bQ[1]||typeof bP.getAttributeNode!=="undefined"&&bP.getAttributeNode("id").nodeValue===bQ[1]?[bP]:L:[]}};bA.filter.ID=function(bR,bP){var bQ=typeof bR.getAttributeNode!=="undefined"&&bR.getAttributeNode("id");return bR.nodeType===1&&bQ&&bQ.nodeValue===bP}}bM.removeChild(bN);bM=bN=null})();(function(){var bM=ar.createElement("div");bM.appendChild(ar.createComment(""));if(bM.getElementsByTagName("*").length>0){bA.find.TAG=function(bN,bR){var bQ=bR.getElementsByTagName(bN[1]);if(bN[1]==="*"){var bP=[];for(var bO=0;bQ[bO];bO++){if(bQ[bO].nodeType===1){bP.push(bQ[bO])}}bQ=bP}return bQ}}bM.innerHTML="<a href='#'></a>";if(bM.firstChild&&typeof bM.firstChild.getAttribute!=="undefined"&&bM.firstChild.getAttribute("href")!=="#"){bA.attrHandle.href=function(bN){return bN.getAttribute("href",2)}}bM=null})();if(ar.querySelectorAll){(function(){var bM=bv,bP=ar.createElement("div"),bO="__sizzle__";bP.innerHTML="<p class='TEST'></p>";if(bP.querySelectorAll&&bP.querySelectorAll(".TEST").length===0){return}bv=function(b0,bR,bV,bZ){bR=bR||ar;if(!bZ&&!bv.isXML(bR)){var bY=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b0);if(bY&&(bR.nodeType===1||bR.nodeType===9)){if(bY[1]){return bB(bR.getElementsByTagName(b0),bV)}else{if(bY[2]&&bA.find.CLASS&&bR.getElementsByClassName){return bB(bR.getElementsByClassName(bY[2]),bV)}}}if(bR.nodeType===9){if(b0==="body"&&bR.body){return bB([bR.body],bV)}else{if(bY&&bY[3]){var bU=bR.getElementById(bY[3]);if(bU&&bU.parentNode){if(bU.id===bY[3]){return bB([bU],bV)}}else{return bB([],bV)}}}try{return bB(bR.querySelectorAll(b0),bV)}catch(bW){}}else{if(bR.nodeType===1&&bR.nodeName.toLowerCase()!=="object"){var bS=bR,bT=bR.getAttribute("id"),bQ=bT||bO,b2=bR.parentNode,b1=/^\s*[+~]/.test(b0);if(!bT){bR.setAttribute("id",bQ)}else{bQ=bQ.replace(/'/g,"\\$&")}if(b1&&b2){bR=bR.parentNode}try{if(!b1||b2){return bB(bR.querySelectorAll("[id='"+bQ+"'] "+b0),bV)}}catch(bX){}finally{if(!bT){bS.removeAttribute("id")}}}}}return bM(b0,bR,bV,bZ)};for(var bN in bM){bv[bN]=bM[bN]}bP=null})()}(function(){var bM=ar.documentElement,bO=bM.matchesSelector||bM.mozMatchesSelector||bM.webkitMatchesSelector||bM.msMatchesSelector;if(bO){var bQ=!bO.call(ar.createElement("div"),"div"),bN=false;try{bO.call(ar.documentElement,"[test!='']:sizzle")}catch(bP){bN=true}bv.matchesSelector=function(bS,bU){bU=bU.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!bv.isXML(bS)){try{if(bN||!bA.match.PSEUDO.test(bU)&&!/!=/.test(bU)){var bR=bO.call(bS,bU);if(bR||!bQ||bS.document&&bS.document.nodeType!==11){return bR}}}catch(bT){}}return bv(bU,null,null,[bS]).length>0}}})();(function(){var bM=ar.createElement("div");bM.innerHTML="<div class='test e'></div><div class='test'></div>";if(!bM.getElementsByClassName||bM.getElementsByClassName("e").length===0){return}bM.lastChild.className="e";if(bM.getElementsByClassName("e").length===1){return}bA.order.splice(1,0,"CLASS");bA.find.CLASS=function(bN,bO,bP){if(typeof bO.getElementsByClassName!=="undefined"&&!bP){return bO.getElementsByClassName(bN[1])}};bM=null})();function bt(bN,bS,bR,bV,bT,bU){for(var bP=0,bO=bV.length;bP<bO;bP++){var bM=bV[bP];if(bM){var bQ=false;bM=bM[bN];while(bM){if(bM.sizcache===bR){bQ=bV[bM.sizset];break}if(bM.nodeType===1&&!bU){bM.sizcache=bR;bM.sizset=bP}if(bM.nodeName.toLowerCase()===bS){bQ=bM;break}bM=bM[bN]}bV[bP]=bQ}}}function bJ(bN,bS,bR,bV,bT,bU){for(var bP=0,bO=bV.length;bP<bO;bP++){var bM=bV[bP];if(bM){var bQ=false;bM=bM[bN];while(bM){if(bM.sizcache===bR){bQ=bV[bM.sizset];break}if(bM.nodeType===1){if(!bU){bM.sizcache=bR;bM.sizset=bP}if(typeof bS!=="string"){if(bM===bS){bQ=true;break}}else{if(bv.filter(bS,[bM]).length>0){bQ=bM;break}}}bM=bM[bN]}bV[bP]=bQ}}}if(ar.documentElement.contains){bv.contains=function(bN,bM){return bN!==bM&&(bN.contains?bN.contains(bM):true)}}else{if(ar.documentElement.compareDocumentPosition){bv.contains=function(bN,bM){return !!(bN.compareDocumentPosition(bM)&16)}}else{bv.contains=function(){return false}}}bv.isXML=function(bM){var bN=(bM?bM.ownerDocument||bM:0).documentElement;return bN?bN.nodeName!=="HTML":false};var bI=function(bM,bT){var bR,bP=[],bQ="",bO=bT.nodeType?[bT]:bT;while((bR=bA.match.PSEUDO.exec(bM))){bQ+=bR[0];bM=bM.replace(bA.match.PSEUDO,"")}bM=bA.relative[bM]?bM+"*":bM;for(var bS=0,bN=bO.length;bS<bN;bS++){bv(bM,bO[bS],bP)}return bv.filter(bQ,bP)};b.find=bv;b.expr=bv.selectors;b.expr[":"]=b.expr.filters;b.unique=bv.uniqueSort;b.text=bv.getText;b.isXMLDoc=bv.isXML;b.contains=bv.contains})();var Z=/Until$/,an=/^(?:parents|prevUntil|prevAll)/,a8=/,/,bo=/^.[^:#\[\.,]*$/,Q=Array.prototype.slice,I=b.expr.match.POS,av={children:true,contents:true,next:true,prev:true};b.fn.extend({find:function(bt){var bv=this,bx,bu;if(typeof bt!=="string"){return b(bt).filter(function(){for(bx=0,bu=bv.length;bx<bu;bx++){if(b.contains(bv[bx],this)){return true}}})}var bw=this.pushStack("","find",bt),bz,bA,by;for(bx=0,bu=this.length;bx<bu;bx++){bz=bw.length;b.find(bt,this[bx],bw);if(bx>0){for(bA=bz;bA<bw.length;bA++){for(by=0;by<bz;by++){if(bw[by]===bw[bA]){bw.splice(bA--,1);break}}}}}return bw},has:function(bu){var bt=b(bu);return this.filter(function(){for(var bw=0,bv=bt.length;bw<bv;bw++){if(b.contains(this,bt[bw])){return true}}})},not:function(bt){return this.pushStack(aC(this,bt,false),"not",bt)},filter:function(bt){return this.pushStack(aC(this,bt,true),"filter",bt)},is:function(bt){return !!bt&&(typeof bt==="string"?b.filter(bt,this).length>0:this.filter(bt).length>0)},closest:function(bD,bu){var bA=[],bx,bv,bC=this[0];if(b.isArray(bD)){var bz,bw,by={},bt=1;if(bC&&bD.length){for(bx=0,bv=bD.length;bx<bv;bx++){bw=bD[bx];if(!by[bw]){by[bw]=I.test(bw)?b(bw,bu||this.context):bw}}while(bC&&bC.ownerDocument&&bC!==bu){for(bw in by){bz=by[bw];if(bz.jquery?bz.index(bC)>-1:b(bC).is(bz)){bA.push({selector:bw,elem:bC,level:bt})}}bC=bC.parentNode;bt++}}return bA}var bB=I.test(bD)||typeof bD!=="string"?b(bD,bu||this.context):0;for(bx=0,bv=this.length;bx<bv;bx++){bC=this[bx];while(bC){if(bB?bB.index(bC)>-1:b.find.matchesSelector(bC,bD)){bA.push(bC);break}else{bC=bC.parentNode;if(!bC||!bC.ownerDocument||bC===bu||bC.nodeType===11){break}}}}bA=bA.length>1?b.unique(bA):bA;return this.pushStack(bA,"closest",bD)},index:function(bt){if(!bt||typeof bt==="string"){return b.inArray(this[0],bt?b(bt):this.parent().children())}return b.inArray(bt.jquery?bt[0]:bt,this)},add:function(bt,bu){var bw=typeof bt==="string"?b(bt,bu):b.makeArray(bt&&bt.nodeType?[bt]:bt),bv=b.merge(this.get(),bw);return this.pushStack(D(bw[0])||D(bv[0])?bv:b.unique(bv))},andSelf:function(){return this.add(this.prevObject)}});function D(bt){return !bt||!bt.parentNode||bt.parentNode.nodeType===11}b.each({parent:function(bu){var bt=bu.parentNode;return bt&&bt.nodeType!==11?bt:null},parents:function(bt){return b.dir(bt,"parentNode")},parentsUntil:function(bu,bt,bv){return b.dir(bu,"parentNode",bv)},next:function(bt){return b.nth(bt,2,"nextSibling")},prev:function(bt){return b.nth(bt,2,"previousSibling")},nextAll:function(bt){return b.dir(bt,"nextSibling")},prevAll:function(bt){return b.dir(bt,"previousSibling")},nextUntil:function(bu,bt,bv){return b.dir(bu,"nextSibling",bv)},prevUntil:function(bu,bt,bv){return b.dir(bu,"previousSibling",bv)},siblings:function(bt){return b.sibling(bt.parentNode.firstChild,bt)},children:function(bt){return b.sibling(bt.firstChild)},contents:function(bt){return b.nodeName(bt,"iframe")?bt.contentDocument||bt.contentWindow.document:b.makeArray(bt.childNodes)}},function(bt,bu){b.fn[bt]=function(by,bv){var bx=b.map(this,bu,by),bw=Q.call(arguments);if(!Z.test(bt)){bv=by}if(bv&&typeof bv==="string"){bx=b.filter(bv,bx)}bx=this.length>1&&!av[bt]?b.unique(bx):bx;if((this.length>1||a8.test(bv))&&an.test(bt)){bx=bx.reverse()}return this.pushStack(bx,bt,bw.join(","))}});b.extend({filter:function(bv,bt,bu){if(bu){bv=":not("+bv+")"}return bt.length===1?b.find.matchesSelector(bt[0],bv)?[bt[0]]:[]:b.find.matches(bv,bt)},dir:function(bv,bu,bx){var bt=[],bw=bv[bu];while(bw&&bw.nodeType!==9&&(bx===L||bw.nodeType!==1||!b(bw).is(bx))){if(bw.nodeType===1){bt.push(bw)}bw=bw[bu]}return bt},nth:function(bx,bt,bv,bw){bt=bt||1;var bu=0;for(;bx;bx=bx[bv]){if(bx.nodeType===1&&++bu===bt){break}}return bx},sibling:function(bv,bu){var bt=[];for(;bv;bv=bv.nextSibling){if(bv.nodeType===1&&bv!==bu){bt.push(bv)}}return bt}});function aC(bw,bv,bt){bv=bv||0;if(b.isFunction(bv)){return b.grep(bw,function(by,bx){var bz=!!bv.call(by,bx,by);return bz===bt})}else{if(bv.nodeType){return b.grep(bw,function(by,bx){return(by===bv)===bt})}else{if(typeof bv==="string"){var bu=b.grep(bw,function(bx){return bx.nodeType===1});if(bo.test(bv)){return b.filter(bv,bu,!bt)}else{bv=b.filter(bv,bu)}}}}return b.grep(bw,function(by,bx){return(b.inArray(by,bv)>=0)===bt})}var ae=/ jQuery\d+="(?:\d+|null)"/g,ao=/^\s+/,T=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,d=/<([\w:]+)/,x=/<tbody/i,W=/<|&#?\w+;/,P=/<(?:script|object|embed|option|style)/i,n=/checked\s*(?:[^=]|=\s*.checked.)/i,bk=/\/(java|ecma)script/i,aK=/^\s*<!(?:\[CDATA\[|\-\-)/,au={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};au.optgroup=au.option;au.tbody=au.tfoot=au.colgroup=au.caption=au.thead;au.th=au.td;if(!b.support.htmlSerialize){au._default=[1,"div<div>","</div>"]}b.fn.extend({text:function(bt){if(b.isFunction(bt)){return this.each(function(bv){var bu=b(this);bu.text(bt.call(this,bv,bu.text()))})}if(typeof bt!=="object"&&bt!==L){return this.empty().append((this[0]&&this[0].ownerDocument||ar).createTextNode(bt))}return b.text(this)},wrapAll:function(bt){if(b.isFunction(bt)){return this.each(function(bv){b(this).wrapAll(bt.call(this,bv))})}if(this[0]){var bu=b(bt,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){bu.insertBefore(this[0])}bu.map(function(){var bv=this;while(bv.firstChild&&bv.firstChild.nodeType===1){bv=bv.firstChild}return bv}).append(this)}return this},wrapInner:function(bt){if(b.isFunction(bt)){return this.each(function(bu){b(this).wrapInner(bt.call(this,bu))})}return this.each(function(){var bu=b(this),bv=bu.contents();if(bv.length){bv.wrapAll(bt)}else{bu.append(bt)}})},wrap:function(bt){return this.each(function(){b(this).wrapAll(bt)})},unwrap:function(){return this.parent().each(function(){if(!b.nodeName(this,"body")){b(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(bt){if(this.nodeType===1){this.appendChild(bt)}})},prepend:function(){return this.domManip(arguments,true,function(bt){if(this.nodeType===1){this.insertBefore(bt,this.firstChild)}})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bu){this.parentNode.insertBefore(bu,this)})}else{if(arguments.length){var bt=b(arguments[0]);bt.push.apply(bt,this.toArray());return this.pushStack(bt,"before",arguments)}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bu){this.parentNode.insertBefore(bu,this.nextSibling)})}else{if(arguments.length){var bt=this.pushStack(this,"after",arguments);bt.push.apply(bt,b(arguments[0]).toArray());return bt}}},remove:function(bt,bw){for(var bu=0,bv;(bv=this[bu])!=null;bu++){if(!bt||b.filter(bt,[bv]).length){if(!bw&&bv.nodeType===1){b.cleanData(bv.getElementsByTagName("*"));b.cleanData([bv])}if(bv.parentNode){bv.parentNode.removeChild(bv)}}}return this},empty:function(){for(var bt=0,bu;(bu=this[bt])!=null;bt++){if(bu.nodeType===1){b.cleanData(bu.getElementsByTagName("*"))}while(bu.firstChild){bu.removeChild(bu.firstChild)}}return this},clone:function(bu,bt){bu=bu==null?false:bu;bt=bt==null?bu:bt;return this.map(function(){return b.clone(this,bu,bt)})},html:function(bv){if(bv===L){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(ae,""):null}else{if(typeof bv==="string"&&!P.test(bv)&&(b.support.leadingWhitespace||!ao.test(bv))&&!au[(d.exec(bv)||["",""])[1].toLowerCase()]){bv=bv.replace(T,"<$1></$2>");try{for(var bu=0,bt=this.length;bu<bt;bu++){if(this[bu].nodeType===1){b.cleanData(this[bu].getElementsByTagName("*"));this[bu].innerHTML=bv}}}catch(bw){this.empty().append(bv)}}else{if(b.isFunction(bv)){this.each(function(by){var bx=b(this);bx.html(bv.call(this,by,bx.html()))})}else{this.empty().append(bv)}}}return this},replaceWith:function(bt){if(this[0]&&this[0].parentNode){if(b.isFunction(bt)){return this.each(function(bw){var bv=b(this),bu=bv.html();bv.replaceWith(bt.call(this,bw,bu))})}if(typeof bt!=="string"){bt=b(bt).detach()}return this.each(function(){var bv=this.nextSibling,bu=this.parentNode;b(this).remove();if(bv){b(bv).before(bt)}else{b(bu).append(bt)}})}else{return this.length?this.pushStack(b(b.isFunction(bt)?bt():bt),"replaceWith",bt):this}},detach:function(bt){return this.remove(bt,true)},domManip:function(bA,bE,bD){var bw,bx,bz,bC,bB=bA[0],bu=[];if(!b.support.checkClone&&arguments.length===3&&typeof bB==="string"&&n.test(bB)){return this.each(function(){b(this).domManip(bA,bE,bD,true)})}if(b.isFunction(bB)){return this.each(function(bG){var bF=b(this);bA[0]=bB.call(this,bG,bE?bF.html():L);bF.domManip(bA,bE,bD)})}if(this[0]){bC=bB&&bB.parentNode;if(b.support.parentNode&&bC&&bC.nodeType===11&&bC.childNodes.length===this.length){bw={fragment:bC}}else{bw=b.buildFragment(bA,this,bu)}bz=bw.fragment;if(bz.childNodes.length===1){bx=bz=bz.firstChild}else{bx=bz.firstChild}if(bx){bE=bE&&b.nodeName(bx,"tr");for(var bv=0,bt=this.length,by=bt-1;bv<bt;bv++){bD.call(bE?a9(this[bv],bx):this[bv],bw.cacheable||(bt>1&&bv<by)?b.clone(bz,true,true):bz)}}if(bu.length){b.each(bu,bn)}}return this}});function a9(bt,bu){return b.nodeName(bt,"table")?(bt.getElementsByTagName("tbody")[0]||bt.appendChild(bt.ownerDocument.createElement("tbody"))):bt}function u(bt,bA){if(bA.nodeType!==1||!b.hasData(bt)){return}var bz=b.expando,bw=b.data(bt),bx=b.data(bA,bw);if((bw=bw[bz])){var bB=bw.events;bx=bx[bz]=b.extend({},bw);if(bB){delete bx.handle;bx.events={};for(var by in bB){for(var bv=0,bu=bB[by].length;bv<bu;bv++){b.event.add(bA,by+(bB[by][bv].namespace?".":"")+bB[by][bv].namespace,bB[by][bv],bB[by][bv].data)}}}}}function af(bu,bt){var bv;if(bt.nodeType!==1){return}if(bt.clearAttributes){bt.clearAttributes()}if(bt.mergeAttributes){bt.mergeAttributes(bu)}bv=bt.nodeName.toLowerCase();if(bv==="object"){bt.outerHTML=bu.outerHTML}else{if(bv==="input"&&(bu.type==="checkbox"||bu.type==="radio")){if(bu.checked){bt.defaultChecked=bt.checked=bu.checked}if(bt.value!==bu.value){bt.value=bu.value}}else{if(bv==="option"){bt.selected=bu.defaultSelected}else{if(bv==="input"||bv==="textarea"){bt.defaultValue=bu.defaultValue}}}}bt.removeAttribute(b.expando)}b.buildFragment=function(by,bw,bu){var bx,bt,bv,bz;if(bw&&bw[0]){bz=bw[0].ownerDocument||bw[0]}if(!bz.createDocumentFragment){bz=ar}if(by.length===1&&typeof by[0]==="string"&&by[0].length<512&&bz===ar&&by[0].charAt(0)==="<"&&!P.test(by[0])&&(b.support.checkClone||!n.test(by[0]))){bt=true;bv=b.fragments[by[0]];if(bv&&bv!==1){bx=bv}}if(!bx){bx=bz.createDocumentFragment();b.clean(by,bz,bx,bu)}if(bt){b.fragments[by[0]]=bv?bx:1}return{fragment:bx,cacheable:bt}};b.fragments={};b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(bt,bu){b.fn[bt]=function(bv){var by=[],bB=b(bv),bA=this.length===1&&this[0].parentNode;if(bA&&bA.nodeType===11&&bA.childNodes.length===1&&bB.length===1){bB[bu](this[0]);return this}else{for(var bz=0,bw=bB.length;bz<bw;bz++){var bx=(bz>0?this.clone(true):this).get();b(bB[bz])[bu](bx);by=by.concat(bx)}return this.pushStack(by,bt,bB.selector)}}});function bd(bt){if("getElementsByTagName" in bt){return bt.getElementsByTagName("*")}else{if("querySelectorAll" in bt){return bt.querySelectorAll("*")}else{return[]}}}function aw(bt){if(bt.type==="checkbox"||bt.type==="radio"){bt.defaultChecked=bt.checked}}function F(bt){if(b.nodeName(bt,"input")){aw(bt)}else{if("getElementsByTagName" in bt){b.grep(bt.getElementsByTagName("input"),aw)}}}b.extend({clone:function(bx,bz,bv){var by=bx.cloneNode(true),bt,bu,bw;if((!b.support.noCloneEvent||!b.support.noCloneChecked)&&(bx.nodeType===1||bx.nodeType===11)&&!b.isXMLDoc(bx)){af(bx,by);bt=bd(bx);bu=bd(by);for(bw=0;bt[bw];++bw){af(bt[bw],bu[bw])}}if(bz){u(bx,by);if(bv){bt=bd(bx);bu=bd(by);for(bw=0;bt[bw];++bw){u(bt[bw],bu[bw])}}}bt=bu=null;return by},clean:function(bv,bx,bG,bz){var bE;bx=bx||ar;if(typeof bx.createElement==="undefined"){bx=bx.ownerDocument||bx[0]&&bx[0].ownerDocument||ar}var bH=[],bA;for(var bD=0,by;(by=bv[bD])!=null;bD++){if(typeof by==="number"){by+=""}if(!by){continue}if(typeof by==="string"){if(!W.test(by)){by=bx.createTextNode(by)}else{by=by.replace(T,"<$1></$2>");var bJ=(d.exec(by)||["",""])[1].toLowerCase(),bw=au[bJ]||au._default,bC=bw[0],bu=bx.createElement("div");bu.innerHTML=bw[1]+by+bw[2];while(bC--){bu=bu.lastChild}if(!b.support.tbody){var bt=x.test(by),bB=bJ==="table"&&!bt?bu.firstChild&&bu.firstChild.childNodes:bw[1]==="<table>"&&!bt?bu.childNodes:[];for(bA=bB.length-1;bA>=0;--bA){if(b.nodeName(bB[bA],"tbody")&&!bB[bA].childNodes.length){bB[bA].parentNode.removeChild(bB[bA])}}}if(!b.support.leadingWhitespace&&ao.test(by)){bu.insertBefore(bx.createTextNode(ao.exec(by)[0]),bu.firstChild)}by=bu.childNodes}}var bF;if(!b.support.appendChecked){if(by[0]&&typeof(bF=by.length)==="number"){for(bA=0;bA<bF;bA++){F(by[bA])}}else{F(by)}}if(by.nodeType){bH.push(by)}else{bH=b.merge(bH,by)}}if(bG){bE=function(bK){return !bK.type||bk.test(bK.type)};for(bD=0;bH[bD];bD++){if(bz&&b.nodeName(bH[bD],"script")&&(!bH[bD].type||bH[bD].type.toLowerCase()==="text/javascript")){bz.push(bH[bD].parentNode?bH[bD].parentNode.removeChild(bH[bD]):bH[bD])}else{if(bH[bD].nodeType===1){var bI=b.grep(bH[bD].getElementsByTagName("script"),bE);bH.splice.apply(bH,[bD+1,0].concat(bI))}bG.appendChild(bH[bD])}}}return bH},cleanData:function(bu){var bx,bv,bt=b.cache,bC=b.expando,bA=b.event.special,bz=b.support.deleteExpando;for(var by=0,bw;(bw=bu[by])!=null;by++){if(bw.nodeName&&b.noData[bw.nodeName.toLowerCase()]){continue}bv=bw[b.expando];if(bv){bx=bt[bv]&&bt[bv][bC];if(bx&&bx.events){for(var bB in bx.events){if(bA[bB]){b.event.remove(bw,bB)}else{b.removeEvent(bw,bB,bx.handle)}}if(bx.handle){bx.handle.elem=null}}if(bz){delete bw[b.expando]}else{if(bw.removeAttribute){bw.removeAttribute(b.expando)}}delete bt[bv]}}}});function bn(bt,bu){if(bu.src){b.ajax({url:bu.src,async:false,dataType:"script"})}else{b.globalEval((bu.text||bu.textContent||bu.innerHTML||"").replace(aK,"/*$0*/"))}if(bu.parentNode){bu.parentNode.removeChild(bu)}}var ai=/alpha\([^)]*\)/i,aq=/opacity=([^)]*)/,A=/([A-Z]|^ms)/g,bb=/^-?\d+(?:px)?$/i,bm=/^-?\d/,J=/^[+\-]=/,ah=/[^+\-\.\de]+/g,a5={position:"absolute",visibility:"hidden",display:"block"},ak=["Left","Right"],aZ=["Top","Bottom"],X,aF,aT;b.fn.css=function(bt,bu){if(arguments.length===2&&bu===L){return this}return b.access(this,bt,bu,true,function(bw,bv,bx){return bx!==L?b.style(bw,bv,bx):b.css(bw,bv)})};b.extend({cssHooks:{opacity:{get:function(bv,bu){if(bu){var bt=X(bv,"opacity","opacity");return bt===""?"1":bt}else{return bv.style.opacity}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(bv,bu,bB,bw){if(!bv||bv.nodeType===3||bv.nodeType===8||!bv.style){return}var bz,bA,bx=b.camelCase(bu),bt=bv.style,bC=b.cssHooks[bx];bu=b.cssProps[bx]||bx;if(bB!==L){bA=typeof bB;if(bA==="number"&&isNaN(bB)||bB==null){return}if(bA==="string"&&J.test(bB)){bB=+bB.replace(ah,"")+parseFloat(b.css(bv,bu));bA="number"}if(bA==="number"&&!b.cssNumber[bx]){bB+="px"}if(!bC||!("set" in bC)||(bB=bC.set(bv,bB))!==L){try{bt[bu]=bB}catch(by){}}}else{if(bC&&"get" in bC&&(bz=bC.get(bv,false,bw))!==L){return bz}return bt[bu]}},css:function(bx,bw,bu){var bv,bt;bw=b.camelCase(bw);bt=b.cssHooks[bw];bw=b.cssProps[bw]||bw;if(bw==="cssFloat"){bw="float"}if(bt&&"get" in bt&&(bv=bt.get(bx,true,bu))!==L){return bv}else{if(X){return X(bx,bw)}}},swap:function(bw,bv,bx){var bt={};for(var bu in bv){bt[bu]=bw.style[bu];bw.style[bu]=bv[bu]}bx.call(bw);for(bu in bv){bw.style[bu]=bt[bu]}}});b.curCSS=b.css;b.each(["height","width"],function(bu,bt){b.cssHooks[bt]={get:function(bx,bw,bv){var by;if(bw){if(bx.offsetWidth!==0){return o(bx,bt,bv)}else{b.swap(bx,a5,function(){by=o(bx,bt,bv)})}return by}},set:function(bv,bw){if(bb.test(bw)){bw=parseFloat(bw);if(bw>=0){return bw+"px"}}else{return bw}}}});if(!b.support.opacity){b.cssHooks.opacity={get:function(bu,bt){return aq.test((bt&&bu.currentStyle?bu.currentStyle.filter:bu.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":bt?"1":""},set:function(bx,by){var bw=bx.style,bu=bx.currentStyle;bw.zoom=1;var bt=b.isNaN(by)?"":"alpha(opacity="+by*100+")",bv=bu&&bu.filter||bw.filter||"";bw.filter=ai.test(bv)?bv.replace(ai,bt):bv+" "+bt}}}b(function(){if(!b.support.reliableMarginRight){b.cssHooks.marginRight={get:function(bv,bu){var bt;b.swap(bv,{display:"inline-block"},function(){if(bu){bt=X(bv,"margin-right","marginRight")}else{bt=bv.style.marginRight}});return bt}}}});if(ar.defaultView&&ar.defaultView.getComputedStyle){aF=function(bx,bv){var bu,bw,bt;bv=bv.replace(A,"-$1").toLowerCase();if(!(bw=bx.ownerDocument.defaultView)){return L}if((bt=bw.getComputedStyle(bx,null))){bu=bt.getPropertyValue(bv);if(bu===""&&!b.contains(bx.ownerDocument.documentElement,bx)){bu=b.style(bx,bv)}}return bu}}if(ar.documentElement.currentStyle){aT=function(bx,bv){var by,bu=bx.currentStyle&&bx.currentStyle[bv],bt=bx.runtimeStyle&&bx.runtimeStyle[bv],bw=bx.style;if(!bb.test(bu)&&bm.test(bu)){by=bw.left;if(bt){bx.runtimeStyle.left=bx.currentStyle.left}bw.left=bv==="fontSize"?"1em":(bu||0);bu=bw.pixelLeft+"px";bw.left=by;if(bt){bx.runtimeStyle.left=bt}}return bu===""?"auto":bu}}X=aF||aT;function o(bv,bu,bt){var bx=bu==="width"?bv.offsetWidth:bv.offsetHeight,bw=bu==="width"?ak:aZ;if(bx>0){if(bt!=="border"){b.each(bw,function(){if(!bt){bx-=parseFloat(b.css(bv,"padding"+this))||0}if(bt==="margin"){bx+=parseFloat(b.css(bv,bt+this))||0}else{bx-=parseFloat(b.css(bv,"border"+this+"Width"))||0}})}return bx+"px"}bx=X(bv,bu,bu);if(bx<0||bx==null){bx=bv.style[bu]||0}bx=parseFloat(bx)||0;if(bt){b.each(bw,function(){bx+=parseFloat(b.css(bv,"padding"+this))||0;if(bt!=="padding"){bx+=parseFloat(b.css(bv,"border"+this+"Width"))||0}if(bt==="margin"){bx+=parseFloat(b.css(bv,bt+this))||0}})}return bx+"px"}if(b.expr&&b.expr.filters){b.expr.filters.hidden=function(bv){var bu=bv.offsetWidth,bt=bv.offsetHeight;return(bu===0&&bt===0)||(!b.support.reliableHiddenOffsets&&(bv.style.display||b.css(bv,"display"))==="none")};b.expr.filters.visible=function(bt){return !b.expr.filters.hidden(bt)}}var j=/%20/g,am=/\[\]$/,br=/\r?\n/g,bp=/#.*$/,aA=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,aW=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,aJ=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,aM=/^(?:GET|HEAD)$/,c=/^\/\//,M=/\?/,a4=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,q=/^(?:select|textarea)/i,h=/\s+/,bq=/([?&])_=[^&]*/,K=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,B=b.fn.load,Y={},r={},aB,t;try{aB=bj.href}catch(at){aB=ar.createElement("a");aB.href="";aB=aB.href}t=K.exec(aB.toLowerCase())||[];function f(bt){return function(bx,bz){if(typeof bx!=="string"){bz=bx;bx="*"}if(b.isFunction(bz)){var bw=bx.toLowerCase().split(h),bv=0,by=bw.length,bu,bA,bB;for(;bv<by;bv++){bu=bw[bv];bB=/^\+/.test(bu);if(bB){bu=bu.substr(1)||"*"}bA=bt[bu]=bt[bu]||[];bA[bB?"unshift":"push"](bz)}}}}function aR(bu,bD,by,bC,bA,bw){bA=bA||bD.dataTypes[0];bw=bw||{};bw[bA]=true;var bz=bu[bA],bv=0,bt=bz?bz.length:0,bx=(bu===Y),bB;for(;bv<bt&&(bx||!bB);bv++){bB=bz[bv](bD,by,bC);if(typeof bB==="string"){if(!bx||bw[bB]){bB=L}else{bD.dataTypes.unshift(bB);bB=aR(bu,bD,by,bC,bB,bw)}}}if((bx||!bB)&&!bw["*"]){bB=aR(bu,bD,by,bC,"*",bw)}return bB}b.fn.extend({load:function(bv,by,bz){if(typeof bv!=="string"&&B){return B.apply(this,arguments)}else{if(!this.length){return this}}var bx=bv.indexOf(" ");if(bx>=0){var bt=bv.slice(bx,bv.length);bv=bv.slice(0,bx)}var bw="GET";if(by){if(b.isFunction(by)){bz=by;by=L}else{if(typeof by==="object"){by=b.param(by,b.ajaxSettings.traditional);bw="POST"}}}var bu=this;b.ajax({url:bv,type:bw,dataType:"html",data:by,complete:function(bB,bA,bC){bC=bB.responseText;if(bB.isResolved()){bB.done(function(bD){bC=bD});bu.html(bt?b("<div>").append(bC.replace(a4,"")).find(bt):bC)}if(bz){bu.each(bz,[bC,bA,bB])}}});return this},serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?b.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||q.test(this.nodeName)||aW.test(this.type))}).map(function(bt,bu){var bv=b(this).val();return bv==null?null:b.isArray(bv)?b.map(bv,function(bx,bw){return{name:bu.name,value:bx.replace(br,"\r\n")}}):{name:bu.name,value:bv.replace(br,"\r\n")}}).get()}});b.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(bt,bu){b.fn[bu]=function(bv){return this.bind(bu,bv)}});b.each(["get","post"],function(bt,bu){b[bu]=function(bv,bx,by,bw){if(b.isFunction(bx)){bw=bw||by;by=bx;bx=L}return b.ajax({type:bu,url:bv,data:bx,success:by,dataType:bw})}});b.extend({getScript:function(bt,bu){return b.get(bt,L,bu,"script")},getJSON:function(bt,bu,bv){return b.get(bt,bu,bv,"json")},ajaxSetup:function(bv,bt){if(!bt){bt=bv;bv=b.extend(true,b.ajaxSettings,bt)}else{b.extend(true,bv,b.ajaxSettings,bt)}for(var bu in {context:1,url:1}){if(bu in bt){bv[bu]=bt[bu]}else{if(bu in b.ajaxSettings){bv[bu]=b.ajaxSettings[bu]}}}return bv},ajaxSettings:{url:aB,isLocal:aJ.test(t[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":ba.String,"text html":true,"text json":b.parseJSON,"text xml":b.parseXML}},ajaxPrefilter:f(Y),ajaxTransport:f(r),ajax:function(bx,bv){if(typeof bx==="object"){bv=bx;bx=L}bv=bv||{};var bB=b.ajaxSetup({},bv),bQ=bB.context||bB,bE=bQ!==bB&&(bQ.nodeType||bQ instanceof b)?b(bQ):b.event,bP=b.Deferred(),bL=b._Deferred(),bz=bB.statusCode||{},bA,bF={},bM={},bO,bw,bJ,bC,bG,by=0,bu,bI,bH={readyState:0,setRequestHeader:function(bS,bT){if(!by){var bR=bS.toLowerCase();bS=bM[bR]=bM[bR]||bS;bF[bS]=bT}return this},getAllResponseHeaders:function(){return by===2?bO:null},getResponseHeader:function(bS){var bR;if(by===2){if(!bw){bw={};while((bR=aA.exec(bO))){bw[bR[1].toLowerCase()]=bR[2]}}bR=bw[bS.toLowerCase()]}return bR===L?null:bR},overrideMimeType:function(bR){if(!by){bB.mimeType=bR}return this},abort:function(bR){bR=bR||"abort";if(bJ){bJ.abort(bR)}bD(0,bR);return this}};function bD(bW,bU,bX,bT){if(by===2){return}by=2;if(bC){clearTimeout(bC)}bJ=L;bO=bT||"";bH.readyState=bW?4:0;var bR,b1,b0,bV=bX?bh(bB,bH,bX):L,bS,bZ;if(bW>=200&&bW<300||bW===304){if(bB.ifModified){if((bS=bH.getResponseHeader("Last-Modified"))){b.lastModified[bA]=bS}if((bZ=bH.getResponseHeader("Etag"))){b.etag[bA]=bZ}}if(bW===304){bU="notmodified";bR=true}else{try{b1=G(bB,bV);bU="success";bR=true}catch(bY){bU="parsererror";b0=bY}}}else{b0=bU;if(!bU||bW){bU="error";if(bW<0){bW=0}}}bH.status=bW;bH.statusText=bU;if(bR){bP.resolveWith(bQ,[b1,bU,bH])}else{bP.rejectWith(bQ,[bH,bU,b0])}bH.statusCode(bz);bz=L;if(bu){bE.trigger("ajax"+(bR?"Success":"Error"),[bH,bB,bR?b1:b0])}bL.resolveWith(bQ,[bH,bU]);if(bu){bE.trigger("ajaxComplete",[bH,bB]);if(!(--b.active)){b.event.trigger("ajaxStop")}}}bP.promise(bH);bH.success=bH.done;bH.error=bH.fail;bH.complete=bL.done;bH.statusCode=function(bS){if(bS){var bR;if(by<2){for(bR in bS){bz[bR]=[bz[bR],bS[bR]]}}else{bR=bS[bH.status];bH.then(bR,bR)}}return this};bB.url=((bx||bB.url)+"").replace(bp,"").replace(c,t[1]+"//");bB.dataTypes=b.trim(bB.dataType||"*").toLowerCase().split(h);if(bB.crossDomain==null){bG=K.exec(bB.url.toLowerCase());bB.crossDomain=!!(bG&&(bG[1]!=t[1]||bG[2]!=t[2]||(bG[3]||(bG[1]==="http:"?80:443))!=(t[3]||(t[1]==="http:"?80:443))))}if(bB.data&&bB.processData&&typeof bB.data!=="string"){bB.data=b.param(bB.data,bB.traditional)}aR(Y,bB,bv,bH);if(by===2){return false}bu=bB.global;bB.type=bB.type.toUpperCase();bB.hasContent=!aM.test(bB.type);if(bu&&b.active++===0){b.event.trigger("ajaxStart")}if(!bB.hasContent){if(bB.data){bB.url+=(M.test(bB.url)?"&":"?")+bB.data}bA=bB.url;if(bB.cache===false){var bt=b.now(),bN=bB.url.replace(bq,"$1_="+bt);bB.url=bN+((bN===bB.url)?(M.test(bB.url)?"&":"?")+"_="+bt:"")}}if(bB.data&&bB.hasContent&&bB.contentType!==false||bv.contentType){bH.setRequestHeader("Content-Type",bB.contentType)}if(bB.ifModified){bA=bA||bB.url;if(b.lastModified[bA]){bH.setRequestHeader("If-Modified-Since",b.lastModified[bA])}if(b.etag[bA]){bH.setRequestHeader("If-None-Match",b.etag[bA])}}bH.setRequestHeader("Accept",bB.dataTypes[0]&&bB.accepts[bB.dataTypes[0]]?bB.accepts[bB.dataTypes[0]]+(bB.dataTypes[0]!=="*"?", */*; q=0.01":""):bB.accepts["*"]);for(bI in bB.headers){bH.setRequestHeader(bI,bB.headers[bI])}if(bB.beforeSend&&(bB.beforeSend.call(bQ,bH,bB)===false||by===2)){bH.abort();return false}for(bI in {success:1,error:1,complete:1}){bH[bI](bB[bI])}bJ=aR(r,bB,bv,bH);if(!bJ){bD(-1,"No Transport")}else{bH.readyState=1;if(bu){bE.trigger("ajaxSend",[bH,bB])}if(bB.async&&bB.timeout>0){bC=setTimeout(function(){bH.abort("timeout")},bB.timeout)}try{by=1;bJ.send(bF,bD)}catch(bK){if(status<2){bD(-1,bK)}else{b.error(bK)}}}return bH},param:function(bt,bv){var bu=[],bx=function(by,bz){bz=b.isFunction(bz)?bz():bz;bu[bu.length]=encodeURIComponent(by)+"="+encodeURIComponent(bz)};if(bv===L){bv=b.ajaxSettings.traditional}if(b.isArray(bt)||(bt.jquery&&!b.isPlainObject(bt))){b.each(bt,function(){bx(this.name,this.value)})}else{for(var bw in bt){w(bw,bt[bw],bv,bx)}}return bu.join("&").replace(j,"+")}});function w(bv,bx,bu,bw){if(b.isArray(bx)){b.each(bx,function(bz,by){if(bu||am.test(bv)){bw(bv,by)}else{w(bv+"["+(typeof by==="object"||b.isArray(by)?bz:"")+"]",by,bu,bw)}})}else{if(!bu&&bx!=null&&typeof bx==="object"){for(var bt in bx){w(bv+"["+bt+"]",bx[bt],bu,bw)}}else{bw(bv,bx)}}}b.extend({active:0,lastModified:{},etag:{}});function bh(bC,bB,by){var bu=bC.contents,bA=bC.dataTypes,bv=bC.responseFields,bx,bz,bw,bt;for(bz in bv){if(bz in by){bB[bv[bz]]=by[bz]}}while(bA[0]==="*"){bA.shift();if(bx===L){bx=bC.mimeType||bB.getResponseHeader("content-type")}}if(bx){for(bz in bu){if(bu[bz]&&bu[bz].test(bx)){bA.unshift(bz);break}}}if(bA[0] in by){bw=bA[0]}else{for(bz in by){if(!bA[0]||bC.converters[bz+" "+bA[0]]){bw=bz;break}if(!bt){bt=bz}}bw=bw||bt}if(bw){if(bw!==bA[0]){bA.unshift(bw)}return by[bw]}}function G(bG,by){if(bG.dataFilter){by=bG.dataFilter(by,bG.dataType)}var bC=bG.dataTypes,bF={},bz,bD,bv=bC.length,bA,bB=bC[0],bw,bx,bE,bu,bt;for(bz=1;bz<bv;bz++){if(bz===1){for(bD in bG.converters){if(typeof bD==="string"){bF[bD.toLowerCase()]=bG.converters[bD]}}}bw=bB;bB=bC[bz];if(bB==="*"){bB=bw}else{if(bw!=="*"&&bw!==bB){bx=bw+" "+bB;bE=bF[bx]||bF["* "+bB];if(!bE){bt=L;for(bu in bF){bA=bu.split(" ");if(bA[0]===bw||bA[0]==="*"){bt=bF[bA[1]+" "+bB];if(bt){bu=bF[bu];if(bu===true){bE=bt}else{if(bt===true){bE=bu}}break}}}}if(!(bE||bt)){b.error("No conversion from "+bx.replace(" "," to "))}if(bE!==true){by=bE?bE(by):bt(bu(by))}}}}return by}var az=b.now(),v=/(\=)\?(&|$)|\?\?/i;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return b.expando+"_"+(az++)}});b.ajaxPrefilter("json jsonp",function(bC,bz,bB){var bw=bC.contentType==="application/x-www-form-urlencoded"&&(typeof bC.data==="string");if(bC.dataTypes[0]==="jsonp"||bC.jsonp!==false&&(v.test(bC.url)||bw&&v.test(bC.data))){var bA,bv=bC.jsonpCallback=b.isFunction(bC.jsonpCallback)?bC.jsonpCallback():bC.jsonpCallback,by=ba[bv],bt=bC.url,bx=bC.data,bu="$1"+bv+"$2";if(bC.jsonp!==false){bt=bt.replace(v,bu);if(bC.url===bt){if(bw){bx=bx.replace(v,bu)}if(bC.data===bx){bt+=(/\?/.test(bt)?"&":"?")+bC.jsonp+"="+bv}}}bC.url=bt;bC.data=bx;ba[bv]=function(bD){bA=[bD]};bB.always(function(){ba[bv]=by;if(bA&&b.isFunction(by)){ba[bv](bA[0])}});bC.converters["script json"]=function(){if(!bA){b.error(bv+" was not called")}return bA[0]};bC.dataTypes[0]="json";return"script"}});b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(bt){b.globalEval(bt);return bt}}});b.ajaxPrefilter("script",function(bt){if(bt.cache===L){bt.cache=false}if(bt.crossDomain){bt.type="GET";bt.global=false}});b.ajaxTransport("script",function(bv){if(bv.crossDomain){var bt,bu=ar.head||ar.getElementsByTagName("head")[0]||ar.documentElement;return{send:function(bw,bx){bt=ar.createElement("script");bt.async="async";if(bv.scriptCharset){bt.charset=bv.scriptCharset}bt.src=bv.url;bt.onload=bt.onreadystatechange=function(bz,by){if(by||!bt.readyState||/loaded|complete/.test(bt.readyState)){bt.onload=bt.onreadystatechange=null;if(bu&&bt.parentNode){bu.removeChild(bt)}bt=L;if(!by){bx(200,"success")}}};bu.insertBefore(bt,bu.firstChild)},abort:function(){if(bt){bt.onload(0,1)}}}}});var C=ba.ActiveXObject?function(){for(var bt in N){N[bt](0,1)}}:false,z=0,N;function aI(){try{return new ba.XMLHttpRequest()}catch(bt){}}function ag(){try{return new ba.ActiveXObject("Microsoft.XMLHTTP")}catch(bt){}}b.ajaxSettings.xhr=ba.ActiveXObject?function(){return !this.isLocal&&aI()||ag()}:aI;(function(bt){b.extend(b.support,{ajax:!!bt,cors:!!bt&&("withCredentials" in bt)})})(b.ajaxSettings.xhr());if(b.support.ajax){b.ajaxTransport(function(bt){if(!bt.crossDomain||b.support.cors){var bu;return{send:function(bA,bv){var bz=bt.xhr(),by,bx;if(bt.username){bz.open(bt.type,bt.url,bt.async,bt.username,bt.password)}else{bz.open(bt.type,bt.url,bt.async)}if(bt.xhrFields){for(bx in bt.xhrFields){bz[bx]=bt.xhrFields[bx]}}if(bt.mimeType&&bz.overrideMimeType){bz.overrideMimeType(bt.mimeType)}if(!bt.crossDomain&&!bA["X-Requested-With"]){bA["X-Requested-With"]="XMLHttpRequest"}try{for(bx in bA){bz.setRequestHeader(bx,bA[bx])}}catch(bw){}bz.send((bt.hasContent&&bt.data)||null);bu=function(bJ,bD){var bE,bC,bB,bH,bG;try{if(bu&&(bD||bz.readyState===4)){bu=L;if(by){bz.onreadystatechange=b.noop;if(C){delete N[by]}}if(bD){if(bz.readyState!==4){bz.abort()}}else{bE=bz.status;bB=bz.getAllResponseHeaders();bH={};bG=bz.responseXML;if(bG&&bG.documentElement){bH.xml=bG}bH.text=bz.responseText;try{bC=bz.statusText}catch(bI){bC=""}if(!bE&&bt.isLocal&&!bt.crossDomain){bE=bH.text?200:404}else{if(bE===1223){bE=204}}}}}catch(bF){if(!bD){bv(-1,bF)}}if(bH){bv(bE,bC,bH,bB)}};if(!bt.async||bz.readyState===4){bu()}else{by=++z;if(C){if(!N){N={};b(ba).unload(C)}N[by]=bu}bz.onreadystatechange=bu}},abort:function(){if(bu){bu(0,1)}}}}})}var R={},a7,m,ay=/^(?:toggle|show|hide)$/,aO=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,a0,aE=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],a2,S=ba.webkitRequestAnimationFrame||ba.mozRequestAnimationFrame||ba.oRequestAnimationFrame;b.fn.extend({show:function(bw,bz,by){var bv,bx;if(bw||bw===0){return this.animate(aY("show",3),bw,bz,by)}else{for(var bu=0,bt=this.length;bu<bt;bu++){bv=this[bu];if(bv.style){bx=bv.style.display;if(!b._data(bv,"olddisplay")&&bx==="none"){bx=bv.style.display=""}if(bx===""&&b.css(bv,"display")==="none"){b._data(bv,"olddisplay",y(bv.nodeName))}}}for(bu=0;bu<bt;bu++){bv=this[bu];if(bv.style){bx=bv.style.display;if(bx===""||bx==="none"){bv.style.display=b._data(bv,"olddisplay")||""}}}return this}},hide:function(bv,by,bx){if(bv||bv===0){return this.animate(aY("hide",3),bv,by,bx)}else{for(var bu=0,bt=this.length;bu<bt;bu++){if(this[bu].style){var bw=b.css(this[bu],"display");if(bw!=="none"&&!b._data(this[bu],"olddisplay")){b._data(this[bu],"olddisplay",bw)}}}for(bu=0;bu<bt;bu++){if(this[bu].style){this[bu].style.display="none"}}return this}},_toggle:b.fn.toggle,toggle:function(bv,bu,bw){var bt=typeof bv==="boolean";if(b.isFunction(bv)&&b.isFunction(bu)){this._toggle.apply(this,arguments)}else{if(bv==null||bt){this.each(function(){var bx=bt?bv:b(this).is(":hidden");b(this)[bx?"show":"hide"]()})}else{this.animate(aY("toggle",3),bv,bu,bw)}}return this},fadeTo:function(bt,bw,bv,bu){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:bw},bt,bv,bu)},animate:function(bx,bu,bw,bv){var bt=b.speed(bu,bw,bv);if(b.isEmptyObject(bx)){return this.each(bt.complete,[false])}bx=b.extend({},bx);return this[bt.queue===false?"each":"queue"](function(){if(bt.queue===false){b._mark(this)}var bB=b.extend({},bt),bI=this.nodeType===1,bF=bI&&b(this).is(":hidden"),by,bC,bA,bH,bG,bE,bz,bD,bJ;bB.animatedProperties={};for(bA in bx){by=b.camelCase(bA);if(bA!==by){bx[by]=bx[bA];delete bx[bA]}bC=bx[by];if(b.isArray(bC)){bB.animatedProperties[by]=bC[1];bC=bx[by]=bC[0]}else{bB.animatedProperties[by]=bB.specialEasing&&bB.specialEasing[by]||bB.easing||"swing"}if(bC==="hide"&&bF||bC==="show"&&!bF){return bB.complete.call(this)}if(bI&&(by==="height"||by==="width")){bB.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(b.css(this,"display")==="inline"&&b.css(this,"float")==="none"){if(!b.support.inlineBlockNeedsLayout){this.style.display="inline-block"}else{bH=y(this.nodeName);if(bH==="inline"){this.style.display="inline-block"}else{this.style.display="inline";this.style.zoom=1}}}}}if(bB.overflow!=null){this.style.overflow="hidden"}for(bA in bx){bG=new b.fx(this,bB,bA);bC=bx[bA];if(ay.test(bC)){bG[bC==="toggle"?bF?"show":"hide":bC]()}else{bE=aO.exec(bC);bz=bG.cur();if(bE){bD=parseFloat(bE[2]);bJ=bE[3]||(b.cssNumber[bA]?"":"px");if(bJ!=="px"){b.style(this,bA,(bD||1)+bJ);bz=((bD||1)/bG.cur())*bz;b.style(this,bA,bz+bJ)}if(bE[1]){bD=((bE[1]==="-="?-1:1)*bD)+bz}bG.custom(bz,bD,bJ)}else{bG.custom(bz,bC,"")}}}return true})},stop:function(bu,bt){if(bu){this.queue([])}this.each(function(){var bw=b.timers,bv=bw.length;if(!bt){b._unmark(true,this)}while(bv--){if(bw[bv].elem===this){if(bt){bw[bv](true)}bw.splice(bv,1)}}});if(!bt){this.dequeue()}return this}});function be(){setTimeout(ap,0);return(a2=b.now())}function ap(){a2=L}function aY(bu,bt){var bv={};b.each(aE.concat.apply([],aE.slice(0,bt)),function(){bv[this]=bu});return bv}b.each({slideDown:aY("show",1),slideUp:aY("hide",1),slideToggle:aY("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(bt,bu){b.fn[bt]=function(bv,bx,bw){return this.animate(bu,bv,bx,bw)}});b.extend({speed:function(bv,bw,bu){var bt=bv&&typeof bv==="object"?b.extend({},bv):{complete:bu||!bu&&bw||b.isFunction(bv)&&bv,duration:bv,easing:bu&&bw||bw&&!b.isFunction(bw)&&bw};bt.duration=b.fx.off?0:typeof bt.duration==="number"?bt.duration:bt.duration in b.fx.speeds?b.fx.speeds[bt.duration]:b.fx.speeds._default;bt.old=bt.complete;bt.complete=function(bx){if(b.isFunction(bt.old)){bt.old.call(this)}if(bt.queue!==false){b.dequeue(this)}else{if(bx!==false){b._unmark(this)}}};return bt},easing:{linear:function(bv,bw,bt,bu){return bt+bu*bv},swing:function(bv,bw,bt,bu){return((-Math.cos(bv*Math.PI)/2)+0.5)*bu+bt}},timers:[],fx:function(bu,bt,bv){this.options=bt;this.elem=bu;this.prop=bv;bt.orig=bt.orig||{}}});b.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(b.fx.step[this.prop]||b.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var bt,bu=b.css(this.elem,this.prop);return isNaN(bt=parseFloat(bu))?!bu||bu==="auto"?0:bu:bt},custom:function(bz,by,bw){var bt=this,bv=b.fx,bx;this.startTime=a2||be();this.start=bz;this.end=by;this.unit=bw||this.unit||(b.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;function bu(bA){return bt.step(bA)}bu.elem=this.elem;if(bu()&&b.timers.push(bu)&&!a0){if(S){a0=true;bx=function(){if(a0){S(bx);bv.tick()}};S(bx)}else{a0=setInterval(bv.tick,bv.interval)}}},show:function(){this.options.orig[this.prop]=b.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());b(this.elem).show()},hide:function(){this.options.orig[this.prop]=b.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(bx){var bw=a2||be(),bt=true,by=this.elem,bu=this.options,bv,bA;if(bx||bw>=bu.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();bu.animatedProperties[this.prop]=true;for(bv in bu.animatedProperties){if(bu.animatedProperties[bv]!==true){bt=false}}if(bt){if(bu.overflow!=null&&!b.support.shrinkWrapBlocks){b.each(["","X","Y"],function(bB,bC){by.style["overflow"+bC]=bu.overflow[bB]})}if(bu.hide){b(by).hide()}if(bu.hide||bu.show){for(var bz in bu.animatedProperties){b.style(by,bz,bu.orig[bz])}}bu.complete.call(by)}return false}else{if(bu.duration==Infinity){this.now=bw}else{bA=bw-this.startTime;this.state=bA/bu.duration;this.pos=b.easing[bu.animatedProperties[this.prop]](this.state,bA,0,1,bu.duration);this.now=this.start+((this.end-this.start)*this.pos)}this.update()}return true}};b.extend(b.fx,{tick:function(){for(var bu=b.timers,bt=0;bt<bu.length;++bt){if(!bu[bt]()){bu.splice(bt--,1)}}if(!bu.length){b.fx.stop()}},interval:13,stop:function(){clearInterval(a0);a0=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(bt){b.style(bt.elem,"opacity",bt.now)},_default:function(bt){if(bt.elem.style&&bt.elem.style[bt.prop]!=null){bt.elem.style[bt.prop]=(bt.prop==="width"||bt.prop==="height"?Math.max(0,bt.now):bt.now)+bt.unit}else{bt.elem[bt.prop]=bt.now}}}});if(b.expr&&b.expr.filters){b.expr.filters.animated=function(bt){return b.grep(b.timers,function(bu){return bt===bu.elem}).length}}function y(bw){if(!R[bw]){var bt=ar.body,bu=b("<"+bw+">").appendTo(bt),bv=bu.css("display");bu.remove();if(bv==="none"||bv===""){if(!a7){a7=ar.createElement("iframe");a7.frameBorder=a7.width=a7.height=0}bt.appendChild(a7);if(!m||!a7.createElement){m=(a7.contentWindow||a7.contentDocument).document;m.write((ar.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");m.close()}bu=m.createElement(bw);m.body.appendChild(bu);bv=b.css(bu,"display");bt.removeChild(a7)}R[bw]=bv}return R[bw]}var V=/^t(?:able|d|h)$/i,ab=/^(?:body|html)$/i;if("getBoundingClientRect" in ar.documentElement){b.fn.offset=function(bG){var bw=this[0],bz;if(bG){return this.each(function(bH){b.offset.setOffset(this,bG,bH)})}if(!bw||!bw.ownerDocument){return null}if(bw===bw.ownerDocument.body){return b.offset.bodyOffset(bw)}try{bz=bw.getBoundingClientRect()}catch(bD){}var bF=bw.ownerDocument,bu=bF.documentElement;if(!bz||!b.contains(bu,bw)){return bz?{top:bz.top,left:bz.left}:{top:0,left:0}}var bA=bF.body,bB=aH(bF),by=bu.clientTop||bA.clientTop||0,bC=bu.clientLeft||bA.clientLeft||0,bt=bB.pageYOffset||b.support.boxModel&&bu.scrollTop||bA.scrollTop,bx=bB.pageXOffset||b.support.boxModel&&bu.scrollLeft||bA.scrollLeft,bE=bz.top+bt-by,bv=bz.left+bx-bC;return{top:bE,left:bv}}}else{b.fn.offset=function(bE){var by=this[0];if(bE){return this.each(function(bF){b.offset.setOffset(this,bE,bF)})}if(!by||!by.ownerDocument){return null}if(by===by.ownerDocument.body){return b.offset.bodyOffset(by)}b.offset.initialize();var bB,bv=by.offsetParent,bu=by,bD=by.ownerDocument,bw=bD.documentElement,bz=bD.body,bA=bD.defaultView,bt=bA?bA.getComputedStyle(by,null):by.currentStyle,bC=by.offsetTop,bx=by.offsetLeft;while((by=by.parentNode)&&by!==bz&&by!==bw){if(b.offset.supportsFixedPosition&&bt.position==="fixed"){break}bB=bA?bA.getComputedStyle(by,null):by.currentStyle;bC-=by.scrollTop;bx-=by.scrollLeft;if(by===bv){bC+=by.offsetTop;bx+=by.offsetLeft;if(b.offset.doesNotAddBorder&&!(b.offset.doesAddBorderForTableAndCells&&V.test(by.nodeName))){bC+=parseFloat(bB.borderTopWidth)||0;bx+=parseFloat(bB.borderLeftWidth)||0}bu=bv;bv=by.offsetParent}if(b.offset.subtractsBorderForOverflowNotVisible&&bB.overflow!=="visible"){bC+=parseFloat(bB.borderTopWidth)||0;bx+=parseFloat(bB.borderLeftWidth)||0}bt=bB}if(bt.position==="relative"||bt.position==="static"){bC+=bz.offsetTop;bx+=bz.offsetLeft}if(b.offset.supportsFixedPosition&&bt.position==="fixed"){bC+=Math.max(bw.scrollTop,bz.scrollTop);bx+=Math.max(bw.scrollLeft,bz.scrollLeft)}return{top:bC,left:bx}}}b.offset={initialize:function(){var bt=ar.body,bu=ar.createElement("div"),bx,bz,by,bA,bv=parseFloat(b.css(bt,"marginTop"))||0,bw="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";b.extend(bu.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});bu.innerHTML=bw;bt.insertBefore(bu,bt.firstChild);bx=bu.firstChild;bz=bx.firstChild;bA=bx.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(bz.offsetTop!==5);this.doesAddBorderForTableAndCells=(bA.offsetTop===5);bz.style.position="fixed";bz.style.top="20px";this.supportsFixedPosition=(bz.offsetTop===20||bz.offsetTop===15);bz.style.position=bz.style.top="";bx.style.overflow="hidden";bx.style.position="relative";this.subtractsBorderForOverflowNotVisible=(bz.offsetTop===-5);this.doesNotIncludeMarginInBodyOffset=(bt.offsetTop!==bv);bt.removeChild(bu);b.offset.initialize=b.noop},bodyOffset:function(bt){var bv=bt.offsetTop,bu=bt.offsetLeft;b.offset.initialize();if(b.offset.doesNotIncludeMarginInBodyOffset){bv+=parseFloat(b.css(bt,"marginTop"))||0;bu+=parseFloat(b.css(bt,"marginLeft"))||0}return{top:bv,left:bu}},setOffset:function(bw,bF,bz){var bA=b.css(bw,"position");if(bA==="static"){bw.style.position="relative"}var by=b(bw),bu=by.offset(),bt=b.css(bw,"top"),bD=b.css(bw,"left"),bE=(bA==="absolute"||bA==="fixed")&&b.inArray("auto",[bt,bD])>-1,bC={},bB={},bv,bx;if(bE){bB=by.position();bv=bB.top;bx=bB.left}else{bv=parseFloat(bt)||0;bx=parseFloat(bD)||0}if(b.isFunction(bF)){bF=bF.call(bw,bz,bu)}if(bF.top!=null){bC.top=(bF.top-bu.top)+bv}if(bF.left!=null){bC.left=(bF.left-bu.left)+bx}if("using" in bF){bF.using.call(bw,bC)}else{by.css(bC)}}};b.fn.extend({position:function(){if(!this[0]){return null}var bv=this[0],bu=this.offsetParent(),bw=this.offset(),bt=ab.test(bu[0].nodeName)?{top:0,left:0}:bu.offset();bw.top-=parseFloat(b.css(bv,"marginTop"))||0;bw.left-=parseFloat(b.css(bv,"marginLeft"))||0;bt.top+=parseFloat(b.css(bu[0],"borderTopWidth"))||0;bt.left+=parseFloat(b.css(bu[0],"borderLeftWidth"))||0;return{top:bw.top-bt.top,left:bw.left-bt.left}},offsetParent:function(){return this.map(function(){var bt=this.offsetParent||ar.body;while(bt&&(!ab.test(bt.nodeName)&&b.css(bt,"position")==="static")){bt=bt.offsetParent}return bt})}});b.each(["Left","Top"],function(bu,bt){var bv="scroll"+bt;b.fn[bv]=function(by){var bw,bx;if(by===L){bw=this[0];if(!bw){return null}bx=aH(bw);return bx?("pageXOffset" in bx)?bx[bu?"pageYOffset":"pageXOffset"]:b.support.boxModel&&bx.document.documentElement[bv]||bx.document.body[bv]:bw[bv]}return this.each(function(){bx=aH(this);if(bx){bx.scrollTo(!bu?by:b(bx).scrollLeft(),bu?by:b(bx).scrollTop())}else{this[bv]=by}})}});function aH(bt){return b.isWindow(bt)?bt:bt.nodeType===9?bt.defaultView||bt.parentWindow:false}b.each(["Height","Width"],function(bu,bt){var bv=bt.toLowerCase();b.fn["inner"+bt]=function(){var bw=this[0];return bw&&bw.style?parseFloat(b.css(bw,bv,"padding")):null};b.fn["outer"+bt]=function(bx){var bw=this[0];return bw&&bw.style?parseFloat(b.css(bw,bv,bx?"margin":"border")):null};b.fn[bv]=function(bx){var by=this[0];if(!by){return bx==null?null:this}if(b.isFunction(bx)){return this.each(function(bC){var bB=b(this);bB[bv](bx.call(this,bC,bB[bv]()))})}if(b.isWindow(by)){var bz=by.document.documentElement["client"+bt];return by.document.compatMode==="CSS1Compat"&&bz||by.document.body["client"+bt]||bz}else{if(by.nodeType===9){return Math.max(by.documentElement["client"+bt],by.body["scroll"+bt],by.documentElement["scroll"+bt],by.body["offset"+bt],by.documentElement["offset"+bt])}else{if(bx===L){var bA=b.css(by,bv),bw=parseFloat(bA);return b.isNaN(bw)?bA:bw}else{return this.css(bv,typeof bx==="string"?bx:bx+"px")}}}}});ba.jQuery=ba.$=b})(window);jQuery.Buffer=function(){var b=function(c){if(c){this.assign(c)}this._bufferedCommandList=[];this._bufferedCommands={}};b._buffers=[];b._pool=[];b.bufferForElement=function(c){if(c._jquery_buffer){return c._jquery_buffer}return this.bufferFromPool().assign(c)};b.bufferFromPool=function(){var c=null;if(this._pool.length===0){c=new b()}else{c=this._pool.pop()}b._buffers.push(c);if(!this.flushingScheduled){this.scheduleFlushing()}return c};b.returnToPool=function(c){c.unassign();this._pool.push(c)};b.scheduleFlushing=function(){this.flushingScheduled=true};b.flush=function(){var f=this._buffers,d,c=f.length;for(d=0;d<c;d++){f[d].flush();this.returnToPool(f[d])}this._buffers=[];this.flushingScheduled=false};b.prototype.assign=function(c){if(this._el){this.unassign()}this._el=c;this._el._jquery_buffer=this;return this};b.prototype.unassign=function(){if(!this._el){return}this._el._jquery_buffer=undefined;this._el=undefined;return this};b.prototype.flush=function(){var g=this._bufferedCommandList,f=g.length,d,h;for(d=0;d<f;d++){h=g[d];this[h](this._bufferedCommands[h]);delete this._bufferedCommands[h]}this._bufferedCommandList.length=0;this.unassign()};b.prototype.$=function(c,d){if(!d){d=this._el}if(c===""||c===undefined){c=d;d=undefined}return jQuery(c,d)};b.prototype.bufferedCommand=function(c){if(!this._bufferedCommands[c]){this._bufferedCommands[c]={};this._bufferedCommandList.push(c)}return this._bufferedCommands[c]};b.prototype.hasBufferedCommand=function(c){return !!this._bufferedCommands[c]};b.prototype.html=function(d){var c=this.bufferedCommand("flushContent");if(d===undefined){return c.text||c.html||this.$().html()}c.text=undefined;c.html=d};b.prototype.text=function(d){var c=this.bufferedCommand("flushContent");if(d===undefined){return c.text||c.html||this.$().text()}c.text=d;c.html=undefined};b.prototype.flushContent=function(c){if(c.text!==undefined){this.$().text(c.text)}else{if(c.html!==undefined){this.$().html(c.html)}}};b.prototype.attr=function(g,h){if(typeof g==="object"){for(var d in g){this.attr(d,g[d])}return}if(g==="class"){if(h===undefined){return this.setClass().join(" ")}else{if(typeof h==="string"||jQuery.isArray(h)){var c=this.bufferedCommand("flushClassNames");c.classNames=this._hashFromClassNames(h);return}else{return this.setClass(h)}}}else{if(g==="html"){return this.html(h)}else{if(g==="text"){return this.text(h)}else{if(g==="style"){return this.resetStyles(h)}}}}var f=this.bufferedCommand("flushAttributes");if(!f.attr){f.attr={}}f.attr[g]=h};b.prototype.flushAttributes=function(g){var c=g.attr,h=this.$(),d;for(var f in c){if(!c.hasOwnProperty(f)){continue}d=c[f];if(d!==null){h.attr(f,d)}else{h.removeAttr(f)}}};b.prototype._STYLE_REGEX=/-?\s*([^:\s]+)\s*:\s*([^;]+)\s*;?/g;b.prototype._camelizeStyleName=function(c){var d=c.match(/^-(webkit|moz|o)-/),f=c.camelize();if(d){return f.substr(0,1).toUpperCase()+f.substr(1)}else{return f}};b.prototype._dasherizeStyleName=function(c){var d=SC.String.dasherize(c);if(d.match(/^(webkit|moz|ms|o)-/)){d="-"+d}return d};b.prototype._loadStyles=function(c){if(!c){c=this.$().attr("style")}if(c&&(c=c.toString()).length>0){if(SC.browser.isIE){c=c.toLowerCase()}var g={};var f=this._STYLE_REGEX,d;f.lastIndex=0;while(d=f.exec(c)){g[this._camelizeStyleName(d[1])]=d[2]}return g}else{return{}}};b.prototype.resetStyles=function(d){var c=this.bufferedCommand("flushStyles");c._styles=this._loadStyles(d||" ")};b.prototype.styles=function(){var c=this.bufferedCommand("flushStyles");if(!c._styles){c._styles=this._loadStyles()}return c._styles};b.prototype.css=function(f,g){if(typeof f==="object"){for(var c in f){this.css(c,f[c])}return}var d=this.bufferedCommand("flushStyles");if(!d._styles){d._styles=this._loadStyles()}d._styles[f]=g};b.prototype.flushStyles=function(f){var h=f._styles;var j="";var d,i,g=[],c=0;for(d in h){if(!h.hasOwnProperty(d)){continue}i=h[d];if(i===null){continue}if(typeof i==="number"&&d!=="zIndex"&&d!=="fontWeight"&&d!=="opacity"){i+="px"}g[c++]=this._dasherizeStyleName(d)+": "+i}this.$().attr("style",g.join("; "))};b.prototype._hashFromClassNames=function(g){if(typeof g==="string"){g=g.split(" ")}var d,c=g.length,f={};for(d=0;d<c;d++){f[g[d]]=true}return f};b.prototype.setClass=function(h,c){var g=this.bufferedCommand("flushClassNames"),f;if(h===undefined){if(!g.classNames){g.classNames=this._hashFromClassNames(this._el.className)}var i=g.classNames,d=[];for(f in i){if(f&&i[f]){d.push(f)}}return d}if(typeof h==="object"){if(!g.classNames){g.classNames=this._hashFromClassNames(this._el.className)}for(f in h){g.classNames[f]=h[f]}return}if(!g.classNames){g.classNames=this._hashFromClassNames(this._el.className)}g.classNames[h]=c||false};b.prototype.hasClass=function(d){var c=this.bufferedCommand("flushClassNames");if(!c.classNames){c.classNames=this._hashFromClassNames(this._el.className)}return !!c.classNames[d]};b.prototype.addClass=function(g){if(!g){return}var f=this.bufferedCommand("flushClassNames");if(!f.classNames){f.classNames=this._hashFromClassNames(this._el.className)}if(typeof g==="string"){g=g.split(" ")}var d,c=g.length;for(d=0;d<c;d++){f.classNames[jQuery.trim(g[d])]=true}};b.prototype.removeClass=function(d){var c=this.bufferedCommand("flushClassNames");if(!c.classNames){c.classNames=this._hashFromClassNames(this._el.className)}c.classNames[d]=false};b.prototype.resetClassNames=function(d){var c=this.bufferedCommand("flushClassNames");c.classNames={}};b.prototype.flushClassNames=function(f){var g=[];var h=f.classNames,d;for(d in h){if(h[d]){g.push(d)}}this.$().attr("class",g.join(" "))};function a(d){for(var c in d){if(typeof d[c]==="function"){d[c].displayName=c}}}a(b);a(b.prototype);return b}();(function(){jQuery.buffer=jQuery.bufferedJQuery=jQuery.sub();jQuery.bufferedJQuery.fn.extend({html:function(d){if(d===undefined){if(this.length<1){return undefined}return jQuery.Buffer.bufferForElement(this[0]).html()}var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.html(d)}return this},text:function(d){if(d===undefined){if(this.length<1){return undefined}return jQuery.Buffer.bufferForElement(this[0]).text()}var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.text(d)}return this},attr:function(d,f){var b;if(typeof f==="undefined"&&typeof d==="string"){if(this.length<1){return false}b=jQuery.Buffer.bufferForElement(this[0]);return b.attr(d)}var a=this.length,c;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.attr(d,f)}return this},hasClass:function(a){if(this.length<1){return false}return jQuery.Buffer.bufferForElement(this[0]).hasClass(a)},setClass:function(f,c){var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.setClass(f,c)}return this},addClass:function(d){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.addClass(d)}return this},removeClass:function(d){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.removeClass(d)}return this},resetClassNames:function(){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.resetClassNames()}return this},css:function(d,f){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.css(d,f)}return this},styles:function(){if(this.length<1){return null}return jQuery.Buffer.bufferForElement(this[0]).styles()},resetStyles:function(){if(this.length<1){return null}jQuery.Buffer.bufferForElement(this[0]).resetStyles();return this}})})();jQuery.Buffer._flush=function(){jQuery.Buffer.flush()};jQuery.Buffer.scheduleFlushing=function(){SC.RunLoop.currentRunLoop.invokeOnce(jQuery.Buffer._flush);this.flushingScheduled=true};if(!window.require){window.require=function require(){}}if(!window.sc_require){window.sc_require=require}if(!window.sc_resource){window.sc_resource=function sc_resource(){}}sc_require("license");window.YES=true;window.NO=false;if(typeof console==="undefined"){window.console={};console.log=console.info=console.warn=console.error=function(){}}window.SC=window.SC||{};window.SproutCore=window.SproutCore||SC;SC=window.SC;SC.VERSION="1.8.0";SC._baseMixin=function(c){var g=Array.prototype.slice.call(arguments,1),a,f=g[0]||{},h=1,d=g.length,j,b,i;if(d===1){f=this||{};h=0}for(;h<d;h++){if(!(j=g[h])){continue}for(i in j){if(!j.hasOwnProperty(i)){continue}b=j[i];if(f===b){continue}if(b!==undefined&&(c||(f[i]===undefined))){f[i]=b}}if(j.hasOwnProperty("toString")){f.toString=j.toString}}return f};SC.mixin=function(){var a=Array.prototype.slice.call(arguments);a.unshift(true);return SC._baseMixin.apply(this,a)};SC.supplement=function(){var a=Array.prototype.slice.call(arguments);a.unshift(false);return SC._baseMixin.apply(this,a)};SC.extend=SC.mixin;SC.mixin({T_ERROR:"error",T_OBJECT:"object",T_NULL:"null",T_CLASS:"class",T_HASH:"hash",T_FUNCTION:"function",T_UNDEFINED:"undefined",T_NUMBER:"number",T_BOOL:"boolean",T_ARRAY:"array",T_STRING:"string",T_DATE:"date",T_REGEXP:"regexp",typeOf:function(a){if(a===undefined){return SC.T_UNDEFINED}if(a===null){return SC.T_NULL}var b=jQuery.type(a);if(b==="function"){return a.isClass?SC.T_CLASS:SC.T_FUNCTION}else{if(b==="object"){if(SC.Error&&(a instanceof SC.Error)){return SC.T_ERROR}else{if(a instanceof SC.Object){return SC.T_OBJECT}else{return SC.T_HASH}}}}return b},none:function(a){return a==null},empty:function(a){return a===null||a===undefined||a===""},isArray:function(a){if(!a||a.setInterval){return false}if(Array.isArray&&Array.isArray(a)){return true}if(a.objectAt){return true}if(a.length!==undefined&&jQuery.type(a)==="object"){return true}return false},makeArray:function(a){return SC.isArray(a)?a:SC.A(a)},A:function(c){if(c===null||c===undefined){return[]}if(c.slice instanceof Function){if(typeof(c)==="string"){return[c]}else{return c.slice()}}if(c.toArray){return c.toArray()}if(!SC.isArray(c)){return[c]}var b=[],a=c.length;while(--a>=0){b[a]=c[a]}return b},guidKey:"SproutCore"+(SC.VERSION+Math.random()).replace(/\D/g,""),_guidPrefixes:{number:"nu",string:"st"},_guidCaches:{number:{},string:{}},_numberGuids:[],_stringGuids:{},_keyCache:{},guidFor:function(f){var b,c,d=typeof f;if(f===undefined){return"(undefined)"}if(f===null){return"(null)"}if(d===SC.T_NUMBER||d===SC.T_STRING){b=this._guidCaches[d];c=b[f];if(!c){c="st"+(jQuery.uuid++);b[f]=c}return c}else{if(d===SC.T_BOOL){return(f)?"(true)":"(false)"}}var a=this.guidKey;if(f[a]){return f[a]}if(f===Object){return"(Object)"}if(f===Array){return"(Array)"}return SC.generateGuid(f,"sc")},keyFor:function(d,c){var b,a=this._keyCache[d];if(!a){a=this._keyCache[d]={}}b=a[c];if(!b){b=a[c]=d+"_"+c}return b},generateGuid:function(c,b){var a=(b+(jQuery.uuid++));if(c){c[this.guidKey]=a}return a},hashFor:function(){var a=arguments.length,c="",g,d,b;for(b=0;b<a;++b){g=arguments[b];c+=(g&&(d=g.hash)&&(typeof d===SC.T_FUNCTION))?d.call(g):this.guidFor(g)}return c===""?null:c},isEqual:function(d,c){return this.hashFor(d)===this.hashFor(c)},compare:function(u,q){if(u===q){return 0}var k=SC.typeOf(u);var h=SC.typeOf(q);var b=SC.ORDER_DEFINITION_MAPPING;if(!b){var d=SC.ORDER_DEFINITION;b=SC.ORDER_DEFINITION_MAPPING={};var t,o;for(t=0,o=d.length;t<o;++t){b[d[t]]=t}delete SC.ORDER_DEFINITION}var x=b[k];var c=b[h];if(x<c){return -1}if(x>c){return 1}switch(k){case SC.T_BOOL:case SC.T_NUMBER:if(u<q){return -1}if(u>q){return 1}return 0;case SC.T_STRING:var m=u.localeCompare(q);if(m<0){return -1}if(m>0){return 1}return 0;case SC.T_ARRAY:var p=u.length;var n=q.length;var f=Math.min(p,n);var a=0;var j=0;var g=arguments.callee;while(a===0&&j<f){a=g(u[j],q[j]);j++}if(a!==0){return a}if(p<n){return -1}if(p>n){return 1}return 0;case SC.T_OBJECT:if(u.constructor.isComparable===YES){return u.constructor.compare(u,q)}return 0;default:return 0}},K:function(){return this},EMPTY_ARRAY:[],EMPTY_HASH:{},EMPTY_RANGE:{start:0,length:0},beget:function(c){if(c===null||c===undefined){return null}var a=SC.K;a.prototype=c;var b=new a();a.prototype=null;if(typeof c.didBeget==="function"){b=c.didBeget(b)}return b},copy:function(d,b){var c=d,a;if(d){if(d.isCopyable){return d.copy(b)}if(d.clone){return d.clone()}}switch(jQuery.type(d)){case"array":c=d.slice();if(b){a=c.length;while(a--){c[a]=SC.copy(c[a],true)}}break;case"object":c={};for(var f in d){c[f]=b?SC.copy(d[f],true):d[f]}}return c},merge:function(){var c={},b=arguments.length,a;for(a=0;a<b;a++){SC.mixin(c,arguments[a])}return c},keys:function(c){var a=[];for(var b in c){a.push(b)}return a},inspect:function(d){var a,b=[];for(var c in d){a=d[c];if(a==="toString"){continue}if(SC.typeOf(a)===SC.T_FUNCTION){a="function() { ... }"}b.push(c+": "+a)}return"{"+b.join(" , ")+"}"},tupleForPropertyPath:function(f,a){if(typeof f==="object"&&(f instanceof Array)){return f}var c;var b=f.indexOf("*");if(b<0){b=f.lastIndexOf(".")}c=(b>=0)?f.slice(b+1):f;var d=this.objectForPropertyPath(f,a,b);return(d&&c)?[d,c]:null},objectForPropertyPath:function(g,c,d){var h,b,f,a;if(!c){c=window}if(SC.typeOf(g)===SC.T_STRING){if(d===undefined){d=g.length}h=0;while((c)&&(h<d)){b=g.indexOf(".",h);if((b<0)||(b>d)){b=d}f=g.slice(h,b);c=c.get?c.get(f):c[f];h=b+1}if(h<d){c=undefined}}else{h=0;a=g.length;f=null;while((h<a)&&c){f=g[h++];if(f){c=(c.get)?c.get(f):c[f]}}if(h<a){c=undefined}}return c},requiredObjectForPropertyPath:function(c,a,b){var d=SC.objectForPropertyPath(c,a,b);if(!d){throw c+" could not be found"}return d}});SC.clone=SC.copy;SC.$A=SC.A;SC.didLoad=SC.K;SC.ORDER_DEFINITION=[SC.T_ERROR,SC.T_UNDEFINED,SC.T_NULL,SC.T_BOOL,SC.T_NUMBER,SC.T_STRING,SC.T_ARRAY,SC.T_HASH,SC.T_OBJECT,SC.T_FUNCTION,SC.T_CLASS];SC.Function={property:function(b,c){b.dependentKeys=SC.$A(c);var a=SC.guidFor(b);b.cacheKey="__cache__"+a;b.lastSetValueKey="__lastValue__"+a;b.isProperty=true;return b},cacheable:function(a,b){a.isProperty=true;if(!a.dependentKeys){a.dependentKeys=[]}a.isCacheable=(b===undefined)?true:b;return a},idempotent:function(a,b){a.isProperty=true;if(!a.dependentKeys){this.dependentKeys=[]}a.isVolatile=(b===undefined)?true:b;return a},enhance:function(a){a.isEnhancement=true;return a},observes:function(c,a){var g=a.length,b=null,f=null;while(--g>=0){var d=a[g];if((d.indexOf(".")<0)&&(d.indexOf("*")<0)){if(!b){b=c.localPropertyPaths=[]}b.push(d)}else{if(!f){f=c.propertyPaths=[]}f.push(d)}}return c}};sc_require("system/function");SC.mixin(Function.prototype,{property:function(){return SC.Function.property(this,arguments)},cacheable:function(a){return SC.Function.cacheable(this,a)},idempotent:function(a){return SC.Function.idempotent(this,a)},enhance:function(){return SC.Function.enhance(this)},observes:function(a){return SC.Function.observes(this,arguments)}});SC.ObserverSet={add:function(k,a,c){var b=SC.guidFor(k),g=SC.guidFor(a),j=this._members,d=this.members,h=j[b],i,f;if(!h){h=j[b]={}}i=h[g];if(i===undefined){h[g]=d.length;f=[k,a,c];d.push(f)}else{}},remove:function(h,i){var f=SC.guidFor(h),b=SC.guidFor(i);var d=this._members[f],a=this.members;if(!d){return false}var c=d[b];if(c===undefined){return false}if(c!==a.length-1){var g=(a[c]=a[a.length-1]);this._members[SC.guidFor(g[0])][SC.guidFor(g[1])]=c}a.pop();delete this._members[f][b];return true},invokeMethods:function(){var b=this.members,d;for(var c=0,a=b.length;c<a;c++){d=b[c];d[1].call(d[0])}},clone:function(){var c=SC.ObserverSet.create(),d=this.members;c._members=SC.clone(this._members);var f=c.members;for(var b=0,a=d.length;b<a;b++){f[b]=SC.clone(d[b]);f[b].length=3}return c},create:function(){return new SC.ObserverSet.constructor()},getMembers:function(){return this.members.slice(0)},constructor:function(){this._members={};this.members=[]}};SC.ObserverSet.constructor.prototype=SC.ObserverSet;SC.ObserverSet.slice=SC.ObserverSet.clone;SC.ObserverSet.copy=SC.ObserverSet.clone;SC._ChainObserver=function(b,a){this.property=b;this.root=a||this};SC._ChainObserver.createChain=function(g,n,h,a,b){var d=n.split("."),k=new SC._ChainObserver(d[0]),j=k;for(var f=1,c=d.length;f<c;f++){j=j.next=new SC._ChainObserver(d[f],k)}var m=k.tails=[j];k.objectDidChange(g);m.forEach(function(i){i.target=h;i.method=a;i.context=b});k.tails=null;return k};SC._ChainObserver.prototype={isChainObserver:true,object:null,property:null,next:null,root:null,target:null,method:null,tail:function(){if(this._tail){return this._tail}var a=this;while(a.next){a=a.next}this._tail=a;return a},objectDidChange:function(a){if(a===this.object){return}if(this.object){if(this.property==="@each"&&this.object._removeContentObserver){this.object._removeContentObserver(this)}else{if(this.object.removeObserver){this.object.removeObserver(this.property,this,this.propertyDidChange)}}}this.object=a;if(this.property==="@each"&&this.next){if(this.object&&this.object._addContentObserver){this.object._addContentObserver(this)}}else{if(this.object&&this.object.addObserver){this.object.addObserver(this.property,this,this.propertyDidChange)}this.propertyDidChange()}},propertyDidChange:function(){var b=this.object;var f=this.property;var d=(b&&b.get)?b.get(f):null;if(this.next){this.next.objectDidChange(d)}var g=this.target,h=this.method,c=this.context;if(g&&h){var a=b?b.propertyRevision:null;if(c){h.call(g,b,f,d,c,a)}else{h.call(g,b,f,d,a)}}},destroyChain:function(){var a=this.object;if(a){if(this.property==="@each"&&this.next&&a._removeContentObserver){a._removeContentObserver(this)}if(a.removeObserver){a.removeObserver(this.property,this,this.propertyDidChange)}}if(this.next){this.next.destroyChain()}this.next=this.target=this.method=this.object=this.context=null;return null}};sc_require("ext/function");sc_require("private/observer_set");sc_require("private/chain_observer");SC.LOG_OBSERVERS=NO;SC.OBSERVES_HANDLER_ADD=0;SC.OBSERVES_HANDLER_REMOVE=1;SC.Observable={isObservable:YES,automaticallyNotifiesObserversFor:function(a){return YES},get:function(c){var b=this[c],a;if(b===undefined){return this.unknownProperty(c)}else{if(b&&b.isProperty){if(b.isCacheable){a=this._kvo_cache;if(!a){a=this._kvo_cache={}}return(a[b.cacheKey]!==undefined)?a[b.cacheKey]:(a[b.cacheKey]=b.call(this,c))}else{return b.call(this,c)}}else{return b}}},set:function(j,h){var b=this[j],k=this.automaticallyNotifiesObserversFor(j),g=h,d,a,i,f;if(h===undefined&&SC.typeOf(j)===SC.T_HASH){var c=j;for(j in c){if(!c.hasOwnProperty(j)){continue}this.set(j,c[j])}return this}if(!k&&this._kvo_cacheable&&(a=this._kvo_cache)){d=this._kvo_cachedep;if(!d||(d=d[j])===undefined){d=this._kvo_computeCachedDependentsFor(j)}if(d){i=d.length;while(--i>=0){f=d[i];a[f.cacheKey]=a[f.lastSetValueKey]=undefined}}}if(b&&b.isProperty){a=this._kvo_cache;if(b.isVolatile||!a||(a[b.lastSetValueKey]!==h)){if(!a){a=this._kvo_cache={}}a[b.lastSetValueKey]=h;if(k){this.propertyWillChange(j)}g=b.call(this,j,h);if(b.isCacheable){a[b.cacheKey]=g}if(k){this.propertyDidChange(j,g,YES)}}}else{if(b===undefined){if(k){this.propertyWillChange(j)}this.unknownProperty(j,h);if(k){this.propertyDidChange(j,g)}}else{if(this[j]!==h){if(k){this.propertyWillChange(j)}g=this[j]=h;if(k){this.propertyDidChange(j,g)}}}}return this},unknownProperty:function(a,b){if(!(b===undefined)){this[a]=b}return b},beginPropertyChanges:function(){this._kvo_changeLevel=(this._kvo_changeLevel||0)+1;return this},endPropertyChanges:function(){this._kvo_changeLevel=(this._kvo_changeLevel||1)-1;var b=this._kvo_changeLevel,a=this._kvo_changes;if((b<=0)&&a&&(a.length>0)&&!SC.Observers.isObservingSuspended){this._notifyPropertyObservers()}return this},propertyWillChange:function(a){return this},propertyDidChange:function(o,m,c){this._kvo_revision=(this._kvo_revision||0)+1;var b=this._kvo_changeLevel||0,i,n,j,d,g=SC.LOG_OBSERVERS&&(this.LOG_OBSERVING!==NO);var k=this._kvo_property_chains;if(k){var h=k[o];if(h){this.beginPropertyChanges();h=SC.clone(h);h.forEach(function(p){p.notifyPropertyDidChange()});this.endPropertyChanges()}}var a=this._kvo_cache;if(a){if(!c){d=this[o];if(d&&d.isProperty){a[d.cacheKey]=a[d.lastSetValueKey]=undefined}}if(this._kvo_cacheable){i=this._kvo_cachedep;if(!i||(i=i[o])===undefined){i=this._kvo_computeCachedDependentsFor(o)}if(i){n=i.length;while(--n>=0){j=i[n];a[j.cacheKey]=a[j.lastSetValueKey]=undefined}}}}var f=SC.Observers.isObservingSuspended;if((b>0)||f){var l=this._kvo_changes;if(!l){l=this._kvo_changes=SC.CoreSet.create()}l.add(o);if(f){if(g){SC.Logger.log("%@%@: will not notify observers because observing is suspended".fmt(SC.KVO_SPACES,this))}SC.Observers.objectHasPendingChanges(this)}}else{this._notifyPropertyObservers(o)}return this},registerDependentKey:function(i,c){var f=this._kvo_dependents,j=this._kvo_chain_dependents,b=this[i],k,h,a,g,d;if(typeof c==="object"&&(c instanceof Array)){k=c;a=0}else{k=arguments;a=1}h=k.length;if(!f){this._kvo_dependents=f={}}while(--h>=a){g=k[h];if(g.indexOf(".")>=0){SC._PropertyChain.createChain(g,this,i).activate()}else{d=f[g];if(!d){d=f[g]=[]}d.push(i)}}},registerDependentKeyWithChain:function(c,a){var d=this._chainsFor(c),b;d.add(a)},removeDependentKeyWithChain:function(c,a){var d=this._chainsFor(c),b;d.remove(a);if(d.get("length")===0){delete this._kvo_property_chains[c]}},_chainsFor:function(a){this._kvo_property_chains=this._kvo_property_chains||{};var b=this._kvo_property_chains[a]||SC.CoreSet.create();this._kvo_property_chains[a]=b;return b},_kvo_addCachedDependents:function(b,g,i,c){var a=g.length,f,d,h;while(--a>=0){d=g[a];c.add(d);f=this[d];if(f&&(f instanceof Function)&&f.isProperty){if(f.isCacheable){b.push(f)}if((h=i[d])&&h.length>0){this._kvo_addCachedDependents(b,h,i,c)}}}},_kvo_computeCachedDependentsFor:function(c){var d=this._kvo_cachedep,g=this._kvo_dependents,f=g?g[c]:null,a,b;if(!d){d=this._kvo_cachedep={}}if(!f||f.length===0){return d[c]=null}a=d[c]=[];b=SC._TMP_SEEN_SET=(SC._TMP_SEEN_SET||SC.CoreSet.create());b.add(c);this._kvo_addCachedDependents(a,f,g,b);b.clear();if(a.length===0){a=d[c]=null}return a},_kvo_for:function(c,b){var a=this[c];if(!this._kvo_cloned){this._kvo_cloned={}}if(!a){a=this[c]=(b===undefined)?[]:b.create();this._kvo_cloned[c]=YES}else{if(!this._kvo_cloned[c]){a=this[c]=a.copy();this._kvo_cloned[c]=YES}}return a},addObserver:function(c,g,i,b){var d,a,f,h;if(i===undefined){i=g;g=this}if(!g){g=this}if(typeof i==="string"){i=g[i]}if(!i){throw"You must pass a method to addObserver()"}c=c.toString();if(c.indexOf(".")>=0){a=SC._ChainObserver.createChain(this,c,g,i,b);a.masterTarget=g;a.masterMethod=i;this._kvo_for(SC.keyFor("_kvo_chains",c)).push(a)}else{if((this[c]===undefined)&&(c.indexOf("@")===0)){this.get(c)}if(g===this){g=null}d=SC.keyFor("_kvo_observers",c);this._kvo_for(d,SC.ObserverSet).add(g,i,b);this._kvo_for("_kvo_observed_keys",SC.CoreSet).add(c)}if(this.didAddObserver){this.didAddObserver(c,g,i)}return this},removeObserver:function(c,g,i){var d,f,b,h,a;if(i===undefined){i=g;g=this}if(!g){g=this}if(typeof i==="string"){i=g[i]}if(!i){throw"You must pass a method to removeObserver()"}c=c.toString();if(c.indexOf(".")>=0){d=SC.keyFor("_kvo_chains",c);if(f=this[d]){f=this._kvo_for(d);a=f.length;while(--a>=0){b=f[a];if(b&&(b.masterTarget===g)&&(b.masterMethod===i)){f[a]=b.destroyChain()}}}}else{if(g===this){g=null}d=SC.keyFor("_kvo_observers",c);if(h=this[d]){h=this._kvo_for(d);h.remove(g,i);if(h.getMembers().length===0){this._kvo_for("_kvo_observed_keys",SC.CoreSet).remove(c)}}}if(this.didRemoveObserver){this.didRemoveObserver(c,g,i)}return this},hasObserverFor:function(b){SC.Observers.flush(this);var d=this[SC.keyFor("_kvo_observers",b)],c=this[SC.keyFor("_kvo_local",b)],a;if(c&&c.length>0){return YES}if(d&&d.getMembers().length>0){return YES}return NO},initObservable:function(){if(this._observableInited){return}this._observableInited=YES;var g,n,l,k,i,f,m,h,c,o,b,j,d,a;if(n=this._observers){h=n.length;for(g=0;g<h;g++){l=n[g];i=this[l];f=i.propertyPaths;m=(f)?f.length:0;for(c=0;c<m;c++){o=f[c];this.addObservesHandler(i,o)}}}this.bindings=[];if(n=this._bindings){for(g=0,a=n.length;g<a;g++){l=n[g];k=this[l];d=l.slice(0,-7);this[l]=this.bind(d,k)}}if(n=this._properties){for(g=0,a=n.length;g<a;g++){l=n[g];if(k=this[l]){if(k.isCacheable){this._kvo_cacheable=YES}if(k.dependentKeys&&(k.dependentKeys.length>0)){this.registerDependentKey(l,k.dependentKeys)}}}}},addObservesHandler:function(a,b){this._configureObservesHandler(SC.OBSERVES_HANDLER_ADD,a,b);return this},removeObservesHandler:function(a,b){this._configureObservesHandler(SC.OBSERVES_HANDLER_REMOVE,a,b);return this},_configureObservesHandler:function(d,b,f){var c,a;switch(d){case SC.OBSERVES_HANDLER_ADD:d="addObserver";break;case SC.OBSERVES_HANDLER_REMOVE:d="removeObserver";break;default:throw"invalid action provided: "+d}c=f.indexOf(".");if(c<0){this[d](f,this,b)}else{if(f.indexOf("*")===0){this[d](f.slice(1),this,b)}else{a=null;if(c===0){a=this;f=f.slice(1)}else{if(c===4&&f.slice(0,5)==="this."){a=this;f=f.slice(5)}else{if(c<0&&f.length===4&&f==="this"){a=this;f=""}else{if(c>0&&f[0]===f.charAt(0).toLowerCase()){a=this}}}}SC.Observers[d](f,this,b,a)}}},observersForKey:function(a){SC.Observers.flush(this);var b=this[SC.keyFor("_kvo_observers",a)];return b?b.getMembers():[]},_notifyPropertyObservers:function(v){if(!this._observableInited){this.initObservable()}SC.Observers.flush(this);var h=SC.LOG_OBSERVERS&&!(this.LOG_OBSERVING===NO),p,t,n,d,o,m,r,q,k,a,g,u,c,j,f,b,i,l;if(h){i=SC.KVO_SPACES=(SC.KVO_SPACES||"")+"  ";SC.Logger.log('%@%@: notifying observers after change to key "%@"'.fmt(i,this,v))}d=this["_kvo_observers_*"];this._kvo_changeLevel=(this._kvo_changeLevel||0)+1;while(((t=this._kvo_changes)&&(t.length>0))||v){r=++this.propertyRevision;if(!t){t=SC.CoreSet.create()}this._kvo_changes=null;if(v==="*"){t.add("*");t.addEach(this._kvo_for("_kvo_observed_keys",SC.CoreSet))}else{if(v){t.add(v)}}if(n=this._kvo_dependents){for(o=0;o<t.length;o++){v=t[o];m=n[v];if(m&&(j=m.length)){if(h){SC.Logger.log("%@...including dependent keys for %@: %@".fmt(i,v,m))}l=this._kvo_cache;if(!l){l=this._kvo_cache={}}while(--j>=0){t.add(v=m[j]);if(f=this[v]){this[f.cacheKey]=undefined;l[f.cacheKey]=l[f.lastSetValueKey]=undefined}}}}}while(t.length>0){v=t.pop();p=this[SC.keyFor("_kvo_observers",v)];if(p){q=SC.clone(p.getMembers());k=q.length;for(g=0;g<k;g++){a=q[g];if(a[3]===r){continue}if(!a[1]){SC.Logger.log(a)}u=a[0]||this;c=a[1];b=a[2];a[3]=r;if(h){SC.Logger.log('%@...firing observer on %@ for key "%@"'.fmt(i,u,v))}if(b!==undefined){c.call(u,this,v,null,b,r)}else{c.call(u,this,v,null,r)}}}q=this[SC.keyFor("_kvo_local",v)];if(q){k=q.length;for(g=0;g<k;g++){a=q[g];c=this[a];if(c){if(h){SC.Logger.log('%@...firing local observer %@.%@ for key "%@"'.fmt(i,this,a,v))}c.call(this,this,v,null,r)}}}if(d&&v!=="*"){q=SC.clone(d.getMembers());k=q.length;for(g=0;g<k;g++){a=q[g];u=a[0]||this;c=a[1];b=a[2];if(h){SC.Logger.log('%@...firing * observer on %@ for key "%@"'.fmt(i,u,v))}if(b!==undefined){c.call(u,this,v,null,b,r)}else{c.call(u,this,v,null,r)}}}if(this.propertyObserver){if(h){SC.Logger.log('%@...firing %@.propertyObserver for key "%@"'.fmt(i,this,v))}this.propertyObserver(this,v,null,r)}}if(t){t.destroy()}v=null}this._kvo_changeLevel=(this._kvo_changeLevel||1)-1;if(h){SC.KVO_SPACES=i.slice(0,-2)}return YES},bind:function(a,c,f){var d,b;if(f!==undefined){c=[c,f]}b=typeof c;if(b==="string"||(b==="object"&&(c instanceof Array))){d=this[a+"BindingDefault"]||SC.Binding;d=d.beget().from(c)}else{d=c.beget()}d=d.to(a,this).connect();this.bindings.push(d);return d},didChangeFor:function(a){var b,g,f,k,d,c,i,j,h;a=SC.hashFor(a);b=this._kvo_didChange_valueCache;if(!b){b=this._kvo_didChange_valueCache={}}g=this._kvo_didChange_revisionCache;if(!g){g=this._kvo_didChange_revisionCache={}}f=b[a]||{};k=g[a]||{};d=false;c=this._kvo_revision||0;i=arguments.length;while(--i>=1){j=arguments[i];if(k[j]!=c){h=this.get(j);if(f[j]!==h){d=true;f[j]=h}}k[j]=c}b[a]=f;g[a]=k;return d},setIfChanged:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){var c=a;for(a in c){if(!c.hasOwnProperty(a)){continue}this.setIfChanged(a,c[a])}return this}return(this.get(a)!==b)?this.set(a,b):this},getPath:function(b){var a=SC.tupleForPropertyPath(b,this);if(a===null||a[0]===null){return undefined}return SC.get(a[0],a[1])},setPath:function(c,b){if(c.indexOf(".")>=0){var a=SC.tupleForPropertyPath(c,this);if(!a||!a[0]){return null}a[0].set(a[1],b)}else{this.set(c,b)}return this},setPathIfChanged:function(c,b){if(c.indexOf(".")>=0){var a=SC.tupleForPropertyPath(c,this);if(!a||!a[0]){return null}if(a[0].get(a[1])!==b){a[0].set(a[1],b)}}else{this.setIfChanged(c,b)}return this},getEach:function(){var d=SC.A(arguments),c=[],a,b;for(a=0,b=d.length;a<b;a++){c[c.length]=this.getPath(d[a])}return c},incrementProperty:function(b,a){if(!a){a=1}this.set(b,(this.get(b)||0)+a);return this.get(b)},decrementProperty:function(b,a){if(!a){a=1}this.set(b,(this.get(b)||0)-a);return this.get(b)},toggleProperty:function(a,b,c){if(b===undefined){b=true}if(c===undefined){c=false}b=(this.get(a)==b)?c:b;this.set(a,b);return this.get(a)},notifyPropertyChange:function(a,b){this.propertyWillChange(a);this.propertyDidChange(a,b);return this},allPropertiesDidChange:function(){this._kvo_cache=null;this._notifyPropertyObservers("*");return this},addProbe:function(a){this.addObserver(a,SC.logChange)},removeProbe:function(a){this.removeObserver(a,SC.logChange)},logProperty:function(){var b=SC.$A(arguments),d,c,a;for(a=0,c=b.length;a<c;a++){d=b[a];SC.Logger.log("%@:%@: ".fmt(SC.guidFor(this),d),this.get(d))}},propertyRevision:1};SC.logChange=function logChange(c,a,b){SC.Logger.log("CHANGE: %@[%@] => %@".fmt(c,a,c.get(a)))};SC.mixin(SC,{get:function(a,b){if(!a){return undefined}if(b===undefined){return this[a]}if(a.get){return a.get(b)}return a[b]},getPath:function(a,b){if(b===undefined){b=a;a=window}return SC.objectForPropertyPath(b,a)}});SC.mixin(Array.prototype,SC.Observable);SC.Enumerator=function(a){this.enumerable=a;this.reset();return this};SC.Enumerator.prototype={nextObject:function(){var c=this._index;var a=this._length;if(c>=a){return undefined}var b=this.enumerable.nextObject(c,this._previousObject,this._context);this._previousObject=b;this._index=c+1;if(c>=a){this._context=SC.Enumerator._pushContext(this._context)}return b},reset:function(){var b=this.enumerable;if(!b){throw SC.$error("Enumerator has been destroyed")}this._length=b.get?b.get("length"):b.length;var a=this._length;this._index=0;this._previousObject=null;this._context=(a>0)?SC.Enumerator._popContext():null},destroy:function(){this.enumerable=this._length=this._index=this._previousObject=this._context=null}};SC.Enumerator.create=function(a){return new SC.Enumerator(a)};SC.Enumerator._popContext=function(){var a=this._contextCache?this._contextCache.pop():null;return a||{}};SC.Enumerator._pushContext=function(b){this._contextCache=this._contextCache||[];var a=this._contextCache;a.push(b);return null};sc_require("core");sc_require("ext/function");sc_require("system/enumerator");SC.Enumerable={isEnumerable:YES,nextObject:function(a,c,b){return this.objectAt?this.objectAt(a):this[a]},firstObject:function(){if(this.get("length")===0){return undefined}if(this.objectAt){return this.objectAt(0)}var b=SC.Enumerator._popContext(),a;a=this.nextObject(0,null,b);b=SC.Enumerator._pushContext(b);return a}.property(),lastObject:function(){var a=this.get("length");if(a===0){return undefined}if(this.objectAt){return this.objectAt(a-1)}}.property(),enumerator:function(){return SC.Enumerator.create(this)},forEach:function(h,g){if(typeof h!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(g===undefined){g=null}var f=null;var c=SC.Enumerator._popContext();for(var a=0;a<b;a++){var d=this.nextObject(a,f,c);h.call(g,d,a,this);f=d}f=null;c=SC.Enumerator._pushContext(c);return this},getEach:function(a){return this.map(function(b){return b?(b.get?b.get(a):b[a]):null},this)},setEach:function(a,b){this.forEach(function(c){if(c){if(c.set){c.set(a,b)}else{c[a]=b}}},this);return this},map:function(i,h){if(typeof i!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var c=[];var g=null;var d=SC.Enumerator._popContext();for(var a=0;a<b;a++){var f=this.nextObject(a,g,d);c[a]=i.call(h,f,a,this);g=f}g=null;d=SC.Enumerator._pushContext(d);return c},mapProperty:function(a){return this.map(function(b){return b?(b.get?b.get(a):b[a]):null})},filter:function(i,h){if(typeof i!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var c=[];var g=null;var d=SC.Enumerator._popContext();for(var a=0;a<b;a++){var f=this.nextObject(a,g,d);if(i.call(h,f,a,this)){c.push(f)}g=f}g=null;d=SC.Enumerator._pushContext(d);return c},sortProperty:function(b){var c=(typeof b===SC.T_STRING)?arguments:b,a=c.length,d;if(this instanceof Array){d=this}else{d=[];this.forEach(function(f){d.push(f)})}if(!d){return[]}return d.sort(function(h,g){var f,j,l,k,i=0;for(f=0;i===0&&f<a;f++){j=c[f];l=h?(h.get?h.get(j):h[j]):null;k=g?(g.get?g.get(j):g[j]):null;i=SC.compare(l,k)}return i})},filterProperty:function(k,g){var d=this.get?this.get("length"):this.length;var f=[];var j=null;var b=SC.Enumerator._popContext();for(var h=0;h<d;h++){var c=this.nextObject(h,j,b);var i=c?(c.get?c.get(k):c[k]):null;var a=(g===undefined)?!!i:SC.isEqual(i,g);if(a){f.push(c)}j=c}j=null;b=SC.Enumerator._pushContext(b);return f},find:function(i,d){var c=this.get?this.get("length"):this.length;if(d===undefined){d=null}var h=null,b,j=NO,f=null;var a=SC.Enumerator._popContext();for(var g=0;g<c&&!j;g++){b=this.nextObject(g,h,a);if(j=i.call(d,b,g,this)){f=b}h=b}b=h=null;a=SC.Enumerator._pushContext(a);return f},findProperty:function(j,g){var c=this.get?this.get("length"):this.length;var k=NO,d=null,i=null,b,h;var a=SC.Enumerator._popContext();for(var f=0;f<c&&!k;f++){b=this.nextObject(f,i,a);h=b?(b.get?b.get(j):b[j]):null;k=(g===undefined)?!!h:SC.isEqual(h,g);if(k){d=b}i=b}i=b=null;a=SC.Enumerator._pushContext(a);return d},every:function(i,h){if(typeof i!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var c=YES;var g=null;var d=SC.Enumerator._popContext();for(var a=0;c&&(a<b);a++){var f=this.nextObject(a,g,d);if(!i.call(h,f,a,this)){c=NO}g=f}g=null;d=SC.Enumerator._pushContext(d);return c},everyProperty:function(j,f){var c=this.get?this.get("length"):this.length;var d=YES;var i=null;var a=SC.Enumerator._popContext();for(var g=0;d&&(g<c);g++){var b=this.nextObject(g,i,a);var h=b?(b.get?b.get(j):b[j]):null;d=(f===undefined)?!!h:SC.isEqual(h,f);i=b}i=null;a=SC.Enumerator._pushContext(a);return d},some:function(i,h){if(typeof i!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var c=NO;var g=null;var d=SC.Enumerator._popContext();for(var a=0;(!c)&&(a<b);a++){var f=this.nextObject(a,g,d);if(i.call(h,f,a,this)){c=YES}g=f}g=null;d=SC.Enumerator._pushContext(d);return c},someProperty:function(j,f){var c=this.get?this.get("length"):this.length;var d=NO;var i=null;var a=SC.Enumerator._popContext();for(var g=0;!d&&(g<c);g++){var b=this.nextObject(g,i,a);var h=b?(b.get?b.get(j):b[j]):null;d=(f===undefined)?!!h:SC.isEqual(h,f);i=b}i=null;a=SC.Enumerator._pushContext(a);return d},reduce:function(h,i,j){if(typeof h!=="function"){throw new TypeError()}var c=this.get?this.get("length"):this.length;if(c===0&&i===undefined){throw new TypeError()}var d=i;var g=null;var a=SC.Enumerator._popContext();for(var f=0;f<c;f++){var b=this.nextObject(f,g,a);if(b!==null){if(d===undefined){d=b}else{d=h.call(null,d,b,f,this,j)}}g=b}g=null;a=SC.Enumerator._pushContext(a);if(d===undefined){throw new TypeError()}return d},invoke:function(i){var f=this.get?this.get("length"):this.length;if(f<=0){return[]}var j;var h=[];var c=arguments.length;if(c>1){for(j=1;j<c;j++){h.push(arguments[j])}}var g=[];var k=null;var b=SC.Enumerator._popContext();for(j=0;j<f;j++){var d=this.nextObject(j,k,b);var a=d?d[i]:null;if(a){g[j]=a.apply(d,h)}k=d}k=null;b=SC.Enumerator._pushContext(b);return g},invokeWhile:function(d,j){var g=this.get?this.get("length"):this.length;if(g<=0){return null}var k;var i=[];var c=arguments.length;if(c>2){for(k=2;k<c;k++){i.push(arguments[k])}}var h=d;var l=null;var b=SC.Enumerator._popContext();for(k=0;(h===d)&&(k<g);k++){var f=this.nextObject(k,l,b);var a=f?f[j]:null;if(a){h=a.apply(f,i)}l=f}l=null;b=SC.Enumerator._pushContext(b);return h},toArray:function(){var a=[];this.forEach(function(b){a.push(b)},this);return a},groupBy:function(j){var c=this.get?this.get("length"):this.length,d=[],i=null,a=SC.Enumerator._popContext(),f=[],k=[],g,b,h;for(g=0;g<c;g++){b=this.nextObject(g,i,a);h=b?(b.get?b.get(j):b[j]):null;if(SC.none(f[h])){f[h]=[];k.push(h)}f[h].push(b);i=b}i=null;a=SC.Enumerator._pushContext(a);for(g=0,c=k.length;g<c;g++){d.push(f[k[g]])}return d}};SC._buildReducerFor=function(a,b){return function(d,f){var g=this[a];if(SC.typeOf(g)!==SC.T_FUNCTION){return this.unknownProperty?this.unknownProperty(d,f):null}else{var c=SC.Enumerable.reduce.call(this,g,null,b);return c}}.property("[]")};SC.Reducers={"[]":function(a,b){return this}.property(),enumerableContentDidChange:function(c,a,b){this.notifyPropertyChange("[]")},reducedProperty:function(j,h,g){if(!j||typeof j!==SC.T_STRING||j.charAt(0)!=="@"){return undefined}var d=j.match(/^@([^(]*)(\(([^)]*)\))?$/);if(!d||d.length<2){return undefined}var i=d[1];var k=d[3];i="reduce"+i.slice(0,1).toUpperCase()+i.slice(1);var a=this[i];if(SC.typeOf(a)!==SC.T_FUNCTION){return undefined}if(g===NO){return SC.Enumerable.reduce.call(this,a,null,k)}var c=SC._buildReducerFor(i,k);var b=this.constructor.prototype;if(b){b[j]=c;var f=b._properties||[];f.push(j);b._properties=f;this.registerDependentKey(j,"[]")}return SC.Enumerable.reduce.call(this,a,null,k)},reduceMax:function(a,d,b,f,c){if(c&&d){d=d.get?d.get(c):d[c]}if(a===null){return d}return(d>a)?d:a},reduceMaxObject:function(b,f,c,g,d){var a=b,h=f;if(d){if(f){h=f.get?f.get(d):f[d]}if(b){a=b.get?b.get(d):b[d]}}if(a===null){return f}return(h>a)?f:b},reduceMin:function(a,d,b,f,c){if(c&&d){d=d.get?d.get(c):d[c]}if(a===null){return d}return(d<a)?d:a},reduceMinObject:function(b,f,c,g,d){var a=b,h=f;if(d){if(f){h=f.get?f.get(d):f[d]}if(b){a=b.get?b.get(d):b[d]}}if(a===null){return f}return(h<a)?f:b},reduceAverage:function(b,g,d,h,f){if(f&&g){g=g.get?g.get(f):g[f]}var c=(b||0)+g;var a=h.get?h.get("length"):h.length;if(d>=a-1){c=c/a}return c},reduceSum:function(a,d,b,f,c){if(c&&d){d=d.get?d.get(c):d[c]}return(a===null)?d:a+d}};SC.mixin(SC.Enumerable,SC.Reducers);SC.mixin(Array.prototype,SC.Reducers);Array.prototype.isEnumerable=YES;(function(){var a={nextObject:SC.Enumerable.nextObject,enumerator:SC.Enumerable.enumerator,firstObject:SC.Enumerable.firstObject,lastObject:SC.Enumerable.lastObject,sortProperty:SC.Enumerable.sortProperty,mapProperty:function(h){var f=this.length;var g=[];for(var d=0;d<f;d++){var i=this[d];g[d]=i?(i.get?i.get(h):i[h]):null}return g},filterProperty:function(i,k){var g=this.length;var h=[];for(var f=0;f<g;f++){var j=this[f];var l=j?(j.get?j.get(i):j[i]):null;var d=(k===undefined)?!!l:SC.isEqual(l,k);if(d){h.push(j)}}return h},groupBy:function(i){var f=this.length,h=[],k=[],g=[],d,j,l;for(d=0;d<f;d++){j=this[d];l=j?(j.get?j.get(i):j[i]):null;if(SC.none(k[l])){k[l]=[];g.push(l)}k[l].push(j)}for(d=0,f=g.length;d<f;d++){h.push(k[g[d]])}return h},find:function(k,j){if(typeof k!=="function"){throw new TypeError()}var f=this.length;if(j===undefined){j=null}var h,g=null,i=NO;for(var d=0;d<f&&!i;d++){h=this[d];if(i=k.call(j,h,d,this)){g=h}}h=null;return g},findProperty:function(h,k){var f=this.length;var i,l,j=NO,g=null;for(var d=0;d<f&&!j;d++){l=(i=this[d])?(i.get?i.get(h):i[h]):null;j=(k===undefined)?!!l:SC.isEqual(l,k);if(j){g=i}}i=null;return g},everyProperty:function(h,j){var f=this.length;var g=YES;for(var d=0;g&&(d<f);d++){var i=this[d];var k=i?(i.get?i.get(h):i[h]):null;g=(j===undefined)?!!k:SC.isEqual(k,j)}return g},someProperty:function(h,j){var f=this.length;var g=NO;for(var d=0;!g&&(d<f);d++){var i=this[d];var k=i?(i.get?i.get(h):i[h]):null;g=(j===undefined)?!!k:SC.isEqual(k,j)}return g},invoke:function(g){var f=this.length;if(f<=0){return[]}var d;var i=[];var k=arguments.length;if(k>1){for(d=1;d<k;d++){i.push(arguments[d])}}var h=[];for(d=0;d<f;d++){var j=this[d];var l=j?j[g]:null;if(l){h[d]=l.apply(j,i)}}return h},invokeWhile:function(g,l){var i=this.length;if(i<=0){return null}var m;var k=[];var f=arguments.length;if(f>2){for(m=2;m<f;m++){k.push(arguments[m])}}var j=g;for(m=0;(j===g)&&(m<i);m++){var h=this[m];var d=h?h[l]:null;if(d){j=d.apply(h,k)}}return j},toArray:function(){var f=this.length;if(f<=0){return[]}var g=[];for(var d=0;d<f;d++){var h=this[d];g.push(h)}return g},getEach:function(h){var g=[];var f=this.length;for(var d=0;d<f;d++){var i=this[d];g[d]=i?(i.get?i.get(h):i[h]):null}return g},setEach:function(g,h){var f=this.length;for(var d=0;d<f;d++){var i=this[d];if(i){if(i.set){i.set(g,h)}else{i[g]=h}}}return this}};var c={forEach:function(j,h){if(typeof j!=="function"){throw new TypeError()}if(h===undefined){h=null}for(var f=0,d=this.length;f<d;f++){var g=this[f];j.call(h,g,f,this)}return this},map:function(k,j){if(typeof k!=="function"){throw new TypeError()}if(j===undefined){j=null}var f=[];for(var g=0,d=this.length;g<d;g++){var h=this[g];f[g]=k.call(j,h,g,this)}return f},filter:function(k,j){if(typeof k!=="function"){throw new TypeError()}if(j===undefined){j=null}var f=[];for(var g=0,d=this.length;g<d;g++){var h=this[g];if(k.call(j,h,g,this)){f.push(h)}}return f},every:function(j,i){if(typeof j!=="function"){throw new TypeError()}var f=this.length;if(i===undefined){i=null}var g=YES;for(var d=0;g&&(d<f);d++){var h=this[d];if(!j.call(i,h,d,this)){g=NO}}return g},some:function(j,i){if(typeof j!=="function"){throw new TypeError()}var f=this.length;if(i===undefined){i=null}var g=NO;for(var d=0;(!g)&&(d<f);d++){var h=this[d];if(j.call(i,h,d,this)){g=YES}}return g},reduce:function(k,g,j){if(typeof k!=="function"){throw new TypeError()}var f=this.length;if(f===0&&g===undefined){throw new TypeError()}var h=g;for(var d=0;d<f;d++){var i=this[d];if(i!==null){if(h===undefined){h=i}else{h=k.call(null,h,i,d,this,j)}}}if(h===undefined){throw new TypeError()}return h}};for(var b in c){if(!c.hasOwnProperty(b)){continue}if(!Array.prototype[b]||((typeof Prototype==="object")&&Prototype.Version.match(/^1\.6/))){Array.prototype[b]=c[b]}}SC.mixin(Array.prototype,a)})();SC.RangeObserver={isRangeObserver:YES,toString:function(){var a=this.indexes?this.indexes.toString():"SC.IndexSet<..>";return a.replace("IndexSet","RangeObserver(%@)".fmt(SC.guidFor(this)))},create:function(d,g,f,h,c,a){var b=SC.beget(this);b.source=d;b.indexes=g?g.frozenCopy():null;b.target=f;b.method=(typeof h==="string")?f[h]:h;b.context=c;b.isDeep=a||false;b.beginObserving();return b},extend:function(d){var c=SC.beget(this),b=arguments;for(var f=0,a=b.length;f<a;f++){SC.mixin(c,b[f])}return c},destroy:function(a){this.endObserving();return this},update:function(a,b){if(this.indexes&&this.indexes.isEqual(b)){return this}this.indexes=b?b.frozenCopy():null;this.endObserving().beginObserving();return this},beginObserving:function(){if(!this.isDeep){return this}var c=this.observing=this.observing||SC.CoreSet.create();var a=this._beginObservingForEach,b=this.source;if(!a){a=this._beginObservingForEach=function(d){var f=b.objectAt(d);if(f&&f.addObserver){c.push(f);f._kvo_needsRangeObserver=true}}}this.indexes.forEach(a);this.isObserving=false;SC.Observers.addPendingRangeObserver(this);return this},setupPending:function(b){var f=this.observing;if(this.isObserving||!f||(f.get("length")===0)){return true}if(f.contains(b)){this.isObserving=true;var c=this._setupPendingForEach;if(!c){var d=this.source,g=this.objectPropertyDidChange,a=this;c=this._setupPendingForEach=function(h){var k=d.objectAt(h),i=SC.guidFor(k),j;if(k&&k.addObserver){f.push(k);k.addObserver("*",a,g);j=a[i];if(j==null){a[i]=h}else{if(j.isIndexSet){j.add(h)}else{a[i]=SC.IndexSet.create(j).add(h)}}}}}this.indexes.forEach(c);return true}else{return false}},endObserving:function(){if(!this.isDeep){return this}var f=this.observing;if(this.isObserving){var b=this.objectPropertyDidChange,c=this.source,a,g,d;if(f){g=f.length;for(a=0;a<g;a++){d=f[a];d.removeObserver("*",this,b);this[SC.guidFor(d)]=null}f.length=0}this.isObserving=false}if(f){f.clear()}return this},rangeDidChange:function(b){var a=this.indexes;if(!b||!a||a.intersects(b)){this.endObserving();this.method.call(this.target,this.source,null,"[]",b,this.context);this.beginObserving()}return this},objectPropertyDidChange:function(d,g,h,a){var f=this.context,i=this.method,c=SC.guidFor(d),b=this[c];if(b&&!b.isIndexSet){b=this[c]=SC.IndexSet.create(b).freeze()}i.call(this.target,this.source,d,g,b,f||a,a)}};sc_require("ext/function");sc_require("mixins/observable");sc_require("mixins/enumerable");sc_require("system/range_observer");SC.OUT_OF_RANGE_EXCEPTION="Index out of range";SC.CoreArray={isSCArray:YES,replace:function(a,c,b){throw"replace() must be implemented to support SC.Array"},indexOf:function(d,c){var b,a=this.get("length");if(c===undefined){c=0}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b<a;b++){if(this.objectAt(b,YES)===d){return b}}return -1},lastIndexOf:function(d,c){var b,a=this.get("length");if(c===undefined){c=a-1}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b>=0;b--){if(this.objectAt(b)===d){return b}}return -1},objectAt:function(a){if(a<0){return undefined}if(a>=this.get("length")){return undefined}return this.get(a)},"[]":function(a,b){if(b!==undefined){this.replace(0,this.get("length"),b)}return this}.property(),insertAt:function(a,b){if(a>this.get("length")){throw SC.OUT_OF_RANGE_EXCEPTION}this.replace(a,0,[b]);return this},removeAt:function(d,a){var c=0,b=[];if(typeof d===SC.T_NUMBER){if((d<0)||(d>=this.get("length"))){throw SC.OUT_OF_RANGE_EXCEPTION}if(a===undefined){this.replace(d,1,b);return this}else{d=SC.IndexSet.create(d,a)}}this.beginPropertyChanges();d.forEachRange(function(g,f){g-=c;c+=f;this.replace(g,f,b)},this);this.endPropertyChanges();return this},removeObject:function(b){var c=this.get("length")||0;while(--c>=0){var a=this.objectAt(c);if(a==b){this.removeAt(c)}}return this},removeObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.removeObject(b)},this);this.endPropertyChanges();return this},slice:function(b,d){var a=[];var c=this.get("length");if(SC.none(b)){b=0}if(SC.none(d)||(d>c)){d=c}while(b<d){a[a.length]=this.objectAt(b++)}return a},pushObject:function(a){this.insertAt(this.get("length"),a);return a},pushObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.pushObject(b)},this);this.endPropertyChanges();return this},popObject:function(){var a=this.get("length");if(a===0){return null}var b=this.objectAt(a-1);this.removeAt(a-1);return b},shiftObject:function(){if(this.get("length")===0){return null}var a=this.objectAt(0);this.removeAt(0);return a},unshiftObject:function(a){this.insertAt(0,a);return a},unshiftObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.unshiftObject(b)},this);this.endPropertyChanges();return this},isEqual:function(a){if(!a){return false}if(a==this){return true}var b=a.get("length");if(b!=this.get("length")){return false}while(--b>=0){if(!SC.isEqual(a.objectAt(b),this.objectAt(b))){return false}}return true},compact:function(){return this.without(null)},without:function(b){if(this.indexOf(b)<0){return this}var a=[];this.forEach(function(c){if(c!==b){a[a.length]=c}});return a},uniq:function(){var a=[];this.forEach(function(b){if(a.indexOf(b)<0){a[a.length]=b}});return a},flatten:function(){var a=[];this.forEach(function(b){if(b&&b.isEnumerable){a=a.pushObjects(b.flatten())}else{a.pushObject(b)}});return a},max:function(){return Math.max.apply(Math,this)},min:function(){return Math.min.apply(Math,this)},rangeObserverClass:SC.RangeObserver,contains:function(a){return this.indexOf(a)>=0},addRangeObserver:function(d,g,i,f){var a=this._array_rangeObservers;if(!a){a=this._array_rangeObservers=SC.CoreSet.create()}if(this._array_oldLength===undefined){this._array_oldLength=this.get("length")}var h=this.rangeObserverClass;var b=NO;var c=h.create(this,d,g,i,f,b);a.add(c);if(!this._array_isNotifyingRangeObservers){this._array_isNotifyingRangeObservers=YES;this.addObserver("[]",this,this._array_notifyRangeObservers)}return c},updateRangeObserver:function(b,a){return b.update(this,a)},removeRangeObserver:function(c){var b=c.destroy(this);var a=this._array_rangeObservers;if(a){a.remove(c)}return b},addArrayObservers:function(a){this._modifyObserverSet("add",a)},removeArrayObservers:function(a){this._modifyObserverSet("remove",a)},_modifyObserverSet:function(i,c){var f,b;var h=c.target||this;var a=c.willChange||"arrayWillChange";var g=c.didChange||"arrayDidChange";var d=c.context;if(typeof a==="string"){a=h[a]}if(typeof g==="string"){g=h[g]}f=this._kvo_for("_kvo_array_will_change",SC.ObserverSet);b=this._kvo_for("_kvo_array_did_change",SC.ObserverSet);f[i](h,a,d);b[i](h,g,d)},arrayContentWillChange:function(b,j,a){this._teardownContentObservers(b,j);var g,d,i,k;var h,c;var f=this._kvo_array_will_change;if(f){d=f.members;i=d.length;for(k=0;k<i;k++){g=d[k];h=g[0];c=g[1];c.call(h,b,j,a,this)}}},arrayContentDidChange:function(b,o,a){var d=this._array_rangeObservers,i,c,m;this.beginPropertyChanges();this.notifyPropertyChange("length");if(d&&d.length>0){m=this._array_rangeChanges;if(!m){m=this._array_rangeChanges=SC.IndexSet.create()}if(o===a){c=o}else{c=this.get("length")-b;if(o>a){c+=(o-a)}}m.add(b,c)}this._setupContentObservers(b,a);var h,g,l,n;var j,f;var k=this._kvo_array_did_change;if(k){if(b===undefined){b=0;o=this.get("length");a=0}g=k.members;l=g.length;for(n=0;n<l;n++){h=g[n];j=h[0];f=h[1];f.call(j,b,o,a,this)}}this.notifyPropertyChange("[]");this.endPropertyChanges();return this},_setupContentObservers:function(g,f){var c=this._kvo_for("_kvo_content_observed_keys",SC.CoreSet);var d;var b;if(c.get("length")>0){d=this.slice(g,g+f);var a=this;c.forEach(function(h){b=SC.keyFor("_kvo_content_observers",h);a._kvo_for(b).forEach(function(i){d.forEach(function(j){a._resumeChainObservingForItemWithChainObserver(j,i)})})})}},_teardownContentObservers:function(f,a){var c=this._kvo_for("_kvo_content_observed_keys",SC.CoreSet);var d;var b;if(c.get("length")>0){d=this.slice(f,f+a);c.forEach(function(g){b=SC.keyFor("_kvo_content_observers",g);d.forEach(function(h){h._kvo_for(b).forEach(function(i){i.destroyChain()})})})}},teardownEnumerablePropertyChains:function(b){var a=this._kvo_enumerable_property_chains;if(a){a.forEach(function(h){var d,c=b.get("length"),j=SC.guidFor(h),g,i,f="_kvo_enumerable_property_clones";h.notifyPropertyDidChange();for(d=0;d<c;d++){i=b.objectAt(d);g=i[f][j];g.deactivate();delete i[f][j]}},this)}return this},setupEnumerablePropertyChains:function(b){var a=this._kvo_enumerable_property_chains;if(a){a.forEach(function(f){var d,c=b.get("length");f.notifyPropertyDidChange();c=b.get("length");for(d=0;d<c;d++){this._clonePropertyChainToItem(f,b.objectAt(d))}},this)}return this},registerDependentKeyWithChain:function(f,c){var b="_kvo_enumerable_property_chains",g,d,h,a;g=this._kvo_for(b,SC.CoreSet);g.add(c);this.forEach(function(i){this._clonePropertyChainToItem(c,i)},this)},_clonePropertyChainToItem:function(c,d){var f=SC.clone(c),b="_kvo_enumerable_property_clones",a;f.object=d;a=d[b]=d[b]||{};a[SC.guidFor(c)]=f;f.activate(d)},removeDependentKeyWithChain:function(g,d){var b="_kvo_enumerable_property_chains",c="_kvo_enumerable_property_clones",h,f,i,a;this.forEach(function(j){j.removeDependentKeyWithChain(g,d);a=j[c];i=a[SC.guidFor(d)];i.deactivate(j)},this)},_resumeChainObservingForItemWithChainObserver:function(d,a){var b=SC.clone(a.next);var c=b.property;b.object=d;d.addObserver(c,b,b.propertyDidChange);if(a.root.tails){a.root.tails.pushObject(b.tail())}b.propertyDidChange();d._kvo_for(SC.keyFor("_kvo_content_observers",c)).push(b)},_addContentObserver:function(a){var b=a.next.property;this._kvo_for("_kvo_content_observed_keys",SC.CoreSet).push(b);var c=SC.keyFor("_kvo_content_observers",b);this._kvo_for(c).push(a);this._setupContentObservers(0,a.object.get("length"))},_removeContentObserver:function(a){var f,c;var d=this._kvo_content_observed_keys;var b=a.next.property;if(d.contains(b)){c=SC.keyFor("_kvo_content_observers",b);f=this._kvo_for(c);f.removeObject(a);this._teardownContentObservers(0,a.object.get("length"));if(f.length===0){this._kvo_for("_kvo_content_observed_keys").remove(b)}}},_array_notifyRangeObservers:function(){var c=this._array_rangeObservers,d=this._array_rangeChanges,b=c?c.length:0,a,f;if(b>0&&d&&d.length>0){for(a=0;a<b;a++){c[a].rangeDidChange(d)}d.clear()}}};SC.Array=SC.mixin({},SC.Enumerable,SC.CoreArray);sc_require("mixins/array");SC.supplement(Array.prototype,SC.CoreArray);SC.mixin(Array.prototype,{replace:function(b,f,d){if(this.isFrozen){throw SC.FROZEN_ERROR}var c;var a=d?(d.get?d.get("length"):d.length):0;this.arrayContentWillChange(b,f,a);if(a===0){this.splice(b,f)}else{c=[b,f].concat(d);this.splice.apply(this,c)}this.arrayContentDidChange(b,f,a);this.enumerableContentDidChange(b,f,a-f);return this},unknownProperty:function(b,c){var a=this.reducedProperty(b,c);if((c!==undefined)&&a===undefined){a=this[b]=c}return a}});if(Array.prototype.indexOf===SC.CoreArray.indexOf){Array.prototype.indexOf=function(d,c){var b,a=this.length;if(c===undefined){c=0}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b<a;b++){if(this[b]===d){return b}}return -1}}if(Array.prototype.lastIndexOf===SC.CoreArray.lastIndexOf){Array.prototype.lastIndexOf=function(d,c){var b,a=this.length;if(c===undefined){c=a-1}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b>=0;b--){if(this[b]===d){return b}}return -1}}if(!Date.now){Date.now=function(){return new Date().getTime()}}SC.String={_scs_valueForKey:function(f,h,c){var a,g,d,b=f.indexOf(":");if(b>-1){a=f.substr(b+1);f=f.substr(0,b)}g=h[f];d=h[f+"Formatter"];if(d){g=d(g,a)}else{if(a){throw"String.fmt was given a formatting string, but key `"+f+"` has no formatter! String: "+c}}return g},fmt:function(b,a){var c=0,d=undefined,f;if(a){d=a[0]}return b.replace(/%\{(.*?)\}/g,function(g,h){f=YES;if(!d){throw"Cannot use named parameters with `fmt` without a data hash. String: '"+b+"'"}return SC.String._scs_valueForKey(h,d,b)}).replace(/%@([0-9]+)?/g,function(h,g){if(f){throw"Invalid attempt to use both named parameters and indexed parameters. String: '"+b+"'"}g=g?parseInt(g,10)-1:c++;if(a[g]!==undefined){return a[g]}else{return""}})},w:function(g){var d=[],f=g.split(" "),b=f.length,c,a=0;for(a=0;a<b;++a){c=f[a];if(c.length!==0){d.push(c)}}return d}};sc_require("system/string");SC.mixin(String.prototype,{fmt:function(){return SC.String.fmt(this,arguments)},w:function(){return SC.String.w(this)}});SC.Comparable={isComparable:YES,compare:function(d,c){throw"%@.compare() is not implemented".fmt(this.toString())}};SC.Copyable={isCopyable:YES,copy:function(a){var b=SC._object_className(this.constructor);throw"%@.copy() is not implemented".fmt(b)},frozenCopy:function(){var a=this.get?this.get("isFrozen"):this.isFrozen;if(a===YES){return this}else{if(a===undefined){throw"%@ does not support freezing".fmt(this)}else{return this.copy().freeze()}}}};SC.mixin(Array.prototype,SC.Copyable);Array.prototype.copy=function(b){var c=this.slice(),a;if(b){a=c.length;while(a--){c[a]=SC.copy(c[a],true)}}return c};SC.FROZEN_ERROR=new Error("Cannot modify a frozen object");SC.Freezable={isFreezable:YES,isFrozen:NO,freeze:function(){if(this.set){this.set("isFrozen",YES)}else{this.isFrozen=YES}return this}};SC.mixin(Array.prototype,SC.Freezable);sc_require("mixins/enumerable");sc_require("mixins/observable");sc_require("mixins/freezable");sc_require("mixins/copyable");SC.Set=SC.mixin({},SC.Enumerable,SC.Observable,SC.Freezable,{create:function(c){var d,b,f=SC.Set._pool,g=this.isObservable,a;if(!g&&c===undefined&&f.length>0){return f.pop()}else{d=SC.beget(this);if(g){d.initObservable()}if(c&&c.isEnumerable&&c.get("length")>0){d.isObservable=NO;if(c.isSCArray){a=c.get("length");for(b=0;b<a;b++){d.add(c.objectAt(b))}}else{if(c.isSet){a=c.length;for(b=0;b<a;b++){d.add(c[b])}}else{c.forEach(function(h){d.add(h)},this)}}d.isObservable=g}}return d},isSet:YES,length:0,firstObject:function(){return(this.length>0)?this[0]:undefined}.property(),clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}this.length=0;return this},contains:function(b){if(b===null){return NO}var a=this[SC.hashFor(b)];return(!SC.none(a)&&(a<this.length)&&(this[a]===b))},isEqual:function(a){if(!a||!a.isSet||(a.get("length")!==this.get("length"))){return NO}var b=this.get("length");while(--b>=0){if(!a.contains(this[b])){return NO}}return YES},addSetObserver:function(a){if(!this.setObservers){this.setObservers=SC.CoreSet.create()}this.setObservers.add(a)},removeSetObserver:function(a){if(!this.setObservers){return}this.setObservers.remove(a)},add:function(f){if(this.isFrozen){throw SC.FROZEN_ERROR}if(SC.none(f)){return this}var c,d=((c=f.hash)&&(typeof c==="function"))?c.call(f):SC.guidFor(f),b=this[d],a=this.length;if((b>=a)||(this[b]!==f)){this[a]=f;this[d]=a;this.length=a+1;if(this.setObservers){this.didAddItem(f)}}if(this.isObservable){this.enumerableContentDidChange()}return this},addEach:function(c){if(this.isFrozen){throw SC.FROZEN_ERROR}if(!c||!c.isEnumerable){throw"%@.addEach must pass enumerable".fmt(this)}var a,b=this.isObservable;if(b){this.beginPropertyChanges()}if(c.isSCArray){a=c.get("length");while(--a>=0){this.add(c.objectAt(a))}}else{if(c.isSet){a=c.length;while(--a>=0){this.add(c[a])}}else{c.forEach(function(d){this.add(d)},this)}}if(b){this.endPropertyChanges()}return this},remove:function(g){if(this.isFrozen){throw SC.FROZEN_ERROR}if(g===null||g===undefined){return this}var c,d=(g&&(c=g.hash)&&(typeof c===SC.T_FUNCTION))?c.call(g):SC.guidFor(g),b=this[d],a=this.length,f;if((b===null||b===undefined)||(b>=a)||(this[b]!==g)){return this}delete this[d];if(b<(a-1)){f=this[b]=this[a-1];d=(f&&(c=f.hash)&&(typeof c===SC.T_FUNCTION))?c.call(f):SC.guidFor(f);this[d]=b}this.length=a-1;if(this.isObservable){this.enumerableContentDidChange()}if(this.setObservers){this.didRemoveItem(g)}return this},pop:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}var a=(this.length>0)?this[this.length-1]:null;this.remove(a);return a},removeEach:function(c){if(this.isFrozen){throw SC.FROZEN_ERROR}if(!c||!c.isEnumerable){throw"%@.addEach must pass enumerable".fmt(this)}var a,b=this.isObservable;if(b){this.beginPropertyChanges()}if(c.isSCArray){a=c.get("length");while(--a>=0){this.remove(c.objectAt(a))}}else{if(c.isSet){a=c.length;while(--a>=0){this.remove(c[a])}}else{c.forEach(function(d){this.remove(d)},this)}}if(b){this.endPropertyChanges()}return this},copy:function(){return this.constructor.create(this)},destroy:function(){this.isFrozen=NO;if(!this.isObservable){SC.Set._pool.push(this.clear())}return this},forEach:function(c,d){var b=this.length;if(!d){d=this}for(var a=0;a<b;a++){c.call(d,this[a],a,this)}return this},toString:function(){var b=this.length,a,c=[];for(a=0;a<b;a++){c[a]=this[a]}return"SC.Set<%@>".fmt(c.join(","))},didAddItem:function(c){var d=this.setObservers;if(!d){return}var b=d.length,a;for(a=0;a<b;a++){d[a].didAddItem(this,c)}},didRemoveItem:function(c){var d=this.setObservers;if(!d){return}var b=d.length,a;for(a=0;a<b;a++){d[a].didRemoveItem(this,c)}},_pool:[],isObservable:YES});SC.Set.constructor=SC.Set;SC.Set.clone=SC.Set.copy;SC.Set.push=SC.Set.unshift=SC.Set.add;SC.Set.shift=SC.Set.pop;SC.Set.addObject=SC.Set.add;SC.Set.removeObject=SC.Set.remove;SC.Set._pool=[];SC.CoreSet=SC.beget(SC.Set);SC.CoreSet.isObservable=NO;SC.CoreSet.constructor=SC.CoreSet;sc_require("mixins/observable");sc_require("system/set");SC.Observers={queue:[],addObserver:function(c,d,f,b){var a;if(typeof c==="string"){a=SC.tupleForPropertyPath(c,b)}else{a=c}if(a&&a[0].addObserver){a[0].addObserver(a[1],d,f)}else{this.queue.push([c,d,f,b])}},removeObserver:function(g,h,i,d){var c,b,a,f;a=SC.tupleForPropertyPath(g,d);if(a){a[0].removeObserver(a[1],h,i)}c=this.queue.length;b=this.queue,newQueue=undefined;while(--c>=0){f=b[c];if(f[0]!==g||f[1]!==h||f[2]!==i||f[3]!==d){if(!newQueue){newQueue=[]}newQueue.push(f)}}this.queue=newQueue||this.queue},addPendingRangeObserver:function(a){var b=this.rangeObservers;if(!b){b=this.rangeObservers=SC.CoreSet.create()}b.add(a);return this},_TMP_OUT:[],flush:function(b){var h=this.queue,d,a=h.length;if(h&&a>0){var l=(this.queue=[]);for(d=0;d<a;d++){var m=h[d];if(!m){continue}var j=SC.tupleForPropertyPath(m[0],m[3]);if(j&&j[0].addObserver){j[0].addObserver(j[1],m[1],m[2])}else{l.push(m)}}}if(b._kvo_needsRangeObserver){var k=this.rangeObservers,g=k?k.get("length"):0,c=this._TMP_OUT,f;for(d=0;d<g;d++){f=k[d];if(f.setupPending(b)){c.push(f)}}if(c.length>0){k.removeEach(c)}c.length=0;b._kvo_needsRangeObserver=false}},isObservingSuspended:0,_pending:SC.CoreSet.create(),objectHasPendingChanges:function(a){this._pending.add(a)},suspendPropertyObserving:function(){this.isObservingSuspended++},resumePropertyObserving:function(){var c;if(--this.isObservingSuspended<=0){c=this._pending;this._pending=SC.CoreSet.create();var b,a=c.length;for(b=0;b<a;b++){c[b]._notifyPropertyObservers()}c.clear();c=null}}};sc_require("core");sc_require("mixins/observable");sc_require("private/observer_queue");sc_require("mixins/array");sc_require("system/set");SC.BENCHMARK_OBJECTS=NO;SC._detect_base=function _detect_base(c,b,a){return function d(){var g=b[a],f;if(!g){throw new Error("No '"+a+"' method was found on the superclass")}if(c.isEnhancement){f=Array.prototype.slice.call(arguments,1)}else{f=arguments}return g.apply(this,f)}};SC._object_extend=function _object_extend(h,g,o){if(!g){throw"SC.Object.extend expects a non-null value.  Did you forget to 'sc_require' something?  Or were you passing a Protocol to extend() as if it were a mixin?"}h._kvo_cloned=null;var z,n,v,f,i=h.concatenatedProperties,l=SC.K,c,b;n=(i)?i.length:0;var a=(n>0)?{}:null;while(--n>=0){z=i[n];c=h[z];b=g[z];if(c){if(!(c instanceof Array)){c=SC.$A(c)}a[z]=(b)?c.concat(b):b}else{if(!(b instanceof Array)){b=SC.$A(b)}a[z]=b}}var y=h._bindings,m=NO,w=h._observers,x=NO,j=h._properties,d=NO,r,k,p,q;var u=h.outlets,t=NO;if(g.outlets){u=(u||SC.EMPTY_ARRAY).concat(g.outlets);t=YES}for(z in g){if(z==="_kvo_cloned"){continue}if(!g.hasOwnProperty(z)){continue}q=(a.hasOwnProperty(z)?a[z]:null)||g[z];if(z.length>7&&z.slice(-7)==="Binding"){if(!m){y=(y||SC.EMPTY_ARRAY).slice();m=YES}if(y===null){y=(h._bindings||SC.EMPTY_ARRAY).slice()}y[y.length]=z}else{if(q&&(q instanceof Function)){if(!q.superclass&&(q!==(f=h[z]))){q.superclass=f||l;q.base=o?SC._detect_base(q,o,z):f||l}if(q.propertyPaths){if(!x){w=(w||SC.EMPTY_ARRAY).slice();x=YES}w[w.length]=z}if(r=q.localPropertyPaths){k=r.length;while(--k>=0){p=h._kvo_for(SC.keyFor("_kvo_local",r[k]),SC.CoreSet);p.add(z);h._kvo_for("_kvo_observed_keys",SC.CoreSet).add(r[k])}}if(q.dependentKeys){if(!d){j=(j||SC.EMPTY_ARRAY).slice();d=YES}j[j.length]=z}if(q.autoconfiguredOutlet){if(!t){u=(u||SC.EMPTY_ARRAY).slice();t=YES}u[u.length]=z}if(q.isEnhancement){q=SC._enhance(h[z]||l,q)}}}h[z]=q}if(g.hasOwnProperty("toString")){z="toString";q=(a.hasOwnProperty(z)?a[z]:null)||g[z];if(!q.superclass&&(q!==(f=h[z]))){q.superclass=q.base=f||l}h[z]=q}h._bindings=y||[];h._observers=w||[];h._properties=j||[];h.outlets=u||[];return h};SC._enhance=function(b,a){return function(){var d=Array.prototype.slice.call(arguments,0),c=this;d.unshift(function(){return b.apply(c,arguments)});return a.apply(this,d)}};SC.Object=function(a){this.__sc_super__=SC.Object.prototype;return this._object_init(a)};SC.mixin(SC.Object,{mixin:function(b){var a=arguments.length,c;for(c=0;c<a;c++){SC.mixin(this,arguments[c])}return this},superclass:null,extend:function(f){var d=SC.BENCHMARK_OBJECTS;if(d){SC.Benchmark.start("SC.Object.extend")}var h,c=function(i){this.__sc_super__=c.prototype;return this._object_init(i)};for(h in this){if(!this.hasOwnProperty(h)){continue}c[h]=this[h]}if(this.hasOwnProperty("toString")){c.toString=this.toString}c.superclass=this;c.__sc_super__=this.prototype;SC.generateGuid(c,"sc");c.subclasses=SC.Set.create();this.subclasses.add(c);var g=(c.prototype=SC.beget(this.prototype)),b,a=arguments.length;for(b=0;b<a;b++){SC._object_extend(g,arguments[b],c.__sc_super__)}g.constructor=c;if(d){SC.Benchmark.end("SC.Object.extend")}return c},reopen:function(a){return SC._object_extend(this.prototype,a,this.__sc_super__)},create:function(){var b=this,a=new b(arguments);if(SC.ObjectDesigner){SC.ObjectDesigner.didCreateObject(a,SC.$A(arguments))}return a},isClass:YES,subclasses:SC.Set.create(),toString:function(){return SC._object_className(this)},subclassOf:function(b){if(this===b){return NO}var a=this;while(a=a.superclass){if(a===b){return YES}}return NO},hasSubclass:function(a){return(a&&a.subclassOf)?a.subclassOf(this):NO},kindOf:function(a){return(this===a)||this.subclassOf(a)},design:function(){if(this.isDesign){return this}var a=this.extend.apply(this,arguments);a.isDesign=YES;if(SC.ObjectDesigner){SC.ObjectDesigner.didLoadDesign(a,this,SC.A(arguments))}return a}});SC.Object.prototype={_kvo_enabled:YES,_object_init:function(c){var b,a=(c)?c.length:0;for(b=0;b<a;b++){SC._object_extend(this,c[b],this.__sc_super__)}SC.generateGuid(this,"sc");this.init();var d=this.initMixin;a=(d)?d.length:0;for(b=0;b<a;b++){d[b].call(this)}return this},mixin:function(){var b,a=arguments.length,c;for(b=0;b<a;b++){SC.mixin(this,arguments[b])}for(b=0;b<a;b++){c=arguments[b].initMixin;if(c){c.call(this)}}return this},init:function(){this.initObservable();return this},isDestroyed:NO,destroy:function(){if(this.get("isDestroyed")){return this}this.set("isDestroyed",YES);var b,c=this.destroyMixin,a=(c)?c.length:0;for(b=0;b<a;b++){c[b].call(this)}this.bindings.invoke("disconnect");this.bindings=null;return this},isObject:true,respondsTo:function(a){return !!(this[a] instanceof Function)},tryToPerform:function(b,c,a){return this.respondsTo(b)&&(this[b](c,a)!==NO)},superclass:function(b){var a=arguments.callee.caller;if(!a){throw"superclass cannot determine the caller method"}return a.superclass?a.superclass.apply(this,arguments):null},instanceOf:function(a){return this.constructor===a},kindOf:function(a){return this.constructor.kindOf(a)},toString:function(){if(!this._object_toString){var a=SC._object_className(this.constructor),b=a+":"+SC.guidFor(this);if(a){this._object_toString=b}else{return b}}return this._object_toString},awake:function(){var d=this.outlets,b,a,c;for(b=0,a=d.length;b<a;++b){c=d[b];this.get(c)}this.bindings.invoke("sync")},invokeOnce:function(a){SC.RunLoop.currentRunLoop.invokeOnce(this,a);return this},invokeLast:function(a){SC.RunLoop.currentRunLoop.invokeLast(this,a);return this},concatenatedProperties:["concatenatedProperties","initMixin","destroyMixin"]};SC.Object.prototype.constructor=SC.Object;SC.mixin(SC.Object.prototype,SC.Observable);function findClassNames(){if(SC._object_foundObjectClassNames){return}SC._object_foundObjectClassNames=true;var b=[],c=false;var a=function(d,f,j){var l,i,h;j--;if(b.indexOf(f)>=0){return}b.push(f);for(var g in f){if(g=="__scope__"){continue}if(g=="superclass"){continue}if(g=="__SC__"){g="SC"}if(!g.match(/^[A-Z0-9]/)){continue}if(g=="SC"){if(c){continue}c=true}l=(d)?[d,g].join("."):g;i=f[g];try{h=SC.typeOf(i)}catch(k){break}switch(h){case SC.T_CLASS:if(!i._object_className){i._object_className=l}if(j>=0){a(l,i,j)}break;case SC.T_OBJECT:if(j>=0){a(l,i,j)}break;case SC.T_HASH:if(((d)||(l==="SC"))&&(j>=0)){a(l,i,j)}break;default:break}}};window.__SC__=SC;a(null,window,2)}SC.instanceOf=function(a,b){return !!(a&&a.constructor===b)};SC.kindOf=function(a,b){if(a&&!a.isClass){a=a.constructor}return !!(a&&a.kindOf&&a.kindOf(b))};SC._object_className=function(b){if(SC.isReady===NO){return""}if(!b._object_className){findClassNames()}if(b._object_className){return b._object_className}var a=b;while(a&&!a._object_className){a=a.superclass}return(a&&a._object_className)?a._object_className:"Anonymous"};sc_require("system/object");SC._PropertyChain=SC.Object.extend({object:null,property:null,target:null,toInvalidate:null,nextProperty:null,activate:function(b){var a=this.get("object"),c=this.get("property"),d;if(!b){b=this.get("target")}if(a&&a!==b){this.deactivate()}this.set("object",b);if(b&&c!=="@each"){b.registerDependentKeyWithChain(c,this)}if(this.next){d=b?b.get(c):undefined;this.next.activate(d)}return this},deactivate:function(){var a=this.get("object"),b=this.get("property");if(a){a.removeDependentKeyWithChain(b,this)}if(this.next){this.next.deactivate()}return this},notifyPropertyDidChange:function(){var d=this.get("target"),c=this.get("toInvalidate"),b,a;d.propertyDidChange(c);if(this.next){b=this.get("object");a=b.get(this.get("property"));this.next.activate(a)}}});SC._PropertyChain.createChain=function(j,h,f){var g=j.split(".");var a=g.length,d=1;var b=SC._PropertyChain.create({property:g[0],target:h,toInvalidate:f,nextProperty:g[1]});b.set("length",a);var c=b;while(--a>=1){c=c.next=SC._PropertyChain.create({property:g[d],target:h,toInvalidate:f,nextProperty:g[++d]});c.set("length",a)}return b};sc_require("ext/function");sc_require("system/object");SC.LOG_BINDINGS=NO;SC.BENCHMARK_BINDING_NOTIFICATIONS=NO;SC.BENCHMARK_BINDING_SETUP=NO;SC.MULTIPLE_PLACEHOLDER="@@MULT@@";SC.NULL_PLACEHOLDER="@@NULL@@";SC.EMPTY_PLACEHOLDER="@@EMPTY@@";SC.Binding={beget:function(b){var a=SC.beget(this);a.parentBinding=this;if(b!==undefined){a=a.from(b)}return a},builder:function(){var b=this,a=function(c){return b.beget().from(c)};a.beget=function(){return b.beget()};return a},from:function(b,a){if(!b){return this}var c=(this===SC.Binding)?this.beget():this;c._fromPropertyPath=b;c._fromRoot=a;c._fromTuple=null;return c},to:function(b,a){var c=(this===SC.Binding)?this.beget():this;c._toPropertyPath=b;c._toRoot=a;c._toTuple=null;return c},connect:function(){if(this.isConnected){return this}this.isConnected=YES;this._connectionPending=YES;this._syncOnConnect=YES;SC.Binding._connectQueue.add(this);if(!SC.RunLoop.isRunLoopInProgress()){this._scheduleSync()}return this},_connect:function(){if(!this._connectionPending){return}this._connectionPending=NO;var c,a,b=SC.BENCHMARK_BINDING_SETUP;if(b){SC.Benchmark.start("SC.Binding.connect()")}c=this._fromPropertyPath;a=this._fromRoot;if(typeof c==="string"){if(c.indexOf(".")===0){c=c.slice(1);if(!a){a=this._toRoot}}else{if(c.indexOf("*")===0){c=[this._fromRoot||this._toRoot,c.slice(1)];a=null}}}this._fromObserverData=[c,this,this.fromPropertyDidChange,a];SC.Observers.addObserver.apply(SC.Observers,this._fromObserverData);if(!this._oneWay){c=this._toPropertyPath;a=this._toRoot;this._toObserverData=[c,this,this.toPropertyDidChange,a];SC.Observers.addObserver.apply(SC.Observers,this._toObserverData)}if(b){SC.Benchmark.end("SC.Binding.connect()")}if(this._syncOnConnect){this._syncOnConnect=NO;if(b){SC.Benchmark.start("SC.Binding.connect().sync")}this.sync();if(b){SC.Benchmark.end("SC.Binding.connect().sync")}}},disconnect:function(){if(!this.isConnected){return this}if(this._connectionPending){this._connectionPending=NO}else{SC.Observers.removeObserver.apply(SC.Observers,this._fromObserverData);if(!this._oneWay){SC.Observers.removeObserver.apply(SC.Observers,this._toObserverData)}}this.isConnected=NO;return this},fromPropertyDidChange:function(c,b){var a=c?c.get(b):null;if(a!==this._bindingValue||b==="[]"){this._setBindingValue(c,b);this._changePending=YES;SC.Binding._changeQueue.add(this);this._scheduleSync()}},toPropertyDidChange:function(c,b){if(this._oneWay){return}var a=c.get(b);if(a!==this._transformedBindingValue){this._setBindingValue(c,b);this._changePending=YES;SC.Binding._changeQueue.add(this);this._scheduleSync()}},_scheduleSync:function(){if(SC.RunLoop.isRunLoopInProgress()||SC.Binding._syncScheduled){return}SC.Binding._syncScheduled=YES;setTimeout(function(){SC.run();SC.Binding._syncScheduled=NO},1)},_setBindingValue:function(b,a){this._bindingSource=b;this._bindingKey=a},_computeBindingValue:function(){var h=this._bindingSource,f=this._bindingKey,c,b;this._bindingValue=c=(h?h.getPath(f):null);var g=this._transforms;if(g){var a=g.length,d;for(b=0;b<a;b++){d=g[b];c=d(c,this)}}if(this._noError&&SC.typeOf(c)===SC.T_ERROR){c=null}this._transformedBindingValue=c},_connectQueue:SC.CoreSet.create(),_alternateConnectQueue:SC.CoreSet.create(),_changeQueue:SC.CoreSet.create(),_alternateChangeQueue:SC.CoreSet.create(),_changePending:NO,flushPendingChanges:function(){if(this._isFlushing){return NO}this._isFlushing=YES;SC.Observers.suspendPropertyObserving();var b=NO,c=SC.LOG_BINDINGS,a,d;while((a=this._connectQueue).length>0){this._connectQueue=this._alternateConnectQueue;this._alternateConnectQueue=a;while(d=a.pop()){d._connect()}}while((a=this._changeQueue).length>0){if(c){SC.Logger.log("Begin: Trigger changed bindings")}b=YES;this._changeQueue=this._alternateChangeQueue;this._alternateChangeQueue=a;while(d=a.pop()){d.applyBindingValue()}if(c){SC.Logger.log("End: Trigger changed bindings")}}this._isFlushing=NO;SC.Observers.resumePropertyObserving();return b},applyBindingValue:function(){this._changePending=NO;this._computeBindingTargets();this._computeBindingValue();var a=this._bindingValue,b=this._transformedBindingValue,c=SC.BENCHMARK_BINDING_NOTIFICATIONS,d=SC.LOG_BINDINGS;if(!this._oneWay&&this._fromTarget){if(d){SC.Logger.log("%@: %@ -> %@".fmt(this,a,b))}if(c){SC.Benchmark.start(this.toString()+"->")}this._fromTarget.setPathIfChanged(this._fromPropertyKey,a);if(c){SC.Benchmark.end(this.toString()+"->")}}if(this._toTarget){if(d){SC.Logger.log("%@: %@ <- %@".fmt(this,a,b))}if(c){SC.Benchmark.start(this.toString()+"<-")}this._toTarget.setPathIfChanged(this._toPropertyKey,b);if(c){SC.Benchmark.start(this.toString()+"<-")}}},sync:function(){if(!this.isConnected){return this}if(this._connectionPending){this._syncOnConnect=YES}else{this._computeBindingTargets();var c=this._fromTarget,b=this._fromPropertyKey;if(!c||!b){return this}if(!c.isObservable){SC.Logger.warn("Cannot bind '%@' to property '%@' on non-observable '%@'".fmt(this._toPropertyPath,b,c));return this}var a=c.getPath(b);if(a!==this._bindingValue||b==="[]"){this._setBindingValue(c,b);this._changePending=YES;SC.Binding._changeQueue.add(this)}}return this},_syncOnConnect:NO,_computeBindingTargets:function(){if(!this._fromTarget){var c,b,a;c=this._fromPropertyPath;b=this._fromRoot;if(typeof c==="string"){if(c.indexOf(".")===0){c=c.slice(1);if(!b){b=this._toRoot}}else{if(c.indexOf("*")===0){c=[b||this._toRoot,c.slice(1)];b=null}}}a=SC.tupleForPropertyPath(c,b);if(a){this._fromTarget=a[0];this._fromPropertyKey=a[1]}}if(!this._toTarget){c=this._toPropertyPath;b=this._toRoot;a=SC.tupleForPropertyPath(c,b);if(a){this._toTarget=a[0];this._toPropertyKey=a[1]}}},oneWay:function(c,a){if((a===undefined)&&(SC.typeOf(c)===SC.T_BOOL)){a=c;c=null}var b=this.from(c);if(b===SC.Binding){b=b.beget()}b._oneWay=(a===undefined)?YES:a;return b},transform:function(b){var c=(this===SC.Binding)?this.beget():this;var a=c._transforms;if(a&&(a===c.parentBinding._transform)){a=c._transforms=a.slice()}if(!a){a=c._transforms=[]}a.push(b);return c},resetTransforms:function(){var a=(this===SC.Binding)?this.beget():this;a._transforms=null;return a},noError:function(c,a){if((a===undefined)&&(SC.typeOf(c)===SC.T_BOOL)){a=c;c=null}var b=this.from(c);if(b===SC.Binding){b=b.beget()}b._noError=(a===undefined)?YES:a;return b},single:function(b,a){if(a===undefined){a=SC.MULTIPLE_PLACEHOLDER}return this.from(b).transform(function(f,d){if(f&&f.isEnumerable){var c=f.get("length");f=(c>1)?a:(c<=0)?null:f.firstObject()}return f})},notEmpty:function(b,a){if(a===undefined){a=SC.EMPTY_PLACEHOLDER}return this.from(b).transform(function(d,c){if(SC.none(d)||(d==="")||(SC.isArray(d)&&(d.get?d.get("length"):d.length)===0)){d=a}return d})},notNull:function(b,a){if(a===undefined){a=SC.EMPTY_PLACEHOLDER}return this.from(b).transform(function(d,c){if(SC.none(d)){d=a}return d})},multiple:function(a){return this.from(a).transform(function(b){if(!SC.isArray(b)){b=(b==null)?[]:[b]}return b})},bool:function(a){return this.from(a).transform(function(b){var c=SC.typeOf(b);if(c===SC.T_ERROR){return b}return(c==SC.T_ARRAY)?(b.length>0):(b==="")?NO:!!b})},and:function(b,a){var c=SC.Object.create({valueABinding:b,valueBBinding:a,and:function(){return(this.get("valueA")&&this.get("valueB"))}.property("valueA","valueB").cacheable()});return this.from("and",c).oneWay()},or:function(b,a){var c=SC.Object.create({valueABinding:b,valueBBinding:a,or:function(){return(this.get("valueA")||this.get("valueB"))}.property("valueA","valueB").cacheable()});return this.from("or",c).oneWay()},not:function(a){return this.from(a).transform(function(b){var c=SC.typeOf(b);if(c===SC.T_ERROR){return b}return !((c==SC.T_ARRAY)?(b.length>0):(b==="")?NO:!!b)})},isNull:function(a){return this.from(a).transform(function(b){var c=SC.typeOf(b);return(c===SC.T_ERROR)?b:SC.none(b)})},toString:function(){var c=this._fromRoot?"<%@>:%@".fmt(this._fromRoot,this._fromPropertyPath):this._fromPropertyPath;var b=this._toRoot?"<%@>:%@".fmt(this._toRoot,this._toPropertyPath):this._toPropertyPath;var a=this._oneWay?"[oneWay]":"";return"SC.Binding%@(%@ -> %@)%@".fmt(SC.guidFor(this),c,b,a)}};SC.binding=function(b,a){return SC.Binding.from(b,a)};sc_require("ext/function");SC.Error=SC.Object.extend({code:-1,message:"",errorValue:null,errorObject:function(){return this}.property().cacheable(),label:null,toString:function(){return"SC.Error:%@:%@ (%@)".fmt(SC.guidFor(this),this.get("message"),this.get("code"))},isError:YES});SC.Error.desc=function(d,a,f,c){var b={message:d};if(a!==undefined){b.label=a}if(c!==undefined){b.code=c}if(f!==undefined){b.errorValue=f}return this.create(b)};SC.$error=function(b,a,d,f){return SC.Error.desc(b,a,d,f)};SC.ok=function(a){return(a!==false)&&!(a&&a.isError)};SC.$ok=SC.ok;SC.val=function(a){if(a&&a.isError){return a.get?a.get("errorValue"):null}else{return a}};SC.$val=SC.val;SC.Error.HAS_MULTIPLE_VALUES=-100;sc_require("mixins/enumerable");sc_require("mixins/observable");sc_require("mixins/freezable");sc_require("mixins/copyable");SC.IndexSet=SC.mixin({},SC.Enumerable,SC.Observable,SC.Freezable,SC.Copyable,{_sc_sliceContent:function(f){if(f.length<1000){return f.slice()}var d=0,a=[],b=f[0];while(b!==0){a[d]=b;d=(b<0)?(0-b):b;b=f[d]}a[d]=0;this._hint(0,d,a);return a},create:function(c,b){var a=SC.beget(this);a.initObservable();a.registerDependentKey("min","[]");if(c&&c.isIndexSet){a._content=this._sc_sliceContent(c._content);a.max=c.max;a.length=c.length;a.source=c.source}else{a._content=[0];if(c!==undefined){a.add(c,b)}}return a},isIndexSet:YES,HINT_SIZE:256,length:0,max:0,min:function(){var a=this._content,b=a[0];return(b===0)?-1:(b>0)?0:Math.abs(b)}.property("[]").cacheable(),firstObject:function(){return(this.get("length")>0)?this.get("min"):undefined}.property(),rangeStartForIndex:function(c){var g=this._content,a=this.get("max"),b,f,d;if(c>=a){return a}if(Math.abs(g[c])>c){return c}d=c-(c%SC.IndexSet.HINT_SIZE);b=g[d];if(b<0||b>c){b=d}f=g[b];if(f===undefined){f=this.rangeStartForIndex(b)}else{f=Math.abs(f)}while(f<c){b=f;f=Math.abs(g[b])}return b},isEqual:function(c){if(c===this){return YES}if(!c||!c.isIndexSet||(c.max!==this.max)||(c.length!==this.length)){return NO}var f=this._content,b=c._content,d=0,a=f[d];do{if(b[d]!==a){return NO}d=Math.abs(a);a=f[d]}while(d!==0);return YES},indexBefore:function(b){if(b===0){return -1}b--;var c=this._content,a=this.get("max"),d=this.rangeStartForIndex(b);if(!c){return null}while((d===a)||(c[d]<0)){if(d===0){return -1}b=d-1;d=this.rangeStartForIndex(b)}return b},indexAfter:function(b){var d=this._content,a=this.get("max"),f,c;if(!d||(b>=a)){return -1}b++;f=this.rangeStartForIndex(b);c=d[f];while(c<0){if(c===0){return -1}b=f=Math.abs(c);c=d[f]}return b},contains:function(h,c){var b,g,a,f,d;if(c===undefined){if(h===null||h===undefined){return NO}if(typeof h===SC.T_NUMBER){c=1}else{if(h&&h.isIndexSet){if(h===this){return YES}b=h._content;g=0;a=b[g];while(a!==0){if((a>0)&&!this.contains(g,a-g)){return NO}g=Math.abs(a);a=b[g]}return YES}else{c=h.length;h=h.start}}}f=this.rangeStartForIndex(h);d=this._content[f];return(d>0)&&(f<=h)&&(d>=(h+c))},intersects:function(g,c){var b,f,a,d;if(c===undefined){if(typeof g===SC.T_NUMBER){c=1}else{if(g&&g.isIndexSet){if(g===this){return YES}b=g._content;f=0;a=b[f];while(a!==0){if((a>0)&&this.intersects(f,a-f)){return YES}f=Math.abs(a);a=b[f]}return NO}else{c=g.length;g=g.start}}}f=this.rangeStartForIndex(g);b=this._content;a=b[f];d=g+c;while(f<d){if(a===0){return NO}if((a>0)&&(a>g)){return YES}f=Math.abs(a);a=b[f]}return NO},without:function(b,a){if(b===this){return SC.IndexSet.create()}return this.clone().remove(b,a)},replace:function(c,a){if(a===undefined){if(typeof c===SC.T_NUMBER){a=1}else{if(c&&c.isIndexSet){this._content=this._sc_sliceContent(c._content);this.beginPropertyChanges().set("max",c.max).set("length",c.length).set("source",c.source).enumerableContentDidChange();this.endPropertyChanges();return this}else{a=c.length;c=c.start}}}var b=this.length;this._content.length=1;this._content[0]=0;this.length=this.max=0;return this.add(c,a)},add:function(a,b){if(this.isFrozen){throw SC.FROZEN_ERROR}var f,j,d;if(a&&a.isIndexSet){f=a._content;if(!f){return this}j=0;d=f[0];while(d!==0){if(d>0){this.add(j,d-j)}j=d<0?0-d:d;d=f[j]}return this}else{if(b===undefined){if(a===null||a===undefined){return this}else{if(typeof a===SC.T_NUMBER){b=1}else{b=a.length;a=a.start}}}else{if(b===null){b=1}}}if(b<=0){return this}var g=this.get("max"),c=g,i,h;f=this._content;if(a===g){if(a>0){j=this.rangeStartForIndex(a-1);d=f[j];if(d>0){delete f[g];f[j]=g=a+b;a=j}else{f[g]=g=a+b}}else{f[a]=g=b}f[g]=0;this.set("max",g);this.set("length",this.length+b);b=g-a}else{if(a>g){f[g]=0-a;f[a]=a+b;f[a+b]=0;this.set("max",a+b);this.set("length",this.length+b);b=a+b-g;a=g}else{j=this.rangeStartForIndex(a);d=f[j];g=a+b;i=0;if((a>0)&&(j===a)&&(d<=0)){j=this.rangeStartForIndex(a-1);d=f[j]}if(d<0){f[j]=0-a;if(Math.abs(d)>g){f[a]=0-g;f[g]=d}else{f[a]=d}}else{a=j;if(d>g){g=d}}j=a;while(j<g){h=f[j];if(h===0){f[g]=0;d=g;i+=g-j}else{d=Math.abs(h);if(d>g){f[g]=h;d=g}if(h<0){i+=d-j}}delete f[j];j=d}if((j=f[g])>0){delete f[g];g=j}f[a]=g;if(g>c){this.set("max",g)}this.set("length",this.get("length")+i);b=g-a}}this._hint(a,b);if(i!==0){this.enumerableContentDidChange()}return this},remove:function(a,b){if(this.isFrozen){throw SC.FROZEN_ERROR}if(b===undefined){if(a===null||a===undefined){return this}else{if(typeof a===SC.T_NUMBER){b=1}else{if(a.isIndexSet){a.forEachRange(this.remove,this);return this}else{b=a.length;a=a.start}}}}if(b<=0){return this}var g=this.get("max"),c=g,f=this._content,k,d,j,h,i;if(a>=g){return this}k=this.rangeStartForIndex(a);d=f[k];i=a+b;j=0;if((a>0)&&(k===a)&&(d>0)){k=this.rangeStartForIndex(a-1);d=f[k]}if(d>0){f[k]=a;if(d>i){f[a]=i;f[i]=d}else{f[a]=d}}else{a=k;d=Math.abs(d);if(d>i){i=d}}k=a;while(k<i){h=f[k];if(h===0){f[i]=0;d=i}else{d=Math.abs(h);if(d>i){f[i]=h;d=i}if(h>0){j+=d-k}}delete f[k];k=d}if((k=f[i])<0){delete f[i];i=Math.abs(k)}if(f[i]===0){delete f[i];f[a]=0;this.set("max",a)}else{f[a]=0-i}this.set("length",this.get("length")-j);b=i-a;this._hint(a,b);if(j!==0){this.enumerableContentDidChange()}return this},_hint:function(h,d,c){if(c===undefined){c=this._content}var b=SC.IndexSet.HINT_SIZE,a=Math.abs(c[h]),g=h-(h%b)+b,f=h+d;while(g<f){while((a!==0)&&(a<=g)){h=a;a=Math.abs(c[h])}if(a===0){delete c[g]}else{if(g!==h){c[g]=h}}g+=b}},clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}var a=this.length;this._content.length=1;this._content[0]=0;this.set("length",0).set("max",0);if(a>0){this.enumerableContentDidChange()}},addEach:function(b){if(this.isFrozen){throw SC.FROZEN_ERROR}this.beginPropertyChanges();var a=b.get("length");if(b.isSCArray){while(--a>=0){this.add(b.objectAt(a))}}else{if(b.isEnumerable){b.forEach(function(c){this.add(c)},this)}}this.endPropertyChanges();return this},removeEach:function(b){if(this.isFrozen){throw SC.FROZEN_ERROR}this.beginPropertyChanges();var a=b.get("length");if(b.isSCArray){while(--a>=0){this.remove(b.objectAt(a))}}else{if(b.isEnumerable){b.forEach(function(c){this.remove(c)},this)}}this.endPropertyChanges();return this},clone:function(){return SC.IndexSet.create(this)},inspect:function(){var f=this._content,b=f.length,a=0,c=[],d;for(a=0;a<b;a++){d=f[a];if(d!==undefined){c.push("%@:%@".fmt(a,d))}}return"SC.IndexSet<%@>".fmt(c.join(" , "))},forEachRange:function(g,d){var b=this._content,f=0,a=b[f],c=this.source;if(d===undefined){d=null}while(a!==0){if(a>0){g.call(d,f,a-f,this,c)}f=Math.abs(a);a=b[f]}return this},forEachIn:function(b,c,k,g){var h=this._content,j=0,i=0,d=b+c,a=this.source,f=h[j];if(g===undefined){g=null}while(f!==0){if(j<b){j=b}while((j<f)&&(j<d)){k.call(g,j++,i++,this,a)}if(j>=d){j=f=0}else{j=Math.abs(f);f=h[j]}}return this},lengthIn:function(h,d){var a=0;if(d===undefined){if(h===null||h===undefined){return 0}else{if(typeof h===SC.T_NUMBER){d=1}else{if(h.isIndexSet){h.forEachRange(function(j,i){a+=this.lengthIn(j,i)},this);return a}else{d=h.length;h=h.start}}}}if(this.get("length")===0){return 0}var c=this._content,g=0,b=c[g],f=h+d;while(g<f&&b!==0){if(b>0){a+=(b>f)?f-g:b-g}g=Math.abs(b);b=c[g]}return a},source:null,indexOf:function(d,c){var g=this.source;if(!g){throw"%@.indexOf() requires source".fmt(this)}var b=g.get("length"),f=this._content,h=f[0]<0?Math.abs(f[0]):0,a;while(h>=0&&h<b){a=g.indexOf(d,h);if(a<0){return -1}if(this.contains(a)){return a}h=a+1}return -1},lastIndexOf:function(d,c){var f=this.source;if(!f){throw"%@.lastIndexOf() requires source".fmt(this)}var b=f.get("length"),g=this.max-1,a;if(g>=b){g=b-1}while(g>=0){a=f.lastIndexOf(d,g);if(a<0){return -1}if(this.contains(a)){return a}g=a+1}return -1},forEachObject:function(h,f){var d=this.source;if(!d){throw"%@.forEachObject() requires source".fmt(this)}var c=this._content,g=0,a=0,b=c[g];if(f===undefined){f=null}while(b!==0){while(g<b){h.call(f,d.objectAt(g),g,d,this);g++}g=Math.abs(b);b=c[g]}return this},addObject:function(c,d){var f=this.source;if(!f){throw"%@.addObject() requires source".fmt(this)}var b=f.get("length"),g=0,a;while(g>=0&&g<b){a=f.indexOf(c,g);if(a>=0){this.add(a);if(d){return this}g=a++}else{return this}}return this},addObjects:function(b,a){b.forEach(function(c){this.addObject(c,a)},this);return this},removeObject:function(c,d){var f=this.source;if(!f){throw"%@.removeObject() requires source".fmt(this)}var b=f.get("length"),g=0,a;while(g>=0&&g<b){a=f.indexOf(c,g);if(a>=0){this.remove(a);if(d){return this}g=a+1}else{return this}}return this},removeObjects:function(b,a){b.forEach(function(c){this.removeObject(c,a)},this);return this},LOG_OBSERVING:NO,forEach:function(h,f){var c=this._content,g=0,a=0,d=this.source,b=c[g];if(f===undefined){f=null}while(b!==0){while(g<b){h.call(f,g++,a++,this,d)}g=Math.abs(b);b=c[g]}return this},nextObject:function(g,b,c){var f=this._content,d=c.next,a=this.get("max");if(b===null){b=d=0}else{if(b>=a){delete c.next;return null}else{b++}}if(b===d){do{b=Math.abs(d);d=f[b]}while(d<0);c.next=d}return b},toString:function(){var a=[];this.forEachRange(function(c,b){a.push(b===1?c:"%@..%@".fmt(c,c+b-1))},this);return"SC.IndexSet<%@>".fmt(a.join(","))},max:0});SC.IndexSet.slice=SC.IndexSet.copy=SC.IndexSet.clone;SC.IndexSet.EMPTY=SC.IndexSet.create().freeze();SC.json={encode:function(a){return JSON.stringify(a)},decode:function(a){return JSON.parse(a)}};if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());sc_require("ext/function");SC.LOGGER_LOG_DELIMITER=", ";SC.LOGGER_LOG_ERROR="ERROR: ";SC.LOGGER_LOG_INFO="INFO:  ";SC.LOGGER_LOG_WARN="WARN:  ";SC.LOGGER_LOG_DEBUG="DEBUG: ";SC.LOGGER_LOG_GROUP_HEADER="** %@";SC.LOGGER_LOG_GROUP_INDENTATION="    ";SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX="%@:  ";SC.LOGGER_LEVEL_DEBUG="debug";SC.LOGGER_LEVEL_INFO="info";SC.LOGGER_LEVEL_WARN="warn";SC.LOGGER_LEVEL_ERROR="error";SC.LOGGER_LEVEL_NONE="none";SC.Logger=SC.Object.create({messagePrefix:null,outputMessagePrefix:null,recordedMessagePrefix:null,logOutputLevel:null,logRecordingLevel:SC.LOGGER_LEVEL_NONE,recordedLogMessages:null,recordedLogMessagesMaximumLength:500,recordedLogMessagesPruningMinimumLength:100,debugEnabled:NO,exists:function(){return !SC.none(this.get("reporter"))}.property("reporter").cacheable(),fallBackOnAlert:NO,reporter:console,debug:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_DEBUG,YES,a,arguments)},debugWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_DEBUG,NO,null,arguments)},debugGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_DEBUG,a,arguments)},debugGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_DEBUG)},info:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_INFO,YES,a,arguments)},infoWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_INFO,NO,null,arguments)},infoGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_INFO,a,arguments)},infoGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_INFO)},warn:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_WARN,YES,a,arguments)},warnWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_WARN,NO,null,arguments)},warnGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_WARN,a,arguments)},warnGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_WARN)},error:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_ERROR,YES,a,arguments)},errorWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_ERROR,NO,null,arguments)},errorGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_ERROR,a,arguments)},errorGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_ERROR)},outputRecordedLogMessages:function(o){if(!this.get("exists")){return}var t=this.get("reporter"),l=this.get("recordedLogMessages"),a=0,d=SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX,r,p,b,c,h,k,f,g,v,n,m,q,u;if(l){for(r=0,p=l.length;r<p;++r){b=l[r];c=b.type;if(o){h=d.fmt(b.timestamp.toUTCString())}k=b.message;if(k){f=b.originalArguments;this._outputMessage(c,h,a,k,f)}else{n=b.indentation;v=b.title;m=n-a;if(t.group){if(Math.abs(m)>1){for(q=0,u=(m-1);q<u;++q){if(m>0){t.group()}else{t.groupEnd()}}}if(m>0){g=h?h:"";g+=v;t.group(g)}else{t.groupEnd()}}else{if(m>0){this._outputGroup(c,h,n-1,v)}}a=n}}}},stringifyRecordedLogMessages:function(){var k="",g=this.get("recordedLogMessages"),n=0,j=SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX,d=this._LOG_FALLBACK_PREFIX_MAPPING,c=SC.LOGGER_LOG_GROUP_HEADER,f,a,p,m,t,r,h,q,o,l,b;if(g){for(f=0,a=g.length;f<a;++f){p=g[f];m=p.type;h=j.fmt(p.timestamp.toUTCString());h+=d[m]||"";t=p.message;if(t){r=p.originalArguments;q=h+this._indentation(n);q+=r?this._argumentsToString(r):t}else{l=p.indentation;o=p.title;b=l-n;if(b>0){q=h+this._indentation(n)+c.fmt(o)}n=l}k+=q+"\n"}}return k},log:function(){var a=this.get("reporter"),c=arguments[0],d=this.get("messagePrefix"),f=this.get("outputMessagePrefix"),b=NO;if(c&&SC.typeOf(c)===SC.T_STRING){if(d||f){if(d){c=d+c}if(f){c=f+c}arguments[0]=c}}if(this.get("exists")){if(typeof a.log==="function"){a.log.apply(a,arguments);b=YES}else{if(a.log){a.log(this._argumentsToArray(arguments));b=YES}}}if(!b&&this.get("fallBackOnAlert")){if(this.get("exists")&&(typeof a.alert==="function")){a.alert(arguments);b=YES}else{alert(arguments);b=YES}}return b},group:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.group==="function")){a.group(b)}},groupEnd:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.groupEnd==="function")){a.groupEnd()}},dir:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.dir==="function")){a.dir.apply(a,arguments)}else{this.log.apply(this,arguments)}},dirxml:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.dirxml==="function")){a.dirxml.apply(a,arguments)}else{this.log.apply(this,arguments)}},profile:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.profile==="function")){a.profile(b);return YES}return NO},profileEnd:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.profileEnd==="function")){a.profileEnd(b);return YES}return NO},time:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.time==="function")){a.time(b);return YES}return NO},timeEnd:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.timeEnd==="function")){a.timeEnd(b);return YES}return NO},trace:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.trace==="function")){a.trace();return YES}return NO},init:function(){arguments.callee.base.apply(this,arguments);if(!this.get("logOutputLevel")){if(SC.buildMode==="debug"){this.set("logOutputLevel",SC.LOGGER_LEVEL_DEBUG)}else{this.set("logOutputLevel",SC.LOGGER_LEVEL_INFO)}}this.debugEnabledDidChange()},debugEnabledDidChange:function(){if(this.get("debugEnabled")){this.set("logOutputLevel",SC.LOGGER_LEVEL_DEBUG)}}.observes("debugEnabled"),_handleMessage:function(m,o,q,p){var a=this._shouldOutputType(m),d=this._shouldRecordType(m),f,g,k,l,b,n,j,c,h;if(!(a||d)){return}f=(p&&p.length>1);if(o&&(SC.none(q)||(typeof q!=="string"))){o=NO}if(o){if(f){l=[];for(g=1,k=p.length;g<k;++g){l.push(p[g])}q=q.fmt.apply(q,l)}}j=this.get("messagePrefix");if(j){q=j+q}if(a){c=this.get("outputMessagePrefix");l=o?null:p;this._outputMessage(m,null,this._outputIndentationLevel,(c?c+q:q),l)}if(d){h=this.get("recordedMessagePrefix");n={type:m,message:q?(h?h+q:q):YES,timestamp:new Date()};if(!o&&f){n.originalArguments=p}this._addRecordedMessageEntry(n)}},_handleGroup:function(m,o,r){var a=this._shouldOutputType(m),f=this._shouldRecordType(m),g,h,k,l,q,d,c,j,b,n,p;if(!(a||f)){return}g=(r&&r.length>1);if(o&&g){l=[];for(h=1,k=r.length;h<k;++h){l.push(r[h])}o=o.fmt.apply(o,l)}if(a){this._outputGroup(m,null,this._outputIndentationLevel,o);this._outputIndentationLevel++}if(f){n=++this._recordingIndentationLevel;p={type:m,indentation:n,beginGroup:YES,title:o,timestamp:new Date()};this._addRecordedMessageEntry(p)}},_handleGroupEnd:function(d){var h=this._shouldOutputType(d),c=this._shouldRecordType(d),a,g,b,f;if(!(h||c)){return}if(h){this._outputIndentationLevel--;if(this.get("exists")){a=this.get("reporter");g=a.groupEnd;if(g){g.call(a)}}}if(c){b=--this._recordingIndentationLevel;f={type:d,indentation:b,timestamp:new Date()};this._addRecordedMessageEntry(f)}},_shouldOutputType:function(a){var c=this._LOG_LEVEL_MAPPING,d=c[a]||0,b=c[this.get("logOutputLevel")]||0;return(d<=b)},_shouldRecordType:function(a){var c=this._LOG_LEVEL_MAPPING,d=c[a]||0,b=c[this.get("logRecordingLevel")]||0;return(d<=b)},_outputMessage:function(i,h,j,m,l){if(!this.get("exists")){return}var d=this.get("reporter"),b,a,c,f,g,k;a=!d.group;c=d[i];if(c){if(!l){b=h?h:"";if(a){b+=this._indentation(j)}b+=m;d[i](b)}else{g=this._argumentsToArray(l);f="";if(h){f=h}if(a){f+=this._indentation(j)}if(f){g.splice(0,0,f)}if(c.apply){c.apply(d,g)}else{d[i](g)}}}else{if(d.log){f="";if(h){f=h}f+=this._LOG_FALLBACK_PREFIX_MAPPING[i]||"";if(a){f+=this._indentation(j)}if(!l){d.log(f+m)}else{g=this._argumentsToArray(l);if(f){g.splice(0,0,f)}d.log(g)}}}},_outputGroup:function(d,g,c,h){if(!this.get("exists")){return}var b=this.get("reporter"),f=b.group,a;if(f){a=g?g:"";a+=h;f.call(b,a)}else{if(b.log){a="";if(g){a=g}a+=this._LOG_FALLBACK_PREFIX_MAPPING[d]||"";a+=this._indentation(c);a+=SC.LOGGER_LOG_GROUP_HEADER.fmt(h);b.log(a)}}},_addRecordedMessageEntry:function(c){var b=this.get("recordedLogMessages"),a;if(!b){b=[];this.set("recordedLogMessages",b)}b.push(c);a=b.length;if(a>this.get("recordedLogMessagesMaximumLength")){b.splice(0,(a-this.get("recordedLogMessagesPruningMinimumLength")))}b.enumerableContentDidChange()},_argumentsToArray:function(c){var b=[],d,a;if(c){for(d=0,a=c.length;d<a;++d){b[d]=c[d]}}return b},_argumentsToString:function(){var c="",b=SC.LOGGER_LOG_DELIMITER,d,a;for(d=0,a=(arguments.length-1);d<a;++d){c+=arguments[d]+b}c+=arguments[a];return c},_indentation:function(d){if(!d||d<0){d=0}var b="",a=SC.LOGGER_LOG_GROUP_INDENTATION,c;for(c=0;c<d;++c){b+=a}return b},_outputIndentationLevel:0,_recordingIndentationLevel:0,_LOG_LEVEL_MAPPING:{debug:4,info:3,warn:2,error:1,none:0},_LOG_FALLBACK_PREFIX_MAPPING:{debug:SC.LOGGER_LOG_DEBUG,info:SC.LOGGER_LOG_INFO,warn:SC.LOGGER_LOG_WARN,error:SC.LOGGER_LOG_ERROR}});SC.debug=SC.Logger.debug;SC.info=SC.Logger.info;SC.warn=SC.Logger.warn;SC.error=SC.Logger.error;sc_require("ext/function");sc_require("private/observer_set");SC.RunLoop=SC.Object.extend({beginRunLoop:function(){this._start=new Date().getTime();if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.beginRunLoop at %@".fmt(this._start))}this._runLoopInProgress=YES;this._flushinvokeNextQueue();return this},isRunLoopInProgress:function(){return this._runLoopInProgress}.property(),endRunLoop:function(){if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.endRunLoop ~ flushing application queues")}this.flushAllPending();this._start=null;if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.endRunLoop ~ End")}SC.RunLoop.lastRunLoopEnd=Date.now();this._runLoopInProgress=NO;return this},flushAllPending:function(){var a;do{a=this.flushApplicationQueues();if(!a){a=this._flushinvokeLastQueue()}}while(a)},invokeOnce:function(b,c){if(c===undefined){c=b;b=this}var a;if(typeof c==="string"){c=b[c]}if(!this._invokeQueue){this._invokeQueue=SC.ObserverSet.create()}if(c){this._invokeQueue.add(b,c,undefined,a)}return this},invokeLast:function(b,c){if(c===undefined){c=b;b=this}var a;if(typeof c==="string"){c=b[c]}if(!this._invokeLastQueue){this._invokeLastQueue=SC.ObserverSet.create()}this._invokeLastQueue.add(b,c,undefined,a);return this},invokeNext:function(a,b){if(b===undefined){b=a;a=this}if(typeof b==="string"){b=a[b]}if(!this._invokeNextQueue){this._invokeNextQueue=SC.ObserverSet.create()}this._invokeNextQueue.add(a,b);return this},flushApplicationQueues:function(){var b=NO,a=this._invokeQueue;if(a&&a.getMembers().length){this._invokeQueue=null;b=YES;a.invokeMethods()}return SC.Binding.flushPendingChanges()||b},_flushinvokeLastQueue:function(){var a=this._invokeLastQueue,b=NO;if(a&&a.getMembers().length){this._invokeLastQueue=null;b=YES;if(b){a.invokeMethods()}}return b},_flushinvokeNextQueue:function(){var a=this._invokeNextQueue,b=NO;if(a&&a.getMembers().length){this._invokeNextQueue=null;b=YES;if(b){a.invokeMethods()}}return b}});SC.RunLoop.currentRunLoop=null;SC.RunLoop.runLoopClass=SC.RunLoop;SC.RunLoop.begin=function(){var a=this.currentRunLoop;if(!a){a=this.currentRunLoop=this.runLoopClass.create()}a.beginRunLoop();return this};SC.RunLoop.end=function(){var a=this.currentRunLoop;if(!a){throw"SC.RunLoop.end() called outside of a runloop!"}a.endRunLoop();return this};SC.RunLoop.kill=function(){this.currentRunLoop=this.runLoopClass.create();return this};SC.RunLoop.isRunLoopInProgress=function(){if(this.currentRunLoop){return this.currentRunLoop.get("isRunLoopInProgress")}return NO};SC.run=function(g,f,b){var a=SC.RunLoop.isRunLoopInProgress();if(SC.ExceptionHandler&&SC.ExceptionHandler.enabled){try{if(b||!a){SC.RunLoop.begin()}if(g){g.call(f)}if(b||!a){SC.RunLoop.end()}}catch(d){var c=SC.ExceptionHandler.handleException(d);if(!c&&!SC.browser.isIE){throw d}}}else{if(b||!a){SC.RunLoop.begin()}if(g){g.call(f)}if(b||!a){SC.RunLoop.end()}}};SC.RunLoop.wrapFunction=function(b){var a=function(){var c=SC.RunLoop.isRunLoopInProgress();if(!c){SC.RunLoop.begin()}var d=arguments.callee.wrapped.apply(this,arguments);if(!c){SC.RunLoop.end()}return d};a.wrapped=b;return a};SC.DROP_ON=1;SC.DROP_BEFORE=2;SC.DROP_AFTER=4;SC.DROP_ANY=7;SC.ALIGN_LEFT="left";SC.ALIGN_RIGHT="right";SC.ALIGN_CENTER="center";SC.ALIGN_TOP="top";SC.ALIGN_MIDDLE="middle";SC.ALIGN_BOTTOM="bottom";SC.ALIGN_TOP_LEFT="top-left";SC.ALIGN_TOP_RIGHT="top-right";SC.ALIGN_BOTTOM_LEFT="bottom-left";SC.ALIGN_BOTTOM_RIGHT="bottom-right";SC.mixin({data:$.data,removeData:$.removeData,STRINGS:{},stringsFor:function(b,a){SC.mixin(SC.STRINGS,a);return this}});SC.Controller=SC.Object.extend({isEditable:YES,destroyContentOnReplace:NO,contentObjectDidChanged:function(){var b,a;if(!this.get("destroyContentOnReplace")){return}b=this._oldContent;a=this.get("content");if(b&&a!==b&&b.destroy){b.destroy()}this._oldContent=a}.observes("content")});SC.SelectionSupport={hasSelectionSupport:YES,allowsSelection:YES,allowsMultipleSelection:YES,allowsEmptySelection:YES,firstSelectableObject:function(){return this.get("firstObject")}.property(),selection:function(d,g){var c=this._scsel_selection,h=c?c.get("length"):0,f,b=this.get("arrangedObjects"),a;if((g===undefined)||!this.get("allowsSelection")){g=c}a=(g&&g.isEnumerable)?g.get("length"):0;if((a>1)&&!this.get("allowsMultipleSelection")){if(h>1){g=SC.SelectionSet.create().addObject(c.get("firstObject")).freeze();a=1}else{g=c;a=h}}if((a===0)&&!this.get("allowsEmptySelection")&&b&&b.get("length")!==0){if(h===0){g=this.get("firstSelectableObject");if(g){g=SC.SelectionSet.create().addObject(g).freeze()}else{g=SC.SelectionSet.EMPTY}a=g.get("length")}else{g=c;a=h}}if(a===0){g=SC.SelectionSet.EMPTY}if(g!==c){g=g.frozenCopy()}this._scsel_selection=g;return g}.property("arrangedObjects","allowsEmptySelection","allowsMultipleSelection","allowsSelection").cacheable(),hasSelection:function(){var a=this.get("selection");return !!a&&(a.get("length")>0)}.property("selection").cacheable(),selectObjects:function(b,c){if(!b||b.get("length")===0){if(!c){this.set("selection",SC.SelectionSet.EMPTY)}return this}var a=this.get("selection");if(c&&a){a=a.copy()}else{a=SC.SelectionSet.create()}a.addObjects(b).freeze();this.set("selection",a);return this},selectObject:function(a,b){if(a===null){if(!b){this.set("selection",null)}return this}else{return this.selectObjects([a],b)}},deselectObjects:function(b){if(!b||b.get("length")===0){return this}var a=this.get("selection");if(!a||a.get("length")===0){return this}a=a.copy().removeObjects(b).freeze();this.set("selection",a.freeze());return this},deselectObject:function(a){if(!a){return this}else{return this.deselectObjects([a])}},updateSelectionAfterContentChange:function(){var a=this.get("arrangedObjects");var b=this.get("selection");var d=this.get("allowsEmptySelection");var c;if(!b){return this}c=b.indexSetForSource(a);if((c&&(c.get("length")!==b.get("length")))||(!c&&(b.get("length")>0))){b=b.copy().constrain(a).freeze();this.set("selection",b)}if((b.get("length")===0)&&a&&(a.get("length")>0)&&!d){this.selectObject(this.get("firstSelectableObject"),NO)}return this}};sc_require("controllers/controller");sc_require("mixins/selection_support");SC.ArrayController=SC.Controller.extend(SC.Array,SC.SelectionSupport,{content:null,isEditable:YES,orderBy:null,allowsSingleContent:YES,destroyOnRemoval:NO,arrangedObjects:function(){return this}.property().cacheable(),canRemoveContent:function(){var b=this.get("content"),a;a=!!b&&this.get("isEditable")&&this.get("hasContent");if(a){return !b.isEnumerable||(SC.typeOf(b.removeObject)===SC.T_FUNCTION)}else{return NO}}.property("content","isEditable","hasContent"),canReorderContent:function(){var b=this.get("content"),a;a=!!b&&this.get("isEditable")&&!this.get("orderBy");return a&&!!b.isSCArray}.property("content","isEditable","orderBy"),canAddContent:function(){var b=this.get("content"),a;a=b&&this.get("isEditable")&&b.isEnumerable;if(a){return(SC.typeOf(b.addObject)===SC.T_FUNCTION)||(SC.typeOf(b.pushObject)===SC.T_FUNCTION)}else{return NO}}.property("content","isEditable"),hasContent:function(){var a=this.get("content");return !!a&&(!!a.isEnumerable||!!this.get("allowsSingleContent"))}.property("content","allowSingleContent"),status:function(){var b=this.get("content"),a=b?b.get("status"):null;return a?a:SC.Record.READY}.property().cacheable(),addObject:function(a){if(!this.get("canAddContent")){throw"%@ cannot add content".fmt(this)}var b=this.get("content");if(b.isSCArray){b.pushObject(a)}else{if(b.addObject){b.addObject(a)}else{throw"%@.content does not support addObject".fmt(this)}}return this},removeObject:function(a){if(!this.get("canRemoveContent")){throw"%@ cannot remove content".fmt(this)}var b=this.get("content");if(b.isEnumerable){b.removeObject(a)}else{this.set("content",null)}if(this.get("destroyOnRemoval")&&a.destroy){a.destroy()}return this},length:function(){var a=this._scac_observableContent();return a?a.get("length"):0}.property().cacheable(),objectAt:function(a){var b=this._scac_observableContent();return b?b.objectAt(a):undefined},replace:function(h,g,d){if(!d||d.get("length")===0){if(!this.get("canRemoveContent")){throw"%@ cannot remove objects from the current content".fmt(this)}}else{if(!this.get("canReorderContent")){throw"%@ cannot add or reorder the current content".fmt(this)}}var c=this.get("content");var b=[],a,f;if(this.get("destroyOnRemoval")){for(a=0;a<g;a++){b.push(c.objectAt(a+h))}}if(c){c.replace(h,g,d)}for(a=0,f=b.length;a<f;a++){b[a].destroy()}b=null;return this},indexOf:function(b,a){var c=this._scac_observableContent();return c?c.indexOf(b,a):-1},init:function(){arguments.callee.base.apply(this,arguments);this._scac_contentDidChange()},_scac_cached:NO,_scac_observableContent:function(){var c=this._scac_cached;if(c){return c}var g=this.get("content"),f,b,a;if(SC.none(g)){return(this._scac_cached=[])}if(!g.isEnumerable){c=this.get("allowsSingleContent")?[g]:[];return(this._scac_cached=c)}var h=this.get("orderBy");if(!h){if(g.isSCArray){return(this._scac_cached=g)}else{throw"%@.orderBy is required for unordered content".fmt(this)}}var d=SC.typeOf(h);if(d===SC.T_STRING){h=[h]}else{if(d===SC.T_FUNCTION){f=h}else{if(d!==SC.T_ARRAY){throw"%@.orderBy must be Array, String, or Function".fmt(this)}}}f=f||function(n,j){var m,q,o,r;for(var p=0,k=h.get("length");p<k&&!m;p++){q=h.objectAt(p);o=q.match(/^(ASC )?(DESC )?(.*)$/);q=o[3];a=o[2]?-1:1;if(n){n=n.isObservable?n.get(q):n[q]}if(j){j=j.isObservable?j.get(q):j[q]}m=SC.compare(n,j)*a}return m};return(this._scac_cached=g.toArray().sort(f))},propertyWillChange:function(a){if(a==="content"){this.arrayContentWillChange(0,this.get("length"),0)}else{return arguments.callee.base.apply(this,arguments)}},_scac_arrayContentWillChange:function(d,c,a){this.arrayContentWillChange(d,c,a);if(this._kvo_enumerable_property_chains){var b=this.slice(d,d+c);this.teardownEnumerablePropertyChains(b)}},_scac_arrayContentDidChange:function(d,c,a){this._scac_cached=NO;this.arrayContentDidChange(d,c,a);if(this._kvo_enumerable_property_chains){var b=this.slice(d,d+a);this.setupEnumerablePropertyChains(b)}this.updateSelectionAfterContentChange()},_scac_contentDidChange:function(){this._scac_cached=NO;var i=this.get("content"),d=!!this.get("orderBy"),j=this._scac_content,a=this._scac_length||0,h=this._scac_arrayContentDidChange,c=this._scac_arrayContentWillChange,b=this._scac_contentStatusDidChange,g=this._scac_enumerableDidChange,f;if(i===j){return this}if(j){if(j.isSCArray){j.removeArrayObservers({target:this,didChange:h,willChange:c})}else{if(j.isEnumerable){j.removeObserver("[]",this,g)}}j.removeObserver("status",this,b);this.teardownEnumerablePropertyChains(j)}this._scac_cached=NO;this._scac_content=i;if(i){if(i.isSCArray){i.addArrayObservers({target:this,didChange:h,willChange:c});f=i.get("length")}else{if(i.isEnumerable){i.addObserver("[]",this,g);f=i.get("length")}else{f=1}}i.addObserver("status",this,b);this.setupEnumerablePropertyChains(i)}else{f=SC.none(i)?0:1}this._scac_length=f;this._scac_contentStatusDidChange();this.arrayContentDidChange(0,0,f);this.updateSelectionAfterContentChange()}.observes("content"),_scac_enumerableDidChange:function(){var a=this.get("content"),c=a?a.get("length"):0,b=this._scac_length;this._scac_length=c;this.beginPropertyChanges();this._scac_cached=NO;this.arrayContentDidChange(0,b,c);this.endPropertyChanges();this.updateSelectionAfterContentChange()}.observes("orderBy"),_scac_contentStatusDidChange:function(){this.notifyPropertyChange("status")}});sc_require("controllers/controller");SC.ObjectController=SC.Controller.extend({content:null,allowsMultipleContent:NO,hasContent:function(){return !SC.none(this.get("observableContent"))}.property("observableContent"),isEditable:YES,observableContent:function(){var b=this.get("content"),a,c;if(b&&b.isEnumerable){a=b.get("length");c=this.get("allowsMultipleContent");if(a===1){b=b.firstObject()}else{if(a===0||!c){b=null}}if(b&&!c&&b.isEnumerable){b=null}}return b}.property("content","allowsMultipleContent").cacheable(),destroy:function(){var a=this.get("observableContent");if(a&&SC.typeOf(a.destroy)===SC.T_FUNCTION){a.destroy()}this.set("content",null);return this},contentPropertyDidChange:function(b,a){if(a==="*"){this.allPropertiesDidChange()}else{this.notifyPropertyChange(a)}},unknownProperty:function(b,d){if(b==="content"){if(d!==undefined){this.content=d}return this.content}var c=this.get("observableContent"),g,f,a;if(c===null||c===undefined){return undefined}if(d===undefined){if(c.isEnumerable){d=c.getEach(b);g=d.get("length");if(g>0){a=YES;f=d.objectAt(0);while((--g>0)&&a){if(f!==d.objectAt(g)){a=NO}}if(a){d=f}}else{d=undefined}}else{d=(c.isObservable)?c.get(b):c[b]}}else{if(!this.get("isEditable")){throw"%@.%@ is not editable".fmt(this,b)}if(c.isEnumerable){c.setEach(b,d)}else{if(c.isObservable){c.set(b,d)}else{c[b]=d}}}return d},init:function(){arguments.callee.base.apply(this,arguments);if(this.get("content")){this._scoc_contentDidChange()}if(this.get("observableContent")){this._scoc_observableContentDidChange()}},_scoc_contentDidChange:function(){var b=this._scoc_content,c=this.get("content");if(b!==c){this._scoc_content=c;var a=this._scoc_enumerableContentDidChange;if(b&&b.isEnumerable){b.removeObserver("[]",this,a)}if(c&&c.isEnumerable){c.addObserver("[]",this,a)}}}.observes("content"),_scoc_observableContentDidChange:function(){var b=this._scoc_observableContent,d=this.get("observableContent"),a=this.contentPropertyDidChange,c=this._scoc_enumerableContentDidChange;if(b===d){return this}this._scoc_observableContent=d;if(b){if(b.isEnumerable){b.removeObserver("[]",this,c)}else{if(b.isObservable){b.removeObserver("*",this,a)}}}if(d){if(d.isEnumerable){d.addObserver("[]",this,c)}else{if(d.isObservable){d.addObserver("*",this,a)}}}if((b&&b.isEnumerable)||(d&&d.isEnumerable)){this._scoc_enumerableContentDidChange()}else{this.contentPropertyDidChange(d,"*")}}.observes("observableContent"),_scoc_enumerableContentDidChange:function(){var b=this.get("observableContent"),c=this._scoc_observableContentItems,a=this.contentPropertyDidChange;if(c){c.forEach(function(d){if(d.isObservable){d.removeObserver("*",this,a)}},this);c.clear()}if(b&&b.isEnumerable){if(!c){c=SC.Set.create()}b.forEach(function(d){if(c.contains(d)){return}c.add(d);if(d.isObservable){d.addObserver("*",this,a)}},this)}else{c=null}this._scoc_observableContentItems=c;this.contentPropertyDidChange(b,"*");return this}});SC.mixin(Function.prototype,{invokeLater:function(g,a){if(a===undefined){a=1}var d=this;if(arguments.length>2){var b=SC.$A(arguments).slice(2,arguments.length);b.unshift(g);var c=d;d=function(){return c.apply(this,b.slice(1))}}return SC.Timer.schedule({target:g,action:d,interval:a})}});SC.mixin(SC.Object.prototype,{invokeLater:function(b,a){if(a===undefined){a=1}var g=b,c,d;if(arguments.length>2){c=SC.$A(arguments).slice(2);if(SC.typeOf(g)===SC.T_STRING){g=this[b]}d=g;g=function(){return d.apply(this,c)}}return SC.Timer.schedule({target:this,action:g,interval:a})},invokeOnceLater:function(i,c){if(c===undefined){c=1}var g=this._sc_invokeOnceLaterTimers,b,h,d,a;if(SC.typeOf(i)===SC.T_STRING){i=this[i]}b=SC.guidFor(i);if(!g){this._sc_invokeOnceLaterTimers=g={}}h=g[b];if(h){h.invalidate()}d=function(){delete g[b];return i.apply(this,arguments)};a=SC.Timer.schedule({target:this,action:d,interval:c});g[b]=a;return a},invokeWith:function(b,c,d){if(d===undefined){d=c;c=this}if(!c){c=this}if(SC.typeOf(d)===SC.T_STRING){d=c[d]}var a=this.getPath(b);d.call(c,a,this);return this}});SC.RunLoop=SC.RunLoop.extend({startTime:function(){if(!this._start){this._start=Date.now()}return this._start}.property(),endRunLoop:function(){this.fireExpiredTimers();var a=arguments.callee.base.apply(this,arguments);this.scheduleNextTimeout();return a},scheduleTimer:function(b,a){this._timerQueue=b.removeFromTimerQueue(this._timerQueue);this._timerQueue=b.scheduleInTimerQueue(this._timerQueue,a);return this},cancelTimer:function(a){this._timerQueue=a.removeFromTimerQueue(this._timerQueue);return this},TIMER_ARRAY:[],fireExpiredTimers:function(){if(!this._timerQueue||this._firing){return NO}var d=this.get("startTime"),f=this.TIMER_ARRAY,c,b,a;this._firing=YES;this._timerQueue=this._timerQueue.collectExpiredTimers(f,d);b=f.length;for(c=0;c<b;c++){f[c].fire()}a=f.length>0;f.length=0;this._firing=NO;return a},scheduleNextTimeout:function(){var d=this._timerQueue;var b=NO;if(!d){if(this._timeout){clearTimeout(this._timeout)}}else{var c=d._timerQueueRunTime;if(this._timeoutAt!==c){if(this._timeout){clearTimeout(this._timeout)}var a=Math.max(0,c-Date.now());this._timeout=setTimeout(this._timeoutDidFire,a);this._timeoutAt=c}b=YES}return b},_timeoutDidFire:function(){var a=SC.RunLoop.currentRunLoop;a._timeout=a._timeoutAt=null;SC.run()}});SC.RunLoop.currentRunLoop=SC.RunLoop.create();SC.RunLoop.runLoopClass=SC.RunLoop;SC.Locale=SC.Object.extend({init:function(){if(!this.language){SC.Locale._assignLocales()}if(!this.hasStrings){var c=this._deprecatedLanguageCodes||[];c.push(this.language);var b=c.length;var a=null;while(!a&&--b>=0){a=String[c[b]]}if(a){this.hasStrings=YES;this.strings=a}}},hasStrings:NO,strings:{},metrics:{},toString:function(){if(!this.language){SC.Locale._assignLocales()}return"SC.Locale["+this.language+"]"+SC.guidFor(this)},locWithDefault:function(b,c){var a=this.strings[b];if(SC.typeOf(a)===SC.T_STRING){return a}else{if(SC.typeOf(c)===SC.T_STRING){return c}}return b},locMetric:function(b){var a=this.metrics[b];if(SC.typeOf(a)===SC.T_NUMBER){return a}else{if(a===undefined){SC.warn('No localized metric found for key "'+b+'"');return undefined}else{SC.warn('Unexpected metric type for key "'+b+'"');return undefined}}},locLayout:function(c,b){var f,h,g,n,m,a=SC.Locale.layoutKeys,l=this.metrics,k=SC.typeOf,d=SC.T_NUMBER,j={};if(b){SC.mixin(j,b)}for(f=0,h=a.length;f<h;++f){g=a[f];n=c+"."+g;m=l[n];if(k(m)===d){if(b&&b[g]){throw"locLayout():  There is a localized value for the key '"+n+"' but a value for '"+g+"' was also specified in the non-localized hash"}j[g]=m}}return j}});SC.Locale.mixin({useAutodetectedLanguage:NO,preferredLanguage:null,layoutKeys:["left","top","right","bottom","width","height","minWidth","minHeight","centerX","centerY"],createCurrentLocale:function(){var c=(String.useAutodetectedLanguage!==undefined)?String.useAutodetectedLanguage:this.useAutodetectedLanguage;var b=(String.preferredLanguage!==undefined)?String.preferredLanguage:this.preferredLanguage;var d=((c)?SC.browser.language:null)||b||SC.browser.language||"en";d=SC.Locale.normalizeLanguage(d);var a=this.localeClassFor(d);if(d!=this.currentLanguage){this.currentLanguage=d;this.currentLocale=a.create()}return this.currentLocale},localeClassFor:function(c){c=SC.Locale.normalizeLanguage(c);var b,a=this.locales[c];if(!a&&((b=c.split("-")[0])!==c)&&(a=this.locales[b])){a=this.locales[c]=a.extend()}if(!a){a=this.locales[c]=this.locales.en.extend()}return a},define:function(b,c){var a;if(c===undefined&&(SC.typeOf(b)!==SC.T_STRING)){a=this;c=b}else{a=SC.Locale.localeClassFor(b)}SC.mixin(a.prototype,c);return a},options:function(){return this.prototype},addStrings:function(b){var a=this.prototype.strings;if(a){if(!this.prototype.hasOwnProperty("strings")){this.prototype.strings=SC.clone(a)}}else{a=this.prototype.strings={}}if(b){this.prototype.strings=SC.mixin(a,b)}this.prototype.hasStrings=YES;return this},addMetrics:function(b){var a=this.prototype.metrics;if(a){if(!this.prototype.hasOwnProperty(a)){this.prototype.metrics=SC.clone(a)}}else{a=this.prototype.metrics={}}if(b){this.prototype.metrics=SC.mixin(a,b)}return this},_map:{english:"en",french:"fr",german:"de",japanese:"ja",jp:"ja",spanish:"es"},normalizeLanguage:function(a){if(!a){return"en"}return SC.Locale._map[a.toLowerCase()]||a},_assignLocales:function(){for(var a in this.locales){this.locales[a].prototype.language=a}},toString:function(){if(!this.prototype.language){SC.Locale._assignLocales()}return"SC.Locale["+this.prototype.language+"]"},extend:function(){var a=SC.Object.extend.apply(this,arguments);a.addStrings=SC.Locale.addStrings;a.define=SC.Locale.define;a.options=SC.Locale.options;a.toString=SC.Locale.toString;return a}});SC.Locale.locales={en:SC.Locale.extend({_deprecatedLanguageCodes:["English"]}),fr:SC.Locale.extend({_deprecatedLanguageCodes:["French"]}),de:SC.Locale.extend({_deprecatedLanguageCodes:["German"]}),ja:SC.Locale.extend({_deprecatedLanguageCodes:["Japanese","jp"]}),es:SC.Locale.extend({_deprecatedLanguageCodes:["Spanish"]})};SC.stringsFor=function(c,b){var a=SC.Locale.localeClassFor(c);a.addStrings(b);return this};SC.metricsFor=function(c,b){var a=SC.Locale.localeClassFor(c);a.addMetrics(b);return this};sc_require("system/locale");SC.STRING_TITLEIZE_REGEXP=(/([\s|\-|\_|\n])([^\s|\-|\_|\n]?)/g);SC.STRING_DECAMELIZE_REGEXP=(/([a-z])([A-Z])/g);SC.STRING_DASHERIZE_REGEXP=(/[ _]/g);SC.STRING_DASHERIZE_CACHE={};SC.STRING_TRIM_LEFT_REGEXP=(/^\s+/g);SC.STRING_TRIM_RIGHT_REGEXP=(/\s+$/g);SC.mixin(SC.String,{capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},camelize:function(d){var b=d.replace(SC.STRING_TITLEIZE_REGEXP,function(g,h,f){return f?f.toUpperCase():""});var c=b.charAt(0),a=c.toLowerCase();return c!==a?a+b.slice(1):b},decamelize:function(a){return a.replace(SC.STRING_DECAMELIZE_REGEXP,"$1_$2").toLowerCase()},dasherize:function(c){var a=SC.STRING_DASHERIZE_CACHE,b=a[c];if(b){return b}else{b=SC.String.decamelize(c).replace(SC.STRING_DASHERIZE_REGEXP,"-");a[c]=b}return b},loc:function(d){if(!SC.Locale.currentLocale){SC.Locale.createCurrentLocale()}var b=SC.Locale.currentLocale.locWithDefault(d);if(SC.typeOf(b)!==SC.T_STRING){b=d}var a=SC.$A(arguments);a.shift();if(a.length>0&&a[0]&&a[0].isSCArray){a=a[0]}try{return SC.String.fmt(b,a)}catch(c){SC.error("Error processing string with key: "+d);SC.error("Localized String: "+b);SC.error("Error: "+c)}},locMetric:function(b){var a=SC.Locale,c=a.currentLocale;if(!c){a.createCurrentLocale();c=a.currentLocale}return c.locMetric(b)},locLayout:function(b,c){var a=SC.Locale,d=a.currentLocale;if(!d){a.createCurrentLocale();d=a.currentLocale}return d.locLayout(b,c)},locWithDefault:function(d,c){if(!SC.Locale.currentLocale){SC.Locale.createCurrentLocale()}var b=SC.Locale.currentLocale.locWithDefault(d,c);if(SC.typeOf(b)!==SC.T_STRING){b=d}var a=SC.$A(arguments);a.shift();a.shift();return SC.String.fmt(b,a)},trim:jQuery.trim,trimLeft:function(a){return a.replace(SC.STRING_TRIM_LEFT_REGEXP,"")},trimRight:function(a){return a.replace(SC.STRING_TRIM_RIGHT_REGEXP,"")},mult:function(d,c){if(SC.typeOf(c)!==SC.T_NUMBER||c<1){return null}var a="";for(var b=0;b<c;b+=1){a+=d}return a}});if(String.prototype.trim){SC.supplement(String.prototype,{trim:function(){return SC.String.trim(this,arguments)},trimLeft:function(){return SC.String.trimLeft(this,arguments)},trimRight:function(){return SC.String.trimRight(this,arguments)}})}SC.mixin(String.prototype,{loc:function(){return SC.String.loc(this.toString(),SC.$A(arguments))},locMetric:function(){return SC.String.locMetric(this.toString())},locLayout:function(a){return SC.String.locLayout(this.toString(),a)}});sc_require("system/string");SC.supplement(String.prototype,{capitalize:function(){return SC.String.capitalize(this,arguments)},camelize:function(){return SC.String.camelize(this,arguments)},decamelize:function(){return SC.String.decamelize(this,arguments)},dasherize:function(){return SC.String.dasherize(this,arguments)},loc:function(){var a=SC.$A(arguments);a.unshift(this);return SC.String.loc.apply(SC.String,a)},locWithDefault:function(b){var a=SC.$A(arguments);a.unshift(this);return SC.String.locWithDefault.apply(SC.String,a)},mult:function(a){return SC.String.mult(this,a)}});SC.ActionSupport={target:null,action:null,actionContext:null,fireAction:function(b){var c=this.get("target")||null,a=this.getPath("pane.rootResponder");if(b===undefined){b=this.get("action")}if(b&&a){return a.sendAction(b,c,this,this.get("pane"),this.get("actionContext"),this)}return false}};SC.DelegateSupport={delegateFor:function(c){var b=1,a=arguments.length,d;while(b<a){d=arguments[b];if(d&&d[c]!==undefined){return d}b++}return(this[c]!==undefined)?this:null},invokeDelegateMethod:function(c,a,b){b=SC.A(arguments);b=b.slice(2,b.length);if(!c||!c[a]){c=this}var d=c[a];return d?d.apply(c,b):null},getDelegateProperty:function(d,f){var b=1,a=arguments.length,c;while(b<a){c=arguments[b++];if(c&&c[d]!=undefined){return c.get?c.get(d):c[d]}}return(this[d]!=undefined)?this.get(d):undefined}};SC.Responder=SC.Object.extend({isResponder:YES,pane:null,responderContext:null,nextResponder:null,isFirstResponder:NO,hasFirstResponder:NO,acceptsFirstResponder:YES,becomingFirstResponder:NO,becomeFirstResponder:function(){var a=this.get("pane")||this.get("responderContext")||this.pane();if(a&&this.get("acceptsFirstResponder")){if(a.get("firstResponder")!==this){a.makeFirstResponder(this)}}return this},resignFirstResponder:function(a){var b=this.get("pane")||this.get("responderContext");if(b&&(b.get("firstResponder")===this)){b.makeFirstResponder(null,a)}return YES},willLoseFirstResponder:function(a){},didBecomeFirstResponder:function(a){}});sc_require("system/responder");SC.ResponderContext={isResponderContext:YES,trace:NO,defaultResponder:null,nextResponder:function(){return this.get("defaultResponder")}.property("defaultResponder").cacheable(),firstResponder:null,nextResponderFor:function(a){var b=a.get("nextResponder");if(typeof b===SC.T_STRING){b=SC.objectForPropertyPath(b,this)}else{if(!b&&(a!==this)){b=this}}return b},responderNameFor:function(a){if(!a){return"(No Responder)"}else{if(a._scrc_name){return a._scrc_name}}var b=this.NAMESPACE;this._findResponderNamesFor(this,3,b?[this.NAMESPACE]:[]);return a._scrc_name||a.toString()},_findResponderNamesFor:function(a,f,d){var b,c;for(b in a){if(b==="nextResponder"){continue}c=a[b];if(c&&c.isResponder){if(c._scrc_name){continue}d.push(b);c._scrc_name=d.join(".");if(f>0){this._findResponderNamesFor(c,f-1,d)}d.pop()}}},makeFirstResponder:function(b,a){var g=this.get("firstResponder"),d=this.get("nextResponder"),f=this.get("trace"),c;if(this._locked){if(f){SC.Logger.log("%@: AFTER ACTION: makeFirstResponder => %@".fmt(this,this.responderNameFor(b)))}this._pendingResponder=b;return}if(f){SC.Logger.log("%@: makeFirstResponder => %@".fmt(this,this.responderNameFor(b)))}if(b){b.set("becomingFirstResponder",YES)}this._locked=YES;this._pendingResponder=null;c=b?b:null;while(c){if(c.get("hasFirstResponder")){break}c=(c===d)?null:this.nextResponderFor(c)}if(!c){c=d}this._notifyWillLoseFirstResponder(g,g,c,a);if(g){g.set("isFirstResponder",NO)}this.beginPropertyChanges();this.set("firstResponder",b);if(b){b.set("isFirstResponder",YES)}this._notifyDidBecomeFirstResponder(b,b,c);this.endPropertyChanges();this._locked=NO;if(this._pendingResponder){this.makeFirstResponder(this._pendingResponder);this._pendingResponder=null}if(b){b.set("becomingFirstResponder",NO)}return this},_notifyWillLoseFirstResponder:function(c,f,b,a){if(!f||f===b){return}f.willLoseFirstResponder(c,a);f.set("hasFirstResponder",NO);var d=this.nextResponderFor(f);if(d){this._notifyWillLoseFirstResponder(c,d,b)}},_notifyDidBecomeFirstResponder:function(b,d,a){if(!d||d===a){return}var c=this.nextResponderFor(d);if(c){this._notifyDidBecomeFirstResponder(b,c,a)}d.set("hasFirstResponder",YES);d.didBecomeFirstResponder(b)},resetFirstResponder:function(){var a=this.get("firstResponder");if(!a){return}a.willLoseFirstResponder();a.didBecomeFirstResponder()},sendAction:function(h,d,c){var a=this.get("firstResponder"),f=this.get("nextResponder"),g=this.get("trace"),i=NO,b;this._locked=YES;if(g){SC.Logger.log("%@: begin action '%@' (%@, %@)".fmt(this,h,d,c))}if(!i&&!a&&this.tryToPerform){i=this.tryToPerform(h,d,c)}while(!i&&a){if(a.tryToPerform){i=a.tryToPerform(h,d,c)}if(!i){a=(a===f)?null:this.nextResponderFor(a)}}if(g){if(!i){SC.Logger.log("%@:  action '%@' NOT HANDLED".fmt(this,h))}else{SC.Logger.log("%@: action '%@' handled by %@".fmt(this,h,this.responderNameFor(a)))}}this._locked=NO;if(b=this._pendingResponder){this._pendingResponder=null;this.makeFirstResponder(b)}return a}};SC.bodyOverflowArbitrator=SC.Object.create({requestHidden:function(b,a){this._makeRequest(b,-1-9*!!a)},requestVisible:function(b,a){this._makeRequest(b,1+9*!!a)},withdrawRequest:function(b){if(!b){return}var a=SC.guidFor(b);if(this._requests[a]){delete this._requests[a]}this.setOverflow()},setOverflow:function(){var a=this._decideOverflow();if(a!==undefined){document.body.style.overflow=a?"auto":"hidden"}},_makeRequest:function(c,b){if(!c){return}var a=SC.guidFor(c);this._requests[a]=b;this.setOverflow()},_requests:{},_decideOverflow:function(){var a,f,c,g,b=this._requests,h;for(var d in b){if((h=b[d])<0){a=YES}if(h<-1){c=YES}if(h>0){f=YES}if(h>1){g=YES}}if(g){return YES}if(f&&c){return NO}if(f){return YES}if(a){return NO}return undefined}});SC.mixin(SC.browser,{compare:function(c,a){var g,h,f;if(typeof c==="number"||typeof a==="number"){SC.warn("SC.browser.compare(): Versions compared against Numbers may not provide accurate results.  Use a String of decimal separated Numbers instead.");c=String(c);a=String(a)}g=function(i){return Number(i.match(/^[0-9]+/))};h=SC.A(c.split(".")).map(g);f=SC.A(a.split(".")).map(g);for(var d=0;d<f.length;d++){var b=h[d]-f[d];if(isNaN(b)){return 0}if(b!==0){return b}}return 0},compareVersion:function(){SC.warn("SC.browser.compareVersion() has been deprecated.  Please use SC.browser.compare() instead.  Example: SC.browser.compareVersion(16,0,912) < 0 becomes SC.browser.compare(SC.browser.engineVersion, '16.0.912').");if(this._versionSplit===undefined){var d=function(f){return Number(f.match(/^[0-9]+/))};this._versionSplit=SC.A(this.version.split(".")).map(d)}var c=SC.A(arguments).map(Number);for(var b=0;b<c.length;b++){var a=this._versionSplit[b]-c[b];if(isNaN(a)){return 0}if(a!==0){return a}}return 0}});SC.Builder=function(a){return SC.Builder.create(a)};SC.Builder.create=function create(c){var b=SC.mixin(SC.beget(this.fn),c||{});if(c.hasOwnProperty("toString")){b.toString=c.toString}var a=function(){var d=SC.beget(b);d.defaultClass=this;d.constructor=a;return d.init.apply(d,arguments)};a.fn=a.prototype=b;a.extend=SC.Builder.create;a.mixin=SC.Builder.mixin;return a};SC.Builder.mixin=function(){var b=arguments.length,a;for(a=0;a<b;a++){SC.mixin(this,arguments[a])}return this};SC.Builder.fn={init:function(a){if(a!==undefined){if(SC.typeOf(a)===SC.T_ARRAY){var b=a.length;while(--b>=0){this[b]=a.objectAt?a.objectAt(b):a[b]}this.length=a.length}else{this[0]=a;this.length=1}}return this},size:function(){return this.length},pushStack:function(){var a=this.constructor.apply(this,arguments);a.prevObject=this;return a},end:function(){return this.prevObject||this.constructor()},toString:function(){return"%@$(%@)".fmt(this.defaultClass.toString(),SC.A(this).invoke("toString").join(","))},mixin:SC.Builder.mixin};(function(){var a=SC.Enumerable,c=SC.Builder.fn,b,d;for(b in a){if(!a.hasOwnProperty(b)){continue}d=Array.prototype[b]||a[b];c[b]=d}})();sc_require("system/builder");SC.$=SC.CoreQuery=jQuery;SC.mixin(SC.$.fn,{isCoreQuery:YES,toString:function(){var c=[],b=this.length,a=0;for(a=0;a<b;a++){c[a]="%@: %@".fmt(a,this[a]?this[a].toString():"(null)")}return"<$:%@>(%@)".fmt(SC.guidFor(this),c.join(" , "))},isVisible:function(){return Array.prototype.every.call(this,function(a){return SC.$.isVisible(a)})},view:function(){return this.map(function(){var b=null,a=SC.viewKey,d=this,c;while(!b&&d&&(d!==document)){if(d.nodeType===1&&(c=d.getAttribute("id"))){b=SC.View.views[c]}d=d.parentNode}d=null;return b})},within:function(a){if(this.filter(a).length){return true}return !!this.has(a).length}});(function(){var c={},g={find:function(i,h){return(h!==undefined)?SC.Enumerable.find.call(this,i,h):c.find.call(this,i)},filter:function(i,h){return(h!==undefined)?this.pushStack(SC.Enumerable.filter.call(this,i,h)):c.filter.call(this,i)},filterProperty:function(h,i){return this.pushStack(SC.Enumerable.filterProperty.call(this,h,i))},indexOf:SC.$.index,map:function(i,h){return(h!==undefined)?SC.Enumerable.map.call(this,i,h):c.map.call(this,i)}};var d=SC.$.fn,a=SC.Enumerable,f;for(var b in a){if(a.hasOwnProperty(b)){f=a[b];if(b in g){c[b]=d[b];f=g[b]}d[b]=f}}})();SC.mixin(SC.$,{isVisible:function(a){var b=SC.$;return("hidden"!=a.type)&&(b.css(a,"display")!="none")&&(b.css(a,"visibility")!="hidden")}});sc_require("system/core_query");SC.Event=function(d){var c,b;if(d){this.originalEvent=d;var h=SC.Event._props,g;b=h.length;c=b;while(--c>=0){g=h[c];this[g]=d[g]}}this.timeStamp=this.timeStamp||Date.now();if(!this.target){this.target=this.srcElement||document}if(this.target.nodeType===3){this.target=this.target.parentNode}if(!this.relatedTarget&&this.fromElement){this.relatedTarget=(this.fromElement===this.target)?this.toElement:this.fromElement}if(SC.none(this.pageX)&&!SC.none(this.clientX)){var i=document.documentElement,a=document.body;this.pageX=this.clientX+(i&&i.scrollLeft||a&&a.scrollLeft||0)-(i.clientLeft||0);this.pageY=this.clientY+(i&&i.scrollTop||a&&a.scrollTop||0)-(i.clientTop||0)}if(!this.which&&((this.charCode||d.charCode===0)?this.charCode:this.keyCode)){this.which=this.charCode||this.keyCode}if(!this.metaKey&&this.ctrlKey){this.metaKey=this.ctrlKey}if(!this.which&&this.button){this.which=((this.button&1)?1:((this.button&2)?3:((this.button&4)?2:0)))}if(this.type==="mousewheel"||this.type==="DOMMouseScroll"||this.type==="MozMousePixelScroll"){var f=SC.Event.MOUSE_WHEEL_MULTIPLIER;if(SC.browser.isWebkit&&d.wheelDelta!==undefined){this.wheelDelta=0-(d.wheelDeltaY||d.wheelDeltaX);this.wheelDeltaY=0-(d.wheelDeltaY||0);this.wheelDeltaX=0-(d.wheelDeltaX||0)}else{if(!SC.none(d.detail)&&SC.browser.isMozilla){if(d.axis&&(d.axis===d.HORIZONTAL_AXIS)){this.wheelDeltaX=d.detail;this.wheelDeltaY=this.wheelDelta=0}else{this.wheelDeltaY=this.wheelDelta=d.detail;this.wheelDeltaX=0}}else{this.wheelDelta=this.wheelDeltaY=SC.browser.isIE||SC.browser.isOpera?0-d.wheelDelta:d.wheelDelta;this.wheelDeltaX=0}}this.wheelDelta*=f;this.wheelDeltaX*=f;this.wheelDeltaY*=f}return this};SC.mixin(SC.Event,{MOUSE_WHEEL_MULTIPLIER:function(){var b=1,a=SC.browser.engineVersion;if(SC.browser.name===SC.BROWSER.safari){b=0.4;if(SC.browser.compare(a,"533.17")>0&&SC.browser.compare(a,"534")<0){b=0.004}else{if(SC.browser.compare(a,"533")<0){b=40}}}else{if(SC.browser.name===SC.BROWSER.ie){b=0.3}else{if(SC.browser.name===SC.BROWSER.chrome){b=0.4}}}return b}(),MOUSE_WHEEL_DELTA_LIMIT:1000,_MOUSE_WHEEL_LIMIT_INVALIDATED:NO,create:function(a){return new SC.Event(a)},add:function(g,f,h,i,d,a){if(g&&g.isCoreQuery){if(g.length>0){g.forEach(function(j){this.add(j,f,h,i,d)},this);return this}else{g=g[0]}}if(!g){return this}if(!a){a=NO}if(g.nodeType===3||g.nodeType===8){return SC.Event}if(SC.browser.name===SC.BROWSER.ie&&g.setInterval){g=window}if(SC.typeOf(h)===SC.T_FUNCTION){d=i;i=h;h=null}else{if(h&&SC.typeOf(i)===SC.T_STRING){i=h[i]}}var c=SC.data(g,"sc_events")||SC.data(g,"sc_events",{}),b=c[f];if(!b){b=c[f]={};this._addEventListener(g,f,a)}b[SC.hashFor(h,i)]=[h,i,d];SC.Event._global[f]=YES;g=c=b=null;return this},remove:function(g,f,h,i){if(g&&g.isCoreQuery){if(g.length>0){g.forEach(function(j){this.remove(j,f,h,i)},this);return this}else{g=g[0]}}if(!g){return this}if(g.nodeType===3||g.nodeType===8){return SC.Event}var a,d,c=SC.data(g,"sc_events");if(!c){return this}if(f===undefined){for(f in c){this.remove(g,f)}}else{if(a=c[f]){var b=NO;if(h||i){if(SC.typeOf(h)===SC.T_FUNCTION){i=h;h=null}else{if(SC.typeOf(i)===SC.T_STRING){i=h[i]}}delete a[SC.hashFor(h,i)];d=null;for(d in a){break}if(d===null){b=YES}}else{b=YES}if(b){delete c[f];this._removeEventListener(g,f)}d=null;for(d in c){break}if(!d){SC.removeData(g,"sc_events");delete this._elements[SC.guidFor(g)]}}}g=c=a=null;return this},NO_BUBBLE:["blur","focus","change"],simulateEvent:function(d,c,b){var a=SC.Event.create({type:c,target:d,preventDefault:function(){this.cancelled=YES},stopPropagation:function(){this.bubbles=NO},allowDefault:function(){this.hasCustomEventHandling=YES},timeStamp:Date.now(),bubbles:(this.NO_BUBBLE.indexOf(c)<0),cancelled:NO,normalized:YES});if(b){SC.mixin(a,b)}return a},trigger:function(c,b,i,j){if(c&&c.isCoreQuery){if(c.length>0){c.forEach(function(m){this.trigger(m,b,i,j)},this);return this}else{c=c[0]}}if(!c){return this}if(c.nodeType===3||c.nodeType===8){return undefined}i=SC.A(i);var h,k=SC.typeOf(c[b]||null)===SC.T_FUNCTION,a,g,d,l;a=i[0];if(!a||!a.preventDefault){a=this.simulateEvent(c,b);i.unshift(a)}a.type=b;g=c;do{h=SC.Event.handle.apply(g,i);g=(g===document)?null:(g.parentNode||document)}while(!h&&a.bubbles&&g);g=null;d=c["on"+b];l=SC.$.nodeName(c,"a")&&b==="click";if((!k||l)&&d&&d.apply(c,i)===NO){h=NO}if(k&&j!==NO&&h!==NO&&!l){this.triggered=YES;try{c[b]()}catch(f){}}this.triggered=NO;return h},handle:function(b){if((typeof SC==="undefined")||SC.Event.triggered){return YES}var c,h,f,j,d,i,k,l,a,g;i=SC.A(arguments);i[0]=b=SC.Event.normalizeEvent(b||window.event);d=(SC.data(this,"sc_events")||{})[b.type];if(!d){return NO}for(k in d){l=d[k];a=l[1];b.handler=a;b.data=b.context=l[2];g=l[0]||this;h=a.apply(g,i);if(c!==NO){c=h}if(h===NO){b.preventDefault();b.stopPropagation()}}return c},unload:function(){var a,b=this._elements;for(a in b){this.remove(b[a])}for(a in b){delete b[a]}delete this._elements},special:{ready:{setup:function(){SC._bindReady();return},teardown:function(){return}},mouseenter:{setup:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.add(this,"mouseover",SC.Event.special.mouseenter.handler);return YES},teardown:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.remove(this,"mouseover",SC.Event.special.mouseenter.handler);return YES},handler:function(a){if(SC.Event._withinElement(a,this)){return YES}a.type="mouseenter";return SC.Event.handle.apply(this,arguments)}},mouseleave:{setup:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.add(this,"mouseout",SC.Event.special.mouseleave.handler);return YES},teardown:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.remove(this,"mouseout",SC.Event.special.mouseleave.handler);return YES},handler:function(a){if(SC.Event._withinElement(a,this)){return YES}a.type="mouseleave";return SC.Event.handle.apply(this,arguments)}}},KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,_withinElement:function(d,c){var b=d.relatedTarget;while(b&&b!==c){try{b=b.parentNode}catch(a){b=c}}return b===c},_addEventListener:function(f,d,a){var g,c=this.special[d];if(!a){a=NO}if(!c||c.setup.call(f)===NO){var b=SC.guidFor(f);this._elements[b]=f;g=SC.data(f,"listener")||SC.data(f,"listener",function(){return SC.Event.handle.apply(SC.Event._elements[b],arguments)});if(f.addEventListener){f.addEventListener(d,g,a)}else{if(f.attachEvent){f.attachEvent("on"+d,g)}}}f=c=g=null},_removeEventListener:function(c,b){var d,a=SC.Event.special[b];if(!a||(a.teardown.call(c)===NO)){d=SC.data(c,"listener");if(d){if(c.removeEventListener){c.removeEventListener(b,d,NO)}else{if(c.detachEvent){c.detachEvent("on"+b,d)}}}}c=a=d=null},_elements:{},normalizeEvent:function(a){if(a===window.event){return SC.Event.create(a)}else{return a.normalized?a:SC.Event.create(a)}},_global:{},_props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target timeStamp toElement type view which touches targetTouches changedTouches animationName elapsedTime dataTransfer".split(" ")});SC.Event.prototype={hasCustomEventHandling:NO,touchesForView:function(a){if(this.touchContext){return this.touchContext.touchesForView(a)}},touchesForResponder:function(a){if(this.touchContext){return this.touchContext.touchesForView(a)}},averagedTouchesForView:function(a){if(this.touchContext){return this.touchContext.averagedTouchesForView(a)}return null},allowDefault:function(){this.hasCustomEventHandling=YES;return this},preventDefault:function(){var a=this.originalEvent;if(a){if(a.preventDefault){a.preventDefault()}a.returnValue=NO}this.hasCustomEventHandling=YES;return this},stopPropagation:function(){var a=this.originalEvent;if(a){if(a.stopPropagation){a.stopPropagation()}a.cancelBubble=YES}this.hasCustomEventHandling=YES;return this},stop:function(){return this.preventDefault().stopPropagation()},normalized:YES,getCharString:function(){if(SC.browser.name===SC.BROWSER.ie&&SC.browser.compare(SC.browser.version,"9.0")<0){if(this.keyCode==8||this.keyCode==9||(this.keyCode>=37&&this.keyCode<=40)){return String.fromCharCode(0)}else{return(this.keyCode>0)?String.fromCharCode(this.keyCode):null}}else{return(this.charCode>0)?String.fromCharCode(this.charCode):null}},commandCodes:function(){var f=this.keyCode,b=null,c=null,a="",d;if(f&&f!==this.charCode){b=SC.FUNCTION_KEYS[f];if(!b&&(this.altKey||this.ctrlKey||this.metaKey)){b=SC.PRINTABLE_KEYS[f]}if(b){if(this.altKey){a+="alt_"}if(this.ctrlKey||this.metaKey){a+="ctrl_"}if(this.shiftKey){a+="shift_"}}}if(!b){f=this.which;c=b=String.fromCharCode(f);d=b.toLowerCase();if(this.metaKey){a="meta_";b=d}else{b=null}}if(b){b=a+b}return[b,c]}};SC.Event.observe=SC.Event.add;SC.Event.stopObserving=SC.Event.remove;SC.Event.fire=SC.Event.trigger;if(SC.browser.name===SC.BROWSER.ie){SC.Event.add(window,"unload",SC.Event.prototype,SC.Event.unload)}SC.MODIFIER_KEYS={16:"shift",17:"ctrl",18:"alt"};SC.FUNCTION_KEYS={8:"backspace",9:"tab",13:"return",19:"pause",27:"escape",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"printscreen",45:"insert",46:"delete",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock"};SC.PRINTABLE_KEYS={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:'"'};SC.SYSTEM_CURSOR="default";SC.AUTO_CURSOR=SC.DEFAULT_CURSOR="auto";SC.CROSSHAIR_CURSOR="crosshair";SC.HAND_CURSOR=SC.POINTER_CURSOR="pointer";SC.MOVE_CURSOR="move";SC.E_RESIZE_CURSOR="e-resize";SC.NE_RESIZE_CURSOR="ne-resize";SC.NW_RESIZE_CURSOR="nw-resize";SC.N_RESIZE_CURSOR="n-resize";SC.SE_RESIZE_CURSOR="se-resize";SC.SW_RESIZE_CURSOR="sw-resize";SC.S_RESIZE_CURSOR="s-resize";SC.W_RESIZE_CURSOR="w-resize";SC.IBEAM_CURSOR=SC.TEXT_CURSOR="text";SC.WAIT_CURSOR="wait";SC.HELP_CURSOR="help";SC.Cursor=SC.Object.extend({init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("cursorStyle")||SC.DEFAULT_CURSOR,c=this.constructor.sharedStyleSheet(),b=SC.guidFor(this);if(c.insertRule){c.insertRule("."+b+" {cursor: "+a+";}",c.cssRules?c.cssRules.length:0)}else{if(c.addRule){c.addRule("."+b,"cursor: "+a)}}this.cursorStyle=a;this.className=b;return this},className:null,cursorStyle:SC.DEFAULT_CURSOR,cursorStyleDidChange:function(){var d,g,c,f,h,b,a;d=this.get("cursorStyle")||SC.DEFAULT_CURSOR;g=this._rule;if(g){g.style.cursor=d;return}c="."+this.get("className");f=this.constructor.sharedStyleSheet();h=(f.cssRules?f.cssRules:f.rules)||[];for(b=0,a=h.length;b<a;++b){g=h[b];if(g.selectorText===c){this._rule=g;g.style.cursor=d;break}}}.observes("cursorStyle")});SC.Cursor.sharedStyleSheet=function(){var b,a=this._styleSheet;if(!a){a=document.createElement("style");a.type="text/css";b=document.getElementsByTagName("head")[0];if(!b){b=document.documentElement}b.appendChild(a);a=document.styleSheets[document.styleSheets.length-1];this._styleSheet=a}return a};SC.Theme={isTheme:YES,classNames:SC.CoreSet.create(),_extend_class_names:function(b){if(b){if(SC.typeOf(b)===SC.T_HASH&&!b.isSet){for(var a in b){if(b[a]){this.classNames.add(a)}else{this.classNames.remove(a)}}}else{if(typeof b==="string"){this.classNames.addEach(b.split(" "))}else{this.classNames.addEach(b)}}}},_extend_self:function(b){if(b.classNames){this._extend_class_names(b.classNames)}var a,c,d;for(a in b){if(a==="classNames"){continue}if(!b.hasOwnProperty(a)){continue}c=b[a];if(c instanceof Function&&!c.base&&(c!==(d=this[a]))){c.base=d}this[a]=c}},create:function(){var c=SC.beget(this);c.baseTheme=this;if(this.themes===SC.Theme.themes){c.themes={}}else{c.themes=SC.beget(this.themes)}c._privateThemes={};c._specializedThemes={};c.classNames=SC.clone(this.classNames);var f=arguments,b=f.length,a,d;for(a=0;a<b;a++){c._extend_self(f[a])}if(c.name){c.classNames.add(c.name)}return c},subtheme:function(a){var b=this.create({name:a});this.addTheme(b);return b},invisibleSubtheme:function(a){var b=this.create({name:a});this._privateThemes[a]=b;return b},themes:{},find:function(a){if(this===SC.Theme){return this.themes[a]}var b;b=this._privateThemes[a];if(b){return b}b=this._specializedThemes[a];if(b){return b}b=this.themes[a];if(b&&!this._specializedThemes[a]){return(this._specializedThemes[a]=b.create({classNames:this.classNames}))}b=SC.Theme.themes[a];if(b){return b}return null},addTheme:function(a){this.themes[a.name]=a}};SC.BaseTheme=SC.Theme.create({name:""});SC.Theme.themes["sc-base"]=SC.BaseTheme;SC.defaultTheme="sc-base";sc_require("mixins/delegate_support");SC.CoreView=SC.Responder.extend(SC.DelegateSupport);sc_require("system/browser");sc_require("system/event");sc_require("system/cursor");sc_require("system/responder");sc_require("system/theme");sc_require("system/string");sc_require("views/view/base");SC.CONTEXT_MENU_ENABLED=YES;SC.TABBING_ONLY_INSIDE_DOCUMENT=NO;SC.FROM_THEME="__FROM_THEME__";SC.EMPTY_CHILD_VIEWS_ARRAY=[];SC.EMPTY_CHILD_VIEWS_ARRAY.needsClone=YES;SC.CoreView.reopen({concatenatedProperties:["outlets","displayProperties","classNames","renderMixin","didCreateLayerMixin","willDestroyLayerMixin","classNameBindings","attributeBindings"],ariaRole:null,ariaHidden:null,pane:function(){var a=this;while(a&&!a.isPane){a=a.get("parentView")}return a}.property("parentView").cacheable(),page:null,parentView:null,isVisible:YES,isVisibleBindingDefault:SC.Binding.bool(),isVisibleInWindow:YES,childViews:SC.EMPTY_CHILD_VIEWS_ARRAY,layer:function(a,c){if(c!==undefined){this._view_layer=c}else{c=this._view_layer;if(!c){var b=this.get("parentView");if(b){b=b.get("layer")}if(b){this._view_layer=c=this.findLayerInParentLayer(b)}}}return c}.property("isVisibleInWindow").cacheable(),$:function(b){var a=this.get("layer");if(!a){return SC.$()}else{if(b===undefined){return SC.$(a)}else{return SC.$(b,a)}}},containerLayer:function(){return this.get("layer")}.property("layer").cacheable(),layerId:function(a,b){if(b){this._layerId=b}if(this._layerId){return this._layerId}return SC.guidFor(this)}.property().cacheable(),findLayerInParentLayer:function(a){var b="#"+this.get("layerId");return jQuery(b)[0]||jQuery(b,a)[0]},isDescendantOf:function(a){var b=this.get("parentView");if(this===a){return YES}else{if(b){return b.isDescendantOf(a)}else{return NO}}},displayDidChange:function(){this.set("layerNeedsUpdate",YES);return this},_sc_isVisibleDidChange:function(){this.displayDidChange()}.observes("isVisible"),layerNeedsUpdate:NO,_view_layerNeedsUpdateDidChange:function(){if(this.get("layerNeedsUpdate")){this.invokeOnce(this.updateLayerIfNeeded)}}.observes("layerNeedsUpdate"),updateLayerIfNeeded:function(b){var c=this.get("layerNeedsUpdate"),a=c&&(b||this.get("isVisibleInWindow"));if(a){if(this.get("layer")){this.beginPropertyChanges();this.set("layerNeedsUpdate",NO);this.updateLayer();this.endPropertyChanges()}}return this},updateLayer:function(g){var c,b,a,d;var f=g||this.renderContext(this.get("layer"));this._renderLayerSettings(f,NO);d=!this.update;if(d){this.render(f,NO)}else{this.update(f.$())}if(c=this.renderMixin){a=c.length;for(b=0;b<a;++b){c[b].call(this,f,NO)}}f.update();if(f._innerHTMLReplaced){var h=this.get("pane");if(h&&h.get("isPaneAttached")){this._notifyDidAppendToDocument()}}if(this.useStaticLayout){this.viewDidResize()}if(this.didUpdateLayer){this.didUpdateLayer()}if(this.designer&&this.designer.viewDidUpdateLayer){this.designer.viewDidUpdateLayer()}return this},parentViewDidResize:function(){if(!this.get("hasLayout")){this.notifyPropertyChange("frame")}this.viewDidResize()},viewDidResize:function(){},renderContext:function(a){return SC.RenderContext(a)},createLayer:function(){if(this.get("layer")){return this}var a=this.renderContext(this.get("tagName"));this.renderToContext(a);this.set("layer",a.element());this._notifyDidCreateLayer();return this},_notifyDidCreateLayer:function(){this.notifyPropertyChange("layer");if(this.get("useStaticLayout")){this.viewDidResize()}if(this.didCreateLayer){this.didCreateLayer()}var c=this.didCreateLayerMixin,b,a,d=this.get("childViews"),f;if(c){b=c.length;for(a=0;a<b;++a){c[a].call(this)}}b=d.length;for(a=0;a<b;++a){f=d[a];if(!f){continue}f.notifyPropertyChange("layer");if(this.get("useStaticLayout")){if(!f.get("isFixedLayout")){f.viewDidResize()}}f._notifyDidCreateLayer()}},destroyLayer:function(){var a=this.get("layer");if(a){this._notifyWillDestroyLayer();if(a.parentNode){a.parentNode.removeChild(a)}a=null}return this},replaceLayer:function(){this.destroyLayer();this.set("layerLocationNeedsUpdate",YES);this.invokeOnce(this.updateLayerLocationIfNeeded)},parentViewDidChange:function(){this.parentViewDidResize();this.updateLayerLocation()},layerLocationNeedsUpdate:NO,updateLayerLocationIfNeeded:function(a){if(this.get("layerLocationNeedsUpdate")){this.updateLayerLocation()}return this},updateLayerLocation:function(){var f=this.get("layer"),d=this.get("parentView"),b=d?d.get("containerLayer"):null;if(f&&f.parentNode&&f.parentNode!==b){f.parentNode.removeChild(f)}if(!d){if(f&&f.parentNode){f.parentNode.removeChild(f)}}else{if(!b){if(f){if(f.parentNode){f.parentNode.removeChild(f)}this.destroyLayer()}}else{if(!f){this.createLayer();f=this.get("layer");if(!f){return}}var g=d.get("childViews"),c=g.objectAt(g.indexOf(this)+1),a=(c)?c.get("layer"):null;if(c&&(!a||a.parentNode!==b)){c.updateLayerLocationIfNeeded();a=c.get("layer")||null}if((f.parentNode!==b)||(f.nextSibling!==a)){b.insertBefore(f,a)}}}b=d=f=a=null;this.set("layerLocationNeedsUpdate",NO);return this},_notifyWillDestroyLayer:function(){if(this.willDestroyLayer){this.willDestroyLayer()}var c=this.willDestroyLayerMixin,b,a,d=this.get("childViews");if(c){b=c.length;for(a=0;a<b;++a){c[a].call(this)}}b=d.length;for(a=0;a<b;++a){d[a]._notifyWillDestroyLayer()}this.set("layer",null)},renderToContext:function(f,g){var d,c,b,a;this.beginPropertyChanges();this.set("layerNeedsUpdate",NO);if(SC.none(g)){g=YES}this._renderLayerSettings(f,g);d=!this.update;if(d){this.render(f,g)}else{if(g){this.render(f)}else{this.update(f.$())}}if(g&&!this._didRenderChildViews){this.renderChildViews(f,g)}this._didRenderChildViews=NO;if(c=this.renderMixin){a=c.length;for(b=0;b<a;++b){c[b].call(this,f,g)}}this.endPropertyChanges()},_renderLayerSettings:function(a,b){a.resetClassNames();a.resetStyles();this.applyAttributesToContext(a)},applyAttributesToContext:function(a){if(!this.get("layer")){this._applyClassNameBindings();this._applyAttributeBindings(a)}a.addClass(this.get("classNames"));if(this.get("isTextSelectable")){a.addClass("allow-select")}if(!this.get("isVisible")){a.addClass("sc-hidden")}if(this.get("isFirstResponder")){a.addClass("focus")}a.id(this.get("layerId"));a.attr("role",this.get("ariaRole"));var b=this.get("ariaHidden");if(b!==null){if(b===NO){a.removeAttr("aria-hidden")}else{a.attr("aria-hidden",b)}}},_applyClassNameBindings:function(){var b=this.get("classNameBindings"),d=this.get("classNames"),a,c,f;if(!b){return}b.forEach(function(i){var h;var g=function(){c=this._classStringForProperty(i);a=this.$();if(h){a.removeClass(h);d.removeObject(h)}if(c){a.addClass(c);d.push(c);h=c}else{h=null}};this.addObserver(i,this,g);f=this._classStringForProperty(i);if(f){d.push(f);h=f}},this)},_applyAttributeBindings:function(a){var f=this.get("attributeBindings"),c,d,b;if(!f){return}f.forEach(function(h){var g=function(){d=this.$();var i=d.attr(h);c=this.get(h);b=typeof c;if((b==="string"||b==="number")&&c!==i){d.attr(h,c)}else{if(c&&b==="boolean"){d.attr(h,h)}else{if(c===NO){d.removeAttr(h)}}}};this.addObserver(h,this,g);c=this.get(h);b=typeof c;if(b==="string"||b==="number"){a.attr(h,c)}else{if(c&&b==="boolean"){a.attr(h,h)}}},this)},_classStringForProperty:function(c){var a=c.split(":"),b=a[1];c=a[0];var d=SC.getPath(this,c);if(d===YES){if(b){return b}return SC.String.dasherize(c.split(".").get("lastObject"))}else{if(d!==NO&&d!==undefined&&d!==null){return d}else{return null}}},prepareContext:function(a,b){if(b!==false){b=YES}if(b){this.renderToContext(a)}else{this.updateLayer(a)}},renderChildViews:function(f,g){var d=this.get("childViews"),b=d.length,a,c;for(a=0;a<b;++a){c=d[a];if(!c){continue}f=f.begin(c.get("tagName"));c.renderToContext(f,g);f=f.end()}this._didRenderChildViews=YES;return f},render:function(){},_notifyDidAppendToDocument:function(){if(!this.get("hasLayout")){this.notifyPropertyChange("frame")}if(this.didAppendToDocument){this.didAppendToDocument()}var c=0,d,a,b=this.get("childViews");for(c=0,a=b.length;c<a;c++){d=b[c];if(d._notifyDidAppendToDocument){d._notifyDidAppendToDocument()}}},childViewsObserver:function(){var c=this.get("childViews"),b,a,d;for(b=0,a=c.length;b<a;b++){d=c[b];if(d._notifyDidAppendToDocument){d._notifyDidAppendToDocument()}}}.observes("childViews"),tagName:"div",classNames:[],toolTip:null,displayToolTip:function(){var a=this.get("toolTip");return(a&&this.get("localize"))?SC.String.loc(a):(a||"")}.property("toolTip","localize").cacheable(),isTextSelectable:NO,displayProperties:["ariaHidden"],nextResponder:function(){return this.get("parentView")}.property("parentView").cacheable(),acceptsFirstResponder:NO,init:function(){var f=this.get("parentView"),h,b,d,g;arguments.callee.base.apply(this,arguments);SC.View.views[this.get("layerId")]=this;this.classNames=this.get("classNames").slice();this.childViews=this.get("childViews").slice();this.createChildViews();g=this.get("displayProperties");for(var c=0,a=g.length;c<a;c++){this.addObserver(g[c],this,this.displayDidChange)}},awake:function(){arguments.callee.base.apply(this,arguments);var c=this.get("childViews"),b=c.length,a;for(a=0;a<b;++a){if(!c[a]){continue}c[a].awake()}},frame:function(){return this.computeFrameWithParentFrame(null)}.property("useStaticLayout").cacheable(),computeFrameWithParentFrame:function(){var a,b=this.get("parentView"),c;if(a=this.get("layer")){c=SC.offset(a);if(b){c=b.convertFrameFromView(c,null)}c.width=a.offsetWidth;c.height=a.offsetHeight;return c}if(this.get("hasLayout")){return null}else{return{x:0,y:0,width:0,height:0}}},clippingFrame:function(){var d=this.get("frame"),a=d,b,c;if(!d){return null}b=this.get("parentView");if(b){c=b.get("clippingFrame");if(!c){return{x:0,y:0,width:d.width,height:d.height}}a=SC.intersectRects(c,d)}a.x-=d.x;a.y-=d.y;return a}.property("parentView","frame").cacheable(),_sc_view_clippingFrameDidChange:function(){var d=this.get("childViews"),b=d.length,a,c;for(a=0;a<b;++a){c=d[a];c.notifyPropertyChange("clippingFrame");c._sc_view_clippingFrameDidChange()}},removeChild:function(b){b.set("parentView",null);var c=this.get("childViews"),a=c.indexOf(b);if(a>=0){c.removeAt(a)}return this},removeAllChildren:function(){var b=this.get("childViews"),a;while(a=b.objectAt(b.get("length")-1)){this.removeChild(a)}return this},removeFromParent:function(){var a=this.get("parentView");if(a){a.removeChild(this)}return this},destroy:function(){if(this.get("isDestroyed")){return this}this._destroy();if(this.get("parentView")){this.removeFromParent()}arguments.callee.base.apply(this,arguments);return this},_destroy:function(){if(this.get("isDestroyed")){return this}this.destroyLayer();var c=this.get("childViews"),b=c.length,a;if(b){c=c.slice();for(a=0;a<b;++a){c[a].destroy()}}delete SC.View.views[this.get("layerId")];delete this._CQ;delete this.page;return this},createChildViews:function(){var g=this.get("childViews"),b=g.length,a,f,d,c;this.beginPropertyChanges();for(a=0;a<b;++a){if(f=(c=g[a])){if(typeof f===SC.T_STRING){c=this[f]}else{f=null}if(!c){SC.Logger.error("No view with name "+f+" has been found in "+this.toString());continue}c=this.createChildView(c);if(f){this[f]=c}}g[a]=c}this.endPropertyChanges();return this},createChildView:function(a,b){if(!a.isClass){b=a}else{if(!b){b={}}else{b=SC.clone(b)}}b.owner=b.parentView=this;if(a.isClass&&a.prototype.hasVisibility){b.isVisibleInWindow=this.get("isVisibleInWindow")}if(!b.page){b.page=this.page}if(a.isClass){a=a.create(b)}return a},isView:YES,selectStart:function(a){return this.get("isTextSelectable")},contextMenu:function(a){if(this.get("isContextMenuEnabled")){return YES}}});SC.CoreView.mixin({isViewClass:YES,design:function(){if(this.isDesign){return this}var a=this.extend.apply(this,arguments);a.isDesign=YES;if(SC.ViewDesigner){SC.ViewDesigner.didLoadDesign(a,this,SC.A(arguments))}return a},extend:function(){var a=arguments[arguments.length-1];if(a&&!SC.none(a.theme)){a.themeName=a.theme;delete a.theme}return SC.Object.extend.apply(this,arguments)},layout:function(a){this.prototype.layout=a;return this},classNames:function(a){a=(this.prototype.classNames||[]).concat(a);this.prototype.classNames=a;return this},tagName:function(a){this.prototype.tagName=a;return this},childView:function(a){var b=this.prototype.childViews||[];if(b===this.superclass.prototype.childViews){b=b.slice()}b.push(a);this.prototype.childViews=b;return this},bind:function(b,d){var c=this.prototype,a=this.superclass.prototype;var f=c._bindings;if(!f||f===a._bindings){f=c._bindings=(f||[]).slice()}b=b+"Binding";c[b]=d;f.push(b);return this},prop:function(a,b){this.prototype[a]=b;return this},localization:function(b,a){if(a){b.rootElement=SC.$(a)[0]}return b},viewFor:function(d,c){var b=SC.$A(arguments);if(SC.none(d)){b.shift()}else{b[0]={rootElement:SC.$(d)[0]}}var a=this.create.apply(this,arguments);b=b[0]=null;return a},create:function(){var b=arguments[arguments.length-1];if(b&&b.theme){b.themeName=b.theme;delete b.theme}var c=this,a=new c(arguments);if(SC.ViewDesigner){SC.ViewDesigner.didCreateView(a,SC.$A(arguments))}return a},loc:function(f){var b=f.childViews;delete f.childViews;this.applyLocalizedAttributes(f);if(SC.ViewDesigner){SC.ViewDesigner.didLoadLocalization(this,SC.$A(arguments))}var d=this.prototype.childViews,a=d.length,c;while(--a>=0){c=d[a];f=b[a];if(f&&c&&typeof c===SC.T_STRING){SC.String.loc(c,f)}}return this},applyLocalizedAttributes:function(a){SC.mixin(this.prototype,a)},views:{}});SC.outlet=function(b,a){return function(c){return(this[c]=SC.objectForPropertyPath(b,(a!==undefined)?a:this))}.property()};SC.CoreView.unload=function(){var a=SC.View.views;if(a){for(var b in a){if(!a.hasOwnProperty(b)){continue}delete a[b]}}};SC.View=SC.CoreView.extend({classNames:["sc-view"],displayProperties:["isFirstResponder"]});if(SC.browser.isIE){SC.Event.add(window,"unload",SC.View,SC.View.unload)}sc_require("views/view");sc_require("views/view/layout_style");SC.ANIMATABLE_PROPERTIES={top:YES,left:YES,bottom:YES,right:YES,width:YES,height:YES,centerX:YES,centerY:YES,opacity:YES,scale:YES,rotate:YES,rotateX:YES,rotateY:YES,rotateZ:YES};SC.View.reopen({didCreateLayerMixin:function(){if(SC.platform.supportsCSSTransitions){this.resetAnimation()}},animate:function(o,k,d,n){var g,p;if(typeof o===SC.T_STRING){g={};g[o]=k;p=d}else{g=o;p=k;n=d}var c=SC.typeOf(p);if(c===SC.T_NUMBER){p={duration:p}}else{if(c!==SC.T_HASH){throw"Must provide options hash or duration!"}}if(n){p.callback=n}var a=p.timing;if(a){if(typeof a!==SC.T_STRING){p.timing="cubic-bezier("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}}else{p.timing="linear"}var h=SC.clone(this.get("layout")),i=NO,j,m,b,f,l;if(!h.animate){h.animate={}}for(l in g){if(!g.hasOwnProperty(l)||!SC.ANIMATABLE_PROPERTIES[l]){continue}j=g[l];m=h[l];f=h.animate[l];if(j==null){throw"Can only animate to an actual value!"}if(m!==j||(f&&f.duration!==p.duration)){i=YES;h.animate[l]=p;h[l]=j}}if(i){this.set("layout",h)}return this},resetAnimation:function(){var c=this.get("layout"),f=c.animate,d=NO,b;if(!f){return}var a;for(b in f){d=YES;delete f[b]}if(d){this.set("layout",c);this.notifyPropertyChange("layout")}return this},transitionDidEnd:function(a){this.get("layoutStyleCalculator").transitionDidEnd(a)}});sc_require("ext/string");sc_require("views/view");sc_require("views/view/animation");SC.CSS_TRANSFORM_MAP={rotate:function(a){return null},rotateX:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateX("+a+")"},rotateY:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateY("+a+")"},rotateZ:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateZ("+a+")"},scale:function(a){if(SC.typeOf(a)===SC.T_ARRAY){a=a.join(", ")}return"scale("+a+")"}};SC.View.reopen({layoutStyleCalculator:null,layoutStyle:function(){var a={layout:this.get("layout"),turbo:this.get("hasAcceleratedLayer"),staticLayout:this.get("useStaticLayout")};var b=this.get("layoutStyleCalculator");b.set(a);return b.calculate()}.property().cacheable()});SC.View.LayoutStyleCalculator=SC.Object.extend({_layoutDidUpdate:function(){var h=this.get("layout");if(!h){return}this.dims=SC._VIEW_DEFAULT_DIMS;this.loc=this.dims.length;var o=(this.right=h.right);this.hasRight=(o!=null);var c=(this.left=h.left);this.hasLeft=(c!=null);var k=(this.top=h.top);this.hasTop=(k!=null);var a=(this.bottom=h.bottom);this.hasBottom=(a!=null);var b=(this.width=h.width);this.hasWidth=(b!=null);var p=(this.height=h.height);this.hasHeight=(p!=null);this.minWidth=((h.minWidth===undefined)?null:h.minWidth);var n=(this.maxWidth=(h.maxWidth===undefined)?null:h.maxWidth);this.hasMaxWidth=(n!=null);this.minHeight=(h.minHeight===undefined)?null:h.minHeight;var m=(this.maxHeight=(h.maxHeight===undefined)?null:h.maxHeight);this.hasMaxHeight=(m!=null);var g=(this.centerX=h.centerX);this.hasCenterX=(g!=null);var f=(this.centerY=h.centerY);this.hasCenterY=(f!=null);var d=(this.borderTop=((h.borderTop!==undefined)?h.borderTop:h.border)||0);var l=(this.borderRight=((h.borderRight!==undefined)?h.borderRight:h.border)||0);var j=(this.borderBottom=((h.borderBottom!==undefined)?h.borderBottom:h.border)||0);var i=(this.borderLeft=((h.borderLeft!==undefined)?h.borderLeft:h.border)||0);this.zIndex=(h.zIndex!=null)?h.zIndex.toString():null;this.opacity=(h.opacity!=null)?h.opacity.toString():null;this.backgroundPosition=(h.backgroundPosition!=null)?h.backgroundPosition:null;this.ret={marginTop:null,marginLeft:null}}.observes("layout"),_invalidAutoValue:function(b){var a=SC.Error.desc("%@.layout() you cannot use %@:auto if staticLayout is disabled".fmt(this.get("view"),b),"%@".fmt(this.get("view")),-1);SC.Logger.error(a.toString());throw a},_handleMistakes:function(){var c=this.get("layout");if(!this.staticLayout){if(this.width===SC.LAYOUT_AUTO){this._invalidAutoValue("width")}if(this.height===SC.LAYOUT_AUTO){this._invalidAutoValue("height")}}if(SC.platform.supportsCSSTransforms){var d=c.animate,a,b;if(d){for(b in d){if(SC.CSS_TRANSFORM_MAP[b]){if(this._pendingAnimations&&this._pendingAnimations["-"+SC.platform.cssPrefix+"-transform"]){throw"Animations of transforms must be executed simultaneously!"}if(a&&d[b].duration!==a){SC.Logger.warn("Can't animate transforms with different durations! Using first duration specified.");d[b].duration=a}a=d[b].duration}}}}},_calculatePosition:function(o){var h=null,a=this.get("turbo"),t=this.ret;var d,l,k,c,j,n,b,g,f,m,r,i,p,q;if(o==="x"){d="left";l="right";k="width";c="maxWidth";j="marginLeft";m="borderLeft";i="borderRight";n=this.hasLeft;b=this.hasRight;g=this.hasWidth;f=this.hasMaxWidth}else{d="top";l="bottom";k="height";c="maxHeight";j="marginTop";m="borderTop";i="borderBottom";n=this.hasTop;b=this.hasBottom;g=this.hasHeight;f=this.hasMaxHeight}t[d]=this._cssNumber(this[d]);t[l]=this._cssNumber(this[l]);r=this._cssNumber(this[m]);p=this._cssNumber(this[i]);t[m+"Width"]=r||null;t[i+"Width"]=p||null;q=this[k];if(q>=1){q-=(r+p)}t[k]=this._cssNumber(q);if(n){if(a){h=t[d];t[d]=0}if(b&&g){t[l]=null}}else{if(!b||(b&&!g&&!f)){t[d]=0}}if(!g&&!b){t[l]=0}return h},_calculateCenter:function(o){var j=this.ret,r,a,c,p,g,h,m,n,f;if(o==="x"){r="width";a="centerX";c="left";p="right";g="marginLeft";h="borderLeft";n="borderRight"}else{r="height";a="centerY";c="top";p="bottom";g="marginTop";h="borderTop";n="borderBottom"}j[c]="50%";m=this._cssNumber(this[h]);f=this._cssNumber(this[n]);j[h+"Width"]=m||null;j[n+"Width"]=f||null;var l=this[r],k=this[a],b=this[c];var i=SC.isPercentage(l),d=SC.isPercentage(k,YES);if(l>1){l-=(m+f)}if((i&&d)||(!i&&!d)){var q=k-l/2;j[g]=(i)?Math.floor(q*100)+"%":Math.floor(q)}else{SC.Logger.warn("You have to set "+r+" and "+a+" using both percentages or pixels");j[g]="50%"}j[r]=this._cssNumber(l)||0;j[p]=null},_calculateTransforms:function(f,i){if(SC.platform.supportsCSSTransforms){var h=this.get("layout");var b=SC.platform.domCSSPrefix+"Transform";var d=[];if(this.turbo){d.push("translateX("+(f||0)+"px)","translateY("+(i||0)+"px)");if(SC.platform.supportsCSS3DTransforms){d.push("translateZ(0px)")}}var g=SC.CSS_TRANSFORM_MAP;for(var a in g){var c=h[a];if(c!=null){d.push(g[a](c))}}this.ret[b]=d.length>0?d.join(" "):null}},_calculateAnimations:function(f,c){var d=this.layout,i=d.animate,h;if(!i){return}if(this.getPath("view.isAnimatable")){return}var g=[],b;this._animatedTransforms=[];if(!this._pendingAnimations){this._pendingAnimations={}}var j="-"+SC.platform.cssPrefix+"-transform";if(SC.platform.supportsCSSTransitions){for(h in i){b=i[h];var k=SC.CSS_TRANSFORM_MAP[h];var a=(h==="top"&&c!=null)||(h==="left"&&f!=null);if(SC.platform.supportsCSSTransforms&&(a||k)){this._animatedTransforms.push(h);h=j}b.css=h+" "+b.duration+"s "+b.timing;if(!this._pendingAnimations[h]){this._pendingAnimations[h]=b;g.push(b.css)}}this.ret[SC.platform.domCSSPrefix+"Transition"]=g.join(", ")}else{for(h in i){this._pendingAnimations[h]=i[h]}}delete d.animate},_cssNumber:function(a){if(a==null){return null}else{if(a===SC.LAYOUT_AUTO){return SC.LAYOUT_AUTO}else{if(SC.isPercentage(a)){return(a*100)+"%"}else{return Math.floor(a)}}}},calculate:function(){var d=this.get("layout"),b=null,m=this.get("staticLayout"),c=null,f=null,a=this.get("turbo"),h=this.ret,k=this.dims,g=this.loc,i=this.get("view"),l,j;this._handleMistakes(d);if(m&&d===SC.View.prototype.layout){return{}}if(this.hasLeft||this.hasRight||!this.hasCenterX){f=this._calculatePosition("x")}else{this._calculateCenter("x")}if(this.hasTop||this.hasBottom||!this.hasCenterY){c=this._calculatePosition("y")}else{this._calculateCenter("y")}h.minWidth=this.minWidth;h.maxWidth=this.maxWidth;h.minHeight=this.minHeight;h.maxHeight=this.maxHeight;h.zIndex=this.zIndex;h.opacity=this.opacity;h.backgroundPosition=this.backgroundPosition;this._calculateTransforms(f,c);this._calculateAnimations(f,c);for(l in h){j=h[l];if(typeof j===SC.T_NUMBER){h[l]=(j+"px")}}return h},willRenderAnimations:function(){if(SC.platform.supportsCSSTransitions){var k=this.get("view"),i=k.get("layer"),a=i?i.style:null,c=k.get("layoutStyle"),o=this._activeAnimations,d,g=this._pendingAnimations,f,q=this._animatedTransforms,j=q?q.length:0,b=c[SC.platform.domCSSPrefix+"Transition"],h=k.get("layout"),n,p,m,l;if(g){if(!o){o={}}for(n in g){if(!g.hasOwnProperty(n)){continue}f=g[n];d=o[n];l=NO;if(c[n]!==(a?a[n]:null)){l=YES}if(d&&(d.duration!==f.duration||d.timing!==f.timing)){l=YES}if(l&&d){if(p=d.callback){if(j>0){for(m=0;m<j;m++){this.runAnimationCallback(p,null,q[m],YES)}this._animatedTransforms=null}else{this.runAnimationCallback(p,null,n,YES)}}this.removeAnimationFromLayout(n,YES)}o[n]=f}}this._activeAnimations=o;this._pendingAnimations=null}},didRenderAnimations:function(){if(!SC.platform.supportsCSSTransitions){var a,b;for(a in this._pendingAnimations){b=this._pendingAnimations[a].callback;if(b){this.runAnimationCallback(b,null,a,NO)}this.removeAnimationFromLayout(a,NO,YES)}this._activeAnimations=this._pendingAnimations=null}},runAnimationCallback:function(f,b,c,d){var a=this.get("view");if(f){if(SC.typeOf(f)!==SC.T_HASH){f={action:f}}f.source=a;if(!f.target){f.target=this}}SC.View.runCallback(f,{event:b,propertyName:c,view:a,isCancelled:d})},transitionDidEnd:function(b){var c=b.originalEvent.propertyName,d,a;d=this._activeAnimations?this._activeAnimations[c]:null;if(d){if(d.callback){SC.RunLoop.begin();if(this._animatedTransforms&&this._animatedTransforms.length>0){for(a=0;a<this._animatedTransforms.length;a++){this.invokeLater("runAnimationCallback",1,d.callback,b,this._animatedTransforms[a],NO)}}else{this.invokeLater("runAnimationCallback",1,d.callback,b,c,NO)}SC.RunLoop.end()}this.removeAnimationFromLayout(c,YES)}},removeAnimationFromLayout:function(c,i,b){if(i){var f=this.getPath("view.layer"),h=[],d;for(d in this._activeAnimations){if(d!==c){h.push(this._activeAnimations[d].css)}}if(f){f.style[SC.platform.domCSSPrefix+"Transition"]=h.join(", ")}}var g=this.getPath("view.layout"),a;if(c==="-"+SC.platform.cssPrefix+"-transform"&&this._animatedTransforms&&this._animatedTransforms.length>0){for(a=0;a<this._animatedTransforms.length;a++){delete g["animate"+SC.String.capitalize(this._animatedTransforms[a])]}this._animatedTransforms=null}delete g["animate"+SC.String.capitalize(c)];if(!b){delete this._activeAnimations[c]}}});SC.CoreView.runCallback=function(h){var b=SC.$A(arguments).slice(1),a=SC.typeOf(h.action);if(a==SC.T_FUNCTION){h.action.apply(h.target,b)}else{if(a===SC.T_STRING){if(h.action.indexOf(".")>=0){var g=h.action.split(".");var d=g.pop();var f=SC.objectForPropertyPath(g,window);var c=f.get?f.get(d):f[d];if(c&&SC.typeOf(c)==SC.T_FUNCTION){c.apply(f,b)}else{throw"SC.runCallback could not find a function at %@".fmt(h.action)}}}}};SC.View.runCallback=SC.CoreView.runCallback;sc_require("views/view");sc_require("views/view/layout_style");SC.LAYOUT_HORIZONTAL="sc-layout-horizontal";SC.LAYOUT_VERTICAL="sc-layout-vertical";SC._VIEW_DEFAULT_DIMS=["marginTop","marginLeft"];SC.FULL_WIDTH={left:0,right:0};SC.FULL_HEIGHT={top:0,bottom:0};SC.ANCHOR_CENTER={centerX:0,centerY:0};SC.LAYOUT_AUTO="auto";SC.View.reopen({hasLayout:YES,concatenatedProperties:["layoutProperties"],backgroundColor:null,displayProperties:["backgroundColor"],useStaticLayout:NO,init:function(a){a();this.layoutStyleCalculator=SC.View.LayoutStyleCalculator.create({view:this});this._previousLayout=this.get("layout")}.enhance(),propertyDidChange:function(b,d,c){var a=false;if(typeof this.layout==="function"&&this._kvo_dependents){var f=this._kvo_dependents[b];if(f&&f.indexOf("layout")!=-1){a=true}}if(b==="layout"||a){this.layoutDidChange()}arguments.callee.base.apply(this,arguments)},adjust:function(a,d){var b=this.get("layout"),c=NO,g,f;if(a===undefined){return this}if(SC.typeOf(a)===SC.T_STRING){g=b[a];if(d===undefined||g==d){return this}b=SC.clone(b);if(d===null){delete b[a]}else{b[a]=d}c=YES}else{f=a;for(a in f){if(!f.hasOwnProperty(a)){continue}d=f[a];g=b[a];if(d===undefined||g==d){continue}if(!c){b=SC.clone(b)}if(d===null){delete b[a]}else{b[a]=d}c=YES}}if(c){this.set("layout",b)}return this},layout:{top:0,left:0,bottom:0,right:0},isFixedLayout:function(){var b=this.get("layout"),a;a=(((b.width!==undefined)&&(b.height!==undefined))&&((b.width!==SC.LAYOUT_AUTO)&&(b.height!==SC.LAYOUT_AUTO))&&((b.left!==undefined)&&(b.top!==undefined))&&((b.left!==SC.LAYOUT_AUTO)&&(b.top!==SC.LAYOUT_AUTO)));if(a){a=(!SC.isPercentage(b.top)&&!SC.isPercentage(b.left)&&!SC.isPercentage(b.width)&&!SC.isPercentage(b.height))}return a}.property("layout").cacheable(),convertFrameToView:function(j,d){var c=0,b=0,h=0,g=0,a=this,i;while(a){i=a.get("frame");c+=i.x;b+=i.y;a=a.get("layoutView")}if(d){a=d;while(a){i=a.get("frame");h+=i.x;g+=i.y;a=a.get("layoutView")}}c=j.x+c-h;b=j.y+b-g;return{x:c,y:b,width:j.width,height:j.height}},convertFrameFromView:function(j,d){var c=0,b=0,h=0,g=0,a=this,i;while(a&&(i=a.get("frame"))){c+=i.x;b+=i.y;a=a.get("parentView")}if(d){a=d;while(a){i=a.get("frame");h+=i.x;g+=i.y;a=a.get("parentView")}}c=j.x-c+h;b=j.y-b+g;return{x:c,y:b,width:j.width,height:j.height}},scrollToVisible:function(){var a=this.get("parentView");while(a&&!a.get("isScrollable")){a=a.get("parentView")}if(a){a.scrollToVisible();return a.scrollToVisible(this)}else{return NO}},_adjustForBorder:function(f,c){var g=((c.borderTop!==undefined)?c.borderTop:c.border)||0,d=((c.borderLeft!==undefined)?c.borderLeft:c.border)||0,b=((c.borderBottom!==undefined)?c.borderBottom:c.border)||0,a=((c.borderRight!==undefined)?c.borderRight:c.border)||0;f.x+=d;f.y+=g;f.width-=(d+a);f.height-=(g+b);return f},computeFrameWithParentFrame:function(n,h){var p,q=this.get("layout");if(this.get("useStaticLayout")){p=n();return p?this._adjustForBorder(p,q):null}else{p={}}var o,u,m=SC.LAYOUT_AUTO,l=this.get("parentView"),i,c,a=q.right,b=q.left,t=q.top,g=q.bottom,r=q.width,d=q.height,k=q.centerX,j=q.centerY;if(r===m){o=SC.Error.desc(("%@.layout() cannot use width:auto if staticLayout is disabled").fmt(this),"%@".fmt(this),-1);SC.Logger.error(o.toString());throw o}if(d===m){o=SC.Error.desc(("%@.layout() cannot use height:auto if staticLayout is disabled").fmt(this),"%@".fmt(this),-1);SC.Logger.error(o.toString());throw o}if(!h){h=this.computeParentDimensions(q)}i=h.height;c=h.width;if(!SC.none(b)){if(SC.isPercentage(b)){p.x=c*b}else{p.x=b}if(r!==undefined){if(r===m){p.width=m}else{if(SC.isPercentage(r)){p.width=c*r}else{p.width=r}}}else{p.width=c-p.x;if(a&&SC.isPercentage(a)){p.width=p.width-(a*c)}else{p.width=p.width-(a||0)}}}else{if(!SC.none(a)){if(SC.none(r)){if(SC.isPercentage(a)){p.width=c-(c*a)}else{p.width=c-a}p.x=0}else{if(r===m){p.width=m}else{if(SC.isPercentage(r)){p.width=c*r}else{p.width=(r||0)}}if(SC.isPercentage(r)){p.x=c-(a*c)-p.width}else{p.x=c-a-p.width}}}else{if(!SC.none(k)){if(r===m){p.width=m}else{if(SC.isPercentage(r)){p.width=r*c}else{p.width=(r||0)}}if(SC.isPercentage(k)){p.x=(c-p.width)/2+(k*c)}else{p.x=(c-p.width)/2+k}}else{p.x=0;if(SC.none(r)){p.width=c}else{if(r===m){p.width=m}if(SC.isPercentage(r)){p.width=r*c}else{p.width=(r||0)}}}}}if(!SC.none(t)){if(SC.isPercentage(t)){p.y=t*i}else{p.y=t}if(d!==undefined){if(d===m){p.height=m}else{if(SC.isPercentage(d)){p.height=d*i}else{p.height=d}}}else{if(g&&SC.isPercentage(g)){p.height=i-p.y-(g*i)}else{p.height=i-p.y-(g||0)}}}else{if(!SC.none(g)){if(SC.none(d)){if(SC.isPercentage(g)){p.height=i-(g*i)}else{p.height=i-g}p.y=0}else{if(d===m){p.height=m}if(d&&SC.isPercentage(d)){p.height=d*i}else{p.height=(d||0)}if(SC.isPercentage(g)){p.y=i-(g*i)-p.height}else{p.y=i-g-p.height}}}else{if(!SC.none(j)){if(d===m){p.height=m}if(d&&SC.isPercentage(d)){p.height=d*i}else{p.height=(d||0)}if(SC.isPercentage(j)){p.y=(i-p.height)/2+(j*i)}else{p.y=(i-p.height)/2+j}}else{p.y=0;if(SC.none(d)){p.height=i}else{if(d===m){p.height=m}if(SC.isPercentage(d)){p.height=d*i}else{p.height=d||0}}}}}p.x=Math.floor(p.x);p.y=Math.floor(p.y);if(p.height!==m){p.height=Math.floor(p.height)}if(p.width!==m){p.width=Math.floor(p.width)}if(p.height===m||p.width===m){u=this.get("layer");if(p.height===m){p.height=u?u.clientHeight:0}if(p.width===m){p.width=u?u.clientWidth:0}}p=this._adjustForBorder(p,q);if(l&&l.isScrollContainer){l=l.get("parentView");p.x-=l.get("horizontalScrollOffset");p.y-=l.get("verticalScrollOffset")}if(!SC.none(q.maxHeight)&&(p.height>q.maxHeight)){p.height=q.maxHeight}if(!SC.none(q.minHeight)&&(p.height<q.minHeight)){p.height=q.minHeight}if(!SC.none(q.maxWidth)&&(p.width>q.maxWidth)){p.width=q.maxWidth}if(!SC.none(q.minWidth)&&(p.width<q.minWidth)){p.width=q.minWidth}if(p.height<0){p.height=0}if(p.width<0){p.width=0}return p}.enhance(),computeParentDimensions:function(g){var b,c=this.get("parentView"),a=(c)?c.get("frame"):null;if(a){b={width:a.width,height:a.height}}else{var d=g||{};b={width:(d.left||0)+(d.width||0)+(d.right||0),height:(d.top||0)+(d.height||0)+(d.bottom||0)}}return b},borderFrame:function(){var d=this.get("layout"),g=this.get("frame"),a=d.border,f=((d.topBorder!==undefined)?d.topBorder:d.border)||0,c=((d.rightBorder!==undefined)?d.rightBorder:d.border)||0,h=((d.bottomBorder!==undefined)?d.bottomBorder:d.border)||0,b=((d.leftBorder!==undefined)?d.leftBorder:d.border)||0;return{x:g.x-b,y:g.y-f,width:g.width+b+c,height:g.height+f+h}}.property("frame").cacheable(),parentViewDidResize:function(){var a;a=this.useStaticLayout||!this.get("isFixedLayout");if(a){this.viewDidResize()}},viewDidResize:function(){this._viewFrameDidChange();var d=this.childViews,b,a,c;for(a=0;a<(b=d.length);++a){c=d[a];c.tryToPerform("parentViewDidResize")}},_viewFrameDidChange:function(){this.notifyPropertyChange("frame");this._sc_view_clippingFrameDidChange()},beginLiveResize:function(){if(this.willBeginLiveResize){this.willBeginLiveResize()}var d=this.get("childViews"),b=d.length,a,c;for(a=0;a<b;++a){c=d[a];if(c.beginLiveResize){c.beginLiveResize()}}return this},endLiveResize:function(){var d=this.get("childViews"),b=d.length,a,c;for(a=b-1;a>=0;--a){c=d[a];if(c.endLiveResize){c.endLiveResize()}}if(this.didEndLiveResize){this.didEndLiveResize()}return this},layoutView:function(){return this.get("parentView")}.property("parentView").cacheable(),layoutDidChange:function(){var h=this._previousLayout,g=this.get("layout"),j=YES,d,c,a,b;if(!SC.none(g.rotate)){if(SC.none(g.rotateX)){g.rotateX=g.rotate;SC.Logger.warn("Please set rotateX instead of rotate")}}if(!SC.none(g.rotateX)){g.rotate=g.rotateX}else{delete g.rotate}var i=g.animations;if(i){if(!SC.none(i.rotate)){if(SC.none(i.rotateX)){i.rotateX=i.rotate;SC.Logger.warn("Please animate rotateX instead of rotate")}}if(!SC.none(i.rotateX)){i.rotate=i.rotateX}else{delete i.rotate}}if(h&&h!==g){d=h.width;if(d!==undefined){a=g.width;if(d===a){c=h.height;if(h!==undefined){b=g.height;if(c===b){j=NO}}}}}this.beginPropertyChanges();this.notifyPropertyChange("hasAcceleratedLayer");this.notifyPropertyChange("layoutStyle");if(j){this.viewDidResize()}else{this._viewFrameDidChange()}this.endPropertyChanges();var f=this.get("layoutView");if(f){f.set("childViewsNeedLayout",YES);f.layoutDidChangeFor(this);if(f.get("childViewsNeedLayout")){f.invokeOnce(f.layoutChildViewsIfNeeded)}}this._previousLayout=g;return this},childViewsNeedLayout:NO,layoutDidChangeFor:function(b){var a=this._needLayoutViews;if(!a){a=this._needLayoutViews=SC.CoreSet.create()}a.add(b)},layoutChildViewsIfNeeded:function(a){if(!a){a=this.get("isVisibleInWindow")}if(a&&this.get("childViewsNeedLayout")){this.set("childViewsNeedLayout",NO);this.layoutChildViews()}return this},layoutChildViews:function(){var c=this._needLayoutViews,a=c?c.length:0,b;for(b=0;b<a;++b){c[b].updateLayout()}c.clear()},updateLayout:function(){var b=this.get("layer"),a;if(b){a=this.renderContext(b);this.renderLayout(a,NO);a.update();if(this.useStaticLayout){this.viewDidResize()}}b=null;return this},renderLayout:function(a,b){this.get("layoutStyleCalculator").willRenderAnimations();a.addStyle(this.get("layoutStyle"));this.get("layoutStyleCalculator").didRenderAnimations()},_renderLayerSettings:function(b,a,c){b(a,c);this.renderLayout(a,c)}.enhance(),applyAttributesToContext:function(b,a){b(a);if(this.get("useStaticLayout")){a.addClass("sc-static-layout")}if(this.get("backgroundColor")){a.css("backgroundColor",this.get("backgroundColor"))}}.enhance()});SC.View.mixin({convertLayoutToAnchoredLayout:function(g,n){var i={top:0,left:0,width:n.width,height:n.height},d=n.width,l=n.height,m=g.right,a=g.left,k=g.top,h=g.bottom,j=g.width,f=g.height,c=g.centerX,b=g.centerY;if(!SC.none(a)){if(SC.isPercentage(a)){i.left=a*d}else{i.left=a}if(j!==undefined){if(j===SC.LAYOUT_AUTO){i.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(j)){i.width=j*d}else{i.width=j}}}else{if(m&&SC.isPercentage(m)){i.width=d-i.left-(m*d)}else{i.width=d-i.left-(m||0)}}}else{if(!SC.none(m)){if(SC.none(j)){i.left=0;if(m&&SC.isPercentage(m)){i.width=d-(m*d)}else{i.width=d-(m||0)}}else{if(j===SC.LAYOUT_AUTO){i.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(j)){i.width=j*d}else{i.width=j}if(SC.isPercentage(m)){i.left=d-(i.width+m)}else{i.left=d-(i.width+m)}}}}else{if(!SC.none(c)){if(j&&SC.isPercentage(j)){i.width=(j*d)}else{i.width=(j||0)}i.left=((d-i.width)/2);if(SC.isPercentage(c)){i.left=i.left+c*d}else{i.left=i.left+c}}else{if(!SC.none(j)){i.left=0;if(j===SC.LAYOUT_AUTO){i.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(j)){i.width=j*d}else{i.width=j}}}else{i.left=0;i.width=0}}}}if(g.minWidth!==undefined){i.minWidth=g.minWidth}if(g.maxWidth!==undefined){i.maxWidth=g.maxWidth}if(!SC.none(k)){if(SC.isPercentage(k)){i.top=k*l}else{i.top=k}if(f!==undefined){if(f===SC.LAYOUT_AUTO){i.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(f)){i.height=f*l}else{i.height=f}}}else{i.height=l-i.top;if(h&&SC.isPercentage(h)){i.height=i.height-(h*l)}else{i.height=i.height-(h||0)}}}else{if(!SC.none(h)){if(SC.none(f)){i.top=0;if(h&&SC.isPercentage(h)){i.height=l-(h*l)}else{i.height=l-(h||0)}}else{if(f===SC.LAYOUT_AUTO){i.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(f)){i.height=f*l}else{i.height=f}i.top=l-i.height;if(SC.isPercentage(h)){i.top=i.top-(h*l)}else{i.top=i.top-h}}}}else{if(!SC.none(b)){if(f&&SC.isPercentage(f)){i.height=(f*l)}else{i.height=(f||0)}i.top=((l-i.height)/2);if(SC.isPercentage(b)){i.top=i.top+b*l}else{i.top=i.top+b}}else{if(!SC.none(f)){i.top=0;if(f===SC.LAYOUT_AUTO){i.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(f)){i.height=f*l}else{i.height=f}}}else{i.top=0;i.height=0}}}}if(i.top){i.top=Math.floor(i.top)}if(i.bottom){i.bottom=Math.floor(i.bottom)}if(i.left){i.left=Math.floor(i.left)}if(i.right){i.right=Math.floor(i.right)}if(i.width!==SC.LAYOUT_AUTO){i.width=Math.floor(i.width)}if(i.height!==SC.LAYOUT_AUTO){i.height=Math.floor(i.height)}if(g.minHeight!==undefined){i.minHeight=g.minHeight}if(g.maxHeight!==undefined){i.maxHeight=g.maxHeight}return i},convertLayoutToCustomLayout:function(b,a,c){}});sc_require("views/view");sc_require("views/view/layout");sc_require("views/view/layout_style");SC.View.reopen({wantsAcceleratedLayer:NO,hasAcceleratedLayer:function(){if(this.get("wantsAcceleratedLayer")&&SC.platform.supportsAcceleratedLayers){var c=this.get("layout"),d=c.animate,b=SC.LAYOUT_AUTO,a;if(d&&(d.top||d.left)){for(a in d){if(SC.CSS_TRANSFORM_MAP[a]&&((d.top&&d.top.duration!==d[a].duration)||(d.left&&d.left.duration!==d[a].duration))){return NO}}}return this.get("isFixedLayout")}return NO}.property("wantsAcceleratedLayer").cacheable()});sc_require("views/view");SC.View.reopen({cursor:function(a,c){var b;if(c){this._setCursor=c}if(this._setCursor!==undefined){return this._setCursor}b=this.get("parentView");if(this.get("shouldInheritCursor")&&b){return b.get("cursor")}return null}.property("parentView","shouldInheritCursor").cacheable(),applyAttributesToContext:function(b,a){var c=this.get("cursor");if(c){a.addClass(c.get("className"))}b(a)}.enhance(),shouldInheritCursor:YES});sc_require("views/view");SC.View.reopen({isEnabled:YES,isEnabledBindingDefault:SC.Binding.oneWay().bool(),isEnabledInPane:function(){var a=this.get("isEnabled"),b;if(a&&(b=this.get("parentView"))){a=b.get("isEnabledInPane")}return a}.property("parentView","isEnabled"),_sc_view_isEnabledDidChange:function(){if(!this.get("isEnabled")&&this.get("isFirstResponder")){this.resignFirstResponder()}}.observes("isEnabled"),applyAttributesToContext:function(b,a){var c=this.get("isEnabled");b(a);a.setClass("disabled",!c);a.attr("aria-disabled",!c?"true":null)}.enhance()});sc_require("views/view");SC.View.reopen({isKeyResponder:NO,willLoseKeyResponderTo:function(a){},willBecomeKeyResponderFrom:function(a){},didLoseKeyResponderTo:function(a){},didBecomeKeyResponderFrom:function(a){},interpretKeyEvents:function(b){var a=b.commandCodes(),d=a[0],f=a[1],h;if(!d&&!f){return null}if(d){var i=SC.MODIFIED_KEY_BINDINGS[d]||SC.BASE_KEY_BINDINGS[d.match(/[^_]+$/)[0]];if(i){var g=this,c=this.get("pane"),j=null;while(g&&!(j=g.tryToPerform(i,b))){g=(g===c)?null:g.get("nextResponder")}return j}}if(f&&this.respondsTo("insertText")){h=this.insertText(f,b);return h?(h===YES?this:h):null}return null},insertText:function(a){return NO},performKeyEquivalent:function(g,d){var f=NO,h=this.get("childViews"),b=h.length,a=-1,c;while(!f&&(++a<b)){c=h[a];f=c.tryToPerform("performKeyEquivalent",g,d)}return f},firstKeyView:null,_getFirstKeyView:function(){var a=this.get("firstKeyView");if(a){return a}var b=this.get("childViews");if(b){return b[0]}},lastKeyView:null,_getLastKeyView:function(){var d=this.get("lastKeyView");if(d){return d}var a,b=this.get("firstKeyView");if(b){while(a=b._getNextKeyView()){b=a}return b}else{var c=this.get("childViews");if(c){return c[c.length-1]}}},nextKeyView:undefined,_getNextKeyView:function(){var b=this.get("parentView"),a=this.get("nextKeyView");if(b&&b.get("lastKeyView")===this){return null}if(a!==undefined){return a}if(b){var c=b.get("childViews");return c[c.indexOf(this)+1]}},nextValidKeyView:function(){var b=this,a;while(a!==this){a=null;if(b.get("isVisibleInWindow")){a=b._getFirstKeyView()}if(!a){a=b._getNextKeyView()}if(!a){while(b=b.get("parentView")){if(a=b._getNextKeyView()){break}}}if(!a){if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){break}else{a=this.get("pane")}}if(a.get("isVisibleInWindow")&&a.get("acceptsFirstResponder")){return a}b=a}return null}.property("nextKeyView"),previousKeyView:undefined,_getPreviousKeyView:function(){var b=this.get("parentView"),a=this.get("previousKeyView");if(b&&b.get("firstKeyView")===this){return null}if(a!==undefined){return a}if(b){var c=b.get("childViews");return c[c.indexOf(this)-1]}},previousValidKeyView:function(){var b=this,a;while(a!==this){if(b.get("parentView")){a=b._getPreviousKeyView()}else{if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){break}else{a=b}}if(a){do{b=a;a=a._getLastKeyView()}while(a&&a.get("isVisibleInWindow"));if(!a){a=b}}else{a=b.get("parentView")}if(a.get("isVisibleInWindow")&&a.get("acceptsFirstResponder")){return a}b=a}return null}.property("previousKeyView")});sc_require("views/view");SC.View.reopen({_lastLayerId:null,layerIdDidChange:function(){var a=this.get("layer"),b=this.get("layerId"),c=this._lastLayerId;if(b!==c){if(c&&SC.View.views[c]===this){delete SC.View.views[c]}this._lastLayerId=b;SC.View.views[b]=this;if(a){a.id=b}}}.observes("layerId"),parentViewDidChange:function(){this.recomputeIsVisibleInWindow();this.resetBuildState();this.set("layerLocationNeedsUpdate",YES);this.invokeOnce(this.updateLayerLocationIfNeeded);this._invalidatePaneCacheForSelfAndAllChildViews();return this},_invalidatePaneCacheForSelfAndAllChildViews:function(){var d,c=this.get("childViews"),b=c.length,a;this.notifyPropertyChange("pane");for(a=0;a<b;++a){d=c[a];if(d._invalidatePaneCacheForSelfAndAllChildViews){d._invalidatePaneCacheForSelfAndAllChildViews()}}},insertBefore:function(b,d){b.beginPropertyChanges();if(b.get("parentView")){b.removeFromParent()}if(this.willAddChild){this.willAddChild(b,d)}if(b.willAddToParent){b.willAddToParent(this,d)}b.set("parentView",this);var a,c=this.get("childViews");if(c.needsClone){this.set(c=[])}a=(d)?c.indexOf(d):c.length;if(a<0){a=c.length}c.insertAt(a,b);if(b.parentViewDidChange){b.parentViewDidChange()}if(b.layoutDidChange){b.layoutDidChange()}b.endPropertyChanges();this.invokeLast(function(){var f=b.get("pane");if(f&&f.get("isPaneAttached")){b._notifyDidAppendToDocument()}});if(this.didAddChild){this.didAddChild(b,d)}if(b.didAddToParent){b.didAddToParent(this,d)}return this},removeChild:function(b,a){if(!a){return this}if(a.parentView!==this){throw"%@.removeChild(%@) must belong to parent".fmt(this,a)}if(a.willRemoveFromParent){a.willRemoveFromParent()}if(this.willRemoveChild){this.willRemoveChild(a)}b(a);if(a.parentViewDidChange){a.parentViewDidChange()}if(this.didRemoveChild){this.didRemoveChild(a)}if(a.didRemoveFromParent){a.didRemoveFromParent(this)}return this}.enhance(),replaceChild:function(a,b){a.beginPropertyChanges();b.beginPropertyChanges();this.beginPropertyChanges();this.insertBefore(a,b).removeChild(b);this.endPropertyChanges();b.endPropertyChanges();a.endPropertyChanges();return this},replaceAllChildren:function(c){var b=c.get("length"),a;this.beginPropertyChanges();this.destroyLayer().removeAllChildren();for(a=0;a<b;a++){this.appendChild(c.objectAt(a))}this.replaceLayer();this.endPropertyChanges();return this},appendChild:function(a){return this.insertBefore(a,null)},buildInChild:function(a){a.willBuildInToView(this);this.appendChild(a);a.buildInToView(this)},buildOutChild:function(a){a.buildOutFromView(this)},buildInDidFinishFor:function(a){},buildOutDidFinishFor:function(a){this.removeChild(a)},isBuildingIn:NO,isBuildingOut:NO,buildIn:function(){this.buildInDidFinish()},buildOut:function(){this.buildOutDidFinish()},resetBuild:function(){},buildOutDidCancel:function(){},buildInDidCancel:function(){},buildInDidFinish:function(){this.isBuildingIn=NO;this._buildingInTo.buildInDidFinishFor(this);this._buildingInTo=null},buildOutDidFinish:function(){this.isBuildingOut=NO;this._buildingOutFrom.buildOutDidFinishFor(this);this._buildingOutFrom=null},resetBuildState:function(){if(this.isBuildingIn){this.buildInDidCancel();this.isBuildingIn=NO}if(this.isBuildingOut){this.buildOutDidCancel();this.isBuildingOut=NO}this.buildingInTo=null;this.buildingOutFrom=null;this.resetBuild()},willBuildInToView:function(a){if(this.isBuildingOut){this.buildOutDidCancel()}},buildInToView:function(a){if(this.isBuildingIn){return}this._buildingInTo=a;this.isBuildingOut=NO;this.isBuildingIn=YES;this.buildIn()},buildOutFromView:function(a){if(this.isBuildingOut){return}if(this.isBuildingIn){this.buildInDidCancel()}this.isBuildingOut=YES;this.isBuildingIn=NO;this._buildingOutFrom=a;this.buildOut()}});sc_require("views/view");SC.View.reopen({init:function(a){a();this._lastTheme=this.get("theme")}.enhance(),themeName:null,baseThemeName:null,theme:function(){var b=this.get("baseTheme"),a=this.get("themeName");if(a){var c;if(b){c=b.find(a);if(c){return c}}c=SC.Theme.find(a);if(c){return c}return b.invisibleSubtheme(a)}return b}.property("baseTheme","themeName").cacheable(),_sc_view_themeDidChange:function(){if(this._lastTheme===this.get("theme")){return}this._lastTheme=this.get("theme");var c=this.childViews,b=c.length,a;for(a=0;a<b;a++){c[a].notifyPropertyChange("baseTheme")}if(this.get("layer")){this.replaceLayer()}}.observes("theme"),baseTheme:function(){var b;var a=this.get("baseThemeName");if(a){return SC.Theme.find(a)}else{b=this.get("parentView");var c=b&&b.get("theme");return c||SC.Theme.find(SC.defaultTheme)}}.property("baseThemeName","parentView").cacheable(),renderDelegate:function(c,d){if(d){this._setRenderDelegate=d}if(this._setRenderDelegate){return this._setRenderDelegate}var a=this.get("renderDelegateName"),b;if(a){b=this.get("theme")[a];if(!b){throw'%@: Unable to locate render delegate "%@" in theme.'.fmt(this,a)}return b}return null}.property("renderDelegateName","theme"),renderDelegateName:null,renderDelegateProxy:function(){return SC.View._RenderDelegateProxy.createForView(this)}.property("renderDelegate").cacheable(),render:function(b,c){var a=this.get("renderDelegate");if(a){if(c){a.render(this.get("renderDelegateProxy"),b)}else{a.update(this.get("renderDelegateProxy"),b.$())}}},applyAttributesToContext:function(g,f){var h=this.get("theme");var c=h.classNames,b,a=c.length;for(b=0;b<a;b++){f.addClass(c[b])}g(f);var d=this.get("renderDelegate");if(d&&d.className){f.addClass(d.className)}}.enhance(),invokeRenderDelegateMethod:function(c,b){var a=this.get("renderDelegate");if(!a){return undefined}if(SC.typeOf(a[c])!==SC.T_FUNCTION){return undefined}b=SC.$A(arguments);b.shift();b.unshift(this.get("renderDelegateProxy"));return a[c].apply(a,b)}});SC.View._RenderDelegateProxy={isViewRenderDelegateProxy:YES,createForView:function(c){var d=SC.beget(this);var g=c.get("displayProperties"),f={};for(var b=0,a=g.length;b<a;b++){f[g[b]]=YES}f.theme=YES;d._displayPropertiesLookup=f;d.renderState={};d._view=c;return d},get:function(b){if(this[b]!==undefined){return this[b]}var a="display"+b.capitalize();if(this._displayPropertiesLookup[a]){return this._view.get(a)}else{if(this._displayPropertiesLookup[b]){return this._view.get(b)}}return undefined},didChangeFor:function(d){var b=arguments.length,a;for(a=1;a<b;a++){var f=arguments[a],c="display"+f.capitalize();if(this._displayPropertiesLookup[c]){if(this._view.didChangeFor(d,c)){return YES}}else{if(this._displayPropertiesLookup[f]){if(this._view.didChangeFor(d,f)){return YES}}}}return NO}};SC.propertyFromRenderDelegate=function(a,b){return function(g,h){if(h!==undefined){this["_set_rd_"+g]=h}var d=this["_set_rd_"+g];if(d!==undefined){return d}var c=this.get("renderDelegate");if(c&&c.get){var f=this.get("renderDelegateProxy");d=c.getPropertyFor(f,a)}if(d!==undefined){return d}return b}.property("renderDelegate").cacheable()};sc_require("views/view");SC.View.reopen({acceptsMultitouch:NO,hasTouch:NO,touchBoundary:{left:50,right:50,top:50,bottom:50},_touchBoundaryFrame:function(){return this.get("parentView").convertFrameToView(this.get("frame"),null)}.property("frame","parentView").cacheable(),touchIsInBoundary:function(i){var c=this.get("_touchBoundaryFrame"),d=0,b=0,h=this.get("touchBoundary");var a=i.pageX,g=i.pageY;if(a<c.x){a=c.x-a;d=h.left}else{if(a>c.x+c.width){a=a-(c.x+c.width);d=h.right}else{a=0;d=1}}if(g<c.y){g=c.y-g;b=h.top}else{if(g>c.y+c.height){g=g-(c.y+c.height);b=h.bottom}else{g=0;b=1}}if(a>100||g>100){return NO}return YES}});sc_require("views/view");SC.View.reopen({hasVisibility:YES,isVisibleInWindow:NO,isContextMenuEnabled:function(){return SC.CONTEXT_MENU_ENABLED}.property(),recomputeIsVisibleInWindow:function(d){var g=this.get("isVisibleInWindow"),i=this.get("isVisible"),f;if(i){if(d===undefined){f=this.get("parentView");d=f?f.get("isVisibleInWindow"):NO}i=i&&d}if(g!==i){this.set("isVisibleInWindow",i);var h=this.get("childViews"),b=h.length,a,c;for(a=0;a<b;a++){c=h[a];if(c.recomputeIsVisibleInWindow){c.recomputeIsVisibleInWindow(i)}}if(i){if(this.get("childViewsNeedLayout")){this.invokeOnce(this.layoutChildViewsIfNeeded)}}else{if(this.get("isFirstResponder")){this.resignFirstResponder()}}}this.updateLayerIfNeeded(YES);return this},_sc_isVisibleDidChange:function(){this.displayDidChange();this.recomputeIsVisibleInWindow()}.observes("isVisible")});sc_require("views/view");sc_require("views/view/acceleration");sc_require("views/view/cursor");sc_require("views/view/enabled");sc_require("views/view/keyboard");sc_require("views/view/layout");sc_require("views/view/manipulation");sc_require("views/view/theming");sc_require("views/view/touch");sc_require("views/view/visibility");sc_require("mixins/responder_context");SC.MIXED_STATE="__MIXED__";SC.Pane=SC.View.extend(SC.ResponderContext,{isPane:YES,page:null,rootResponder:null,sendEvent:function(c,a,d){var b;if(!d){d=this.get("firstResponder")}while(d){if(c==="touchStart"){if(a.touchResponder===d){d=null;break}if(!d.get("hasTouch")||d.get("acceptsMultitouch")){if(d.tryToPerform("touchStart",a)){break}}}else{if(c==="touchEnd"&&!d.get("acceptsMultitouch")){if(!d.get("hasTouch")){if(d.tryToPerform("touchEnd",a)){break}}}else{if(d.tryToPerform(c,a)){break}}}d=(d===this)?null:d.get("nextResponder")}if(!d&&(d=this.get("defaultResponder"))){if(typeof d===SC.T_STRING){d=SC.objectForPropertyPath(d)}if(!d){d=null}else{d=d.tryToPerform(c,a)?d:null}}else{if(!d&&!(d=this.get("defaultResponder"))){d=this.tryToPerform(c,a)?this:null}}return a.mouseHandler||d},nextResponder:function(){return null}.property().cacheable(),firstResponder:null,acceptsKeyPane:YES,isKeyPane:NO,becomeKeyPane:function(){if(this.get("isKeyPane")){return this}if(this.rootResponder){this.rootResponder.makeKeyPane(this)}return this},resignKeyPane:function(){if(!this.get("isKeyPane")){return this}if(this.rootResponder){this.rootResponder.makeKeyPane(null)}return this},makeFirstResponder:function(c,b,a){if(!b){b=this}var f=this.get("firstResponder"),d=this.get("isKeyPane");if(f===b){return this}if(SC.platform.touch&&b&&b.kindOf(SC.TextFieldView)&&!b.get("focused")){return this}if(d){if(f){f.tryToPerform("willLoseKeyResponderTo",b)}if(b){b.tryToPerform("willBecomeKeyResponderFrom",f)}}if(f){f.beginPropertyChanges();f.set("isKeyResponder",NO)}if(b){b.beginPropertyChanges();b.set("isKeyResponder",d)}c(b,a);if(f){f.endPropertyChanges()}if(b){b.endPropertyChanges()}if(d){if(b){b.tryToPerform("didBecomeKeyResponderFrom",f)}if(f){f.tryToPerform("didLoseKeyResponderTo",b)}}return this}.enhance(),willLoseKeyPaneTo:function(a){this._forwardKeyChange(this.get("isKeyPane"),"willLoseKeyResponderTo",a,NO);return this},willBecomeKeyPaneFrom:function(a){this._forwardKeyChange(!this.get("isKeyPane"),"willBecomeKeyResponderFrom",a,YES);return this},didBecomeKeyResponderFrom:function(a){},didLoseKeyPaneTo:function(b){var a=this.get("isKeyPane");this.set("isKeyPane",NO);this._forwardKeyChange(a,"didLoseKeyResponderTo",b);return this},didBecomeKeyPaneFrom:function(b){var a=this.get("isKeyPane");this.set("isKeyPane",YES);this._forwardKeyChange(!a,"didBecomeKeyResponderFrom",b,YES);return this},isMainPane:NO,focusFrom:function(a){},blurTo:function(a){},blurMainTo:function(a){this.set("isMainPane",NO)},focusMainFrom:function(a){this.set("isMainPane",YES)},append:function(){return this.appendTo(document.body)},remove:function(){if(!this.get("isVisibleInWindow")){return this}if(!this.get("isPaneAttached")){return this}var b=this.get("layer");if(b&&b.parentNode){b.parentNode.removeChild(b)}b=null;this._removeIntercept();this.resignKeyPane();var a=this.rootResponder;if(this.get("isMainPane")){a.makeMainPane(null)}a.panes.remove(this);this.rootResponder=null;this.set("isPaneAttached",NO);this.parentViewDidChange();return this},insert:function(b){var a=this.get("layer");if(!a){a=this.createLayer().get("layer")}b(a);if(!this.get("isPaneAttached")){this.paneDidAttach()}return this},appendTo:function(a){return this.insert(function(b){jQuery(a).append(b)})},paneDidAttach:function(){var a=(this.rootResponder=SC.RootResponder.responder);a.panes.add(this);this.set("isPaneAttached",YES);this.recomputeDependentProperties();this._notifyDidAppendToDocument();this._addIntercept();return this},recomputeDependentProperties:function(){},isPaneAttached:NO,wantsTouchIntercept:NO,hasTouchIntercept:function(){return this.get("wantsTouchIntercept")&&SC.platform.touch}.property("wantsTouchIntercept").cacheable(),zIndex:0,touchZ:99,_addIntercept:function(){if(this.get("hasTouchIntercept")){var b=document.createElement("div");var a=b.style;a.position="absolute";a.left="0px";a.top="0px";a.right="0px";a.bottom="0px";a.webkitTransform="translateZ(0px)";a.zIndex=this.get("zIndex")+this.get("touchZ");b.className="touch-intercept";b.id="touch-intercept-"+SC.guidFor(this);this._touchIntercept=b;document.body.appendChild(b)}},_removeIntercept:function(){if(this._touchIntercept){document.body.removeChild(this._touchIntercept);this._touchIntercept=null}},hideTouchIntercept:function(){if(this._touchIntercept){this._touchIntercept.style.display="none"}},showTouchIntercept:function(){if(this._touchIntercept){this._touchIntercept.style.display="block"}},recomputeIsVisibleInWindow:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}var d=this.get("isVisibleInWindow"),g=this.get("isVisible")&&this.get("isPaneAttached");if(d!==g){this.set("isVisibleInWindow",g);var f=this.get("childViews"),b=f.length,a,c;for(a=0;a<b;a++){c=f[a];if(c.recomputeIsVisibleInWindow){c.recomputeIsVisibleInWindow(g)}}if(g){if(this.get("childViewsNeedLayout")){this.invokeOnce(this.layoutChildViewsIfNeeded)}}else{if(this.get("isKeyPane")){this.resignKeyPane()}}}this.updateLayerIfNeeded(YES);return this},updateLayerLocation:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}return this},init:function(){if(this.hasTouchIntercept===YES){SC.Logger.warn("Do not set hasTouchIntercept directly. Use wantsTouchIntercept instead.");this.hasTouchIntercept=SC.platform.touch}var a=!!this.get("layer");arguments.callee.base.apply(this,arguments);if(a){this.paneDidAttach()}},classNames:["sc-pane"]});sc_require("panes/pane");SC.Pane.reopen({performKeyEquivalent:function(c,a){var b=arguments.callee.base.apply(this,arguments);if(!b){var d=this.get("defaultResponder");if(d){if(d.performKeyEquivalent){b=d.performKeyEquivalent(c,a)}if(!b&&d.tryToPerform){b=d.tryToPerform(c,a)}}}return b},keyDown:function(a){var b;if(a.keyCode===9&&!this.get("firstResponder")){if(a.shiftKey){b=this.get("previousValidKeyView")}else{b=this.get("nextValidKeyView")}if(b){this.makeFirstResponder(b);return YES}else{if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){a.allowDefault()}}}return NO},_forwardKeyChange:function(d,b,h,g){var c,a,f;if(d&&(a=this.get("firstResponder"))){f=(h)?h.get("firstResponder"):null;c=this.get("firstResponder");if(c&&c[b]){c[b](f)}if((g!==undefined)&&a){a.set("isKeyResponder",g)}}}});sc_require("panes/pane");SC.Pane.reopen({currentWindowSize:null,computeParentDimensions:function(c){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}var d={x:0,y:0,width:1000,height:1000},b=this.get("layout");if(document&&document.body){d.width=document.body.clientWidth;d.height=document.body.clientHeight;if(SC.browser.name===SC.BROWSER.ie&&SC.browser.compareVersion(SC.browser.version,"7")===0){var a=SC.platform.get("scrollbarSize");if(document.body.scrollWidth>d.width){d.width-=a}if(document.body.scrollHeight>d.height){d.height-=a}}}if(b.minHeight||b.minWidth){if(b.minHeight){d.height=Math.max(d.height,b.minHeight)}if(b.minWidth){d.width=Math.max(d.width,b.minWidth)}}return d},frame:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}return this.computeFrameWithParentFrame(null)}.property(),windowSizeDidChange:function(b,a){this.set("currentWindowSize",a);this.setBodyOverflowIfNeeded();this.parentViewDidResize();return this},setBodyOverflowIfNeeded:function(f){var d=this.get("layout"),b=this.get("currentWindowSize");if(!d||!b||!b.width||!b.height){return}var a=d.minWidth,c=d.minHeight;if(f===true||a||c){if((c&&b.height<c)||(a&&b.width<a)){SC.bodyOverflowArbitrator.requestVisible(this)}else{SC.bodyOverflowArbitrator.requestHidden(this)}}},paneLayoutDidChange:function(){this.invokeOnce(this.updateLayout);this.setBodyOverflowIfNeeded()}.observes("layout"),recomputeDependentProperties:function(a){this.set("currentWindowSize",this.rootResponder.computeWindowSize());a()}.enhance()});sc_require("panes/pane");SC.Pane.reopen({prependTo:function(a){return this.insert(function(b){jQuery(a).prepend(b)})},removeFromParent:function(){throw SC.Error.desc("SC.Pane cannot be removed from its parent, since it's the root. Did you mean remove()?")}});sc_require("panes/pane");SC.Pane.reopen({recomputeDependentProperties:function(a){this.recomputeIsVisibleInWindow();a()}.enhance()});SC.Application=SC.Responder.extend(SC.ResponderContext,{});SC.BENCHMARK_LOG_READY=YES;sc_require("system/event");SC.mixin({isReady:NO,suppressOnReady:SC.suppressOnReady?YES:NO,suppressMain:SC.suppressMain?YES:NO,ready:function(b,c){var a=SC._readyQueue;if(c===undefined){c=b;b=null}else{if(SC.typeOf(c)===SC.T_STRING){c=b[c]}}if(SC.isReady){jQuery(document).ready(function(){c.call(b)})}else{if(!a){SC._readyQueue=[]}SC._readyQueue.push(function(){c.call(b)})}return this},onReady:{done:function(){if(SC.isReady){return}SC.isReady=true;SC.RunLoop.begin();SC.Locale.createCurrentLocale();var d=SC.Locale.currentLanguage.toLowerCase();jQuery("body").addClass(d);jQuery("html").attr("lang",d);jQuery("#loading").remove();var c=SC._readyQueue,b,a;if(c){for(b=0,a=c.length;b<a;b++){c[b].call()}SC._readyQueue=null}if(window.main&&!SC.suppressMain&&(SC.mode===SC.APP_MODE)){window.main()}SC.RunLoop.end()}}});if(!SC.suppressOnReady){jQuery.event.special.ready._default=SC.onReady.done}SC.APP_MODE="APP_MODE";SC.TEST_MODE="TEST_MODE";SC.mode=SC.APP_MODE;SC.platform=SC.Object.create({scrollbarSize:function(){var a=document.createElement("DIV"),d;a.innerHTML="<div style='height:1px;'></div>";a.style.cssText="position:absolute;width:100px;height:100px;overflow-y:visible;";d=a.childNodes[0];document.body.appendChild(a);var b=d.innerWidth||d.clientWidth;a.style.overflowY="scroll";var c=d.innerWidth||d.clientWidth;document.body.removeChild(a);return b-c}.property().cacheable(),touch:"ontouchstart" in window||SC.browser.name===SC.BROWSER.android,bounceOnScroll:SC.browser.os===SC.OS.ios,pinchToZoom:SC.browser.os===SC.OS.ios,input:{placeholder:("placeholder" in document.createElement("input"))},input:function(d){var f={},c=d.length,g=document.createElement("input"),b,a;for(a=0;a<c;a++){b=d[a];f[b]=!!(b in g)}return f}(["autocomplete","readonly","list","size","required","multiple","maxlength","pattern","min","max","step","placeholder"]),standalone:!!navigator.standalone,cssPrefix:null,domCSSPrefix:null,simulateTouchEvents:function(){if(this.touch){return}SC.Logger.log("Simulating touch events");SC.platform.touch=YES;SC.platform.bounceOnScroll=YES;document.body.className=document.body.className+" touch";this._simtouch_counter=1;this.removeEvents(["click","dblclick","mouseout","mouseover","mousewheel"]);this.replaceEvent("mousemove",this._simtouch_mousemove);this.replaceEvent("mousedown",this._simtouch_mousedown);this.replaceEvent("mouseup",this._simtouch_mouseup);SC.platform.windowSizeDeterminesOrientation=YES;SC.device.orientationHandlingShouldChange()},removeEvents:function(d){var b,a=d.length,c;for(b=0;b<a;b++){c=d[b];SC.Event.remove(document,c,SC.RootResponder.responder,SC.RootResponder.responder[c])}},replaceEvent:function(a,b){SC.Event.remove(document,a,SC.RootResponder.responder,SC.RootResponder.responder[a]);SC.Event.add(document,a,this,b)},_simtouch_mousemove:function(a){if(!this._mousedown){if(a.altKey&&this._pinchCenter===null){this._pinchCenter={pageX:a.pageX,pageY:a.pageY,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}}else{if(!a.altKey&&this._pinchCenter!==null){this._pinchCenter=null}}return NO}var b=this.manufactureTouchEvent(a,"touchmove");return SC.RootResponder.responder.touchmove(b)},_simtouch_mousedown:function(a){this._mousedown=YES;var b=this.manufactureTouchEvent(a,"touchstart");return SC.RootResponder.responder.touchstart(b)},_simtouch_mouseup:function(a){var c=this.manufactureTouchEvent(a,"touchend"),b=SC.RootResponder.responder.touchend(c);this._mousedown=NO;this._simtouch_counter++;return b},manufactureTouchEvent:function(l,k){var c,m,g=this._simtouch_counter;c={type:k,target:l.target,identifier:g,pageX:l.pageX,pageY:l.pageY,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY};l.touches=[c];if(l.altKey&&this._pinchCenter!==null){var i=this._pinchCenter.pageX+this._pinchCenter.pageX-l.pageX,h=this._pinchCenter.pageY+this._pinchCenter.pageY-l.pageY,f=this._pinchCenter.screenX+this._pinchCenter.screenX-l.screenX,d=this._pinchCenter.screenY+this._pinchCenter.screenY-l.screenY,b=this._pinchCenter.clientX+this._pinchCenter.clientX-l.clientX,a=this._pinchCenter.clientY+this._pinchCenter.clientY-l.clientY,j=this._simtouch_counter+1;m={type:k,target:l.target,identifier:j,pageX:i,pageY:h,screenX:f,screenY:d,clientX:b,clientY:a};l.touches=[c,m]}l.changedTouches=l.touches;return l},supportsCSSTransitions:NO,supportsCSSTransforms:NO,understandsCSS3DTransforms:NO,supportsCSS3DTransforms:NO,supportsAcceleratedLayers:NO,supportsHashChange:function(){return("onhashchange" in window)&&(document.documentMode===undefined||document.documentMode>7)}(),supportsHistory:function(){return !!(window.history&&window.history.pushState)}(),supportsCanvas:function(){return !!document.createElement("canvas").getContext}(),supportsOrientationChange:("onorientationchange" in window),windowSizeDeterminesOrientation:SC.browser.os===SC.OS.ios||!("onorientationchange" in window)});(function(){var a=navigator.userAgent.toLowerCase();if((/webkit/).test(a)){SC.platform.cssPrefix="webkit";SC.platform.domCSSPrefix="Webkit"}else{if((/opera/).test(a)){SC.platform.cssPrefix="opera";SC.platform.domCSSPrefix="O"}else{if((/msie/).test(a)&&!(/opera/).test(a)){SC.platform.cssPrefix="ms";SC.platform.domCSSPrefix="ms"}else{if((/mozilla/).test(a)&&!(/(compatible|webkit)/).test(a)){SC.platform.cssPrefix="moz";SC.platform.domCSSPrefix="Moz"}}}}})();(function(){var b=document.createElement("div");var a=["-moz-","-moz-","-o-","-ms-","-webkit-"],h=["moz","Moz","o","ms","webkit"];var f="",d=null,j,c;for(d=0,c=a.length;d<c;d++){j=a[d];f+=j+"transition:all 1s linear;";f+=j+"transform: translate(1px, 1px);";f+=j+"perspective: 500px;"}b.style.cssText=f;var k;for(d=0,c=h.length;d<c;d++){k=h[d];if(b.style[k+"TransitionProperty"]!==undefined){SC.platform.supportsCSSTransitions=YES}if(b.style[k+"Transform"]!==undefined){SC.platform.supportsCSSTransforms=YES}if(b.style[k+"Perspective"]!==undefined||b.style[k+"PerspectiveProperty"]!==undefined){SC.platform.understandsCSS3DTransforms=YES;SC.platform.supportsCSS3DTransforms=YES}}try{if(window.media&&window.media.matchMedium){if(!window.media.matchMedium("(-webkit-transform-3d)")){SC.platform.supportsCSS3DTransforms=NO}}else{if(window.styleMedia&&window.styleMedia.matchMedium){if(!window.styleMedia.matchMedium("(-webkit-transform-3d)")){SC.platform.supportsCSS3DTransforms=NO}}}}catch(g){SC.platform.supportsCSS3DTransforms=NO}if(SC.platform.supportsCSSTransforms&&SC.platform.cssPrefix==="webkit"){SC.platform.supportsAcceleratedLayers=YES}})();sc_require("system/ready");sc_require("system/platform");SC.CAPTURE_BACKSPACE_KEY=NO;SC.RootResponder=SC.Object.extend({panes:null,init:function(){arguments.callee.base.apply(this,arguments);this.panes=SC.Set.create();if(SC.platform.supportsCSSTransitions){this[SC.platform.cssPrefix+"TransitionEnd"]=this.transitionEnd;this["transitionend"]=this.transitionEnd}},mainPane:null,makeMainPane:function(b){var a=this.get("mainPane");if(a===b){return this}this.beginPropertyChanges();if(this.get("keyPane")===a){this.makeKeyPane(b)}this.set("mainPane",b);if(a){a.blurMainTo(b)}if(b){b.focusMainFrom(a)}this.endPropertyChanges();return this},menuPane:null,makeMenuPane:function(b){if(b&&!b.get("acceptsMenuPane")){return this}else{var a=this.get("menuPane");if(a===b){return this}this.set("menuPane",b)}return this},keyPane:null,previousKeyPanes:[],makeKeyPane:function(g){var f,a,d;if(g){if(!g.get("acceptsKeyPane")){return this}else{a=this.get("keyPane");if(a===g){return this}else{if(a){d=this.get("previousKeyPanes");d.push(a)}f=g}}}else{a=this.get("keyPane");d=this.get("previousKeyPanes");f=null;var c;while(d.length>0){c=d.pop();if(c.get("isPaneAttached")&&c.get("acceptsKeyPane")){f=c;break}}}if(!f){var b=this.get("mainPane");if(b&&b.get("acceptsKeyPane")){f=b}}if(a){a.willLoseKeyPaneTo(f)}if(f){f.willBecomeKeyPaneFrom(a)}this.set("keyPane",f);if(f){f.didBecomeKeyPaneFrom(a)}if(a){a.didLoseKeyPaneTo(f)}return this},currentWindowSize:null,computeWindowSize:function(){var c,b,a;if(!this._bod||!this._docElement){b=document.body;a=document.documentElement;this._bod=b;this._docElement=a}else{b=this._bod;a=this._docElement}if(window.innerHeight){c={width:window.innerWidth,height:window.innerHeight}}else{if(a&&a.clientHeight){c={width:a.clientWidth,height:a.clientHeight}}else{if(b){c={width:b.clientWidth,height:b.clientHeight}}}}return c},resize:function(){this._resize();return YES},_resize:function(){var a=this.computeWindowSize(),b=this.get("currentWindowSize");this.set("currentWindowSize",a);if(!SC.rectsEqual(a,b)){SC.device.windowSizeDidChange(a);if(this.panes){SC.run(function(){this.panes.invoke("windowSizeDidChange",b,a)},this)}}},hasFocus:NO,focus:function(b){if(!this.get("hasFocus")){SC.$("body").addClass("sc-focus").removeClass("sc-blur");if(!SC.TABBING_ONLY_INSIDE_DOCUMENT&&!SC.browser.isIE8OrLower){var a=SC.RootResponder.responder.get("keyPane");if(a){var c=a.get("nextValidKeyView");if(c){a.makeFirstResponder(c)}}}SC.run(function(){this.set("hasFocus",YES)},this)}return YES},focusin:function(a){if(this._focusTimeout){clearTimeout(this._focusTimeout)}this.focus(a)},focusout:function(a){var b=this;this._focusTimeout=setTimeout(function(){b.blur(a)},300)},blur:function(a){if(this.get("hasFocus")){SC.$("body").addClass("sc-blur").removeClass("sc-focus");SC.run(function(){this.set("hasFocus",NO)},this)}return YES},dragDidStart:function(a){this._mouseDownView=a;this._drag=a},defaultResponder:null,sendAction:function(d,f,c,g,b,a){f=this.targetForAction(d,f,c,g,a);if(f&&f.isResponderContext){return !!f.sendAction(d,c,b,a)}else{return f&&f.tryToPerform(d,c)}},_responderFor:function(d,b,a){var c=d?d.get("defaultResponder"):null;if(d){d=a||d.get("firstResponder")||d;do{if(d.respondsTo(b)){return d}}while((d=d.get("nextResponder")))}if(typeof c===SC.T_STRING){c=SC.objectForPropertyPath(c)}if(!c){return null}else{if(c.isResponderContext){return c}else{if(c.respondsTo(b)){return c}else{return null}}}},targetForAction:function(c,g,f,h,a){if(!c||(SC.typeOf(c)!==SC.T_STRING)){return null}if(g){if(SC.typeOf(g)===SC.T_STRING){g=SC.objectForPropertyPath(g)||SC.objectForPropertyPath(g,f)}if(g&&!g.isResponderContext){if(g.respondsTo&&!g.respondsTo(c)){g=null}else{if(SC.typeOf(g[c])!==SC.T_FUNCTION){g=null}}}return g}if(h){g=this._responderFor(h,c,a);if(g){return g}}var b=this.get("keyPane"),d=this.get("mainPane");if(b&&(b!==h)){g=this._responderFor(b,c)}if(!g&&d&&(d!==b)){g=this._responderFor(d,c)}if(!g&&(g=this.get("defaultResponder"))){if(SC.typeOf(g)===SC.T_STRING){g=SC.objectForPropertyPath(g);if(g){this.set("defaultResponder",g)}}if(g&&!g.isResponderContext){if(g.respondsTo&&!g.respondsTo(c)){g=null}else{if(SC.typeOf(g[c])!==SC.T_FUNCTION){g=null}}}}return g},targetViewForEvent:function(a){return a.target?SC.$(a.target).view()[0]:null},sendEvent:function(c,a,d){var f,b;SC.run(function(){if(d){f=d.get("pane")}else{f=this.get("menuPane")||this.get("keyPane")||this.get("mainPane")}b=(f)?f.sendEvent(c,a,d):null},this);return b},listenFor:function(d,c,b,a){b=b?b:this;d.forEach(function(f){var g=b[f];if(g){SC.Event.add(c,f,b,g,null,a)}},this);c=null;return b},setup:function(){this.listenFor(["touchstart","touchmove","touchend","touchcancel"],document);this.listenFor(["keydown","keyup","beforedeactivate","mousedown","mouseup","click","dblclick","mousemove","selectstart","contextmenu"],document).listenFor(["resize"],window);if(SC.browser.isIE8OrLower){this.listenFor(["focusin","focusout"],document)}else{this.listenFor(["focus","blur"],window)}this.listenFor(["webkitAnimationStart","webkitAnimationIteration","webkitAnimationEnd"],document);if(SC.platform.supportsCSSTransitions){this.listenFor(["transitionend",SC.platform.cssPrefix+"TransitionEnd"],document)}if(this.keypress){if(SC.CAPTURE_BACKSPACE_KEY&&SC.browser.isMozilla){var b=this;document.onkeypress=function(f){f=SC.Event.normalizeEvent(f);return b.keypress.call(b,f)}}else{SC.Event.add(document,"keypress",this,this.keypress)}}["drag","selectstart"].forEach(function(g){var h=this[g];if(h){if(SC.browser.isIE){var f=this;document.body["on"+g]=function(i){return h.call(f,SC.Event.normalizeEvent(event||window.event))};SC.Event.add(window,"unload",this,function(){document.body["on"+g]=null})}else{SC.Event.add(document,g,this,h)}}},this);var a="mousewheel";if(SC.browser.isMozilla){if(SC.browser.compare(SC.browser.engineVersion,"1.9.1")<0){a="DOMMouseScroll"}else{a="MozMousePixelScroll"}}SC.Event.add(document,a,this,this.mousewheel);this.set("currentWindowSize",this.computeWindowSize());if(SC.browser.os===SC.OS.ios&&SC.browser.name===SC.BROWSER.safari){if(SC.platform&&!SC.platform.touch){SC.platform.simulateTouchEvents()}var c=SC.RunLoop.prototype.endRunLoop,d;d=function(){if(c){c.apply(this,arguments)}var j=SC.RootResponder.responder._touches,i,f,k,g,m,n=NO;if(j){for(i in j){if(j[i]._rescuedElement){continue}k=f=j[i].target;while(f&&(f=f.parentNode)&&!n){n=(f===document.body)}if(!n&&k){if(k.parentNode&&k.cloneNode){var l=k.cloneNode(true);k.parentNode.replaceChild(l,k);k.swapNode=l}var h=SC.touchHoldingPen;if(!h){h=SC.touchHoldingPen=document.createElement("div");h.style.display="none";document.body.appendChild(h)}h.appendChild(k);j[i]._rescuedElement=k}}}};SC.RunLoop.prototype.endRunLoop=d}},_touchedViews:{},_touches:{},touchesForView:function(a){if(this._touchedViews[SC.guidFor(a)]){return this._touchedViews[SC.guidFor(a)].touches}},averagedTouchesForView:function(j,h){var n=this.touchesForView(j),b=j._scrr_averagedTouches||(j._scrr_averagedTouches={});if((!n||n.length===0)&&!h){b.x=0;b.y=0;b.d=0;b.touchCount=0}else{var f=this._averagedTouches_touches||(this._averagedTouches_touches=[]);f.length=0;if(n){var d,g=n.length;for(d=0;d<g;d++){f.push(n[d])}}if(h){f.push(h)}var k,c,a=0,p=0,o,m,l=0;g=f.length;for(k=0;k<g;k++){c=f[k];a+=c.pageX;p+=c.pageY}a/=g;p/=g;for(k=0;k<g;k++){c=f[k];o=Math.abs(c.pageX-a);m=Math.abs(c.pageY-p);l+=Math.pow(o*o+m*m,0.5)}l/=g;b.x=a;b.y=p;b.d=l;b.touchCount=g}return b},assignTouch:function(b,a){if(b.hasEnded){throw"Attempt to assign a touch that is already finished."}if(b.view===a){return}if(b.view){this.unassignTouch(b)}if(!this._touchedViews[SC.guidFor(a)]){this._touchedViews[SC.guidFor(a)]={view:a,touches:SC.CoreSet.create([]),touchCount:0};a.set("hasTouch",YES)}b.view=a;this._touchedViews[SC.guidFor(a)].touches.add(b);this._touchedViews[SC.guidFor(a)].touchCount++},unassignTouch:function(c){var a,b;if(!c.view){return}a=c.view;b=this._touchedViews[SC.guidFor(a)];b.touches.remove(c);b.touchCount--;if(b.touchCount<1){a.set("hasTouch",NO);b.view=null;delete this._touchedViews[SC.guidFor(a)]}c.view=undefined},_flushQueuedTouchResponder:function(){if(this._queuedTouchResponder){var a=this._queuedTouchResponder;this._queuedTouchResponder=null;this.makeTouchResponder.apply(this,a)}},makeTouchResponder:function(f,d,c,k){if(this._isMakingTouchResponder){this._queuedTouchResponder=[f,d,c,k];return}this._isMakingTouchResponder=YES;var h=f.touchResponders,b;if(f.touchResponder===d){this._isMakingTouchResponder=NO;this._flushQueuedTouchResponder();return}var a;if(d){a=d.get("pane")}else{a=this.get("keyPane")||this.get("mainPane")}if(h.indexOf(d)<0){if(k){try{d=(a)?a.sendEvent("touchStart",f,d):null}catch(g){SC.Logger.error("Error in touchStart: "+g);d=null}}else{if(d&&((d.get?d.get("acceptsMultitouch"):d.acceptsMultitouch)||!d.hasTouch)){if(!d.touchStart(f)){d=null}}else{}}}if(!c||(h.indexOf(d)>-1&&h[h.length-1]!==d)){this.unassignTouch(f);var i=h.length-1,j=h[i];while(j&&j!==d){b=this.touchesForView(j);if((j.get?j.get("acceptsMultitouch"):j.acceptsMultitouch)||!b){if(j.touchCancelled){j.touchCancelled(f)}}i--;j=h[i];h.pop();f.touchResponder=h[i];f.nextTouchResponder=h[i-1]}}if(d){this.assignTouch(f,d);if(d!==f.touchResponder){h.push(d);f.touchResponder=d;f.nextTouchResponder=h[h.length-2]}}this._isMakingTouchResponder=NO;this._flushQueuedTouchResponder()},captureTouch:function(i,f,h){if(!f){f=this}var g=i.targetView,c=g,d=[],b,a;if(SC.LOG_TOUCH_EVENTS){SC.Logger.info("  -- Received one touch on %@".fmt(g.toString()))}while(c&&(c!==f)){d.unshift(c);c=c.get("nextResponder")}for(a=d.length,b=0;b<a;b++){c=d[b];if(SC.LOG_TOUCH_EVENTS){SC.Logger.info("  -- Checking %@ for captureTouch response".fmt(c.toString()))}if(c.tryToPerform("captureTouch",i)){if(SC.LOG_TOUCH_EVENTS){SC.Logger.info("   -- Making %@ touch responder because it returns YES to captureTouch".fmt(c.toString()))}this.makeTouchResponder(i,c,h,YES);return}}if(SC.LOG_TOUCH_EVENTS){SC.Logger.info("   -- Didn't find a view that returned YES to captureTouch, so we're calling touchStart")}this.makeTouchResponder(i,g,h,YES)},endMissingTouches:function(f){var b,a=f.length,d={},c=[];for(b=0;b<a;b++){d[f[b].identifier]=YES}for(b in this._touches){var g=this._touches[b].identifier;if(!d[g]){c.push(this._touches[b])}}for(b=0,a=c.length;b<a;b++){this.endTouch(c[b]);this.finishTouch(c[b])}},_touchCount:0,endTouch:function(b,h,c){if(!h){h="touchEnd"}var a,g,d,f;this.unassignTouch(b);if(b.touchResponder){f=b.touchResponder;g=b.touchResponders;a=g.length-1;d=g[a];while(d){if(d[h]){d[h](b,c)}if(b.touchResponder!==f){break}a--;d=g[a];h="touchCancelled"}}},finishTouch:function(b){var a;this.unassignTouch(b);if(a=b._rescuedElement){if(a.swapNode&&a.swapNode.parentNode){a.swapNode.parentNode.replaceChild(a,a.swapNode)}else{if(a.parentNode===SC.touchHoldingPen){SC.touchHoldingPen.removeChild(a)}}delete b._rescuedElement;a.swapNode=null;a=null}b.touchResponders=null;b.touchResponder=null;b.nextTouchResponder=null;b.hasEnded=YES;if(this._touches[b.identifier]){delete this._touches[b.identifier]}},touchstart:function(a){if(this.ignoreTouchHandle(a)){return YES}var b=NO;SC.run(function(){this.endMissingTouches(a.touches);var f,i=a.changedTouches,d=i.length,h,g,j,c;a.touchContext=this;for(f=0;f<d;f++){j=i[f];c=SC.Touch.create(j,this);if(!c.targetView){continue}if(c.hidesTouchIntercept){b=YES}c.timeStamp=a.timeStamp;this._touches[j.identifier]=c;c.event=a;this.captureTouch(c,this);c.event=null}},this);if(b){return YES}return a.hasCustomEventHandling},touchmove:function(a){if(this.ignoreTouchHandle(a)){return YES}SC.run(function(){var c=a.changedTouches,b,o,m,g=c.length,l,k,j,n,h={},f,i,d=NO;if(this._drag){b=SC.Touch.create(a.changedTouches[0],this);this._drag.tryToPerform("mouseDragged",b)}for(m=0;m<g;m++){b=c[m];o=this._touches[b.identifier];if(!o){continue}if(o.hidesTouchIntercept){d=YES}o.pageX=b.pageX;o.pageY=b.pageY;o.clientX=b.clientX;o.clientY=b.clientY;o.screenX=b.screenX;o.screenY=b.screenY;o.timeStamp=a.timeStamp;o.event=a;if(o.touchResponder){l=o.touchResponder;i=SC.guidFor(l);if(!h[i]){h[i]={view:l,touches:[]}}h[i].touches.push(o)}}if(d){a.allowDefault();return YES}for(m in h){l=h[m].view;k=h[m].touches;a.viewChangedTouches=k;j=this.touchesForView(l);n=j.firstObject();a.pageX=n.pageX;a.pageY=n.pageY;a.clientX=n.clientX;a.clientY=n.clientY;a.screenX=n.screenX;a.screenY=n.screenY;a.touchContext=this;l.tryToPerform("touchesDragged",a,j)}c=a.changedTouches;g=c.length;for(m=0;m<g;m++){b=c[m];o=this._touches[b.identifier];if(o){o.event=null}}},this);return a.hasCustomEventHandling},touchend:function(a){var b=NO;if(this.ignoreTouchHandle(a)){return YES}SC.run(function(){var i=a.changedTouches,h,o,m,j=i.length,k,c,g=a.isCancel?"touchCancelled":"touchEnd",l,n,d,f;for(m=0;m<j;m++){h=i[m];h.type="touchend";o=this._touches[h.identifier];if(!o){continue}o.timeStamp=a.timeStamp;o.pageX=h.pageX;o.pageY=h.pageY;o.clientX=h.clientX;o.clientY=h.clientY;o.screenX=h.screenX;o.screenY=h.screenY;o.type="touchend";o.event=a;if(SC.LOG_TOUCH_EVENTS){SC.Logger.info("-- Received touch end")}if(o.hidesTouchIntercept){o.unhideTouchIntercept();b=YES}if(this._drag){this._drag.tryToPerform("mouseUp",h);this._drag=null}this.endTouch(o,g,a);this.finishTouch(o)}},this);if(b){return YES}return a.hasCustomEventHandling},touchcancel:function(a){a.isCancel=YES;this.touchend(a)},ignoreTouchHandle:function(b){if(SC.browser.isMobileSafari){var a=b.target.tagName;if(a==="INPUT"||a==="A"){b.allowDefault();return YES}}return NO},attemptKeyEquivalent:function(b){var d=null;var c=b.commandCodes()[0];if(!c){return NO}var g=this.get("menuPane"),a=this.get("keyPane"),f=this.get("mainPane");if(g){d=g.performKeyEquivalent(c,b);if(d){return d}}if(a){d=a.performKeyEquivalent(c,b);if(d||a.get("isModal")){return d}}if(!d&&f&&(f!==a)){d=f.performKeyEquivalent(c,b);if(d||f.get("isModal")){return d}}return d},_lastModifiers:null,_handleModifierChanges:function(b){var a;a=this._lastModifiers=(this._lastModifiers||{alt:false,ctrl:false,shift:false});var c=false;if(b.altKey!==a.alt){a.alt=b.altKey;c=true}if(b.ctrlKey!==a.ctrl){a.ctrl=b.ctrlKey;c=true}if(b.shiftKey!==a.shift){a.shift=b.shiftKey;c=true}b.modifiers=a;return(c)?(this.sendEvent("flagsChanged",b)?b.hasCustomEventHandling:YES):YES},_isFunctionOrNonPrintableKey:function(a){return !!(a.altKey||a.ctrlKey||a.metaKey||((a.charCode!==a.which)&&SC.FUNCTION_KEYS[a.which]))},_isModifierKey:function(a){return !!SC.MODIFIER_KEYS[a.charCode]},keydown:function(a){if(SC.none(a)){return YES}var f=a.keyCode;if(SC.browser.isMozilla&&a.keyCode===9){this.keydownCounter=1}if(f===229){this._IMEInputON=YES;return this.sendEvent("keyDown",a)}if(f===27&&this._drag){this._drag.cancelDrag();this._drag=null;this._mouseDownView=null;return YES}if(SC.browser.isMozilla&&(a.which===8)){return true}var b=this._handleModifierChanges(a),d=a.target||a.srcElement,c=(a.which===8)&&!SC.allowsBackspaceToPreviousPage&&(d===document.body);if(this._isModifierKey(a)){return(c?NO:b)}b=YES;if(this._isFunctionOrNonPrintableKey(a)){if(f>=37&&f<=40&&SC.browser.isMozilla){return YES}b=this.sendEvent("keyDown",a);if(!b){b=!this.attemptKeyEquivalent(a)}else{b=a.hasCustomEventHandling;if(b){c=NO}}}return c?NO:b},keypress:function(b){var c,f=b.keyCode,g=SC.browser.isMozilla;if(g&&b.keyCode===9){this.keydownCounter++;if(this.keydownCounter==2){return YES}}if(g&&(b.which===8)){b.which=f;c=this.sendEvent("keyDown",b);return c?(SC.allowsBackspaceToPreviousPage||b.hasCustomEventHandling):YES}else{var d=(f>=37&&f<=40&&g),a=b.charCode;if((a!==undefined&&a===0&&b.keyCode!==9)&&!d){return YES}if(d){b.which=f}if(d||!this._isFunctionOrNonPrintableKey(b)){return this.sendEvent("keyDown",b)?b.hasCustomEventHandling:YES}}},keyup:function(a){if(this._ffevt){this._ffevt=null}var b=this._handleModifierChanges(a);if(this._isModifierKey(a)){return b}if(this._IMEInputON&&a.keyCode===13){a.isIMEInput=YES;this.sendEvent("keyDown",a);this._IMEInputON=NO}return this.sendEvent("keyUp",a)?a.hasCustomEventHandling:YES},beforedeactivate:function(c){var b=c.toElement;if(b&&b.tagName&&b.tagName!=="IFRAME"){var a=SC.$(b).view()[0];if(a&&a.get("blocksIEDeactivate")){return NO}}return YES},mousedown:function(f){var d;if(SC.platform.touch){f.allowDefault();this._lastMouseDownCustomHandling=YES;return YES}this._clickCount+=1;if(!this._lastMouseUpAt||((Date.now()-this._lastMouseUpAt)>250)){this._clickCount=1}else{var c=this._lastMouseDownX-f.clientX,a=this._lastMouseDownY-f.clientY,h=Math.sqrt(c*c+a*a);if(h>8){this._clickCount=1}}f.clickCount=this._clickCount;this._lastMouseDownX=f.clientX;this._lastMouseDownY=f.clientY;var b=this.targetViewForEvent(f);if(b){d=b.getPath("pane.firstResponder")}if(d&&d.get("blurOnMouseDown")&&d!==b){d.resignFirstResponder(f)}b=this._mouseDownView=this.sendEvent("mouseDown",f,b);if(b&&b.respondsTo("mouseDragged")){this._mouseCanDrag=YES}var g=b?f.hasCustomEventHandling:YES;this._lastMouseDownCustomHandling=g;return g},mouseup:function(b){var g=NO;if(SC.platform.touch){b.allowDefault();this._lastMouseUpCustomHandling=YES;return YES}if(this._drag){this._drag.tryToPerform("mouseUp",b);this._drag=null}var f=null,a=this._mouseDownView,d=this.targetViewForEvent(b);b.clickCount=this._clickCount;if(a){f=this.sendEvent("mouseUp",b,a);if(!f&&(this._clickCount===2)){f=this.sendEvent("doubleClick",b,a);g=YES}if(!f){f=this.sendEvent("click",b,a);g=YES}}if(!f&&!g){if(this._clickCount===2){f=this.sendEvent("doubleClick",b,d)}if(!f){f=this.sendEvent("click",b,d)}}this._mouseCanDrag=NO;this._mouseDownView=null;this._lastMouseUpAt=Date.now();var c=f?b.hasCustomEventHandling:YES;this._lastMouseUpCustomHandling=c;return c},click:function(a){if(!this._lastMouseUpCustomHandling||!this._lastMouseDownCustomHandling){a.preventDefault();a.stopPropagation();return NO}return YES},dblclick:function(a){if(SC.browser.isIE8OrLower){this._clickCount=2;this.mouseup(a)}},mousewheel:function(b){var a=this.targetViewForEvent(b),c=this.sendEvent("mouseWheel",b,a);return(c)?b.hasCustomEventHandling:YES},_lastHovered:null,mousemove:function(a){if(SC.platform.touch){a.allowDefault();return YES}if(SC.browser.isIE){if(this._lastMoveX===a.clientX&&this._lastMoveY===a.clientY){return}}this._lastMoveX=a.clientX;this._lastMoveY=a.clientY;SC.run(function(){if(this._drag){if(SC.browser.isIE){if(this._lastMouseDownX!==a.clientX||this._lastMouseDownY!==a.clientY){this._drag.tryToPerform("mouseDragged",a)}}else{this._drag.tryToPerform("mouseDragged",a)}}else{var d=this._lastHovered||[],f=[],h,g,b,c=this.targetViewForEvent(a);while(c&&(c!==this)){f.push(c);c=c.get("nextResponder")}for(g=0,b=d.length;g<b;g++){c=d[g];h=c.respondsTo("mouseExited");if(h&&f.indexOf(c)===-1){c.tryToPerform("mouseExited",a)}}for(g=0,b=f.length;g<b;g++){c=f[g];if(d.indexOf(c)!==-1){c.tryToPerform("mouseMoved",a)}else{c.tryToPerform("mouseEntered",a)}}this._lastHovered=f;if(this._mouseDownView){if(SC.browser.isIE){if(this._lastMouseDownX!==a.clientX&&this._lastMouseDownY!==a.clientY){this._mouseDownView.tryToPerform("mouseDragged",a)}}else{this._mouseDownView.tryToPerform("mouseDragged",a)}}}},this)},_mouseCanDrag:YES,selectstart:function(b){var c=this.targetViewForEvent(b),a=this.sendEvent("selectStart",b,c);if(c&&c.respondsTo("mouseDragged")){return(a!==null?YES:NO)&&!this._mouseCanDrag}else{return(a!==null?YES:NO)}},drag:function(){return false},contextmenu:function(b){var a=this.targetViewForEvent(b);return this.sendEvent("contextMenu",b,a)},webkitAnimationStart:function(b){try{var a=this.targetViewForEvent(b);this.sendEvent("animationDidStart",b,a)}catch(c){SC.Logger.warn("Exception during animationDidStart: %@".fmt(c));throw c}return a?b.hasCustomEventHandling:YES},webkitAnimationIteration:function(b){try{var a=this.targetViewForEvent(b);this.sendEvent("animationDidIterate",b,a)}catch(c){SC.Logger.warn("Exception during animationDidIterate: %@".fmt(c));throw c}return a?b.hasCustomEventHandling:YES},webkitAnimationEnd:function(b){try{var a=this.targetViewForEvent(b);this.sendEvent("animationDidEnd",b,a)}catch(c){SC.Logger.warn("Exception during animationDidEnd: %@".fmt(c));throw c}return a?b.hasCustomEventHandling:YES},transitionEnd:function(b){try{var a=this.targetViewForEvent(b);this.sendEvent("transitionDidEnd",b,a)}catch(c){SC.Logger.warn("Exception during transitionDidEnd: %@".fmt(c));throw c}return a?b.hasCustomEventHandling:YES}});SC.Touch=function(d,a){this.touchContext=a;this.identifier=d.identifier;var c=d.target,b;if(c&&SC.$(c).hasClass("touch-intercept")){d.target.style.webkitTransform="translate3d(0px,-5000px,0px)";c=document.elementFromPoint(d.pageX,d.pageY);if(c){b=SC.$(c).view()[0]}this.hidesTouchIntercept=NO;if(c.tagName==="INPUT"){this.hidesTouchIntercept=d.target}else{d.target.style.webkitTransform="translate3d(0px,0px,0px)"}}else{b=d.target?SC.$(d.target).view()[0]:null}this.targetView=b;this.target=c;this.hasEnded=NO;this.type=d.type;this.clickCount=1;this.view=undefined;this.touchResponder=this.nextTouchResponder=undefined;this.touchResponders=[];this.startX=this.pageX=d.pageX;this.startY=this.pageY=d.pageY;this.clientX=d.clientX;this.clientY=d.clientY;this.screenX=d.screenX;this.screenY=d.screenY};SC.Touch.prototype={unhideTouchIntercept:function(){var a=this.hidesTouchIntercept;if(a){setTimeout(function(){a.style.webkitTransform="translate3d(0px,0px,0px)"},500)}},allowDefault:function(){if(this.event){this.event.hasCustomEventHandling=YES}},preventDefault:function(){if(this.event){this.event.preventDefault()}},stopPropagation:function(){if(this.event){this.event.stopPropagation()}},stop:function(){if(this.event){this.event.stop()}},end:function(){this.touchContext.endTouch(this)},makeTouchResponder:function(b,c,a){this.touchContext.makeTouchResponder(this,b,c,a)},captureTouch:function(a,b){this.touchContext.captureTouch(this,a,b)},touchesForView:function(a){return this.touchContext.touchesForView(a)},touchesForResponder:function(a){return this.touchContext.touchesForView(a)},averagedTouchesForView:function(a,b){return this.touchContext.averagedTouchesForView(a,(b?this:null))}};SC.mixin(SC.Touch,{create:function(b,a){return new SC.Touch(b,a)}});SC.ready(SC.RootResponder,SC.RootResponder.ready=function(){var a;a=SC.RootResponder.responder=SC.RootResponder.create();a.setup()});sc_require("system/core_query");sc_require("system/ready");sc_require("system/root_responder");sc_require("system/platform");SC.PORTRAIT_ORIENTATION="portrait";SC.LANDSCAPE_ORIENTATION="landscape";SC.NO_ORIENTATION="desktop";SC.device=SC.Object.create({orientation:SC.NO_ORIENTATION,isOffline:NO,mouseLocation:function(){var a=SC.RootResponder.responder,c=a._lastMoveX,b=a._lastMoveY;if(SC.empty(c)||SC.empty(b)){return null}return{x:c,y:b}}.property(),init:function(){arguments.callee.base.apply(this,arguments);if(navigator&&navigator.onLine===false){this.set("isOffline",YES)}},setup:function(){var a=SC.RootResponder.responder;a.listenFor(["online","offline"],window,this);this.orientationHandlingShouldChange()},orientationHandlingShouldChange:function(){if(SC.platform.windowSizeDeterminesOrientation){SC.Event.remove(window,"orientationchange",this,this.orientationchange);this.windowSizeDidChange(SC.RootResponder.responder.get("currentWindowSize"))}else{if(SC.platform.supportsOrientationChange){SC.Event.add(window,"orientationchange",this,this.orientationchange);this.orientationchange()}}},windowSizeDidChange:function(a){if(SC.platform.windowSizeDeterminesOrientation){if(!SC.browser.iOS){SC.run(function(){if(SC.platform.touch){if(a.height>=a.width){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}}else{SC.device.set("orientation",SC.NO_ORIENTATION)}})}else{SC.run(function(){if(a.width===window.screen.width){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}})}return YES}return NO},orientationchange:function(a){SC.run(function(){if(window.orientation===0||window.orientation===180){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}})},orientationObserver:function(){var a=SC.$(document.body),b=this.get("orientation");if(b===SC.PORTRAIT_ORIENTATION){a.addClass("portrait")}else{a.removeClass("portrait")}if(b===SC.LANDSCAPE_ORIENTATION){a.addClass("landscape")}else{a.removeClass("landscape")}}.observes("orientation"),online:function(a){this.set("isOffline",NO)},offline:function(a){this.set("isOffline",YES)}});SC.ready(function(){SC.device.setup()});SC.Page=SC.Object.extend({owner:null,get:function(a){var b=this[a];if(b&&b.isClass){this[a]=b=b.create({page:this});if(!this.get("inDesignMode")){b.awake()}return b}else{return arguments.callee.base.apply(this,arguments)}},awake:function(){var b,a;for(a in this){if(!this.hasOwnProperty(a)){continue}b=this[a];if(b&&b.isViewClass){this[a]=b=b.create({page:this})}}return this},getIfConfigured:function(b){var a=this[b];return(a&&a.isViewClass)?null:this.get(b)},loc:function(c){var a,b;for(b in c){if(!c.hasOwnProperty(b)){continue}a=this[b];if(!a||!a.isViewClass){continue}a.loc(c[b])}return this}});SC.Page.design=SC.Page.create;SC.Page.localization=function(a){return a};sc_require("system/builder");SC.MODE_REPLACE="replace";SC.MODE_APPEND="append";SC.MODE_PREPEND="prepend";SC.NON_PIXEL_PROPERTIES=["zIndex","fontWeight","opacity"];SC.COMBO_STYLES={WebkitTransition:["WebkitTransitionProperty","WebkitTransitionDuration","WebkitTransitionDelay","WebkitTransitionTimingFunction"]};SC.RenderContext=SC.Builder.create({SELF_CLOSING:SC.CoreSet.create().addEach(["area","base","basefront","br","hr","input","img","link","meta"]),init:function(f,d){var b,a;if(d){this.prevObject=d;this.strings=d.strings;this.offset=d.length+d.offset}if(!this.strings){this.strings=[]}if(f===undefined){f="div";a=YES}else{if(f==="div"||f==="label"||f==="a"){a=YES}else{if(SC.typeOf(f)===SC.T_STRING){f=f.toLowerCase();a=YES}}}if(a){this._tagName=f;this._needsTag=YES;this.needsContent=YES;var g=this;while(g){g.length++;g=g.prevObject}this.strings.push(null);this._selfClosing=this.SELF_CLOSING.contains(f)}else{this._elem=f;this._needsTag=NO;this.length=0;this.needsContent=NO}return this},strings:null,offset:0,length:0,updateMode:SC.MODE_REPLACE,needsContent:NO,get:function(b){var a=this.strings||[];return(b===undefined)?a.slice(this.offset,this.length):a[b+this.offset]},push:function(d){var b=this.strings,a=arguments.length;if(!b){this.strings=b=[]}if(a>1){b.push.apply(b,arguments)}else{b.push(d)}var f=this;while(f){f.length+=a;f=f.prevObject}this.needsContent=YES;return this},text:function(c){var b=arguments.length,a=0;for(a=0;a<b;a++){this.push(SC.RenderContext.escapeHTML(arguments[a]))}return this},join:function(b){if(this._needsTag){this.end()}var a=this.strings;return a?a.join(b||""):""},begin:function(a){return SC.RenderContext(a,this)},element:function(){return this._elem?this._elem:SC.$(this.join())[0]},remove:function(a){if(!a){return}var b,c=this._elem;if(!c||!c.removeChild){return}b=document.getElementById(a);if(b){b=c.removeChild(b);b=null}},update:function(){var c=this._elem,h=this.updateMode,f,d,a,g,b;this._innerHTMLReplaced=NO;if(!c){return}f=this.$();if(this.length>0){this._innerHTMLReplaced=YES;if(h===SC.MODE_REPLACE){f.html(this.join())}else{a=c.cloneNode(false);a.innerHTML=this.join();g=a.firstChild;while(g){b=g.nextSibling;c.insertBefore(g,b);g=b}g=b=a=null}}if(this._idDidChange&&(d=this._id)){f.attr("id",d)}jQuery.Buffer.flush();c=this._elem=null;return this.prevObject||this},_DEFAULT_ATTRS:{},end:function(){var o="",b="",d,m,k,i,l=this._attrs,f=this._classNames,a=this._id,n=this._styles,j,h;o="<"+this._tagName;if(l||f||n||a){if(!l){l=this._DEFAULT_ATTRS}if(a){l.id=a}if(f){l["class"]=f.join(" ")}if(n){for(k in n){if(!n.hasOwnProperty(k)){continue}i=n[k];if(i===null){continue}if(typeof i===SC.T_NUMBER&&!SC.NON_PIXEL_PROPERTIES.contains(k)){i+="px"}b=b+this._dasherizeStyleName(k)+": "+i+"; "}l.style=b}o=o+" ";for(k in l){if(!l.hasOwnProperty(k)){continue}i=l[k];if(i===null){continue}o=o+k+'="'+i+'" '}if(l===this._DEFAULT_ATTRS){delete l.style;delete l["class"];delete l.id}}j=this.strings;h=(this._selfClosing===NO)?NO:(this.length===1);o=o+(h?" />":">");j[this.offset]=o;if(!h){j.push("</"+this._tagName+">");var g=this;while(g){g.length++;g=g.prevObject}}this._elem=null;return this.prevObject||this},tag:function(a,b){return this.begin(a,b).end()},tagName:function(a){if(a===undefined){if(!this._tagName&&this._elem){this._tagName=this._elem.tagName}return this._tagName}else{this._tagName=a;this._tagNameDidChange=YES;return this}},id:function(a){if(a===undefined){if(!this._id&&this._elem){this._id=this._elem.id}return this._id}else{this._id=a;this._idDidChange=YES;return this}},classNames:function(b,a){if(this._elem){if(b){this.$().resetClassNames().addClass(b);return this}else{return this.$().attr("class").split(" ")}}if(b===undefined){if(this._cloneClassNames){this._classNames=(this._classNames||[]).slice();this._cloneClassNames=NO}if(!this._classNames){this._classNames=[]}return this._classNames}else{this._classNames=b;this._cloneClassNames=a||NO;this._classNamesDidChange=YES;return this}},hasClass:function(a){if(this._elem){return this.$().hasClass(a)}return this.classNames().indexOf(a)>=0},addClass:function(g){if(g===undefined||g===null){SC.Logger.warn("You are adding an undefined or empty class"+this.toString());return this}if(this._elem){if(SC.typeOf(g)===SC.T_STRING){this.$().addClass(g)}else{var c,b=g.length;for(c=0;c<b;c++){this.$().addClass(g[c])}}return this}var h=this.classNames();if(SC.typeOf(g)===SC.T_STRING){if(h.indexOf(g)<0){h.push(g);this._classNamesDidChange=YES}}else{var d;for(var f=0,a=g.length;f<a;f++){d=g[f];if(h.indexOf(d)<0){h.push(d);this._classNamesDidChange=YES}}}return this},removeClass:function(b){if(this._elem){this.$().removeClass(b);return this}var c=this._classNames,a;if(c&&(a=c.indexOf(b))>=0){if(this._cloneClassNames){c=this._classNames=c.slice();this._cloneClassNames=NO}c[a]=null;this._classNamesDidChange=YES}return this},resetClassNames:function(){if(this._elem){this.$().resetClassNames();return this}this._classNames=[];this._classNamesDidChange=YES;return this},setClass:function(d,c){if(this._elem){this.$().setClass(d,c);return this}var g,a,b,f;if(c!==undefined){return c?this.addClass(d):this.removeClass(d)}else{g=this._classNames;if(!g){g=this._classNames=[]}if(this._cloneClassNames){g=this._classNames=g.slice();this._cloneClassNames=NO}f=NO;for(b in d){if(!d.hasOwnProperty(b)){continue}a=g.indexOf(b);if(d[b]){if(a<0){g.push(b);f=YES}}else{if(a>=0){g[a]=null;f=YES}}}if(f){this._classNamesDidChange=YES}}return this},_STYLE_REGEX:/-?\s*([^:\s]+)\s*:\s*([^;]+)\s*;?/g,styles:function(d,f){if(this._elem){if(d){this.$().resetStyles().css(d)}return this.$().styles()}var a,c,b;if(d===undefined){if(!this._styles&&this._elem){a=this.$().attr("style");if(a&&(a=a.toString()).length>0){if(SC.browser.name===SC.BROWSER.ie){a=a.toLowerCase()}d={};c=this._STYLE_REGEX;c.lastIndex=0;while(b=c.exec(a)){d[this._camelizeStyleName(b[1])]=b[2]}this._styles=d;this._cloneStyles=NO}else{this._styles={}}}else{if(!this._styles){this._styles={}}else{if(this._cloneStyles){this._styles=SC.clone(this._styles);this._cloneStyles=NO}}}return this._styles}else{this._styles=d;this._cloneStyles=f||NO;this._stylesDidChange=YES;return this}},_deleteComboStyles:function(f,d){var h=SC.COMBO_STYLES[d],g=NO,c;if(h){for(var a=0,b=h.length;a<b;a++){c=h[a];if(f[c]){delete f[c];g=YES}}}return g},resetStyles:function(){this.styles({});return this},addStyle:function(a,f){if(this._elem){this.$().css(a,f);return this}var b,d=NO,c=this.styles();if(typeof a===SC.T_STRING){if(f===undefined){return c[a]}else{d=this._deleteComboStyles(c,a);if(c[a]!==f){c[a]=f;d=YES}if(d){this._stylesDidChange=YES}}}else{for(b in a){if(!a.hasOwnProperty(b)){continue}d=d||this._deleteComboStyles(c,b);f=a[b];if(c[b]!==f){c[b]=f;d=YES}}if(d){this._stylesDidChange=YES}}return this},removeStyle:function(a){if(this._elem){this.$().css(a,null);return this}if(!this._styles){return this}var b=this.styles();if(b[a]){b[a]=null;this._stylesDidChange=YES}},attr:function(a,f){if(this._elem){this.$().attr(a,f);return this}var c,b=this._attrs,d=NO;if(!b){this._attrs=b={}}if(typeof a===SC.T_STRING){if(f===undefined){return b[a]}else{if(b[a]!==f){b[a]=f;this._attrsDidChange=YES}}}else{for(c in a){if(!a.hasOwnProperty(c)){continue}f=a[c];if(b[c]!==f){b[c]=f;d=YES}}if(d){this._attrsDidChange=YES}}return this},removeAttr:function(a){if(this._elem){this.$().removeAttr(a);return this}},$:function(c){var a,b=this._elem;a=!b?SC.$.buffer([]):(c===undefined)?SC.$.buffer(b):SC.$.buffer(c,b);b=null;return a},_camelizeStyleName:function(a){var b=a.match(/^-(webkit|moz|o)-/),c=SC.String.camelize(a);if(b){return c.substr(0,1).toUpperCase()+c.substr(1)}else{return c}},_dasherizeStyleName:function(a){var b=SC.String.dasherize(a);if(b.match(/^(webkit|moz|ms|o)-/)){b="-"+b}return b}});SC.RenderContext.fn.html=SC.RenderContext.fn.push;SC.RenderContext.fn.css=SC.RenderContext.fn.addStyle;(function(){var b=/[&<>]/g,a=function(c){switch(c){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;"}};SC.RenderContext.escapeHTML=function(c){if(!c){return""}return c.replace(b,a)}})();SC.SelectionSet=SC.Object.extend(SC.Enumerable,SC.Freezable,SC.Copyable,{isSelectionSet:YES,length:function(){var a=0,b=this._sets,c=this._objects;if(c){a+=c.get("length")}if(b){b.forEach(function(d){a+=d.get("length")})}return a}.property().cacheable(),sources:function(){var c=[],d=this._sets,b=d?d.length:0,a,g,f;for(a=0;a<b;a++){g=d[a];if(g&&g.get("length")>0&&g.source){c.push(g.source)}}return c}.property().cacheable(),indexSetForSource:function(f){if(!f||!f.isSCArray){return null}var b=this._indexSetCache,d=this._objects,c,a;if(!b){b=this._indexSetCache={}}c=b[SC.guidFor(f)];if(c&&c._sourceRevision&&(c._sourceRevision!==f.propertyRevision)){c=null}if(!c){c=this._indexSetForSource(f,NO);if(c&&c.get("length")===0){c=null}if(d){if(c){c=c.copy()}d.forEach(function(g){if((a=f.indexOf(g))>=0){if(!c){c=SC.IndexSet.create()}c.add(a)}},this)}if(c){c=b[SC.guidFor(f)]=c.frozenCopy();c._sourceRevision=f.propertyRevision}}return c},_indexSetForSource:function(g,h){if(h===undefined){h=YES}var d=SC.guidFor(g),c=this[d],f=this._sets,a=f?f.length:0,b=null;if(c>=a){c=null}if(SC.none(c)){if(h&&!this.isFrozen){this.propertyWillChange("sources");if(!f){f=this._sets=[]}b=f[a]=SC.IndexSet.create();b.source=g;this[d]=a;this.propertyDidChange("sources")}}else{b=f?f[c]:null}return b},add:function(a,b,d){if(this.isFrozen){throw SC.FROZEN_ERROR}var h,g,k,j,c,f,i,l;if(b===undefined&&d===undefined){if(!a){throw"Must pass params to SC.SelectionSet.add()"}if(a.isIndexSet){return this.add(a.source,a)}if(a.isSelectionSet){h=a._sets;l=a._objects;g=h?h.length:0;this.beginPropertyChanges();for(k=0;k<g;k++){j=h[k];if(j&&j.get("length")>0){this.add(j.source,j)}}if(l){this.addObjects(l)}this.endPropertyChanges();return this}}j=this._indexSetForSource(a,YES);c=this.get("length");i=j.get("length");f=c-i;j.add(b,d);this._indexSetCache=null;f+=j.get("length");if(f!==c){this.propertyDidChange("length");this.enumerableContentDidChange();if(i===0){this.notifyPropertyChange("sources")}}return this},remove:function(a,b,d){if(this.isFrozen){throw SC.FROZEN_ERROR}var h,g,k,j,c,f,i,l;if(b===undefined&&d===undefined){if(!a){throw"Must pass params to SC.SelectionSet.remove()"}if(a.isIndexSet){return this.remove(a.source,a)}if(a.isSelectionSet){h=a._sets;l=a._objects;g=h?h.length:0;this.beginPropertyChanges();for(k=0;k<g;k++){j=h[k];if(j&&j.get("length")>0){this.remove(j.source,j)}}if(l){this.removeObjects(l)}this.endPropertyChanges();return this}}j=this._indexSetForSource(a,YES);c=this.get("length");f=c-j.get("length");if(j&&(l=this._objects)){if(d!==undefined){b=SC.IndexSet.create(b,d);d=undefined}l.forEach(function(m){k=a.indexOf(m);if(b.contains(k)){l.remove(m);f--}},this)}j.remove(b,d);i=j.get("length");f+=i;this._indexSetCache=null;if(f!==c){this.propertyDidChange("length");this.enumerableContentDidChange();if(i===0){this.notifyPropertyChange("sources")}}return this},contains:function(b,d,a){if(d===undefined&&a===undefined){return this.containsObject(b)}var c=this.indexSetForSource(b);if(!c){return NO}return c.contains(d,a)},intersects:function(b,d,a){var c=this.indexSetForSource(b,NO);if(!c){return NO}return c.intersects(d,a)},_TMP_ARY:[],addObject:function(b){var c=this._TMP_ARY,a;c[0]=b;a=this.addObjects(c);c.length=0;return a},addObjects:function(a){var d=this._objects,b,c;if(!d){d=this._objects=SC.CoreSet.create()}b=d.get("length");d.addEach(a);c=d.get("length");this._indexSetCache=null;if(c!==b){this.propertyDidChange("length");this.enumerableContentDidChange()}return this},removeObject:function(b){var c=this._TMP_ARY,a;c[0]=b;a=this.removeObjects(c);c.length=0;return a},removeObjects:function(b){var f=this._objects,c,d,a;if(!f){return this}c=f.get("length");f.removeEach(b);d=f.get("length");if(a=this._sets){a.forEach(function(g){c+=g.get("length");g.removeObjects(b);d+=g.get("length")},this)}this._indexSetCache=null;if(d!==c){this.propertyDidChange("length");this.enumerableContentDidChange()}return this},containsObject:function(c){var f=this._objects;if(f&&f.contains(c)){return YES}var d=this._sets,b=d?d.length:0,a,g;for(a=0;a<b;a++){g=d[a];if(g&&g.indexOf(c)>=0){return YES}}return NO},constrain:function(d){var f,b,a,c;this.beginPropertyChanges();this.get("sources").forEach(function(g){if(g===d){return}var h=this._indexSetForSource(d,NO);if(h){this.remove(d,h)}},this);f=this._indexSetForSource(d,NO);if(f&&((a=f.get("max"))>(b=d.get("length")))){this.remove(d,b,a-b)}if(c=this._objects){c.forEach(function(g){if(d.indexOf(g)<0){this.removeObject(g)}},this)}this.endPropertyChanges();return this},isEqual:function(h){var g,d,b,a,c,f;if(!h||!h.isSelectionSet){return NO}if(h===this){return YES}if((this._sets===h._sets)&&(this._objects===h._objects)){return YES}if(this.get("length")!==h.get("length")){return NO}g=this._objects;d=h._objects;if(g||d){if((g?g.get("length"):0)!==(d?d.get("length"):0)){return NO}if(g&&!g.isEqual(d)){return NO}}c=this.get("sources");a=c.get("length");for(b=0;b<a;b++){f=c.objectAt(b);g=this._indexSetForSource(f,NO);d=this._indexSetForSource(f,NO);if(!!d!==!!g){return NO}if(g&&!g.isEqual(d)){return NO}}return YES},clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}if(this._sets){this._sets.length=0}if(this._objects){this._objects=null}this._indexSetCache=null;this.propertyDidChange("length");this.enumerableContentDidChange();this.notifyPropertyChange("sources");return this},copy:function(){var c=this.constructor.create(),d=this._sets,b=d?d.length:0,a,f;if(d&&b>0){d=c._sets=d.slice();for(a=0;a<b;a++){if(!(f=d[a])){continue}f=d[a]=f.copy();c[SC.guidFor(f.source)]=a}}if(this._objects){c._objects=this._objects.copy()}return c},freeze:function(){if(this.get("isFrozen")){return this}var a=this._sets,b=a?a.length:0,c;while(--b>=0){c=a[b];if(c){c.freeze()}}if(this._objects){this._objects.freeze()}this.set("isFrozen",YES);return this},toString:function(){var a=this._sets||[];a=a.map(function(b){return b.toString().replace("SC.IndexSet",SC.guidFor(b.source))},this);if(this._objects){a.push(this._objects.toString())}return"SC.SelectionSet:%@<%@>".fmt(SC.guidFor(this),a.join(","))},firstObject:function(){var b=this._sets,c=this._objects;if(b&&b.get("length")>0){var f=b?b[0]:null,d=f?f.source:null,a=f?f.firstObject():-1;if(d&&a>=0){return d.objectAt(a)}}return c?c.firstObject():undefined}.property(),nextObject:function(c,f,b){var d,a;if(c===0){d=b.objects=[];this.forEach(function(g){d.push(g)},this);b.max=d.length}d=b.objects;a=d[c];if(c+1>=b.max){b.objects=b.max=null}return a},forEach:function(h,f){var c=this._sets,d=this._objects,b=c?c.length:0,g,a;for(a=0;a<b;a++){g=c[a];if(g){g.forEachObject(h,f)}}if(d){d.forEach(h,f)}return this}});SC.SelectionSet.prototype.clone=SC.SelectionSet.prototype.copy;SC.SelectionSet.EMPTY=SC.SelectionSet.create().freeze();sc_require("mixins/delegate_support");SC.SparseArray=SC.Object.extend(SC.Observable,SC.Enumerable,SC.Array,SC.DelegateSupport,{_requestingLength:0,_requestingIndex:0,length:function(){var a=this.delegate;if(a&&SC.none(this._length)&&a.sparseArrayDidRequestLength){this._requestingLength++;a.sparseArrayDidRequestLength(this);this._requestingLength--}return this._length||0}.property().cacheable(),provideLength:function(b){var a;if(SC.none(b)){this._sa_content=null}if(b!==this._length){a=this._length;this._length=b;if(this._requestingLength<=0){this.arrayContentDidChange(0,a||0,b||0)}}return this},rangeWindowSize:1,requestedRangeIndex:null,init:function(){arguments.callee.base.apply(this,arguments);this.requestedRangeIndex=[];this._TMP_PROVIDE_ARRAY=[];this._TMP_PROVIDE_RANGE={length:1};this._TMP_RANGE={}},objectAt:function(a,d){var c=this._sa_content,b;if(!c){c=this._sa_content=[]}if((b=c[a])===undefined){if(!d){this.requestIndex(a)}b=c[a]}return b},definedIndexes:function(d){var c=SC.IndexSet.create(),f=this._sa_content,b,a;if(!f){return c.freeze()}if(d){d.forEach(function(g){if(f[g]!==undefined){c.add(g)}})}else{a=f.length;for(b=0;b<a;b++){if(f[b]!==undefined){c.add(b)}}}return c.freeze()},_TMP_RANGE:{},requestIndex:function(b){var c=this.delegate;if(!c){return this}var a=this.get("rangeWindowSize"),f=b;if(a>1){f=f-Math.floor(f%a)}if(a<1){a=1}this._requestingIndex++;if(c.sparseArrayDidRequestRange){var d=this._TMP_RANGE;if(this.wasRangeRequested(f)===-1){d.start=f;d.length=a;this.requestedRangeIndex.push(f);c.sparseArrayDidRequestRange(this,d)}}else{if(c.sparseArrayDidRequestIndex){while(--a>=0){c.sparseArrayDidRequestIndex(this,f+a)}}}this._requestingIndex--;return this},wasRangeRequested:function(c){var b,a;for(b=0,a=this.requestedRangeIndex.length;b<a;b++){if(this.requestedRangeIndex[b]===c){return b}}return -1},rangeRequestCompleted:function(b){var a=this.wasRangeRequested(b);if(a>=0){this.requestedRangeIndex.removeAt(a,1);return YES}return NO},provideObjectsInRange:function(b,f){var c=this._sa_content;if(!c){c=this._sa_content=[]}var d=b.start,a=b.length;while(--a>=0){c[d+a]=f.objectAt(a)}if(this._requestingIndex<=0){this.arrayContentDidChange(b.start,b.length,b.length)}return this},provideObjectAtIndex:function(c,b){var d=this._TMP_PROVIDE_ARRAY,a=this._TMP_PROVIDE_RANGE;d[0]=b;a.start=c;return this.provideObjectsInRange(a,d)},objectsDidChangeInRange:function(a){var b=this._sa_content;if(b){if(a.start===0&&SC.maxRange(a)>=b.length){this._sa_content=null}else{var d=a.start,c=Math.min(d+a.length,b.length);while(--c>=d){b[c]=undefined}}}this.arrayContentDidChange(a.start,a.length,a.length);return this},indexOf:function(d){var f,b,a=this.delegate;if(a&&a.sparseArrayDidRequestIndexOf){b=a.sparseArrayDidRequestIndexOf(this,d)}if(SC.none(b)){f=this._sa_content;if(!f){f=this._sa_content=[]}b=f.indexOf(d)}return b},replace:function(b,h,f){f=f||[];var c=this.delegate;if(c){if(!c.sparseArrayShouldReplace||!c.sparseArrayShouldReplace(this,b,h,f)){return this}}var d=this._sa_content;if(!d){d=this._sa_content=[]}d.replace(b,h,f);var a=f?(f.get?f.get("length"):f.length):0;var g=a-h;this.arrayContentWillChange(b,h,a);if(!SC.none(this._length)){this.propertyWillChange("length");this._length+=g;this.propertyDidChange("length")}this.arrayContentDidChange(b,h,a);this.enumerableContentDidChange(b,h,g);return this},reset:function(){var a;this._sa_content=null;a=this._length;this._length=null;this.arrayContentDidChange(0,a,0);this.invokeDelegateMethod(this.delegate,"sparseArrayDidReset",this);return this}});SC.SparseArray.array=function(a){return this.create({_length:a||0})};SC.Timer=SC.Object.extend({target:null,action:null,isPooled:NO,interval:0,startTime:null,repeats:NO,until:null,isPaused:NO,isScheduled:NO,isValid:YES,lastFireTime:0,fireTime:function(){if(!this.get("isValid")){return -1}var f=this.get("startTime");if(!f||f===0){return -1}var a=this.get("interval"),c=this.get("lastFireTime");if(c<f){c=f}var b;if(this.get("repeats")){if(a===0){b=c}else{b=f+(Math.floor((c-f)/a)+1)*a}}else{b=f+a}var d=this.get("until");if(d&&d>0&&b>d){b=d}return b}.property("interval","startTime","repeats","until","isValid","lastFireTime").cacheable(),schedule:function(){if(!this.get("isValid")){return this}this.beginPropertyChanges();if(!this.startTime){this.set("startTime",SC.RunLoop.currentRunLoop.get("startTime"))}var a=this.get("fireTime"),b=this.get("lastFireTime");if(a>=b){this.set("isScheduled",YES);SC.RunLoop.currentRunLoop.scheduleTimer(this,a)}this.endPropertyChanges();return this},invalidate:function(){this.beginPropertyChanges();this.set("isValid",NO);var a=SC.RunLoop.currentRunLoop;if(a){a.cancelTimer(this)}this.action=this.target=null;this.endPropertyChanges();if(this.get("isPooled")){SC.Timer.returnTimerToPool(this)}return this},fire:function(){var b=Date.now();this.set("lastFireTime",b);var a=this.get("fireTime");if(!this.get("isPaused")){this.performAction()}if(a>b){this.schedule()}else{this.invalidate()}},performAction:function(){var a=SC.typeOf(this.action);if(a==SC.T_FUNCTION){this.action.call((this.target||this),this)}else{if(a===SC.T_STRING){if(this.action.indexOf(".")>=0){var f=this.action.split(".");var c=f.pop();var d=SC.objectForPropertyPath(f,window);var b=d.get?d.get(c):d[c];if(b&&SC.typeOf(b)==SC.T_FUNCTION){b.call(d,this)}else{throw"%@: Timer could not find a function at %@".fmt(this,this.action)}}else{SC.RootResponder.responder.sendAction(this.action,this.target,this)}}}},init:function(){arguments.callee.base.apply(this,arguments);if(this.startTime instanceof Date){this.startTime=this.startTime.getTime()}if(this.until instanceof Date){this.until=this.until.getTime()}},RESET_DEFAULTS:{target:null,action:null,isPooled:NO,isPaused:NO,isScheduled:NO,isValid:YES,interval:0,repeats:NO,until:null,startTime:null,lastFireTime:0},reset:function(b){if(!b){b=SC.EMPTY_HASH}this.propertyWillChange("fireTime");var c=this.RESET_DEFAULTS;for(var a in c){if(!c.hasOwnProperty(a)){continue}this[a]=SC.none(b[a])?c[a]:b[a]}this.propertyDidChange("fireTime");return this},removeFromTimerQueue:function(c){var b=this._timerQueuePrevious,a=this._timerQueueNext;if(!b&&!a&&c!==this){return c}if(b){b._timerQueueNext=a}if(a){a._timerQueuePrevious=b}this._timerQueuePrevious=this._timerQueueNext=null;return(c===this)?a:c},scheduleInTimerQueue:function(c,b){this._timerQueueRunTime=b;var a=c;var d=null;while(a&&a._timerQueueRunTime<b){d=a;a=a._timerQueueNext}if(d){d._timerQueueNext=this;this._timerQueuePrevious=d}if(a){a._timerQueuePrevious=this;this._timerQueueNext=a}return(a===c)?this:c},collectExpiredTimers:function(c,a){if(this._timerQueueRunTime>a){return this}c.push(this);var b=this._timerQueueNext;this._timerQueueNext=null;if(b){b._timerQueuePrevious=null}return b?b.collectExpiredTimers(c,a):null}});SC.Timer.schedule=function(a){var b;if(!a||SC.none(a.isPooled)||a.isPooled){b=this.timerFromPool(a)}else{b=this.create(a)}return b.schedule()};SC.Timer.timerFromPool=function(a){var b=this._timerPool;if(!b){b=this._timerPool=[]}var c=b.pop();if(!c){c=this.create()}return c.reset(a)};SC.Timer.returnTimerToPool=function(a){if(!this._timerPool){this._timerPool=[]}this._timerPool.push(a);return this};sc_require("system/browser");SC.mixin({normalizeURL:function(a){if(a.slice(0,1)=="/"){a=window.location.protocol+"//"+window.location.host+a}else{if((a.slice(0,5)=="http:")||(a.slice(0,6)=="https:")){}else{a=window.location.href+"/"+a}}return a},isPercentage:function(a){return(a<1&&a>0)},minX:function(a){return a.x||0},maxX:function(a){return(a.x||0)+(a.width||0)},midX:function(a){return(a.x||0)+((a.width||0)/2)},minY:function(a){return a.y||0},maxY:function(a){return(a.y||0)+(a.height||0)},midY:function(a){return(a.y||0)+((a.height||0)/2)},centerX:function(b,a){return(a.width-b.width)/2},centerY:function(b,a){return(a.height-b.height)/2},offset:function(d,c){var f,b,h,a;c=c||"document";if(c==="parent"){a=jQuery(d).position()}else{a=jQuery(d).offset();if(SC.browser.mobileSafari){f=navigator.userAgent;b=f.indexOf("Mobile/");h=f.substring(b+7,b+9);if(parseInt(SC.browser.mobileSafari,0)<=532||(h<="8A")){a.left-=window.pageXOffset;a.top-=window.pageYOffset}}if(c==="viewport"){if(SC.browser.isIE8OrLower){a.left-=$(window).scrollLeft();a.top-=$(window).scrollTop()}else{a.left-=window.pageXOffset;a.top-=window.pageYOffset}}}try{a.x=a.left;a.y=a.top}catch(g){a={x:a.left,y:a.top}}delete a.left;delete a.top;return a},viewportOffset:function(b){console.warn("SC.viewportOffset() has been deprecated in favor of SC.offset().  Please use SC.offset() from here on.");var a=SC.offset(b,"viewport");return{x:a.left,y:a.top}}});SC.mixin({ZERO_POINT:{x:0,y:0},pointInRect:function(a,b){return(a.x>=SC.minX(b))&&(a.y>=SC.minY(b))&&(a.x<=SC.maxX(b))&&(a.y<=SC.maxY(b))},rectsEqual:function(b,a,c){if(!b||!a){return(b==a)}if(!c&&c!==0){c=0.1}if((b.y!=a.y)&&(Math.abs(b.y-a.y)>c)){return NO}if((b.x!=a.x)&&(Math.abs(b.x-a.x)>c)){return NO}if((b.width!=a.width)&&(Math.abs(b.width-a.width)>c)){return NO}if((b.height!=a.height)&&(Math.abs(b.height-a.height)>c)){return NO}return YES},intersectRects:function(b,a){var c={x:Math.max(SC.minX(b),SC.minX(a)),y:Math.max(SC.minY(b),SC.minY(a)),width:Math.min(SC.maxX(b),SC.maxX(a)),height:Math.min(SC.maxY(b),SC.maxY(a))};c.width=Math.max(0,c.width-c.x);c.height=Math.max(0,c.height-c.y);return c},unionRects:function(b,a){var c={x:Math.min(SC.minX(b),SC.minX(a)),y:Math.min(SC.minY(b),SC.minY(a)),width:Math.max(SC.maxX(b),SC.maxX(a)),height:Math.max(SC.maxY(b),SC.maxY(a))};c.width=Math.max(0,c.width-c.x);c.height=Math.max(0,c.height-c.y);return c},cloneRect:function(a){return{x:a.x,y:a.y,width:a.width,height:a.height}},stringFromRect:function(a){if(!a){return"(null)"}else{return"{x:"+a.x+", y:"+a.y+", width:"+a.width+", height:"+a.height+"}"}}});sc_require("panes/pane");sc_require("panes/keyboard");sc_require("panes/layout");sc_require("panes/manipulation");sc_require("panes/visibility");SC.MainPane=SC.Pane.extend({layout:{top:0,left:0,bottom:0,right:0,minHeight:200,minWidth:200},init:function(){var c={x:0,y:0,width:1000,height:1000},a=this.get("layout"),b=false;if(document&&document.body){c.width=document.body.clientWidth;c.height=document.body.clientHeight;if(a.minHeight||a.minWidth){if((a.minHeight&&c.height<a.minHeight)||(a.minWidth&&c.width<a.minWidth)){SC.bodyOverflowArbitrator.requestVisible(this)}else{SC.bodyOverflowArbitrator.requestHidden(this)}}}arguments.callee.base.apply(this,arguments)},paneDidAttach:function(){var b=arguments.callee.base.apply(this,arguments),a=this.rootResponder;a.makeMainPane(this);if(!a.get("keyRootView")){a.makeKeyPane(this)}return b},acceptsKeyPane:YES,classNames:["sc-main"]});SC.routes=SC.Object.create({wantsHistory:NO,usesHistory:null,baseURI:document.baseURI,_didSetup:NO,_location:null,_firstRoute:null,_extractParametersAndRoute:function(c){var a={},j=c.route||"",f,b,d,h,g,k;f=(j.indexOf("?")<0&&j.indexOf("&")>=0)?"&":"?";b=j.split(f);j=b[0];if(b.length===1){b=[]}else{if(b.length===2){b=b[1].split("&")}else{if(b.length>2){b.shift()}}}h=b.length;for(d=0;d<h;++d){g=b[d].split("=");a[g[0]]=g[1]}for(k in c){if(c.hasOwnProperty(k)&&k!=="route"){a[k]=""+c[k]}}b=[];for(k in a){b.push([k,a[k]].join("="))}a.params=f+b.join("&");a.route=j;return a},location:function(a,b){this._skipRoute=NO;return this._extractLocation(a,b)}.property(),informLocation:function(a,b){this._skipRoute=YES;var c=this.location.lastSetValueKey;if(c&&this._kvo_cache){this._kvo_cache[c]=b}return this._extractLocation(a,b)}.property(),_extractLocation:function(c,d){var a,b;if(d!==undefined){if(d===null){d=""}if(typeof(d)==="object"){a=this._extractParametersAndRoute(d);d=a.route+a.params}if(!SC.empty(d)||(this._location&&this._location!==d)){b=encodeURI(d);if(this.usesHistory){if(b.length>0){b="/"+b}window.history.pushState(null,null,this.get("baseURI")+b)}else{window.location.hash=b}}this._location=d}return this._location},ping:function(){var a;if(!this._didSetup){this._didSetup=YES;if(this.get("wantsHistory")&&SC.platform.supportsHistory){this.usesHistory=YES;this.popState();SC.Event.add(window,"popstate",this,this.popState)}else{this.usesHistory=NO;if(SC.platform.supportsHashChange){this.hashChange();SC.Event.add(window,"hashchange",this,this.hashChange)}else{a=this;this._invokeHashChange=function(){a.hashChange();setTimeout(a._invokeHashChange,100)};this._invokeHashChange()}}}},hashChange:function(a){var b=window.location.hash;b=(b&&b.length>0)?b.slice(1,b.length):"";if(!SC.browser.isMozilla){b=decodeURI(b)}if(this.get("location")!==b&&!this._skipRoute){SC.run(function(){this.set("location",b)},this)}this._skipRoute=false},popState:function(a){var b=this.get("baseURI"),c=document.location.href;if(c.slice(0,b.length)===b){c=c.slice(b.length+1,c.length);if(this.get("location")!==c&&!this._skipRoute){SC.run(function(){this.set("location",c)},this)}}this._skipRoute=false},add:function(a,b,c){if(!this._didSetup){this.invokeLast(this.ping)}if(c===undefined&&SC.typeOf(b)===SC.T_FUNCTION){c=b;b=null}else{if(SC.typeOf(c)===SC.T_STRING){c=b[c]}}if(!this._firstRoute){this._firstRoute=this._Route.create()}this._firstRoute.add(a.split("/"),b,c);return this},locationDidChange:function(){this.trigger()}.observes("location"),trigger:function(){var a=this._firstRoute,b=this.get("location"),d,c;if(a){d=this._extractParametersAndRoute({route:b});b=d.route;delete d.route;delete d.params;c=a.routeForParts(b.split("/"),d);if(c&&c.method){c.method.call(c.target||this,d)}}},_Route:SC.Object.extend({target:null,method:null,staticRoutes:null,dynamicRoutes:null,wildcardRoutes:null,add:function(c,b,f){var a,d;c=SC.clone(c);if(!c||c.length===0){this.target=b;this.method=f}else{a=c.shift();switch(a.slice(0,1)){case":":a=a.slice(1,a.length);if(!this.dynamicRoutes){this.dynamicRoutes={}}if(!this.dynamicRoutes[a]){this.dynamicRoutes[a]=this.constructor.create()}d=this.dynamicRoutes[a];break;case"*":a=a.slice(1,a.length);if(!this.wildcardRoutes){this.wildcardRoutes={}}d=this.wildcardRoutes[a]=this.constructor.create();break;default:if(!this.staticRoutes){this.staticRoutes={}}if(!this.staticRoutes[a]){this.staticRoutes[a]=this.constructor.create()}d=this.staticRoutes[a]}if(d){d.add(c,b,f)}}},routeForParts:function(d,f){var b,c,a;d=SC.clone(d);if(!d||d.length===0){return this.method?this:null}else{b=d.shift();if(this.staticRoutes&&this.staticRoutes[b]){return this.staticRoutes[b].routeForParts(d,f)}else{for(c in this.dynamicRoutes){a=this.dynamicRoutes[c].routeForParts(d,f);if(a){f[c]=b;return a}}for(c in this.wildcardRoutes){d.unshift(b);f[c]=d.join("/");return this.wildcardRoutes[c].routeForParts(null,f)}return null}}}})});SC.SCANNER_OUT_OF_BOUNDS_ERROR=new Error("Out of bounds.");SC.SCANNER_INT_ERROR=new Error("Not an int.");SC.SCANNER_SKIP_ERROR=new Error("Did not find the string to skip.");SC.SCANNER_SCAN_ARRAY_ERROR=new Error("Did not find any string of the given array to scan.");SC.DATETIME_COMPAREDATE_TIMEZONE_ERROR=new Error("Can't compare the dates of two DateTimes that don't have the same timezone.");SC.DATETIME_ISO8601="%Y-%m-%dT%H:%M:%S%Z";SC.Scanner=SC.Object.extend({string:null,scanLocation:0,scan:function(a){if(this.scanLocation+a>this.length){throw SC.SCANNER_OUT_OF_BOUNDS_ERROR}var b=this.string.substr(this.scanLocation,a);this.scanLocation+=a;return b},scanInt:function(c,f){if(f===undefined){f=c}var d=this.scan(f);var b=new RegExp("^\\d{"+c+","+f+"}");var a=d.match(b);if(!a){throw SC.SCANNER_INT_ERROR}if(a[0].length<f){this.scanLocation+=a[0].length-f}return parseInt(a[0],10)},skipString:function(a){if(this.scan(a.length)!==a){throw SC.SCANNER_SKIP_ERROR}return YES},scanArray:function(c){for(var b=0,a=c.length;b<a;b++){if(this.scan(c[b].length)===c[b]){return b}this.scanLocation-=c[b].length}throw SC.SCANNER_SCAN_ARRAY_ERROR}});SC.DateTime=SC.Object.extend(SC.Freezable,SC.Copyable,{_ms:0,timezone:0,isFrozen:YES,adjust:function(b,a){var c;b=b?SC.clone(b):{};c=(b.timezone!==undefined)?b.timezone:(this.timezone!==undefined)?this.timezone:0;return this.constructor._adjust(b,this._ms,c,a)._createFromCurrentState()},advance:function(a){return this.constructor._advance(a,this._ms,this.timezone)._createFromCurrentState()},unknownProperty:function(a){return this.constructor._get(a,this._ms,this.timezone)},toFormattedString:function(a){return this.constructor._toFormattedString(a,this._ms,this.timezone)},toISO8601:function(){return this.constructor._toFormattedString(SC.DATETIME_ISO8601,this._ms,this.timezone)},toString:function(){return"UTC: "+new Date(this._ms).toUTCString()+", timezone: "+this.timezone},isEqual:function(a){return this.constructor.compare(this,a)===0},copy:function(){return this},toTimezone:function(a){if(a===undefined){a=0}return this.advance({timezone:a-this.timezone})}});SC.DateTime.mixin(SC.Comparable,{recordFormat:SC.DATETIME_ISO8601,dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_englishDayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AMPMNames:["AM","PM"],_date:new Date(),_tz:0,timezone:new Date().getTimezoneOffset(),_dt_cache:{},_dt_cache_index:-1,_DT_CACHE_MAX_LENGTH:1000,_setCalcState:function(a,c){var b={milliseconds:this._date.getTime(),timezone:this._tz};if(a!==undefined){this._date.setTime(a)}if(c!==undefined){this._tz=c}return b},_setCalcStateFromHash:function(c,b){var d=(b!==undefined)?b:this._tz;var a=this._toMilliseconds(c,this._ms,d);return this._setCalcState(a,d)},_get:function(x,b,o){var n,u,i,p,f,k,l,g,q,a;var c,j;var t=this._date;var r,h=null;r=this._setCalcState(b,o);if(x==="milliseconds"){h=t.getTime()}else{if(x==="timezone"){h=this._tz}}if(h===null){q=x.slice(0,4);a=x.slice(4);if(q==="last"||q==="next"){c=this._get("dayOfWeek",b,o);j=this._englishDayNames.indexOf(a);if(j>=0){var w=j-c;if(q==="last"&&w>=0){w-=7}if(q==="next"&&w<0){w+=7}this._advance({day:w},b,o);h=this._createFromCurrentState()}}}if(h===null){if(o!==undefined){this._setCalcState(t.getTime()-(o*60000),0)}switch(x){case"year":h=t.getUTCFullYear();break;case"month":h=t.getUTCMonth()+1;break;case"day":h=t.getUTCDate();break;case"dayOfWeek":h=t.getUTCDay();break;case"hour":h=t.getUTCHours();break;case"minute":h=t.getUTCMinutes();break;case"second":h=t.getUTCSeconds();break;case"millisecond":h=t.getUTCMilliseconds();break}if((h===null)&&(x==="isLeapYear")){f=this._get("year");h=(f%4===0&&f%100!==0)||f%400===0}if((h===null)&&(x==="daysInMonth")){switch(this._get("month")){case 4:case 6:case 9:case 11:h=30;break;case 2:h=this._get("isLeapYear")?29:28;break;default:h=31;break}}if((h===null)&&(x==="dayOfYear")){n=t.getTime();i=this._get("day");this._setCalcStateFromHash({day:1});for(p=this._get("month")-1;p>0;p--){this._setCalcStateFromHash({month:p});i+=this._get("daysInMonth")}t.setTime(n);h=i}if((h===null)&&(x.slice(0,4)==="week")){k=x.length===4?1:parseInt(x.slice("4"),10);l=this._get("dayOfWeek");g=this._get("dayOfYear")-1;if(k===0){h=parseInt((g-l+7)/7,10)}else{h=parseInt((g-(l-1+7)%7+7)/7,10)}}}this._setCalcState(r.milliseconds,r.timezone);return h},_adjust:function(c,g,f,a){var d=c?SC.clone(c):{};var b=this._toMilliseconds(c,g,f,a);this._setCalcState(b,f);return this},_advance:function(a,g,d){var c=a?SC.clone(a):{};var f;for(var b in c){c[b]+=this._get(b,g,d)}f=(c.timezone!==undefined)?c.timezone:d;return this._adjust(c,g,f,NO)},_toMilliseconds:function(k,c,i,g){var a=k?SC.clone(k):{};var j=this._date;var h=j.getTime();var b,f;if(!SC.none(c)){j.setTime(c)}f=(i!==undefined)?i:(this.timezone!==undefined)?this.timezone:0;j.setTime(j.getTime()-(f*60000));if(g===undefined||g===YES){if(!SC.none(a.hour)&&SC.none(a.minute)){a.minute=0}if(!(SC.none(a.hour)&&SC.none(a.minute))&&SC.none(a.second)){a.second=0}if(!(SC.none(a.hour)&&SC.none(a.minute)&&SC.none(a.second))&&SC.none(a.millisecond)){a.millisecond=0}}if(SC.none(a.year)){a.year=j.getUTCFullYear()}if(SC.none(a.month)){a.month=j.getUTCMonth()+1}if(SC.none(a.day)){a.day=j.getUTCDate()}if(SC.none(a.hour)){a.hour=j.getUTCHours()}if(SC.none(a.minute)){a.minute=j.getUTCMinutes()}if(SC.none(a.second)){a.second=j.getUTCSeconds()}if(SC.none(a.millisecond)){a.millisecond=j.getUTCMilliseconds()}b=Date.UTC(a.year,a.month-1,a.day,a.hour,a.minute,a.second,a.millisecond);j.setTime(b+(f*60000));b=j.getTime();j.setTime(h);return b},create:function(){var j=arguments.length===0?{}:arguments[0];var d;if(SC.typeOf(j)===SC.T_NUMBER){j={milliseconds:j}}d=(j.timezone!==undefined)?j.timezone:this.timezone;if(d===undefined){d=0}if(!SC.none(j.milliseconds)){var i="nu"+j.milliseconds+d,a=this._dt_cache;var f=a[i];if(!f){var g,h=this._dt_cache_index,b=this;f=a[i]=new b([{_ms:j.milliseconds,timezone:d}]);h=this._dt_cache_index=(h+1)%this._DT_CACHE_MAX_LENGTH;g=a[h];if(g!==undefined&&a[g]){delete a[g]}a[h]=i}return f}else{var c=new Date();return this.create({milliseconds:this._toMilliseconds(j,c.getTime(),d,j.resetCascadingly),timezone:d})}},_createFromCurrentState:function(){return this.create({milliseconds:this._date.getTime(),timezone:this._tz})},parse:function(o,c){var p=new RegExp("(?:%([aAbBcdDhHiIjmMpsSUWwxXyYZ%])|(.))","g");var n,j,a={},b={},i=SC.Scanner.create({string:o});if(SC.none(c)){c=SC.DATETIME_ISO8601}try{while((j=p.exec(c))!==null){switch(j[1]){case"a":b.dayOfWeek=i.scanArray(this.abbreviatedDayNames);break;case"A":b.dayOfWeek=i.scanArray(this.dayNames);break;case"b":a.month=i.scanArray(this.abbreviatedMonthNames)+1;break;case"B":a.month=i.scanArray(this.monthNames)+1;break;case"c":throw"%c is not implemented";case"d":case"D":a.day=i.scanInt(1,2);break;case"h":case"H":a.hour=i.scanInt(1,2);break;case"i":case"I":a.hour=i.scanInt(1,2);break;case"j":throw"%j is not implemented";case"m":a.month=i.scanInt(1,2);break;case"M":a.minute=i.scanInt(1,2);break;case"p":a.meridian=i.scanArray(this.AMPMNames);break;case"S":a.second=i.scanInt(1,2);break;case"s":a.millisecond=i.scanInt(1,3);break;case"U":throw"%U is not implemented";case"W":throw"%W is not implemented";case"w":throw"%w is not implemented";case"x":throw"%x is not implemented";case"X":throw"%X is not implemented";case"y":a.year=i.scanInt(2);a.year+=(a.year>70?1900:2000);break;case"Y":a.year=i.scanInt(4);break;case"Z":var g=i.scan(1);if(g==="Z"){a.timezone=0}else{if(g==="+"||g==="-"){var k=i.scanInt(2);if(i.scan(1)!==":"){i.scan(-1)}var f=i.scanInt(2);a.timezone=(g==="+"?-1:1)*(k*60+f)}}break;case"%":i.skipString("%");break;default:i.skipString(j[0]);break}}}catch(l){SC.Logger.log("SC.DateTime.createFromString "+l.toString());return null}if(!SC.none(a.meridian)&&!SC.none(a.hour)){if((a.meridian===1&&a.hour!==12)||(a.meridian===0&&a.hour===12)){a.hour=(a.hour+12)%24}delete a.meridian}n=this.create(a);if(!SC.none(b.dayOfWeek)&&n.get("dayOfWeek")!==b.dayOfWeek){return null}return n},_pad:function(b,a){var c=""+b;if(a===undefined){a=2}while(c.length<a){c="0"+c}return c},__toFormattedString:function(b,f,c){var a,d;switch(b[1]){case"a":return this.abbreviatedDayNames[this._get("dayOfWeek")];case"A":return this.dayNames[this._get("dayOfWeek")];case"b":return this.abbreviatedMonthNames[this._get("month")-1];case"B":return this.monthNames[this._get("month")-1];case"c":return this._date.toString();case"d":return this._pad(this._get("day"));case"D":return this._get("day");case"h":return this._get("hour");case"H":return this._pad(this._get("hour"));case"i":a=this._get("hour");return(a===12||a===0)?12:(a+12)%12;case"I":a=this._get("hour");return this._pad((a===12||a===0)?12:(a+12)%12);case"j":return this._pad(this._get("dayOfYear"),3);case"m":return this._pad(this._get("month"));case"M":return this._pad(this._get("minute"));case"p":return this._get("hour")>11?this.AMPMNames[1]:this.AMPMNames[0];case"S":return this._pad(this._get("second"));case"s":return this._pad(this._get("millisecond"),3);case"u":return this._pad(this._get("utc"));case"U":return this._pad(this._get("week0"));case"W":return this._pad(this._get("week1"));case"w":return this._get("dayOfWeek");case"x":return this._date.toDateString();case"X":return this._date.toTimeString();case"y":return this._pad(this._get("year")%100);case"Y":return this._get("year");case"Z":d=-1*c;return(d>=0?"+":"-")+this._pad(parseInt(Math.abs(d)/60,10))+":"+this._pad(Math.abs(d)%60);case"%":return"%"}},_toFormattedString:function(c,f,b){var a=this;var d=(b!==undefined)?b:(this.timezone!==undefined)?this.timezone:0;this._setCalcState(f-(b*60000),0);return c.replace(/\%([aAbBcdDhHiIjmMpsSUWwxXyYZ\%])/g,function(){var g=a.__toFormattedString.call(a,arguments,f,b);return g})},compare:function(d,c){var g=d.get("milliseconds");var f=c.get("milliseconds");return g<f?-1:g===f?0:1},compareDate:function(d,c){if(d.get("timezone")!==c.get("timezone")){throw SC.DATETIME_COMPAREDATE_TIMEZONE_ERROR}var g=d.adjust({hour:0}).get("milliseconds");var f=c.adjust({hour:0}).get("milliseconds");return g<f?-1:g===f?0:1}});SC.Binding.dateTime=function(a){return this.transform(function(b,c){return b?b.toFormattedString(a):null})};SC.stringsFor("English",{"_SC.DateTime.dayNames":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday","_SC.DateTime.abbreviatedDayNames":"Sun Mon Tue Wed Thu Fri Sat","_SC.DateTime.monthNames":"January February March April May June July August September October November December","_SC.DateTime.abbreviatedMonthNames":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec","_SC.DateTime.AMPMNames":"AM PM"});SC.DateTime.mixin({_setup:function(){SC.DateTime.dayNames=SC.String.w(SC.String.loc("_SC.DateTime.dayNames"));SC.DateTime.abbreviatedDayNames=SC.String.w(SC.String.loc("_SC.DateTime.abbreviatedDayNames"));SC.DateTime.monthNames=SC.String.w(SC.String.loc("_SC.DateTime.monthNames"));SC.DateTime.abbreviatedMonthNames=SC.String.w(SC.String.loc("_SC.DateTime.abbreviatedMonthNames"));SC.DateTime.AMPMNames=SC.String.w(SC.String.loc("_SC.DateTime.AMPMNames"))}});jQuery(document).ready(function(){SC.DateTime._setup()});SC.Response=SC.Object.extend({isResponse:YES,isError:NO,errorValue:function(){return this}.property().cacheable(),errorObject:null,request:null,originalRequest:function(){var a=this.get("request");while(a.get("source")){a=a.get("source")}return a}.property("request").cacheable(),type:function(){return this.getPath("request.type")}.property("request").cacheable(),address:function(){return this.getPath("request.address")}.property("request").cacheable(),isJSON:function(){return this.getPath("request.isJSON")||NO}.property("request").cacheable(),isXML:function(){return this.getPath("request.isXML")||NO}.property("request").cacheable(),listeners:function(){return this.getPath("request.listeners")}.property("request").cacheable(),status:-100,headers:null,body:function(){var a=this.get("encodedBody");if(a&&this.get("isJSON")){try{a=SC.json.decode(a)}catch(b){return SC.Error.create({message:b.name+": "+b.message,label:"Response",errorValue:this})}}return a}.property("encodedBody").cacheable(),response:function(){return this.get("body")}.property("body").cacheable(),isCancelled:NO,timedOut:null,timeoutTimer:null,fire:function(){var a=this.get("request"),c=a?a.get("source"):null;if(c&&c.willSend){c.willSend(a,this)}a.freeze();if(!this.get("isCancelled")){this.invokeTransport()}var b=a.get("timeout");if(b){var d=SC.Timer.schedule({target:this,action:"timeoutReached",interval:b,repeats:NO});this.set("timeoutTimer",d)}if(!this.get("isCancelled")&&c&&c.didSend){c.didSend(a,this)}},invokeTransport:function(){this.receive(function(a){this.set("status",200)},this)},receive:function(f,a){if(!this.get("timedOut")){var d=this.get("timeoutTimer");if(d){d.invalidate()}this.set("timedOut",NO)}var b=this.get("request");var c=b?b.get("source"):null;SC.run(function(){if(c&&c.willReceive){c.willReceive(b,this)}f.call(a,!this.get("isCancelled"));if(!this.get("isCancelled")&&c&&c.didReceive){c.didReceive(b,this)}if(!this.get("isCancelled")){this.notify()}},this);SC.Request.manager.transportDidClose(this);return this},cancel:function(){if(!this.get("isCancelled")){this.set("isCancelled",YES);this.cancelTransport();SC.Request.manager.transportDidClose(this)}},timeoutReached:function(){if(this.get("timedOut")===null){this.set("timedOut",YES);this.cancelTransport();this.receive(function(b){if(!b){return}var a=SC.$error("HTTP Request timed out","Request",0);a.set("errorValue",this);this.set("isError",YES);this.set("errorObject",a);this.set("status",0)},this);return YES}return NO},cancelTransport:function(){},_notifyListeners:function(j,c){var k=j[c],a,h,b;if(!k){return NO}var f=NO;var g=k.length;for(var d=0;d<g;d++){var l=k[d];a=(l.params||[]).copy();a.unshift(this);h=l.target;b=l.action;if(SC.typeOf(b)===SC.T_STRING){b=h[b]}f=b.apply(h,a)}return f},notify:function(){var b=this.get("listeners"),a=this.get("status"),c=Math.floor(a/100)*100,d=NO;if(!b){return this}d=this._notifyListeners(b,a);if(!d&&c!==a){d=this._notifyListeners(b,c)}if(!d&&a!==0){d=this._notifyListeners(b,0)}return this},toString:function(){var a=arguments.callee.base.apply(this,arguments);return"%@<%@ %@, status=%@".fmt(a,this.get("type"),this.get("address"),this.get("status"))}});SC.XHRResponse=SC.Response.extend({headers:function(){var c=this.get("rawRequest"),b=c?c.getAllResponseHeaders():null,a={};if(!b){return a}b.split("\n").forEach(function(h){var d=h.indexOf(":"),f,g;if(d>=0){f=h.slice(0,d);g=h.slice(d+1).trim();a[f]=g}},this);return a}.property("status").cacheable(),header:function(a){var b=this.get("rawRequest");return b?b.getResponseHeader(a):null},encodedBody:function(){var a=this.get("rawRequest");if(!a){return null}if(this.get("isXML")){return a.responseXML}return a.responseText}.property("status").cacheable(),cancelTransport:function(){var a=this.get("rawRequest");if(a){a.abort()}this.set("rawRequest",null)},invokeTransport:function(){var d,g,b,c,f;d=this.createRequest();this.set("rawRequest",d);c=!!this.getPath("request.isAsynchronous");if(c){if(!SC.browser.isIE&&!SC.browser.isOpera){SC.Event.add(d,"readystatechange",this,this.finishRequest,d)}else{g=this;b=function(){if(!g){return null}var h=g.finishRequest();if(h){g=null}return h};d.onreadystatechange=b}}d.open(this.get("type"),this.get("address"),c);f=this.getPath("request.headers");for(var a in f){d.setRequestHeader(a,f[a])}d.send(this.getPath("request.encodedBody"));if(!c){this.finishRequest()}return d},createRequest:function(){function a(){for(var b=0;b<arguments.length;b++){try{var c=arguments[b]();return c}catch(d){}}return NO}return a(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})},finishRequest:function(c){var f=this.get("rawRequest"),a=f.readyState,d,b,g;if(a===4&&!this.get("timedOut")){this.receive(function(h){if(!h){return}b=-1;try{b=f.status||0}catch(j){}if((b<200)||(b>=300)){try{g=f.statusText||""}catch(i){g=""}d=SC.$error(g||"HTTP Request failed","Request",b);d.set("errorValue",this);this.set("isError",YES);this.set("errorObject",d)}this.set("status",b)},this);if(!SC.browser.isIE&&!SC.browser.isOpera){SC.Event.remove(f,"readystatechange",this,this.finishRequest)}else{f.onreadystatechange=null}return YES}return NO}});sc_require("system/response");SC.Request=SC.Object.extend(SC.Copyable,SC.Freezable,{isAsynchronous:YES,isJSON:NO,isXML:NO,attachIdentifyingHeaders:YES,headers:function(){var a=this._headers;if(!a){a=this._headers={}}return a}.property().cacheable(),responseClass:SC.XHRResponse,source:null,address:null,type:"GET",timeout:null,body:null,encodedBody:function(){var a=this.get("body");if(a&&this.get("isJSON")){a=SC.json.encode(a)}return a}.property("isJSON","isXML","body").cacheable(),willSend:function(b,a){},didSend:function(b,a){},willReceive:function(b,a){},didReceive:function(b,a){},concatenatedProperties:"COPY_KEYS",COPY_KEYS:["attachIdentifyingHeaders","isAsynchronous","isJSON","isXML","address","type","timeout","body","responseClass","willSend","didSend","willReceive","didReceive"],copy:function(){var a={},d=this.COPY_KEYS,g=d.length,b,c,f;while(--g>=0){b=d[g];if(this.hasOwnProperty(b)){a[b]=this.get(b)}}if(this.hasOwnProperty("listeners")){a.listeners=SC.copy(this.get("listeners"))}if(this.hasOwnProperty("_headers")){a._headers=SC.copy(this._headers)}a.source=this.get("source")||this;return this.constructor.create(a)},header:function(a,b){var c;if(SC.typeOf(a)===SC.T_STRING){c=this._headers;if(arguments.length===1){return c?c[a]:null}else{this.propertyWillChange("headers");if(!c){c=this._headers={}}c[a]=b;this.propertyDidChange("headers");return this}}else{if(b===undefined){c=a;this.beginPropertyChanges();for(a in c){if(!c.hasOwnProperty(a)){continue}this.header(a,c[a])}this.endPropertyChanges();return this}}return this},clearHeaders:function(){this.propertyWillChange("headers");this._headers={};this.propertyDidChange("headers")},async:function(a){if(a===undefined){a=YES}return this.set("isAsynchronous",a)},timeoutAfter:function(a){return this.set("timeout",a)},json:function(a){if(a===undefined){a=YES}if(a){this.set("isXML",NO)}return this.set("isJSON",a)},xml:function(a){if(a===undefined){a=YES}if(a){this.set("isJSON",NO)}return this.set("isXML",a)},_prep:function(){var a=!!this.header("Content-Type");if(this.get("attachIdentifyingHeaders")){this.header("X-Requested-With","XMLHttpRequest");this.header("X-SproutCore-Version",SC.VERSION)}if(this.get("isJSON")&&!a){this.header("Content-Type","application/json")}else{if(this.get("isXML")&&!a){this.header("Content-Type","text/xml")}}return this},send:function(a){var b=this.get("timeout");if(b&&!this.get("isAsynchronous")){throw"Timeout values cannot be used with synchronous requests"}else{if(b===0){throw"The timeout value must either not be specified or must be greater than 0"}}if(a){this.set("body",a)}return SC.Request.manager.sendRequest(this.copy()._prep())},resend:function(){var a=this.get("source")?this:this.copy()._prep();return SC.Request.manager.sendRequest(a)},notify:function(a,f,d,g){var c=YES;if(SC.typeOf(a)!==SC.T_NUMBER){g=SC.A(arguments).slice(2);d=f;f=a;a=0;c=NO}else{g=SC.A(arguments).slice(3)}var b=this.get("listeners");if(!b){this.set("listeners",b={})}if(!b[a]){b[a]=[]}b[a].push({target:f,action:d,params:g});return this}});SC.Request.mixin({getUrl:function(a){return this.create().set("address",a).set("type","GET")},postUrl:function(b,a){var c=this.create().set("address",b).set("type","POST");if(a){c.set("body",a)}return c},deleteUrl:function(a){return this.create().set("address",a).set("type","DELETE")},putUrl:function(b,a){var c=this.create().set("address",b).set("type","PUT");if(a){c.set("body",a)}return c},patchUrl:function(b,a){var c=this.create().set("address",b).set("type","PATCH");if(a){c.set("body",a)}return c}});SC.Request.manager=SC.Object.create({maxRequests:6,inflight:[],pending:[],sendRequest:function(b){if(!b){return null}var a=b.get("responseClass").create({request:b});this.get("pending").pushObject(a);this.fireRequestIfNeeded();return a},cancel:function(b){var d=this.get("pending"),c=this.get("inflight"),a;if(d.indexOf(b)>=0){this.propertyWillChange("pending");d.removeObject(b);this.propertyDidChange("pending");return YES}else{if(c.indexOf(b)>=0){b.cancel();c.removeObject(b);this.fireRequestIfNeeded();return YES}}return NO},cancelAll:function(){if(this.get("pending").length||this.get("inflight").length){this.set("pending",[]);this.get("inflight").forEach(function(a){a.cancel()});this.set("inflight",[]);return YES}return NO},fireRequestIfNeeded:function(){var d=this.get("pending"),c=this.get("inflight"),a=this.get("maxRequests"),b;if((d.length>0)&&(c.length<a)){b=d.shiftObject();c.pushObject(b);b.fire()}},transportDidClose:function(a){this.get("inflight").removeObject(a);this.fireRequestIfNeeded()}});SC.FOCUS_ALL_CONTROLS=NO;SC.ready(function(){var a=SC.SAFARI_FOCUS_BEHAVIOR;if(a!==null&&a!==undefined){SC.FOCUS_ALL_CONTROLS=SC.SAFARI_FOCUS_BEHAVIOR}});SC.TreeItemContent={isTreeItemContent:YES,treeItemChildren:null,treeItemIsExpanded:YES,treeItemIsGrouped:NO,treeItemDisclosureState:function(b,a){return this.get("treeItemIsExpanded")?SC.BRANCH_OPEN:SC.BRANCH_CLOSED},treeItemCollapse:function(b,a){this.setIfChanged("treeItemIsExpanded",NO)},treeItemExpand:function(b,a){this.setIfChanged("treeItemIsExpanded",YES)},treeItemBranchIndexes:function(f,c){var d=this.get("treeItemChildren"),b,h,a,g;if(!d){return null}b=SC.IndexSet.create();h=d.get("length");for(a=0;a<h;a++){if(!(g=d.objectAt(a))){continue}if(!g.get("treeItemChildren")){continue}if(g.treeItemDisclosureState(this,a)!==SC.LEAF_NODE){b.add(a)}}return b.get("length")>0?b:null}};SC.BRANCH_OPEN=17;SC.BRANCH_CLOSED=18;SC.LEAF_NODE=32;SC.CollectionContent={isCollectionContent:YES,contentIndexIsSelected:function(b,c,a){var d=b.get("selection");return d?d.contains(c,a):NO},contentIndexIsEnabled:function(b,c,a){return b.get("isEnabled")},contentGroupIndexes:function(a,b){return null},contentIndexIsGroup:function(b,c,a){return NO},contentIndexOutlineLevel:function(b,c,a){return -1},contentIndexDisclosureState:function(b,c,a){return SC.LEAF_NODE},contentIndexExpand:function(b,c,a){SC.Logger.log("contentIndexExpand(%@, %@, %@)".fmt(b,c,a))},contentIndexCollapse:function(b,c,a){SC.Logger.log("contentIndexCollapse(%@, %@, %@)".fmt(b,c,a))}};sc_require("mixins/tree_item_content");sc_require("mixins/collection_content");SC.TreeItemObserver=SC.Object.extend(SC.Array,SC.CollectionContent,{item:null,delegate:null,parentObserver:null,parentItem:function(){var a=this.get("parentObserver");return a?a.get("item"):null}.property("parentObserver").cacheable(),index:null,outlineLevel:0,children:null,disclosureState:SC.BRANCH_OPEN,branchIndexes:function(){var f=this.get("item"),b,g,a,d,c;if(!f){return SC.IndexSet.EMPTY}else{if(f.isTreeItemContent){g=this.get("parentItem");a=this.get("index");return f.treeItemBranchIndexes(g,a)}else{d=this.get("children");if(!d){return null}c=SC.IndexSet.create();b=d.get("length");g=f;for(a=0;a<b;a++){if(!(f=d.objectAt(a))){continue}if(!this._computeChildren(f,g,a)){continue}if(this._computeDisclosureState(f,g,a)!==SC.LEAF_NODE){c.add(a)}}return c.get("length")>0?c:null}}}.property("children").cacheable(),isHeaderVisible:function(){return !!this.get("parentObserver")}.property("parentObserver").cacheable(),length:0,objectAt:function(g,c){var h=this.get("length"),j=this.get("item"),a=this._objectAtCache,i=g,f=0,d,b;if(g>=h){return undefined}if(this.get("isHeaderVisible")){if(g===0){return j}else{i--}}j=null;if(!a){a=this._objectAtCache=[]}if((j=a[g])!==undefined){return j}b=this.get("children");if(!b){return undefined}if(d=this.get("branchIndexes")){d.forEach(function(m){if(j||(m>i)){return}var l=this.branchObserverAt(m),k;if(!l){return}k=l.get("length");if(m+k>i){j=l.objectAt(i-m,c);i=-1}else{i-=k-1}},this)}if(i>=0){j=b.objectAt(i,c)}a[g]=j;return j},replace:function(a,b,k,d){var j=a,h=null,f,g,i;if(d===undefined){d=SC.DROP_BEFORE}if(this.get("isHeaderVisible")){j--}if(j<0){throw"Tree Item cannot replace itself"}if(f=this.get("branchIndexes")){f.forEach(function(l){if(h||(l>=j)){return}if(!(h=this.branchObserverAt(l))){return}g=h.get("length");if((l+g===j)&&d===SC.DROP_AFTER){j-=l}else{if(l+g>j){j-=l}else{j-=g-1;h=null}}},this)}if(h){h.replace(j,b,k,d);return this}i=j+b;if(b>1&&f){f.forEachIn(j,f.get("max")-j,function(l){if(l>i){return}if(!(h=this.branchObserverAt(l))){return}g=h.get("length");i-=g-1},this)}b=i-j;var c=this.get("children");if(!c){throw"cannot replace() tree item with no children"}if((b<0)||(i>c.get("length"))){throw"replace() range must lie within a single tree item"}c.replace(j,b,k,d);return this},observerContentDidChange:function(b,c,j){this.invalidateBranchObserversAt(b);this._objectAtCache=this._outlineLevelCache=null;this._disclosureStateCache=null;this._contentGroupIndexes=NO;this.notifyPropertyChange("branchIndexes");var d=this.get("length"),f=this._computeLength(),h=this.get("parentObserver"),g;if(d!==f){this.set("length",f)}if(!this._notifyParent){return this}if(h){g=SC.IndexSet.create(this.get("index"));h._childrenRangeDidChange(h.get("children"),null,"[]",g)}else{if(d===f){c=this.expandChildIndex(b+c);b=this.expandChildIndex(b);c=c-b;j=0}else{b=this.expandChildIndex(b);c=f-b;j=f-d}var i=c;var a=j+i;this.arrayContentDidChange(b,i,a)}},expandChildIndex:function(c){var b=c;if(this.get("isHeaderVisible")){c++}var a=this.get("branchIndexes");if(!a||a.get("length")===0){return b}a.forEachIn(0,c,function(d){b+=this.branchObserverAt(d).get("length")-1},this);return b},_contentGroupIndexes:NO,contentGroupIndexes:function(a,f){if(f!==this){return null}var c=this._contentGroupIndexes;if(c!==NO){return c}if(this.get("parentObserver")){return null}var d=this.get("item"),h,b,i,g;if(d&&d.isTreeItemContent){h=d.get("treeItemIsGrouped")}else{h=!!this.delegate.get("treeItemIsGrouped")}if(h){c=SC.IndexSet.create();b=this.get("branchIndexes");if(b){i=b.min();g=0;b.forEach(function(k){c.add(k+g,1);var j=this.branchObserverAt(k);if(j){g+=j.get("length")-1;i+=g}},this)}}else{c=null}this._contentGroupIndexes=c;return c},contentIndexIsGroup:function(b,d,a){var c=this.contentGroupIndexes(b,d);return c?c.contains(a):NO},contentIndexOutlineLevel:function(k,h,f){if(h!==this){return -1}var a=this._outlineLevelCache;if(a&&(a[f]!==undefined)){return a[f]}if(!a){a=this._outlineLevelCache=[]}var g=this.get("length"),l=f,d=0,i=null,c,b,j;if(f>=g){return -1}if(this.get("isHeaderVisible")){if(f===0){return a[0]=this.get("outlineLevel")-1}else{l--}}if(c=this.get("branchIndexes")){c.forEach(function(o){if((i!==null)||(o>l)){return}var n=this.branchObserverAt(o),m;if(!n){return}m=n.get("length");if(o+m>l){i=n.contentIndexOutlineLevel(k,n,l-o);l=-1}else{l-=m-1}},this)}if(l>=0){i=this.get("outlineLevel")}a[f]=i;return i},contentIndexDisclosureState:function(k,h,f){if(h!==this){return -1}var a=this._disclosureStateCache;if(a&&(a[f]!==undefined)){return a[f]}if(!a){a=this._disclosureStateCache=[]}var g=this.get("length"),l=f,d=0,i=null,c,b,j;if(f>=g){return SC.LEAF_NODE}if(this.get("isHeaderVisible")){if(f===0){return a[0]=this.get("disclosureState")}else{l--}}if(c=this.get("branchIndexes")){c.forEach(function(o){if((i!==null)||(o>l)){return}var n=this.branchObserverAt(o),m;if(!n){return}m=n.get("length");if(o+m>l){i=n.contentIndexDisclosureState(k,n,l-o);l=-1}else{l-=m-1}},this)}if(l>=0){i=SC.LEAF_NODE}a[f]=i;return i},contentIndexExpand:function(b,g,a){var c,h=a,d,f;if(g!==this){return}if(this.get("isHeaderVisible")){if(a===0){this._expand(this.get("item"));return}else{h--}}if(c=this.get("branchIndexes")){c.forEach(function(l){if(l>=h){return}var k=this.branchObserverAt(l),j;if(!k){return}j=k.get("length");if(l+j>h){k.contentIndexExpand(b,k,h-l);h=-1}else{h-=j-1}},this)}if(h>=0){d=this.get("children");f=d?d.objectAt(h):null;if(f){this._expand(f,this.get("item"),h)}}},contentIndexCollapse:function(b,g,a){var c,d,f,h=a;if(g!==this){return}if(this.get("isHeaderVisible")){if(a===0){this._collapse(this.get("item"));return}else{h--}}if(c=this.get("branchIndexes")){c.forEach(function(l){if(l>=h){return}var k=this.branchObserverAt(l),j;if(!k){return}j=k.get("length");if(l+j>h){k.contentIndexCollapse(b,k,h-l);h=-1}else{h-=j-1}},this)}if(h>=0){d=this.get("children");f=d?d.objectAt(h):null;if(f){this._collapse(f,this.get("item"),h)}}},branchObserverAt:function(d){var h=this._branchObserversByIndex,c=this._branchObserverIndexes,f,i,b,k,a,g,j;if(!h){h=this._branchObserversByIndex=[]}if(!c){c=this._branchObserverIndexes=SC.IndexSet.create()}if(f=h[d]){return f}a=this.get("children");k=a?a.objectAt(d):null;if(!k){return null}h[d]=f=SC.TreeItemObserver.create({item:k,delegate:this.get("delegate"),parentObserver:this,index:d,outlineLevel:this.get("outlineLevel")+1});c.add(d);return f},invalidateBranchObserversAt:function(c){var b=this._branchObserversByIndex,a=this._branchObserverIndexes;if(!b||b.length<=c){return this}if(c<0){c=0}a.forEachIn(c,a.get("max")-c,function(f){var d=b[f];if(d){d.destroy()}},this);b.length=c;return this},init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("item");if(!a){throw"SC.TreeItemObserver.item cannot be null"}a.addObserver("*",this,this._itemPropertyDidChange);this._itemPropertyDidChange(a,"*");this._notifyParent=YES},destroy:function(){this.invalidateBranchObserversAt(0);this._objectAtCache=null;this._notifyParent=NO;var c=this.get("item");if(c){c.removeObserver("*",this,this._itemPropertyDidChange)}var a=this._children,b=this._childrenRangeObserver;if(a&&b){a.removeRangeObserver(b)}this.set("length",0);arguments.callee.base.apply(this,arguments)},_itemPropertyDidChange:function(g,b){var a=this.get("children"),f=this.get("disclosureState"),d=this.get("item"),c;this.beginPropertyChanges();c=this._computeDisclosureState(d);if(f!==c){this.set("disclosureState",c)}c=this._computeChildren(d);if(a!==c){this.set("children",c)}this.endPropertyChanges()},_childrenDidChange:function(){var c=this.get("disclosureState"),d=c===SC.BRANCH_OPEN?this.get("children"):null,b=this._children,a=this._childrenRangeObserver;if(b===d){return this}if(a){b.removeRangeObserver(a)}if(d){this._childrenRangeObserver=d.addRangeObserver(null,this,this._childrenRangeDidChange)}else{this._childrenRangeObserver=null}this._children=d;this._childrenRangeDidChange(d,null,"[]",null)}.observes("children","disclosureState"),_childrenRangeDidChange:function(g,j,i,d){var a=this.get("children"),f=a?a.get("length"):0,c=d?d.get("min"):0,h=d?d.get("max"):f,b=this._childrenLen||0;this._childrenLen=f;this.observerContentDidChange(c,h-c,f-b)},_computeDisclosureState:function(d,f,b){var c,a;if(!d||!this._computeChildren(d)){return SC.LEAF_NODE}else{if(d.isTreeItemContent){if(f===undefined){f=this.get("parentItem")}if(b===undefined){b=this.get("index")}return d.treeItemDisclosureState(f,b)}else{c=this._treeItemIsExpandedKey;if(!c){a=this.get("delegate");c=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=c}return d.get(c)?SC.BRANCH_OPEN:SC.BRANCH_CLOSED}}},_collapse:function(d,f,b){var c,a;if(!d||!this._computeChildren(d)){return this}else{if(d.isTreeItemContent){if(f===undefined){f=this.get("parentItem")}if(b===undefined){b=this.get("index")}d.treeItemCollapse(f,b)}else{c=this._treeItemIsExpandedKey;if(!c){a=this.get("delegate");c=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=c}d.setIfChanged(c,NO)}}return this},_expand:function(d,f,b){var c,a;if(!d||!this._computeChildren(d)){return this}else{if(d.isTreeItemContent){if(f===undefined){f=this.get("parentItem")}if(b===undefined){b=this.get("index")}d.treeItemExpand(f,b)}else{c=this._treeItemIsExpandedKey;if(!c){a=this.get("delegate");c=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=c}d.setIfChanged(c,YES)}}return this},_computeChildren:function(c){var a,b;if(!c){return null}else{if(c.isTreeItemContent){return c.get("treeItemChildren")}else{b=this._treeItemChildrenKey;if(!b){a=this.get("delegate");b=a?a.get("treeItemChildrenKey"):"treeItemChildren";this._treeItemChildrenKey=b}return c.get(b)}}},_computeLength:function(){var b=this.get("isHeaderVisible")?1:0,d=this.get("disclosureState"),c=this.get("children"),a;if((d===SC.BRANCH_OPEN)&&c){b+=c.get("length");if(a=this.get("branchIndexes")){a.forEach(function(f){var g=this.branchObserverAt(f);b+=g.get("length")-1},this)}}return b}});sc_require("private/tree_item_observer");SC.TreeController=SC.ObjectController.extend(SC.SelectionSupport,{treeItemIsGrouped:NO,treeItemIsExpandedKey:"treeItemIsExpanded",treeItemChildrenKey:"treeItemChildren",arrangedObjects:function(){var a,b=this.get("content");if(b){a=SC.TreeItemObserver.create({item:b,delegate:this})}else{a=null}this._sctc_arrangedObjects=a;return a}.property().cacheable(),_sctc_invalidateArrangedObjects:function(){this.propertyWillChange("arrangedObjects");var a=this._sctc_arrangedObjects;if(a){a.destroy()}this._sctc_arrangedObjects=null;this.propertyDidChange("arrangedObjects")}.observes("content","treeItemIsExpandedKey","treeItemChildrenKey","treeItemIsGrouped"),_sctc_arrangedObjectsContentDidChange:function(){this.updateSelectionAfterContentChange()}.observes("*arrangedObjects.[]"),canSelectGroups:NO,firstSelectableObject:function(){var d=this.get("arrangedObjects"),c,b,a=0;if(!d){return null}if(this.get("canSelectGroups")){return d.get("firstObject")}c=d.contentGroupIndexes(null,d);b=d.get("length");while(c.contains(a)&&(a<b)){a++}return a>=b?null:d.objectAt(a)}.property()});SC.InlineTextFieldDelegate={editor:null,acquireEditor:function(a){var b=this.editor;if(b){if(b.get("isEditing")&&!b.commitEditing()&&!b.discardEditing()){return null}this.releaseEditor(b)}var c=a.exampleEditor?a.exampleEditor:SC.InlineTextFieldView,d=a.get("pane");b=this.editor=d.createChildView(c,{inlineEditorDelegate:this});d.appendChild(b);return b},releaseEditor:function(a){a.removeFromParent();this.editor=null;return YES}};SC.STRING_TITLEIZE_REGEXP=(/([\s|\-|\_|\n])([^\s|\-|\_|\n]?)/g);SC.STRING_HUMANIZE_REGEXP=(/[\-_]/g);SC.STRING_REGEXP_ESCAPED_REGEXP=(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g);SC.STRING_DASHERIZE_CACHE={top:"top",left:"left",right:"right",bottom:"bottom",width:"width",height:"height",minWidth:"min-width",maxWidth:"max-width"};SC.INFLECTION_CONSTANTS={PLURAL:[[/(quiz)$/i,"$1zes"],[/^(ox)$/i,"$1en"],[/([m|l])ouse$/i,"$1ice"],[/(matr|vert|ind)ix|ex$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/sis$/i,"ses"],[/([ti])um$/i,"$1a"],[/(buffal|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/,"s"]],SINGULAR:[[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/^(ox)en/i,"$1"],[/(alias|status)es$/i,"$1"],[/(octop|vir)i$/i,"$1us"],[/(cris|ax|test)es$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)es$/i,"$1"],[/([m|l])ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(^analy)ses$/i,"$1sis"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1$2sis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/s$/i,""]],IRREGULAR:[["move","moves"],["sex","sexes"],["child","children"],["man","men"],["person","people"]],UNCOUNTABLE:["sheep","fish","series","species","money","rice","information","info","equipment"]};SC.mixin(SC.String,{capitalizeEach:function(a){return a.replace(SC.STRING_TITLEIZE_REGEXP,function(c,b,d){return(d)?(b+d.toUpperCase()):b}).capitalize()},titleize:function(b){var a=b.replace(SC.STRING_DECAMELIZE_REGEXP,"$1_$2");return a.replace(SC.STRING_TITLEIZE_REGEXP,function(c,f,d){return d?" "+d.toUpperCase():" "}).capitalize()},classify:function(d){var a=d.replace(SC.STRING_TITLEIZE_REGEXP,function(f,h,g){return g?g.toUpperCase():""});var c=a.charAt(0),b=c.toUpperCase();return c!==b?b+a.slice(1):a},humanize:function(a){return SC.String.decamelize(a).replace(SC.STRING_HUMANIZE_REGEXP," ")},escapeForRegExp:function(a){return a.replace(SC.STRING_REGEXP_ESCAPED_REGEXP,"\\$1")},removeDiacritics:function(h){var a=SC.diacriticMappingTable;if(!a){SC.diacriticMappingTable={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"P","":"P","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"`","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"p","":"p","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z"};a=SC.diacriticMappingTable}var d,f,b="",g=h.length;for(var c=0;c<=g;++c){d=h.charAt(c);f=a[d];b+=f||d}return b},pluralize:function(h){var l,f,b=h.split(/\s/).pop(),i=h.replace(b,""),a=b.charAt(0).match(/[A-Z]/)?true:false;b=b.toLowerCase();for(l=0,f=SC.INFLECTION_CONSTANTS.UNCOUNTABLE.length;l<f;l++){var g=SC.INFLECTION_CONSTANTS.UNCOUNTABLE[l];if(b==g){return h.toString()}}for(l=0,f=SC.INFLECTION_CONSTANTS.IRREGULAR.length;l<f;l++){var c=SC.INFLECTION_CONSTANTS.IRREGULAR[l][0],k=SC.INFLECTION_CONSTANTS.IRREGULAR[l][1];if((b==c)||(b==k)){if(a){k=k.capitalize()}return i+k}}for(l=0,f=SC.INFLECTION_CONSTANTS.PLURAL.length;l<f;l++){var j=SC.INFLECTION_CONSTANTS.PLURAL[l][0],d=SC.INFLECTION_CONSTANTS.PLURAL[l][1];if(j.test(b)){return h.replace(j,d)}}},singularize:function(h){var l,f,b=h.split(/\s/).pop(),i=h.replace(b,""),a=b.charAt(0).match(/[A-Z]/)?true:false;b=b.toLowerCase();for(l=0,f=SC.INFLECTION_CONSTANTS.UNCOUNTABLE.length;l<f;l++){var g=SC.INFLECTION_CONSTANTS.UNCOUNTABLE[l];if(b==g){return h.toString()}}for(l=0,f=SC.INFLECTION_CONSTANTS.IRREGULAR.length;l<f;l++){var c=SC.INFLECTION_CONSTANTS.IRREGULAR[l][0],k=SC.INFLECTION_CONSTANTS.IRREGULAR[l][1];if((b==c)||(b==k)){if(a){c=c.capitalize()}return i+c}}for(l=0,f=SC.INFLECTION_CONSTANTS.SINGULAR.length;l<f;l++){var j=SC.INFLECTION_CONSTANTS.SINGULAR[l][0],d=SC.INFLECTION_CONSTANTS.SINGULAR[l][1];if(j.test(b)){return h.replace(j,d)}}}});SC.String.strip=SC.String.trim;sc_require("system/string");SC.supplement(String.prototype,{capitalizeEach:function(){return SC.String.capitalizeEach(this,arguments)},titleize:function(a){return SC.String.titleize(this,arguments)},classify:function(a){return SC.String.classify(this,arguments)},humanize:function(a){return SC.String.humanize(this,arguments)},escapeForRegExp:function(a){return SC.String.escapeForRegExp(this,arguments)},removeDiacritics:function(a){return SC.String.removeDiacritics(this,arguments)},trim:function(a){return SC.String.trim(this,arguments)},trimLeft:function(a){return SC.String.trimLeft(this,arguments)},trimRight:function(a){return SC.String.trimRight(this,arguments)},pluralize:function(a){return SC.String.pluralize(this,arguments)},singularize:function(a){return SC.String.singularize(this,arguments)}});SC.Gesture=SC.Object.extend({name:"gesture",touchIsInGesture:function(b,a){return NO},touchStart:function(a){},touchesDragged:function(a,b){},touchEnd:function(a){},start:function(){if(!this.get("isActive")){this.set("isActive",YES);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Start";if(this.view[a]){this.view[a].apply(this.view,b)}}},end:function(){if(this.get("isActive")){this.set("isActive",NO);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"End";if(this.view[a]){this.view[a].apply(this.view,b)}}},change:function(){if(this.get("isActive")){var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Changed";if(this.view[a]){this.view[a].apply(this.view,b)}}},cancel:function(){if(this.get("isActive")){this.set("isActive",NO);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Cancelled";if(this.view[a]){this.view[a].apply(this.view,b)}}},trigger:function(){var b=SC.$A(arguments);b.unshift(this);var a=this.name;if(this.view[a]){this.view[a].apply(this.view,b)}},take:function(a){a.isTaken=YES;if(SC.none(a.touchResponder)||a.touchResponder!==this){a.makeTouchResponder(this,YES)}},release:function(a){a.isTaken=NO;if(a.nextTouchResponder){a.makeTouchResponder(a.nextTouchResponder)}},discardTouch:function(a){a.isTaken=YES;a.makeTouchResponder(null)},statusForTouch:function(c){var b=SC.guidFor(c.view)+this.name;var a=c[b];if(!a){a=c[b]={}}return a},unassignedTouchDidStart:function(a){if(a.isTaken){return}if(this.touchIsInGesture(a,this.statusForTouch(a))){this.take(a)}},unassignedTouchesDidChange:function(a,b){b.forEach(function(c){if(c.isTaken){return}if(this.touchIsInGesture(c,this.statusForTouch(c))){this.take(c)}},this)},unassignedTouchDidEnd:function(a){},interestedInTouch:function(b){var a=this.statusForTouch(b);if(a.isInterested){return}a.isInterested=YES;b.isInteresting++},uninterestedInTouch:function(b){var a=this.statusForTouch(b);if(!a.isInterested){return}a.isInterested=NO;b.isInteresting--}});sc_require("system/gesture");SC.PinchGesture=SC.Gesture.extend({name:"pinch",acceptsMultitouch:YES,scale:1,unassignedTouchesDidChange:function(a,b){if(b.length==2){this.take(b[0]);this.take(b[1])}},touchStart:function(b){var a=b.touchesForResponder(this);if(!a||a.length===0){return YES}else{if(a.length==1){this.start([a[0],b]);return YES}else{return NO}}},touchesDragged:function(a,c){var d=c.firstObject(),b=d.averagedTouchesForView(this);if(b.touchCount==2){if(!this._startDistance){this._startDistance=b.d}this.scale=b.d/this._startDistance;this.change(c,this.scale)}},touchEnd:function(b){this._startDistance=null;var a=b.touchesForResponder(this);this.trigger(a,this.scale);this.end(a,this.scale);if(a){a.forEach(function(c){this.release(c)},this)}}});sc_require("system/gesture");SC.SWIPE_HORIZONTAL="X";SC.SWIPE_VERTICAL="Y";SC.SWIPE_ANY="XY";SC.SWIPE_LEFT="LEFT";SC.SWIPE_RIGHT="RIGHT";SC.SWIPE_UP="UP";SC.SWIPE_DOWN="DOWN";SC.SwipeGesture=SC.Gesture.extend({name:"swipe",acceptsMultitouch:YES,direction:SC.SWIPE_HORIZONTAL,currentDirection:null,startDistance:5,swipeDistance:40,tolerance:0.5,touchIsInGesture:function(j,h){if(!h.flunked){var k=this.get("direction"),f=this.get("currentDirection"),a=this.get("startDistance"),i=j.pageX-j.startX,g=j.pageY-j.startY,c=Math.abs(i),b=Math.abs(g);if(Math.abs(i)>a||Math.abs(g)>a){if(!f){if(k==SC.SWIPE_ANY){if(c>b){f=SC.SWIPE_HORIZONTAL}else{if(b>c){f=SC.SWIPE_VERTICAL}else{return NO}}}else{f=k}this.set("currentDirection",f)}var m=(f==SC.SWIPE_HORIZONTAL)?i:g,l=(f==SC.SWIPE_HORIZONTAL)?g:i;if(Math.abs(m)*this.get("tolerance")>Math.abs(l)){return YES}}}return NO},touchStart:function(f){var b=this.get("currentDirection"),c=f["page"+b]-f["start"+b],a;if(c<0){a=(b===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{a=(b===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}this.start(f,a,c);return YES},touchesDragged:function(k,f){var c=f.firstObject();var g=this.get("currentDirection"),a=(g===SC.SWIPE_HORIZONTAL?"Y":"X"),j=c["page"+g]-c["start"+g],h=c["page"+a]-c["start"+a],i;if(j<0){i=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{i=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}if(Math.abs(j)<this.get("startDistance")||Math.abs(j)*this.get("tolerance")<Math.abs(h)){this.release(c);var b=c.touchesForResponder(this);if(!b||b.length===0){this.cancel(c,i,j)}}else{this.change(c,i,j)}},touchEnd:function(i){var g=this.get("currentDirection"),f=(g===SC.SWIPE_HORIZONTAL?"Y":"X"),h=i["page"+g]-i["start"+g],b=i["page"+f]-i["start"+f],a;if(h<0){a=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{a=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}if(Math.abs(h)>this.get("swipeDistance")||Math.abs(h)*this.get("tolerance")<Math.abs(b)){this.trigger(i,a)}this.end(i,a,h);this.set("currentDirection",null);var c=i.touchesForResponder(this);if(c){c.forEach(function(d){this.release(d)},this)}},cancel:function(){arguments.callee.base.apply(this,arguments);this.set("currentDirection",null)}});sc_require("system/gesture");SC.TapGesture=SC.Gesture.extend({name:"tap",acceptsMultitouch:NO,_tapCount:null,_candidateTouch:null,_eventTimer:null,tapWiggle:10,tapDelay:200,touchIsInGesture:function(b,a){return !b.tapFlunked},touchStart:function(a){if(this._eventTimer){this._eventTimer.invalidate()}if(this._candidateTouch&&this._candidateTouch.touch.identifier!==a.identifier){this._cancelTap(a);return NO}this._candidateTouch={startTime:Date.now(),touch:a};this.start(a);return YES},touchesDragged:function(a,c){var f=c[0];var b=(c.length>1||!this._candidateTouch||f.identifier!==this._candidateTouch.touch.identifier);var d=this._calculateDragDistance(f)>this.get("tapWiggle");if(b||d){this._cancelTap(f)}},touchEnd:function(a){if(this._calculateDragDistance(a)>this.get("tapWiggle")||Date.now()-this._candidateTouch.startTime>this.get("tapDelay")){this._cancelTap(a)}else{this._addTap(a)}},_addTap:function(b){var a=this;if(this._eventTimer){this._eventTimer.invalidate()}this._tapCount=(this._tapCount||0)+1;this._candidateTouch=null;this._eventTimer=SC.Timer.schedule({target:a,action:function(){this._triggerTap(b)},interval:this.get("tapDelay")});this.change(b,this._tapCount);this.trigger(b,this._tapCount)},_cancelTap:function(a){a.tapFlunked=YES;this.release(a);this.cancel(a,this._tapCount);if(this._eventTimer){this._eventTimer.invalidate()}this._tapCount=null;this._candidateTouch=null;this._eventTimer=null},_triggerTap:function(a){this.end(a,this._tapCount);this._tapCount=null;this._candidateTouch=null;this._eventTimer=null},_calculateDragDistance:function(a){return Math.sqrt(Math.pow(a.pageX-a.startX,2)+Math.pow(a.pageY-a.startY,2))}});SC.AutoMixin={autoMixins:[],createChildView:function(b,c){if(!c){c={}}c.owner=c.parentView=this;c.isVisibleInWindow=this.get("isVisibleInWindow");if(!c.page){c.page=this.page}var a=this.get("autoMixins");a.push(c);b=b.create.apply(b,a);return b}};SC.mixin({_copy_computed_props:["maxWidth","maxHeight","paddingLeft","paddingRight","paddingTop","paddingBottom","fontFamily","fontSize","fontStyle","fontWeight","fontVariant","lineHeight","whiteSpace","letterSpacing","wordWrap"],stringFromLayout:function(f){var d=["maxHeight","maxWidth","minHeight","minWidth","centerY","centerX","width","height","bottom","right","top","left"],a=[],c,b=d.length;while(--b>=0){c=d[b];if(f.hasOwnProperty(c)){a.push(c+":"+f[c])}}return"{"+a.join(", ")+"}"},heightForString:function(i,c,b,a,h){var f=this._heightCalcElement,g,j;if(!h){i=SC.RenderContext.escapeHTML(i)}g=(a&&SC.typeOf(a)===SC.T_ARRAY)?a.join(" "):"";if(!c){c=100}if(!f){f=this._heightCalcElement=document.createElement("div");document.body.insertBefore(f,null)}b=b+"; width: "+c+"px; left: "+(-1*c)+"px; position: absolute";var d=SC.$(f);d.attr("style",b);if(g!==""){d.attr("class",g)}f.innerHTML=i;j=f.clientHeight;f=null;return j},prepareStringMeasurement:function(p,a){var l=this._metricsCalculationElement,j,q,c,d;j=SC.A(a).join(" ");if(!l){var o=document.createElement("div");o.style.cssText="position:absolute; left:-10010px; top:-10px;width:10000px; height:0px; overflow:hidden;visibility:hidden;";l=this._metricsCalculationElement=document.createElement("div");o.appendChild(l);document.body.insertBefore(o,null)}d=SC.$(l);if(SC.typeOf(p)!=SC.T_STRING){var h=null;if(document.defaultView&&document.defaultView.getComputedStyle){h=document.defaultView.getComputedStyle(p,null)}else{h=p.currentStyle}var n=this._copy_computed_props;for(var k=0;k<n.length;k++){var b=n[k],g=h[b];l.style[b]=g}var m=l.style;if(m.font===""){var f="";if(m.fontStyle){f+=m.fontStyle+" "}if(m.fontVariant){f+=m.fontVariant+" "}if(m.fontWeight){f+=m.fontWeight+" "}if(m.fontSize){f+=m.fontSize}else{f+="10px"}if(m.lineHeight){f+="/"+m.lineHeight}f+=" ";if(m.fontFamily){f+=m.fontFamily}else{m+="sans-serif"}l.style.font=f}SC.mixin(l.style,{left:"0px",top:"0px",position:"absolute",bottom:"auto",right:"auto",width:"auto",height:"auto"});h=null}else{c=p;d.attr("style",c+"; position:absolute; left: 0px; top: 0px; bottom: auto; right: auto; width: auto; height: auto;")}l.className=j;l=null},teardownStringMeasurement:function(){var a=this._metricsCalculationElement;a.innerHTML="";a.className="";a.setAttribute("style","");a=null},measureString:function(c,b){var d=this._metricsCalculationElement,f=0;if(!d){throw"measureString requires a string measurement environment to be set up. Did you mean metricsForString?"}if(b){d.innerHTML=c}else{if(typeof d.innerText!="undefined"){d.innerText=c}else{d.textContent=c}}if(SC.browser.isIE){f=1}var a={width:d.clientWidth+f,height:d.clientHeight};if(SC.browser.isMozilla){a.width+=1}d=null;return a},metricsForString:function(c,d,f,b){SC.prepareStringMeasurement(d,f);var a=SC.measureString(c,b);SC.teardownStringMeasurement();return a}});sc_require("system/utils/string_measurement");SC.AutoResize={shouldAutoResize:YES,shouldMeasureSize:YES,shouldCacheSizes:NO,shouldResizeWidth:YES,shouldResizeHeight:NO,measuredSize:{width:0,height:0},maxWidth:null,maxHeight:null,shouldAutoFitText:NO,autoFitDiscreteFontSizes:NO,minFontSize:12,maxFontSize:20,calculatedFontSize:20,fontPropertyDidChange:function(){if(this.get("shouldAutoFitText")){this.invokeLast(this.fitTextToFrame)}}.observes("shouldAutoFitText","minFontSize","maxFontSize","measuredSize"),measuredSizeDidChange:function(){var c=this.get("measuredSize"),b=c.width,i=c.height,h,a,d=this.get("autoResizePadding")||0,g=this.get("maxWidth"),f=this.get("maxHeight");if(SC.typeOf(d)===SC.T_NUMBER){h=a=d}else{h=d.height;a=d.width}i+=h;b+=a;if(this.get("shouldAutoResize")){if(this.get("shouldResizeWidth")){if(g&&b>g){b=g}this.set("calculatedWidth",b);this.adjust("width",b)}if(this.get("shouldResizeHeight")){if(f&&i>f){i=f}this.set("calculatedHeight",i);this.adjust("height",i)}}}.observes("shouldAutoResize","measuredSize","autoResizePadding","maxWidth","minWidth","shouldResizeWidth","shouldResizeHeight"),initMixin:function(){},batchResizeId:null,scheduleMeasurement:function(){var a=this.get("batchResizeId");if(!this.get("shouldMeasureSize")||!this.get("isVisibleInWindow")||(this.get("autoResizeText")===this._lastMeasuredText&&a===this._lastMeasuredId)){return}SC.AutoResizeManager.scheduleMeasurementForView(this,a)}.observes("isVisibleInWindow","shouldMeasureSize","autoResizeText","batchResizeId"),_lastMeasuredText:null,_cachedMetrics:function(c,d){if(!this.get("shouldCacheSizes")){return}var b=SC.cacheSlotFor(this.get("batchResizeId")||this),a=this.get("autoResizeText");if(d){b[a]=d}else{d=b[a]}return d}.property("shouldCacheSizes","autoResizeText","batchResizeId").cacheable(),measureSize:function(d){var i,f=this.get("autoResizeLayer"),c=this.get("autoResizeText"),b=!this.get("escapeHTML"),h=this.get("batchResizeId"),a=this.get("_cachedMetrics"),g=this.get("maxFontSize");if(!f){return}if(a){i=a}else{if(SC.none(c)||c===""){i={width:0,height:0}}else{if(d){i=SC.measureString(c,b)}else{this.prepareLayerForStringMeasurement(f);i=SC.metricsForString(c,f,this.get("classNames"),b)}}}this.set("measuredSize",i);if(this.get("shouldCacheSizes")){this.setIfChanged("_cachedMetrics",i)}this._lastMeasuredText=c;this._lastMeasuredId=h;return i},prepareLayerForStringMeasurement:function(a){var b=this.get("maxFontSize");if(this.get("shouldAutoFitText")&&this.get("calculatedFontSize")!==b){a.style.fontSize=b+"px"}},viewDidResize:function(a){a();this.fontPropertyDidChange()}.enhance(),fitTextToFrame:function(){var r=this.get("autoResizeLayer");if(!r){return}var c=this.get("maxFontSize"),d=this.get("minFontSize");this.prepareLayerForStringMeasurement(r);var f=this.get("frame"),g=this.get("autoResizePadding")||0,k=f.width-1,h=f.height-1,q=this.get("measuredSize"),a=q.width,t=q.height;if(SC.typeOf(g)===SC.T_NUMBER){k-=g;h-=g}else{k-=g.width;h-=g.height}if(a<=k&&t<=h){return}if(this.get("autoFitDiscreteFontSizes")){i=d}else{var b=k/a,j=h/t,m=Math.floor(c*Math.min(b,j)),i,p=this.get("classNames"),o=!this.get("escapeHTML"),l=this.get("autoResizeText"),n;m=i=Math.min(c,Math.max(d,m));r.style.fontSize=m+"px";n=SC.metricsForString(l,r,p,o);if(n.width>k||n.height>h){for(m=m-1;m>=d;m--){r.style.fontSize=m+"px";n=SC.metricsForString(l,r,p,o);i=m;if(n.width<=k&&n.height<=h){break}}}else{if(n.width<k||n.height<h){for(m=m+1;m<=c;m++){r.style.fontSize=m+"px";n=SC.metricsForString(l,r,p,o);if(n.width<=k&&n.height<=h){i=m}if(n.width>=k||n.height>=h){break}}}}}r.style.fontSize=i+"px";this.set("calculatedFontSize",i)},applyAttributesToContext:function(b,a){b(a);if(this.get("shouldAutoFitText")){a.css("font-size",this.get("calculatedFontSize")+"px")}}.enhance(),didCreateLayer:function(a){a();this.scheduleMeasurement()}.enhance()};SC.AutoResizeManager={measurementQueue:SC.CoreSet.create(),scheduleMeasurementForView:function(a){this.measurementQueue.add(a);SC.RunLoop.currentRunLoop.invokeLast(this.doBatchResize)},cancelMeasurementForView:function(a,b){this.measurementQueue.remove(a)},doBatchResize:function(){if(this!==SC.AutoResizeManager){return SC.AutoResizeManager.doBatchResize()}var b,d,g,h=this.measurementQueue,j,c,f,a;while((a=h.get("length"))>0){j=NO;b=h[a-1].get("batchResizeId");for(f=a-1;f>=0;--f){d=h[f];if(d.get("batchResizeId")!==b){continue}if(d.get("isVisibleInWindow")&&d.get("shouldMeasureSize")&&(g=d.get("autoResizeLayer"))){c=d.get("autoResizeText");if(!SC.none(c)&&c!==""&&!d.get("_cachedMetrics")&&!j){d.prepareLayerForStringMeasurement(g);SC.prepareStringMeasurement(g,d.get("classNames"));j=YES}d.measureSize(YES)}h.remove(d);if(!b){break}}if(j){SC.teardownStringMeasurement()}}}};if(SC.Button){SC.Button.initMixin=function(){throw"SC.Button is deprecated as a mixin and is now a subclass of SC.TemplateView. Subclass SC.ButtonView instead."}}SC.ContentDisplay={concatenatedProperties:"contentDisplayProperties",displayProperties:["content"],contentDisplayProperties:[],initMixin:function(){this._display_contentDidChange()},destroyMixin:function(){if(!this._display_content){return}this._display_stopObservingContent(this._display_content);this._display_content=null},_display_beginObservingContent:function(a){var b=this._display_contentPropertyDidChange;if(SC.isArray(a)){a.invoke("addObserver","*",this,b)}else{if(a.addObserver){a.addObserver("*",this,b)}}},_display_stopObservingContent:function(a){var b=this._display_contentPropertyDidChange;if(SC.isArray(a)){a.invoke("removeObserver","*",this,b)}else{if(a.removeObserver){a.removeObserver("*",this,b)}}},_display_contentDidChange:function(d,a,c){if((c=this.get("content"))===this._display_content){return}var b=this._display_content;if(b){this._display_stopObservingContent(b)}b=this._display_content=c;if(b){this._display_beginObservingContent(b)}this.displayDidChange()}.observes("content","contentDisplayProperties"),_display_contentPropertyDidChange:function(f,c,d,b){if(c==="*"){this.displayDidChange()}else{var a=this.get("contentDisplayProperties");if(a&&a.indexOf(c)>=0){this.displayDidChange()}}}};SC.ContentValueSupport={hasContentValueSupport:YES,initMixin:function(){this._control_contentKeysDidChange()},value:null,content:null,contentKeys:null,_default_contentKeys:{contentValueKey:"value"},contentValueKey:null,contentPropertyDidChange:function(c,b){var a=this.get("contentKeys");if(a){var d;for(d in a){if(b==="*"||b===this.getDelegateProperty(d,this,this.get("displayDelegate"),a)){return this.updatePropertyFromContent(a[d],b,d,c)}}}else{return this.updatePropertyFromContent("value",b,"contentValueKey",c)}},updatePropertyFromContent:function(g,c,f,d){var a,b;if(f===undefined){f="content"+g.capitalize()+"Key"}if(this[f]){f=this.get(f)}else{if((a=this.get("displayDelegate"))&&(b=a[f])){f=a.get?a.get(f):b}else{return this}}if(c==="*"||c===f){if(d===undefined){d=this.get("content")}if(d){b=d.get?d.get(f):d[f]}else{b=null}this.setIfChanged(g,b)}return this},updateContentWithValueObserver:function(d,a){var g=this._reverseContentKeys;if(!a||a==="*"){for(a in g){this.updateContentWithValueObserver(this,a)}}var c=this.get(a);var b=this.get("content"),f=this.getDelegateProperty(g[a],this,this.displayDelegate);if(!f||!b){return this}if(typeof b.setIfChanged===SC.T_FUNCTION){b.setIfChanged(f,c)}else{if(b[f]!==c){b[f]=c}}},_control_content:null,_old_contentValueKeys:null,_old_contentKeys:null,_control_contentDidChange:function(j,m){var k=this.get("content"),b=this.get("contentKeys"),a,c=this._control_content,n=this._old_contentValueKeys,l=SC.typeOf(n),h=this.contentPropertyDidChange;if(c&&c.removeObserver&&n){if(l===SC.T_STRING){c.removeObserver(n,this,h);n=null}else{var d,g=n.get("length");for(d=0;d<g;d++){a=n[d];c.removeObserver(a,this,h)}n.clear()}}if(k&&k.addObserver){if(b){if(!n){n=SC.CoreSet.create()}for(a in b){a=this.getDelegateProperty(a,this,this.get("displayDelegate"));if(a){k.addObserver(a,this,h);n.add(a)}}}else{a=this.getDelegateProperty("contentValueKey",this,this.get("displayDelegate"));if(a){k.addObserver(a,this,h);if(n){n.add(a)}else{n=a}}}}this._control_content=k;this._old_contentValueKeys=n;m=(!m||m==="content")?"*":this.get(m);if(m){this.contentPropertyDidChange(k,m)}}.observes("content"),_old_contentKeys:null,_control_contentKeysDidChange:function(){var d,c={},a=this.get("contentKeys")||this._default_contentKeys,i,b=this._old_contentKeys,h=this._control_contentDidChange,g=this.updateContentWithValueObserver;for(d in b){i=b[d];this.removeObserver(i,this,g);this.removeObserver(d,this,h)}for(d in a){i=a[d];c[i]=d;this.addObserver(i,this,g);this.addObserver(d,this,h)}this._reverseContentKeys=c;this._old_contentKeys=a;this._control_contentDidChange()}.observes("contentKeys")};sc_require("mixins/content_value_support");sc_require("system/string");SC.AUTO_CONTROL_SIZE="__AUTO__";SC.JUMBO_CONTROL_SIZE="sc-jumbo-size";SC.HUGE_CONTROL_SIZE="sc-huge-size";SC.LARGE_CONTROL_SIZE="sc-large-size";SC.REGULAR_CONTROL_SIZE="sc-regular-size";SC.SMALL_CONTROL_SIZE="sc-small-size";SC.TINY_CONTROL_SIZE="sc-tiny-size";SC.Control=SC.mixin(SC.clone(SC.ContentValueSupport),{isControl:YES,isSelected:NO,isSelectedBindingDefault:SC.Binding.oneWay().bool(),isActive:NO,isActiveBindingDefault:SC.Binding.oneWay().bool(),fieldKey:null,fieldLabel:null,errorLabel:function(){var a,d,c,b;if(a=this.get("fieldLabel")){return a}d=this.get("fieldKey")||this.constructor.toString();c=d?SC.String.capitalize(SC.String.humanize(d)):"";b=SC.String.locWithDefault("FieldKey."+d,c);return SC.String.locWithDefault("ErrorLabel."+d,b)}.property("fieldLabel","fieldKey").cacheable(),controlSize:SC.REGULAR_CONTROL_SIZE,displayProperties:["isEnabled","isSelected","isActive","controlSize"],_CONTROL_TMP_CLASSNAMES:{},renderMixin:function(b,h){var d=this.get("isSelected"),c=!this.get("isEnabled"),f=this._CONTROL_TMP_CLASSNAMES;f.mixed=d===SC.MIXED_STATE;f.sel=d&&(d!==SC.MIXED_STATE);f.active=this.get("isActive");var g=this.get("controlSize");if(!g){g=SC.REGULAR_CONTROL_SIZE}if(h){b.setClass(f);if(!this.get("renderDelegate")){b.addClass(g)}}else{b.$().setClass(f);if(!this.get("renderDelegate")){b.$().addClass(g)}}if(!h&&this.$input){var a=this.$input();if(a.attr("type")!=="radio"){this.$input().attr("disabled",c)}}}});SC.Editable={isEditable:NO,isEditing:NO,beginEditing:function(){if(!this.get("isEditable")){return NO}if(this.get("isEditing")){return YES}this.beginPropertyChanges();this.set("isEditing",YES);this.becomeFirstResponder();this.endPropertyChanges();return YES},discardEditing:function(){return !this.get("isEditing")},commitEditing:function(){if(!this.get("isEditing")){return YES}this.set("isEditing",NO);this.resignFirstResponder();return YES}};SC.ALIGN_JUSTIFY="justify";SC.FlowedLayout={isFlowedLayout:YES,layoutDirection:SC.LAYOUT_HORIZONTAL,autoResize:YES,shouldResizeWidth:YES,shouldResizeHeight:YES,align:SC.ALIGN_LEFT,canWrap:YES,defaultFlowSpacing:{left:0,bottom:0,top:0,right:0},flowPadding:{left:0,bottom:0,right:0,top:0},_scfl_validFlowPadding:function(){var b=this.get("flowPadding")||{},a={};a.left=b.left||0;a.top=b.top||0;a.bottom=b.bottom||0;a.right=b.right||0;return a}.property("flowPadding").cacheable(),concatenatedProperties:["childMixins"],initMixin:function(){this._scfl_tileOnce()},_scfl_childViewsDidChange:function(a){this._scfl_tileOnce()}.observes("childViews"),_scfl_layoutPropertyDidChange:function(a){this._scfl_tileOnce()}.observes("layoutDirection","align","flowPadding","canWrap","defaultFlowSpacing","isVisibleInWindow"),layoutDidChangeFor:function(h){var b=h._scfl_lastLayout,a=h.get("layout"),d=h.get("frame");if(!b){return arguments.callee.base.apply(this,arguments)}var g=YES;if(b.left&&b.left!==a.left){g=NO}else{if(b.top&&b.top!==a.top){g=NO}else{if(!h.get("fillWidth")&&b.width&&b.width!==a.width){g=NO}else{if(!b.width&&!h.get("fillWidth")&&d.width!==h._scfl_lastFrame.width){g=NO}else{if(!h.get("fillHeight")&&b.height&&b.height!==a.height){g=NO}else{if(!b.height&&!h.get("fillHeight")&&d.height!==h._scfl_lastFrame.height){g=NO}}}}}}if(g){return arguments.callee.base.apply(this,arguments)}this._scfl_tileOnce();arguments.callee.base.apply(this,arguments)},observeChildLayout:function(a){if(a._scfl_isBeingObserved){return}a._scfl_isBeingObserved=YES;a.addObserver("flowSpacing",this,"_scfl_tileOnce");a.addObserver("isVisible",this,"_scfl_tileOnce");a.addObserver("useAbsoluteLayout",this,"_scfl_tileOnce");a.addObserver("calculatedWidth",this,"_scfl_tileOnce");a.addObserver("calculatedHeight",this,"_scfl_tileOnce");a.addObserver("startsNewRow",this,"_scfl_tileOnce");a.addObserver("isSpacer",this,"_scfl_tileOnce");a.addObserver("maxSpacerLength",this,"_scfl_tileOnce");a.addObserver("fillWidth",this,"_scfl_tileOnce");a.addObserver("fillHeight",this,"_scfl_tileOnce")},unobserveChildLayout:function(a){a._scfl_isBeingObserved=NO;a.removeObserver("flowSpacing",this,"_scfl_tileOnce");a.removeObserver("isVisible",this,"_scfl_tileOnce");a.removeObserver("useAbsoluteLayout",this,"_scfl_tileOnce");a.removeObserver("calculatedWidth",this,"_scfl_tileOnce");a.removeObserver("calculatedHeight",this,"_scfl_tileOnce");a.removeObserver("startsNewRow",this,"_scfl_tileOnce");a.removeObserver("isSpacer",this,"_scfl_tileOnce");a.removeObserver("maxSpacerLength",this,"_scfl_tileOnce");a.removeObserver("fillWidth",this,"_scfl_tileOnce");a.removeObserver("fillHeight",this,"_scfl_tileOnce")},shouldIncludeChildInFlow:function(a,b){return b.get("isVisible")&&!b.get("useAbsoluteLayout")},flowSpacingForChild:function(a,b){var c=b.get("flowSpacing");if(SC.none(c)){c=this.get("defaultFlowSpacing")}if(SC.none(c)){c=0}if(SC.typeOf(c)===SC.T_NUMBER){c={left:c,right:c,bottom:c,top:c}}else{c.left=c.left||0;c.right=c.right||0;c.top=c.top||0;c.bottom=c.bottom||0}return c},flowSizeForChild:function(a,d){var c=d.get("calculatedWidth"),h=d.get("calculatedHeight"),j=this.get("layoutDirection"),g={},i=d.get("frame"),b=d.get("layout");d._scfl_lastFrame=i;if(c){g.width=c}else{g.width=b.width||i.width}if(h){g.height=h}else{g.height=b.height||i.height}if(d.get("isSpacer")){g.maxSpacerLength=d.get("maxSpacerLength");if(j===SC.LAYOUT_HORIZONTAL){g.width=b.minWidth||0}else{g.height=b.minHeight||0}}if(j===SC.LAYOUT_HORIZONTAL&&d.get("fillHeight")){g.height=b.minHeight||0}else{if(j===SC.LAYOUT_VERTICAL&&d.get("fillWidth")){g.width=b.minWidth||0}}return g},clippingFrame:function(){return{left:0,top:0,width:this.get("calculatedWidth"),height:this.get("calculatedHeight")}}.property("calculatedWidth","calculatedHeight"),_scfl_maxCollapsedRowLength:0,_scfl_totalCollapsedRowSize:0,_scfl_calculatedSizeDidChange:function(){if(this.get("autoResize")){if(this.get("layoutDirection")==SC.LAYOUT_VERTICAL){if(this.get("shouldResizeHeight")){this.adjust("minHeight",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_totalCollapsedRowSize"))}}else{if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeHeight")){this.adjust("minHeight",this.get("_scfl_totalCollapsedRowSize"))}}}}.observes("autoResize","shouldResizeWidth","_scfl_maximumCollapsedRowLength","_scfl_totalCollapsedRowSize","shouldResizeHeight"),_scfl_createPlan:function(){var f=this.get("layoutDirection"),a=this.get("_scfl_validFlowPadding"),d=this.get("frame");var c=(f===SC.LAYOUT_VERTICAL);var b={rows:undefined,maximumCollapsedRowLength:0,totalCollapsedRowSize:0,isVertical:f===SC.LAYOUT_VERTICAL,isHorizontal:f===SC.LAYOUT_HORIZONTAL,flowPadding:a,planStartPadding:a[c?"left":"top"],planEndPadding:a[c?"right":"bottom"],rowStartPadding:a[c?"top":"left"],rowEndPadding:a[c?"bottom":"right"],maximumRowLength:undefined,fitToPlanSize:undefined,align:this.get("align")};if(c){b.maximumRowLength=d.height-b.rowStartPadding-b.rowEndPadding;b.fitToPlanSize=d.width-b.planStartPadding-b.planEndPadding}else{b.maximumRowLength=d.width-b.rowStartPadding-b.rowEndPadding;b.fitToPlanSize=d.height-b.planStartPadding-b.planEndPadding}return b},_scfl_distributeChildrenIntoRows:function(d){var b=this.get("childViews"),a,h,c=b.length,f=d.isVertical,j=[],g;g=-1;h=0;while(h<c&&h!==g){g=h;var i={plan:d,rowLength:undefined,rowSize:undefined,shouldExpand:undefined,items:undefined,position:undefined};h=this._scfl_distributeChildrenIntoRow(b,h,i);j.push(i)}d.rows=j},_scfl_distributeChildrenIntoRow:function(f,n,j){var p,v=f.length,b=j.plan,h,a,d,q=[],l=0,m=b.isVertical,k,g,c,o=this.get("canWrap"),i=NO,r=0,u=j.plan.maximumRowLength;for(p=n;p<v;p++){h=f[p];i=i||(q.length>0&&h.get("startsNewRow"));if(!this.shouldIncludeChildInFlow(p,h)){continue}a=this.flowSizeForChild(p,h);d=this.flowSpacingForChild(p,h);a.width+=d.left+d.right;a.height+=d.top+d.bottom;g=a[m?"height":"width"];if(!SC.none(a.maxSpacerLength)){c=a.maxSpacerLength+(m?d.top+d.bottom:d.left+d.right)}k=a[m?"width":"height"];if((i||(o&&l+g>u))&&q.length>0){break}var w={child:h,itemLength:g,maxSpacerLength:c,itemSize:k,spacing:d,position:undefined,fillRow:m?h.get("fillWidth"):h.get("fillHeight"),isSpacer:h.get("isSpacer"),left:undefined,top:undefined,width:undefined,height:undefined};q.push(w);l+=g;r=Math.max(g,r)}j.rowLength=l;var t=o?r:j.rowLength;j.plan.maximumCollapsedRowLength=Math.max(t,j.plan.maximumCollapsedRowLength);j.items=q;return p},_scfl_positionChildrenInRows:function(d){var c=d.rows,b=c.length,a;for(a=0;a<b;a++){this._scfl_positionChildrenInRow(c[a])}},_scfl_positionChildrenInRow:function(n){var h=n.items,f=h.length,k,m,d,l=0,a=0,c,g=n.plan.align,j=YES,b=0,i=NO;for(k=0;k<f;k++){m=h[k];if(m.isSpacer){a+=m.child.get("spaceUnits")||1}}if(g===SC.ALIGN_JUSTIFY){a+=f-1}c=Math.max(0,n.plan.maximumRowLength-n.rowLength)/a;while(c>0){for(k=0;k<f;k++){m=h[k];if(m.isSpacer){m.itemLength+=c*(m.child.get("spaceUnits")||1);if(m.itemLength>m.maxSpacerLength){b+=m.itemLength-m.maxSpacerLength;m.itemLength=m.maxSpacerLength}else{i=YES}}}if(!i){break}c=Math.round(b/a);b=0}d=0;if(a===0&&(g===SC.ALIGN_RIGHT||g===SC.ALIGN_BOTTOM)){d=n.plan.maximumRowLength-n.rowLength}else{if(a===0&&(g===SC.ALIGN_CENTER||g===SC.ALIGN_MIDDLE)){d=(n.plan.maximumRowLength/2)-(n.rowLength/2)}}d+=n.plan.rowStartPadding;for(k=0;k<f;k++){m=h[k];if(!m.fillRow){j=NO}l=Math.max(m.itemSize,l);m.position=d;d+=m.itemLength;if(g===SC.ALIGN_JUSTIFY&&k<f-1){d+=c}}n.shouldExpand=f>0?j:NO;n.rowLength=d-n.plan.rowStartPadding;n.rowSize=l;n.plan.totalCollapsedRowSize+=n.rowSize},_scfl_positionRows:function(d){var j=d.rows,c=j.length,g,i,b,a=0,h=0,f;for(g=0;g<c;g++){if(j[g].shouldExpand){a++}h+=j[g].rowSize}f=d.fitToPlanSize-h;b=d.planStartPadding;for(g=0;g<c;g++){i=j[g];if(i.shouldExpand&&f>0){i.rowSize+=f/a;a--}i.position=b;b+=i.rowSize}},_scfl_applyPlan:function(i){var o=i.rows,b,c,n,f=0,k=0,h,a,d,m,g,l,j=i.isVertical;c=o.length;for(b=0;b<c;b++){n=o[b];f=Math.max(f,n.rowLength);k+=n.rowSize;h=n.items;d=h.length;for(a=0;a<d;a++){m=h[a];m.child.beginPropertyChanges();l=m.fillRow?n.rowSize:m.itemSize;g={left:m.spacing.left+(j?n.position:m.position),top:m.spacing.top+(j?m.position:n.position),width:j?l:m.itemLength,height:j?m.itemLength:l};g.width-=m.spacing.left+m.spacing.right;g.height-=m.spacing.top+m.spacing.bottom;this.applyPlanToView(m.child,g);m.child._scfl_lastLayout=g;m.child.endPropertyChanges()}}k+=i.planStartPadding+i.planEndPadding;f+=i.rowStartPadding+i.rowEndPadding;this.beginPropertyChanges();this.set("calculatedHeight",j?f:k);this.set("calculatedWidth",j?k:f);this.set("_scfl_maximumCollapsedRowLength",i.maximumCollapsedRowLength);this.set("_scfl_totalCollapsedRowSize",i.totalCollapsedRowSize);this.endPropertyChanges()},applyPlanToView:function(a,b){a.adjust(b)},_scfl_tileOnce:function(){this.invokeLast(this._scfl_tile)},_scfl_tile:function(){if(!this.get("isVisibleInWindow")){return}var g=this._scfl_createPlan();this._scfl_distributeChildrenIntoRows(g);this._scfl_positionChildrenInRows(g);this._scfl_positionRows(g);this._scfl_applyPlan(g);this.setIfChanged("numberOfRows",g.rows.length);var d=this._scfl_isObserving||SC.CoreSet.create(),c=SC.CoreSet.create();var f=this.get("childViews"),b=f.length,a,h;for(a=0;a<b;a++){h=f[a];if(!d.contains(h)){this.observeChildLayout(h)}else{d.remove(h)}c.add(h)}b=d.length;for(a=0;a<b;a++){this.unobserveChildLayout(d[a])}},_scfl_frameDidChange:function(){var b=this.get("frame"),a=this._scfl_lastFrameSize||{};this._scfl_lastFrameSize=SC.clone(b);if(a.width==b.width&&a.height==b.height){return}this._scfl_tileOnce()}.observes("frame"),destroyMixin:function(){var c=this._scfl_isObserving;if(!c){return}var b=c.length,a;for(a=0;a<b;a++){this.unobserveChildLayout(c[a])}},reorder:function(b){if(!SC.typeOf(b)===SC.T_ARRAY){b=arguments}var c=b.length,d=this.childViews,a;this.beginPropertyChanges();while(c-->0){a=b[c];if(SC.typeOf(a)===SC.T_STRING){a=this.get(a)}d.removeObject(a);d.unshiftObject(a)}this.endPropertyChanges();this._scfl_childViewsDidChange();return this}};SC.Gesturable={concatenatedProperties:["gestures"],gestures:[],initMixin:function(){this.createGestures()},createGestures:function(){var f=this.get("gestures"),b,a=f.length,c,d=[];for(b=0;b<a;b++){if(SC.typeOf(f[b])===SC.T_STRING){c=this.get(f[b])}else{c=f[b]}if(!c){throw"Could not find gesture named '"+f[b]+"' on view."}if(c.isClass){c=c.create({view:this})}if(SC.typeOf(f[b])===SC.T_STRING){this[f[b]]=c}d.push(c)}this.set("gestures",d)},touchStart:function(a){this.gestureTouchStart(a)},touchesDragged:function(a,b){this.gestureTouchesDragged(a,b)},touchEnd:function(a){this.gestureTouchEnd(a)},gestureTouchStart:function(f){f.isInteresting=0;var d=this.get("gestures"),b,a=d.length,c;for(b=0;b<a;b++){c=d[b];c.unassignedTouchDidStart(f)}},gestureTouchesDragged:function(c,f){var h=this.get("gestures"),b,a=h.length,d;for(b=0;b<a;b++){d=h[b];d.unassignedTouchesDidChange(c,f)}},gestureTouchEnd:function(f){var d=this.get("gestures"),b,a=d.length,c;for(b=0;b<a;b++){c=d[b];c.unassignedTouchDidEnd(f)}}};SC.InlineEditable={isInlineEditable:YES,isEditable:YES,exampleEditor:SC.InlineTextFieldView,isEditing:NO,inlineEditorDelegate:SC.InlineTextFieldDelegate,_editor:null,beginEditing:function(){var a;a=this.delegateFor("inlineEditorShouldBeginEditing",this.inlineEditorDelegate);if(a&&!a.inlineEditorShouldBeginEditing(this,this.get("value"))){return NO}this._editor=this.invokeDelegateMethod(this.inlineEditorDelegate,"acquireEditor",this);if(this._editor){return this._editor.beginEditing(this)}else{return NO}},commitEditing:function(){return this._editor?this._editor.commitEditing():NO},discardEditing:function(){return this._editor?this._editor.discardEditing():NO},inlineEditorShouldBeginEditing:function(){return !this.get("isEditing")&&this.get("isEditable")},inlineEditorWillBeginEditing:function(b,c,a){b.set("value",this.get("value"))},inlineEditorDidBeginEditing:function(b,c,a){this.set("isEditing",YES)},inlineEditorWillCommmitEditing:function(b,c,a){if(this.inlineEditorWillEndEditing){this.inlineEditorWillEndEditing(b,c)}},inlineEditorDidCommitEditing:function(b,c,a){a.setIfChanged("value",c);if(this.inlineEditorDidEndEditing){this.inlineEditorDidEndEditing(b,c)}this._endEditing()},inlineEditorWillDiscardEditing:function(b,a){if(this.inlineEditorWillEndEditing){this.inlineEditorWillEndEditing(b,this.get("value"))}},inlineEditorDidDiscardEditing:function(b,a){if(this.inlineEditorDidEndEditing){this.inlineEditorDidEndEditing(b,this.get("value"))}this._endEditing()},_endEditing:function(){if(this._editor){this.invokeDelegateMethod(this.inlineEditorDelegate,"releaseEditor",this._editor);this._editor=null}this.set("isEditing",NO)}};SC.InlineEditor={isInlineEditor:YES,isEditing:NO,inlineEditorDelegate:null,_target:null,beginEditing:function(b){if(this.get("isEditing")||!b||!b.isInlineEditable){return NO}var a,c;c=this._target=b;a=this.delegateFor("inlineEditorWillBeginEditing",this.inlineEditorDelegate,c);if(a){a.inlineEditorWillBeginEditing(this,this.get("value"),c)}this.set("isEditing",YES);this.invokeLast(this._callDidBegin);this._didBeginInvoked=YES;return YES},_callDidBegin:function(){if(!this.get("isEditing")){return NO}this._didBeginInvoked=NO;var b=this._target,a;a=this.delegateFor("inlineEditorDidBeginEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidBeginEditing(this,this.get("value"),b)}},commitEditing:function(){if(!this.get("isEditing")){return NO}if(this._didBeginInvoked){this._callDidBegin()}var a,b=this._target;a=this.delegateFor("inlineEditorShouldCommitEditing",this.inlineEditorDelegate,b);if(a&&!a.inlineEditorShouldCommitEditing(this,this.get("value"),b)){return NO}a=this.delegateFor("inlineEditorWillCommitEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorWillCommitEditing(this,this.get("value"),b)}this._endEditing();a=this.delegateFor("inlineEditorDidCommitEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidCommitEditing(this,this.get("value"),b)}return YES},discardEditing:function(){if(!this.get("isEditing")){return NO}if(this._didBeginInvoked){this._callDidBegin()}var a,b=this._target;a=this.delegateFor("inlineEditorShouldDiscardEditing",this.inlineEditorDelegate,b);if(a&&!a.inlineEditorShouldDiscardEditing(this,b)){return NO}a=this.delegateFor("inlineEditorWillDiscardEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorWillDiscardEditing(this,b)}this._endEditing();a=this.delegateFor("inlineEditorDidDiscardEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidDiscardEditing(this,b)}return YES},_endEditing:function(){this.set("isEditing",NO);this._target=null}};SC.InlineEditorDelegate={acquireEditor:function(a){},releaseEditor:function(a){},inlineEditorShouldBeginEditing:function(a,b){},inlineEditorWillBeginEditing:function(b,c,a){},inlineEditorDidBeginEditing:function(b,c,a){},inlineEditorShouldCommitEditing:function(b,c,a){},inlineEditorWillCommitEditing:function(b,c,a){},inlineEditorDidCommitEditing:function(b,c,a){},inlineEditorShouldDiscardEditing:function(b,a){},inlineEditorWillDiscardEditing:function(b,a){},inlineEditorDidDiscardEditing:function(b,a){},inlineEditorWillEndEditing:function(b,c,a){},inlineEditorDidEndEditing:function(b,c,a){}};SC.SCALE_NONE="none";SC.FILL="fill";SC.FILL_PROPORTIONALLY="fillProportionally";SC.BEST_FIT="fitBest";SC.BEST_FIT_DOWN_ONLY="fitBestDown";SC.InnerFrame={align:SC.ALIGN_CENTER,innerFrameForSize:function(a,c,i,b){var f=this.get("align"),d=this.get("scale"),h,g,j;j={x:0,y:0,width:i,height:b};if(d===SC.FILL){return j}h=i/a;g=b/c;switch(d){case SC.FILL_PROPORTIONALLY:d=h>g?h:g;break;case SC.BEST_FIT:d=h<g?h:g;break;case SC.BEST_FIT_DOWN_ONLY:if((a>i)||(c>b)){d=h<g?h:g}else{d=1}break;case SC.SCALE_NONE:d=1;break;default:if(isNaN(window.parseFloat(d))||(window.parseFloat(d)<=0)){SC.Logger.warn("SC.InnerFrame: The scale '%@' was not understood.  Scale must be one of SC.FILL, SC.FILL_PROPORTIONALLY, SC.BEST_FIT, SC.BEST_FIT_DOWN_ONLY or a positive number greater than 0.00.".fmt(d));return j}}a*=d;c*=d;j.width=Math.round(a);j.height=Math.round(c);switch(f){case SC.ALIGN_LEFT:j.x=0;j.y=(b/2)-(c/2);break;case SC.ALIGN_RIGHT:j.x=i-a;j.y=(b/2)-(c/2);break;case SC.ALIGN_TOP:j.x=(i/2)-(a/2);j.y=0;break;case SC.ALIGN_BOTTOM:j.x=(i/2)-(a/2);j.y=b-c;break;case SC.ALIGN_TOP_LEFT:j.x=0;j.y=0;break;case SC.ALIGN_TOP_RIGHT:j.x=i-a;j.y=0;break;case SC.ALIGN_BOTTOM_LEFT:j.x=0;j.y=b-c;break;case SC.ALIGN_BOTTOM_RIGHT:j.x=i-a;j.y=b-c;break;default:if(f!==SC.ALIGN_CENTER&&f!==SC.ALIGN_MIDDLE){SC.Logger.warn("SC.InnerFrame: The align '%@' was not understood.  Align must be one of SC.ALIGN_CENTER/SC.ALIGN_MIDDLE, SC.ALIGN_LEFT, SC.ALIGN_RIGHT, SC.ALIGN_TOP, SC.ALIGN_BOTTOM, SC.ALIGN_TOP_LEFT, SC.ALIGN_TOP_RIGHT, SC.ALIGN_BOTTOM_LEFT or SC.ALIGN_BOTTOM_RIGHT.".fmt(f))}j.x=(i/2)-(a/2);j.y=(b/2)-(c/2)}return j},scale:SC.FILL};SC.StaticLayout={hasStaticLayout:YES};SC.Validatable={initMixin:function(){this._validatable_validatorDidChange()},validator:null,errorLabel:null,isValid:function(){return SC.typeOf(this.get("value"))!==SC.T_ERROR}.property("value"),ownerForm:null,performValidate:function(c){var a=SC.VALIDATE_OK;if(this._validator){var b=this.get("ownerForm");if(c){a=this._validator.validatePartial(b,this);if((a==SC.VALIDATE_NO_CHANGE)&&(this._validator.validateChange(b,this)==SC.VALIDATE_OK)){a=SC.VALIDATE_OK}}else{a=this._validator.validateChange(b,this)}}return a},performValidateSubmit:function(){return this._validator?this._validator.validateSubmit(this.get("ownerForm"),this):SC.VALIDATE_OK},performValidateKeyDown:function(a){var b=a.getCharString();if(!b){return YES}return this._validator?this._validator.validateKeyDown(this.get("ownerForm"),this,b):YES},validatorObject:function(){return this._validator}.property(),validateSubmit:function(){return this.performValidateSubmit()},objectForFieldValue:function(b,a){return this._validator?this._validator.objectForFieldValue(b,this.get("ownerForm"),this):b},fieldValueForObject:function(a){return this._validator?this._validator.fieldValueForObject(a,this.get("ownerForm"),this):a},_validatable_displayObserver:function(){this.displayDidChange()}.observes("isValid"),renderMixin:function(a){a.setClass("invalid",!this.get("isValid"))},_validatable_validatorDidChange:function(){var a=this.get("ownerForm");var b=SC.Validator.findFor(a,this,this.get("validator"));if(b!=this._validator){this.propertyWillChange("validatorObject");if(this._validator){this._validator.detachFrom(a,this)}this._validator=b;if(this._validator){this._validator.attachTo(a,this)}this.propertyDidChange("validatorObject")}}.observes("validator","ownerForm")};SC.RenderDelegate={create:function(){var c=SC.beget(this);var b,a=arguments.length;for(b=0;b<a;b++){c.mixin(arguments[b])}return c},reopen:function(b){var c,a;for(c in b){a=b[c];if(!b.hasOwnProperty(c)){continue}if(typeof a==="function"&&a!==this[c]){a.base=this[c]||SC.K}if(a&&a.isEnhancement&&a!==this[c]){a=SC._enhance(this[c]||SC.K,a)}this[c]=a}},get:function(a){return this[a]},getPropertyFor:function(b,a){if(this[a+"For"]){return this[a+"For"](b,a)}return this[a]},className:undefined,render:function(b,a){},update:function(b,a){}};SC.RenderDelegate.extend=SC.RenderDelegate.create;SC.RenderDelegate.mixin=SC.RenderDelegate.reopen;sc_require("render_delegates/render_delegate");SC.BaseTheme.canvasImageRenderDelegate=SC.RenderDelegate.create({className:"canvasImage",render:function(d,b){var c=d.get("width")||0,a=d.get("height")||0;b.attr("width",c);b.attr("height",a)},update:function(a,f){var h=f[0],j=a.get("image"),d=a.get("frame"),m=d.width,k=d.height,l=a.get("innerFrame"),n=a.get("backgroundColor"),p=a.get("renderState"),b;var o=![l.x,l.y,l.width,l.height].isEqual(p._lastInnerFrameValues),i=![h.width,h.height].isEqual(p._lastElemSizeValues),g=a.didChangeFor("canvasImageRenderDelegate","backgroundColor"),c=a.didChangeFor("canvasImageRenderDelegate","image")||(j&&j.complete)!==p._lastImageComplete;if(i||o||g||c){if(h&&h.getContext){h.height=k;h.width=m;b=h.getContext("2d");b.clearRect(0,0,m,k);if(n){b.fillStyle=n;b.fillRect(0,0,m,k)}if(j&&j.complete){b.drawImage(j,Math.floor(l.x),Math.floor(l.y),Math.floor(l.width),Math.floor(l.height))}}p._lastInnerFrameValues=[l.x,l.y,l.width,l.height];p._lastElemSizeValues=[h.width,h.height];p._lastImageComplete=j&&j.complete}}});sc_require("render_delegates/render_delegate");SC.BaseTheme.containerRenderDelegate=SC.RenderDelegate.create({render:function(b,a){},update:function(){}});sc_require("render_delegates/render_delegate");SC.RenderDelegate.reopen({sizes:[SC.TINY_CONTROL_SIZE,SC.SMALL_CONTROL_SIZE,SC.REGULAR_CONTROL_SIZE,SC.LARGE_CONTROL_SIZE,SC.HUGE_CONTROL_SIZE,SC.JUMBO_CONTROL_SIZE],sizeFor:function(g){var f=g.get("controlSize"),c,b,a;if(f){if(!this[f]){this[f]={}}c=this[f];if(!c.name){c.name=f}return c}var d=g.get("frame");if(!d){c=this["sc-regular-size"];if(!c){c=this["sc-regular-size"]={}}if(!c.name){c.name="sc-regular-size"}return c}for(b=0;b<a;b++){key=sizes[b];c=this[key];if(!c){continue}if((c.width===undefined&&c.height===undefined&&c.minHeight===undefined&&c.minWidth===undefined&&c.maxHeight===undefined&&c.maxWidth===undefined)||(c.width!==undefined&&d.width!==c.width)||(c.minWidth!==undefined&&d.width<c.minWidth)||(c.maxWidth!==undefined&&d.width>c.maxWidth)||(c.height!==undefined&&d.height!==c.height)||(c.minHeight!==undefined&&d.height<c.minHeight)||(c.maxHeight!==undefined&&d.height<c.maxHeight)){continue}if(!c.name){c.name=key}return c}c=this["sc-regular-size"];if(!c){c=this["sc-regular-size"]={}}if(!c.name){c.name="sc-regular-size"}return c},addSizeClassName:function(c,b){var a=this.sizeFor(c);if(a){b.addClass(a.name)}},updateSizeClassName:function(c,a){var b=this.sizeFor(c);if(b){a.addClass(b.name)}},getPropertyFor:function(c,a){var b=this.sizeFor(c);if(b){if(b[a+"For"]){return b[a+"For"](c,a)}else{if(b[a]!==undefined){return b[a]}}}if(this[a+"For"]){return this[a+"For"]}return this[a]}});sc_require("render_delegates/render_delegate");SC.BaseTheme.imageRenderDelegate=SC.RenderDelegate.create({className:"image",render:function(g,c){var f=g.get("image"),b=g.get("imageValue"),d=g.get("type")||SC.IMAGE_TYPE_URL,a=g.get("toolTip");c=c.begin("img");c.attr("src",f.src);if(b&&d===SC.IMAGE_TYPE_CSS_CLASS){c.addClass(b);this._last_class=b}if(a){c.attr("title",a);c.attr("alt",a)}c.addStyle(this.imageStyles(g));c=c.end()},update:function(f,a){var d=f.get("image"),c=f.get("imageValue"),b=f.get("toolTip");a=a.find("img");a.attr("src",d.src);if(c!==this._last_class){a.setClass(this._last_class,NO)}if(c){a.addClass(c);this._last_class=c}if(b){a.attr("title",b);a.attr("alt",b)}a.css(this.imageStyles(f))},imageStyles:function(b){var a=b.get("innerFrame");return{position:"absolute",left:Math.round(a.x),top:Math.round(a.y),width:Math.round(a.width),height:Math.round(a.height)}}});sc_require("render_delegates/render_delegate");SC.BaseTheme.labelRenderDelegate=SC.RenderDelegate.create({className:"label",render:function(d,c){this.addSizeClassName(d,c);var a=d.get("toolTip");if(a){c.attr("title",a)}c.addStyle({fontWeight:d.get("fontWeight")||null,textAlign:d.get("textAlign")||null});c.setClass("ellipsis",d.get("needsEllipsis")||NO);c.setClass("icon",d.get("icon")||NO);var b=this.htmlForTitleAndIcon(d);c.push(b);d.get("renderState")._lastHTMLForTitleAndIcon=b},update:function(d,a){this.updateSizeClassName(d,a);a.css({fontWeight:d.get("fontWeight")||null,textAlign:d.get("textAlign")||null});var b=d.get("toolTip");if(b){a.attr("title",b)}else{a.removeAttr("title")}a.setClass("ellipsis",d.get("needsEllipsis")||NO);var c=this.htmlForTitleAndIcon(d);if(d.get("renderState")._lastHTMLForTitleAndIcon!==c){a.html(c);d.get("renderState")._lastHTMLForTitleAndIcon=c}},htmlForTitleAndIcon:function(g){var f=g.get("title"),d=g.get("hint"),a=g.get("hintEnabled"),c=g.get("escapeHTML"),b=g.get("icon")||"";if(f&&c){f=SC.RenderContext.escapeHTML(f)}if(a&&d&&!f){if(c){d=SC.RenderContext.escapeHTML(d)}f="<span class='sc-hint'>"+d+"</span>"}if(b){if(b.indexOf("/")>=0){b='<img src="'+b+'" alt="" class="icon" />'}else{b='<img src="'+SC.BLANK_IMAGE_URL+'" alt="" class="icon '+b+'" />'}}return b+f}});sc_require("core");SC.Benchmark={verbose:NO,enabled:YES,events:{},stats:{},globalStartTime:null,addEvent:function(a,b){if(!b){b=new Date().getTime()}this.events[a]=b},start:function(b,a,f,d){if(!this.enabled){return}var g=(f||Date.now()),c;if(a){c=this._subStatFor(b,a)}else{c=this._statFor(b)}if(d&&c._starts.length>0){c._starts.push("ignore")}else{c._starts.push(g)}c._times.push({start:g,_subStats:{}});return b},end:function(c,b,g){var f;if(!this.enabled){return}if(b){f=this._subStatFor(c,b)}else{f=this._statFor(c)}var h=f._starts.pop();if(!h){SC.Logger.log('SC.Benchmark "%@" ended without a matching start.  No information was saved.'.fmt(c));return}if(h=="ignore"){return}var a=(g||Date.now());var d=a-h;f._times[f._times.length-1].end=a;f._times[f._times.length-1].dur=d;f.amt+=d;f.runs++;if(this.verbose){this.log(c)}},setGlobalStartTime:function(a){this.globalStartTime=a},bench:function(f,d,a){if(!d){d="bench%@".fmt(this._benchCount++)}if(!a){a=1}var b;while(--a>=0){var c=SC.Benchmark.start(d);b=f();SC.Benchmark.end(c)}return b},install:function(a,d,b){a["b__"+d]=a[d];var c=a["b__"+d];a[d]=function(){var g="%@(%@)".fmt(d,$A(arguments).join(", "));SC.Benchmark.start(g,b);var f=c.apply(this,arguments);SC.Benchmark.end(g);return f}},restore:function(a,b){a[b]=a["b__"+b]},report:function(c){if(c){return this._genReport(c)}var b=[];for(var a in this.stats){if(!this.stats.hasOwnProperty(a)){continue}b.push(this._genReport(a))}return b.join("\n")},timelineReport:function(a){a=(a)?"SproutCore Application":a;var b=[a,"User-Agent: %@".fmt(navigator.userAgent),"Report Generated: %@ (%@)".fmt(new Date().toString(),Date.now()),""];var d=this._compileChartData(true);for(var c=0;c<d.length;c++){if(d[c][4]){b.push(this._timelineGenSubReport(d[c]))}else{b.push(this._timelineGenReport(d[c]))}}return b.join("\n")},getTimelineChartContent:function(){var m=this._compileChartData(false);var h=m.length;if(h===0){return}var c=this.globalStartTime?this.globalStartTime:m[0][1];var d=m[h-1][2]-c;var o=25+h*30;var r=Math.ceil(d/200)+1;var u=r*50;var n=10,v=300;var p="<div class = 'sc-benchmark-timeline-chart' style = 'position:relative;'>";p+="<div class = 'sc-benchmark-top'></div>";for(var q=0;q<r;q++){p+="<div class = 'sc-benchmark-tick' style = '";p+="left: "+(n+q*50)+"px; ";p+="height: "+o+"px;";p+="'></div>";p+="<div class = 'sc-benchmark-tick-label' style = '";p+="left: "+(n+q*50)+"px; ";p+="'>"+(q*200)+"ms</div>"}for(q=0;q<h;q++){p+="<div class = 'sc-benchmark-row ";p+=(q%2===0)?"even":"odd";p+="' style = '";p+="top: "+(50+(q*30))+"px; ";p+="'></div>";var k=document.createElement("div");var g=m[q][1];var f=m[q][2];var a=m[q][3];p+="<div class = 'sc-benchmark-bar' style = '";p+="left:"+(n+((g-c)/4))+"px; width: "+((a/4))+"px;";p+="top: "+(28+(q*30))+"px;";p+="' title = 'start: "+(g-c)+" ms, end: "+(f-c)+" ms, duration: "+a+" ms'";p+=">";p+="&nbsp;"+m[q][0]+" <span class='sc-benchmark-emphasis'>";p+=a+"ms (start: "+(g-c)+"ms)";p+="</span>";p+="</div>"}var b=this.events,l=0;for(q in b){var j=b[q]-c;p+="<div class = 'sc-benchmark-event idx"+(l%10)+"' style = '";p+="left: "+(n+j/4)+"px; height: "+o+"px; top: 20px;";p+="' title = '"+q+": "+j+"'></div>";l++}p+="</div>";return{html:p,totalCapturedTime:d,pointsCaptured:h,width:u+n+v,height:o}},getTimelineChartView:function(){var a=SC.ScrollView.create({contentView:SC.StaticContentView.extend({}),reload:function(){var b=SC.Benchmark.getTimelineChartContent();this.contentView.set("content",b.html);this.contentView.adjust({width:b.width,height:b.height});this.chartContent=b;SC.RunLoop.invokeLater(SC.Benchmark,function(){this.contentView.notifyPropertyChange("frame")})}});a.reload();return a},timelineChart:function(a){SC.RunLoop.begin();var c=0;this.hideChart();var b=this.getTimelineChartView();var f=b.chartContent.pointsCaptured,d=b.chartContent.totalCapturedTime;this._benchmarkChart=SC.Pane.create({classNames:["sc-benchmark-pane"],layout:{left:20,right:20,bottom:20,top:20},childViews:["title","exit"],exit:SC.ButtonView.extend({layout:{right:20,top:20,width:100,height:30},title:"Hide Chart",target:this,action:"hideChart"}),title:SC.LabelView.extend({classNames:["sc-benchmark-title"],layout:{left:20,top:23,right:200,height:30},value:((a)?a:"SproutCore Application")+(" - Total Captured Time: "+d+" ms - Points Captured: "+f),fontWeight:"bold"})}).append();b.set("layout",{left:20,top:60,bottom:20,right:20});this._benchmarkChart.appendChild(b);SC.RunLoop.end()},hideChart:function(){if(this._benchmarkChart){this._benchmarkChart.remove();this._benchmarkChart=null}return YES},tryToPerform:function(b,a){if(this[b]){return this[b](a)}return NO},log:function(d){var c=this.report(d).split("\n"),b=c.length,a;for(a=0;a<b;a++){SC.Logger.log(c[a])}},startProfile:function(a){if(!this.enabled){return}SC.Logger.profile(a)},endProfile:function(a){if(!this.enabled){return}SC.Logger.profileEnd(a)},loadPreloadEvents:function(){var g=SC.benchmarkPreloadEvents,f=[],b,a,c;if(typeof webkitPerformnce!=="undefined"){SC.mixin(g,webkitPerformane.timing)}if(!this.globalStartTime){var d=["navigation","navigationStart","headStart"];a=d.length;for(b=0;b<a;b++){if(g[d[b]]){this.globalStartTime=g[d[b]];break}}}this.javascriptStartTime=g.headStart;SC.mixin(this.events,g);this._hasLoadedPreloadEvents=true},_loadBenchmarksFromEvents:function(){if(!this._hasLoadedPreloadEvents){this.loadPreloadEvents()}var b=this.events;for(var a in b){if(a.substr(-3)!=="End"){continue}var c=a.substr(0,a.length-3);if(!b[c+"Start"]){continue}SC.Benchmark.start(c,undefined,b[c+"Start"]);SC.Benchmark.end(c,undefined,b[c+"End"]);delete b[c+"Start"];delete b[c+"End"]}},_compileChartData:function(h){this._loadBenchmarksFromEvents();var m=[],a;for(var n in this.stats){var f=this.stats[n];for(var g=0;g<f._times.length;g++){var o=f._times[g];a=(f._times.length>1)?(g+1)+" - "+n:n;m.push([a,o.start,o.end,o.dur,false]);if(h){var b=o._subStats;for(var c in b){var l=b[c];for(var d=0;d<l._times.length;d++){var p=l._times[d];a=(l._times.length>1)?(d+1)+" - "+c:c;m.push([a,p.start,p.end,p.dur,true])}}}}}m.sort(function(j,i){if(j[1]<i[1]){return -1}else{if(j[1]==i[1]){if(j[3]&&!i[3]){return -1}if(!j[3]&&i[3]){return 1}return 0}}return 1});return m},_genReport:function(a){var b=this._statFor(a);var d=(b.runs>0)?(Math.floor(b.amt*1000/b.runs)/1000):0;var c=b._times[b._times.length-1];return"BENCH %@ msec: %@ (%@x); latest: %@".fmt(d,(b.name||a),b.runs,c.end-c.start)},_timelineGenReport:function(a){if(this.globalStartTime){return"BENCH start: %@ msec, duration: %@ msec,  %@".fmt((a[1]-this.globalStartTime),a[3],a[0])}else{return"BENCH duration: %@ msec, %@".fmt(a[3],a[0])}},_timelineGenSubReport:function(a){if(this.globalStartTime){return"   CHECKPOINT BENCH start: %@ msec, duration: %@ msec,  %@".fmt((a[1]-this.globalStartTime),a[3],a[0])}else{return"   CHECKPOINT BENCH duration: %@ msec, %@".fmt(a[3],a[0])}},_subStatFor:function(d,c){var f=this.stats[c]._times.length;if(f===0){return}var a=this.stats[c]._times[this.stats[c]._times.length-1]._subStats;var b=a[d];if(!b){a[d]={runs:0,amt:0,name:d,_starts:[],_times:[]};b=a[d]}return b},_statFor:function(b){var a=this.stats[b];if(!a){a=this.stats[b]={runs:0,amt:0,name:b,_starts:[],_times:[]};a=this.stats[b]}return a},reset:function(){this.stats={}},_bench:function(b,a){SC.Benchmark.bench(b,a,1)},_benchCount:1};SC.Benchmark=SC.Benchmark;SC.Cookie=SC.Object.extend({name:null,value:"",expires:null,path:null,domain:null,secure:NO,isCookie:YES,destroy:function(){this.set("expires",-1);this.write();arguments.callee.base.apply(this,arguments)},write:function(){var d=this.get("name"),g=this.get("value"),a=this.get("expires"),i=this.get("path"),f=this.get("domain"),h=this.get("secure"),b="",c;if(a){if(typeof a===SC.T_NUMBER){c=new Date();c.setTime(c.getTime()+(a*24*60*60*1000))}else{if(SC.DateTime&&a.get&&a.get("milliseconds")){c=new Date(a.get("milliseconds"))}else{if(a.toUTCString&&a.toUTCString.apply){c=a}}}if(c){b="; expires="+c.toUTCString()}}if(!SC.none(i)){b+="; path="+i}if(!SC.none(f)){b+="; domain="+f}if(h===YES){b+="; secure"}document.cookie=d+"="+encodeURIComponent(g)+b;return this}});SC.Cookie.mixin({find:function(a){if(document.cookie&&document.cookie!==""){var d=document.cookie.split(";");for(var c=0;c<d.length;c++){var b=SC.String.trim(String(d[c]));if(b.substring(0,a.length+1)===(a+"=")){return SC.Cookie.create({name:a,value:decodeURIComponent(b.substring(a.length+1))})}}}return null}});SC.CookieMonster={nomNomNom:function(b){var a=SC.kindOf(b,SC.Cookie);if(a){SC.Logger.log("YUM!");return b.destroy()}SC.Logger.error("Y U PASS ME NO COOKIE? %@",b);return NO}};SC.mixin(SC.$.fn,{setClass:function(d,c){if(SC.none(d)){return this}var f=SC.typeOf(d)!==SC.T_STRING,a=this._fixupClass,b;this.each(function(){if(this.nodeType!==1){return}var i=this.className.split(/\s+/),h=NO;if(f){for(var g in d){if(d.hasOwnProperty(g)){h=a(i,g,d[g])||h}}}else{h=a(i,d,c)}if(h){this.className=i.join(" ")}});return this},_fixupClass:function(d,a,c){var b=d.indexOf(a);if(c){if(b<0){d.push(a);return YES}}else{if(b>=0){d[b]=null;return YES}}return NO}});SC.ExceptionHandler={enabled:(SC.buildMode!=="debug"),handleException:function(a){if(this.isShowingErrorDialog){return NO}this._displayErrorDialog(a);return NO},_displayErrorDialog:function(b){var a=this._errorDialogHTMLForException(b),c=document.createElement("div");c.style.cssText="left: 0px; right: 0px; top: 0px; bottom: 0px; position: absolute; background-color: white; background-color: rgba(255,255,255,0.6); z-index:100;";c.innerHTML=a;document.body.appendChild(c);this.isShowingErrorDialog=YES},_errorDialogHTMLForException:function(b){var a;a=['<div id="sc-error-dialog" style="position: absolute; width: 500px; left: 50%; top: 50%; margin-left: -250px; background-color: white; border: 1px solid black; font-family: Monaco, monospace; font-size: 9px; letter-spacing: 1px; padding: 10px">',"An error has occurred which prevents the application from running:","<br><br>",b.message,'<div id="sc-error-dialog-reload-button" onclick="window.location.reload();" style="float: right; font-family: Monaco, monospace; font-size: 9px; letter-spacing: 1px; border: 1px solid black; padding: 3px; clear: both; margin-top: 20px; cursor: pointer;">',"Reload","</div>","</div>"];return a.join("")},isShowingErrorDialog:NO};SC.IMAGE_ABORTED_ERROR=SC.$error("SC.Image.AbortedError","Image",-100);SC.IMAGE_FAILED_ERROR=SC.$error("SC.Image.FailedError","Image",-101);SC.imageQueue=SC.Object.create({loadLimit:4,activeRequests:0,loadImage:function(a,f,g,d){var b=SC.typeOf(f);if(SC.none(g)&&SC.typeOf(f)===SC.T_FUNCTION){f=null;g=f}if(SC.typeOf(g)===SC.T_STRING){g=f[g]}if(SC.none(d)){d=SC.none(f)&&SC.none(g)}var c=this._imageEntryFor(a);if(c.status===this.IMAGE_LOADED){if(g){g.call(f||c.image,c.url,c.image)}}else{if(f||g){this._addCallback(c,f,g)}c.retainCount++;this._scheduleImageEntry(c,d)}},releaseImage:function(a,d,f){var c=this._imageEntryFor(a,NO);if(!c){return this}if(--c.retainCount<=0){this._deleteEntry(c)}else{if(d||f){var b=SC.typeOf(d);if(SC.none(f)&&SC.typeOf(d)===SC.T_FUNCTION){d=null;f=d}if(SC.typeOf(f)===SC.T_STRING){f=d[f]}this._removeCallback(c,d,f)}}},reloadImage:function(a){var b=this._imageEntryFor(a,NO);if(b&&b.status===this.IMAGE_LOADED){b.status=this.IMAGE_WAITING}},loadNextImage:function(){var c=null,a;if(this.get("activeRequests")>=this.get("loadLimit")){return}a=this._foregroundQueue;while(a.length>0&&!c){c=a.shift()}if(!c){a=this._backgroundQueue;while(a.length>0&&!c){c=a.shift()}}this.set("isLoading",!!c);if(c){var b=c.image;if(!b){return}$(b).bind("abort",this._imageDidAbort);$(b).bind("error",this._imageDidError);$(b).bind("load",this._imageDidLoad);b.src=c.url;this._loading.push(c);this.incrementProperty("activeRequests");this.loadNextImage()}},_imageEntryFor:function(c,a){if(a===undefined){a=YES}var d=this._images[c];if(!d&&a){var b=new Image();d=this._images[c]={url:c,status:this.IMAGE_WAITING,callbacks:[],retainCount:0,image:b};b.entry=d}return d},_deleteEntry:function(a){this._unscheduleImageEntry(a);delete this._images[a.url]},_addCallback:function(c,d,f){var b=c.callbacks;var a=b.find(function(g){return g[0]===d&&g[1]===f},this);if(!a){b.push([d,f])}b=null;return this},_removeCallback:function(b,c,d){var a=b.callbacks;a.forEach(function(g,f){if(g[0]===c&&g[1]===d){a[f]=null}},this);a=null;return this},_scheduleImageEntry:function(d,c){var b=this._backgroundQueue;var f=this._foregroundQueue;if(d.status===this.IMAGE_LOADED){return this}if((d.status===this.IMAGE_QUEUED)&&!c&&d.isBackground){b[b.indexOf(d)]=null;d.status=this.IMAGE_WAITING}if(d.status!==this.IMAGE_QUEUED){var a=(c)?b:f;a.push(d);d.status=this.IMAGE_QUEUED;d.isBackground=c}if(!this.isLoading){this.invokeLater(this.loadNextImage,100)}this.set("isLoading",YES);return this},_unscheduleImageEntry:function(b){if(b.status!==this.IMAGE_QUEUED){return this}var a=b.isBackground?this._backgroundQueue:this._foregroundQueue;a[a.indexOf(b)]=null;if(this._loading.indexOf(b)>=0){if(a.image){a.image.abort()}this.imageStatusDidChange(b,this.ABORTED)}return this},_imageDidAbort:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.ABORTED)},this)},_imageDidError:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.ERROR)},this)},_imageDidLoad:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.LOADED)},this)},imageStatusDidChange:function(c,a){if(!c){return}var b=c.url;var d;switch(a){case this.LOADED:d=c.image;break;case this.ABORTED:d=SC.IMAGE_ABORTED_ERROR;break;case this.ERROR:d=SC.IMAGE_FAILED_ERROR;break;default:d=SC.IMAGE_FAILED_ERROR;break}c.callbacks.forEach(function(g){var h=g[0],i=g[1];i.call(h,b,d)},this);c.callbacks=[];c.status=(a===this.LOADED)?this.IMAGE_LOADED:this.IMAGE_WAITING;var f=c.image;if(f){f.onload=f.onerror=f.onabort=null;if(a!==this.LOADED){c.image=null}}this._loading[this._loading.indexOf(c)]=null;if(this._loading.length>this.loadLimit*2){this._loading=this._loading.compact()}this.decrementProperty("activeRequests");this.loadNextImage()},init:function(){arguments.callee.base.apply(this,arguments);this._images={};this._loading=[];this._foregroundQueue=[];this._backgroundQueue=[]},IMAGE_LOADED:"loaded",IMAGE_QUEUED:"queued",IMAGE_WAITING:"waiting",ABORTED:"aborted",ERROR:"error",LOADED:"loaded"});SC.Math=SC.Object.create({near:function(c,b,a){if(!a){a=0.00001}return Math.abs(c-b)<=a},round:function(d,a){if(!a){a=0}var b=Math.pow(10,a);if(a<0){var c=b.toString();b=c.substring(0,c.indexOf("1")+1)}d=d.valueOf();return Math.round(d*b)/b}});SC.Task=SC.Object.extend({run:function(a){}});sc_require("tasks/task");SC.LOG_MODULE_LOADING=YES;SC.Module=SC.Object.create({isModuleReady:function(a){var b=SC.MODULE_INFO[a];return b?!!b.isReady:NO},loadModule:function(b,h,a){var c=SC.MODULE_INFO[b],i,g,j=SC.A(arguments).slice(3),d=SC.LOG_MODULE_LOADING,k,f;if(a===undefined&&SC.typeOf(h)===SC.T_FUNCTION){a=h;h=null}if(d){SC.debug("SC.Module: Attempting to load '%@'",b)}if(!c){throw"SC.Module: could not find module '%@'".fmt(b)}c.isPrefetching=NO;if(c.isLoaded&&!c.isWaitingForRunLoop){if(d){SC.debug("SC.Module: Module '%@' already loaded.",b)}if(!this._dependenciesMetForModule(b)){this._addCallbackForModule(b,h,a,j);this._loadDependenciesForModule(b);return NO}if(c.source){if(d){SC.debug("SC.Module: Evaluating JavaScript for module '%@'.",b)}this._evaluateStringLoadedModule(c);this._addCallbackForModule(b,h,a,j);this.invokeLast(function(){c.isReady=YES;this._moduleDidBecomeReady(b)});return NO}if(a){if(SC.isReady){SC.Module._invokeCallback(b,h,a,j)}else{SC.ready(SC.Module,function(){SC.Module._invokeCallback(b,h,a,j)})}}return YES}else{if(c.isWaitingForRunLoop){this._addCallbackForModule(b,h,a,j)}else{if(d){SC.debug("SC.Module: Module '%@' is not loaded, loading now.",b)}this._addCallbackForModule(b,h,a,j);if(!c.isLoading){this._loadDependenciesForModule(b);this._loadCSSForModule(b);this._loadJavaScriptForModule(b);c.isLoading=YES}return NO}}},_addCallbackForModule:function(b,f,g,a){var c=SC.MODULE_INFO[b];var d=c.callbacks||[];if(g){d.push(function(){SC.Module._invokeCallback(b,f,g,a)})}c.callbacks=d},prefetchModule:function(a){var b=SC.MODULE_INFO[a];if(b.isLoading||b.isLoaded){return}if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Prefetching module '%@'.",a)}this._loadDependenciesForModule(a);this._loadCSSForModule(a);this._loadJavaScriptForModule(a);b.isLoading=YES;b.isPrefetching=YES},_executeLazilyInstantiatedModule:function(b,c,i){var h=SC.LAZY_INSTANTIATION[b];var g;var a;var j,d;if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Module '%@' is marked for lazy instantiation, instantiating it now",b)}d=h.length;for(j=0;j<d;j++){try{h[j]()}catch(f){SC.Logger.error("SC.Module: Failed to lazily instatiate entry for  '%@'".fmt(b))}}delete SC.LAZY_INSTANTIATION[b];g=this._targetForTargetName(c);a=this._methodForMethodNameInTarget(i,g);if(!a){throw"SC.Module: could not find callback for lazily instantiated module '%@'".fmt(b)}},_evaluateStringLoadedModule:function(b){var a=b.source;jQuery.globalEval(a);delete b.source;if(b.cssSource){var c=document.createElement("style");c.setAttribute("type","text/css");if(c.styleSheet){c.styleSheet.cssText=b.cssSource}else{var d=document.createTextNode(b.cssSource);c.appendChild(d)}document.getElementsByTagName("head")[0].appendChild(c)}b.isReady=YES},_loadCSSForModule:function(d){var g=document.getElementsByTagName("head")[0];var f=SC.MODULE_INFO[d];var i=f.styles||[];var b=i.length;var c;var h;var a;if(!g){g=document.documentElement}b=i.length;for(a=0;a<b;a++){c=i[a];if(c.length>0){if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Loading CSS file in '%@' -> '%@'",d,c)}h=document.createElement("link");h.setAttribute("href",c);h.setAttribute("rel","stylesheet");h.setAttribute("type","text/css");g.appendChild(h)}}h=null},_loadJavaScriptForModule:function(b){var c=SC.MODULE_INFO[b];var d;var a;var f=c.dependencies;var g=YES;if(f&&f.length>0){g=this._dependenciesMetForModule(b)}if(c.isPrefetched){a=c.stringURL}else{if(g){a=c.scriptURL}else{a=c.stringURL}}if(a.length>0){if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Loading JavaScript file in '%@' -> '%@'",b,a)}d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",a);if(SC.browser.isIE){d.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){SC.run(function(){SC.Module._moduleDidLoad(b)})}}}else{d.onload=function(){SC.run(function(){SC.Module._moduleDidLoad(b)})}}document.body.appendChild(d)}},_dependenciesMetForModule:function(c){var f=SC.MODULE_INFO[c].dependencies||[];var b,a=f.length;var g;var d;for(b=0;b<a;b++){g=f[b];d=SC.MODULE_INFO[g];if(!d){throw"SC.loadModule: Unable to find dependency %@ for module %@.".fmt(g,c)}if(!d.isReady){return NO}}return YES},_loadDependenciesForModule:function(a){var b=SC.MODULE_INFO[a];var f=SC.LOG_MODULE_LOADING;var j=b.dependencies||[];var g=YES;var h=j.length;var k;var d;var c;var i;for(k=0;k<h;k++){d=j[k];c=SC.MODULE_INFO[d];if(!c){throw"SC.Module: could not find required module '%@' for module '%@'".fmt(d,a)}else{if(c.isLoading){g=NO;i=c.dependents;if(!i){c.dependents=i=[]}i.push(a)}else{if(c.isReady){continue}else{g=NO;i=c.dependents;if(!i){c.dependents=i=[]}i.push(a);if(f){SC.debug("SC.Module: '%@' depends on '%@', loading dependency",a,d)}SC.Module.loadModule(d)}}}}},_invokeCallback:function(c,d,a,b){var h;var g;g=this._targetForTargetName(d);h=this._methodForMethodNameInTarget(a,g);if(!h){if(SC.LAZY_INSTANTIATION[c]){this._executeLazilyInstantiatedModule(c,d,a);g=this._targetForTargetName(d);h=this._methodForMethodNameInTarget(a,g)}else{throw"SC.Module: could not find callback for '%@'".fmt(c)}}if(!b){b=[]}b.unshift(c);var f=!!SC.RunLoop.currentRunLoop;if(f){SC.run(function(){h.apply(g,b)})}else{h.apply(g,b)}},_invokeCallbacksForModule:function(c){var f=SC.MODULE_INFO[c],d;if(!f){return}if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Module '%@' has completed loading, invoking callbacks.",c)}d=f.callbacks||[];for(var b=0,a=d.length;b<a;++b){d[b]()}},_evaluateAndInvokeCallbacks:function(a){var d=SC.MODULE_INFO;var b=d[a];var c=SC.LOG_MODULE_LOADING;if(c){SC.debug("SC.Module: Evaluating and invoking callbacks for '%@'.",a)}if(b.source){this._evaluateStringLoadedModule(b)}b.isWaitingForRunLoop=YES;this.invokeLast(function(){b.isReady=YES;this._moduleDidBecomeReady(a)})},_moduleDidBecomeReady:function(a){var c=SC.MODULE_INFO;var b=c[a];var d=SC.LOG_MODULE_LOADING;b.isWaitingForRunLoop=NO;if(SC.isReady){SC.Module._invokeCallbacksForModule(a);delete b.callbacks}else{SC.ready(SC,function(){SC.Module._invokeCallbacksForModule(a);delete b.callbacks})}var h=b.dependents||[];var f,j;for(var i=0,g=h.length;i<g;i++){f=h[i];j=c[f];if(j.isLoaded&&this._dependenciesMetForModule(f)){if(d){SC.debug("SC.Module: Now that %@ has loaded, all dependencies for a dependent %@ are met.",a,f)}this._evaluateAndInvokeCallbacks(f)}}},_moduleDidLoad:function(b){var c=SC.MODULE_INFO[b];var f=SC.LOG_MODULE_LOADING;var d;var g,a;if(f){SC.debug("SC.Module: Module '%@' finished loading.",b)}if(!c){if(f){SC.debug("SC._moduleDidLoad() called for unknown module '@'.",b)}c=SC.MODULE_INFO[b]={isLoaded:YES,isReady:YES};return}if(c.isLoaded){if(f){SC.debug("SC._moduleDidLoad() called more than once for module '%@'. Skipping.",b)}return}delete c.isLoading;c.isLoaded=YES;if(!c.isPrefetching){d=this._dependenciesMetForModule(b);if(d){this._evaluateAndInvokeCallbacks(b)}else{if(f){SC.debug("SC.Module: Dependencies for '%@' not met yet, waiting to evaluate.",b)}}}else{delete c.isPrefetching;if(f){SC.debug("SC.Module: Module '%@' was prefetched, not evaluating until needed.",b)}}},_targetForTargetName:function(a){if(SC.typeOf(a)===SC.T_STRING){return SC.objectForPropertyPath(a)}return a},_methodForMethodNameInTarget:function(a,b){if(SC.typeOf(a)===SC.T_STRING){return SC.objectForPropertyPath(a,b)}return a},methodsForSuspend:"loadModule _moduleDidLoad prefetchModule _moduleDidBecomeReady".w(),suspend:function(){this._suspendCount=(this._suspendCount||0)+1;if(this._suspendCount!==1){return}var a=this.get("methodsForSuspend"),f,d,c,b;for(b=0;c=a[b];b++){if(!this[f="__replacement_"+c+"__"]){(this[f]=function(){(this._bufferedCalls||(this._bufferedCalls=[])).push({method:arguments.callee.methodName,arguments:arguments})}).methodName=c}if(!this[d="__saved_"+c+"__"]){this[d]=this[c]}this[c]=this[f]}},resume:function(){this._suspendCount=(this._suspendCount||0)-1;if(this._suspendCount<0){SC.warn("SC.Module.resume() was called without SC.Module having been in a suspended state. Call aborted.");this._suspendCount=0;return}if(this._suspendCount>0){return}var a=this.get("methodsForSuspend"),d=this._bufferedCalls,c,b,g,f;for(b=0;(c=a[b]);b++){this[c]=this["__saved_"+c+"__"]}for(b=0;f=d&&d[b];b++){this[f.method].apply(this,f.arguments)}if(d){d.length=0}}});SC.ready(function(){var d=SC.MODULE_INFO;var b;var c;var a;for(b in d){c=d[b];if(c.isPrefetched){a=SC.Module.PrefetchModuleTask.create({prefetchedModuleName:b});SC.backgroundTaskQueue.push(a)}}});SC.Module.PrefetchModuleTask=SC.Task.extend({prefetchedModuleName:null,run:function(){SC.Module.prefetchModule(this.prefetchedModuleName)}});sc_require("tasks/task");SC.TaskQueue=SC.Task.extend({init:function(){var a=this;this._doIdleEntry=function(){a._idleEntry()};this._suspendCount=0;this._tasks=[]},runWhenIdle:NO,runLimit:50,interval:50,isRunning:NO,minimumIdleDuration:500,_tasks:null,hasTasks:function(){return this._tasks.length>0}.property("taskCount").cacheable(),taskCount:function(){return this._tasks.length}.property().cacheable(),push:function(a){this._tasks.push(a);this.notifyPropertyChange("taskCount")},next:function(){if(this._tasks.length<1){return null}var a=this._tasks.shift();this.notifyPropertyChange("taskCount");return a},suspend:function(){this._suspendCount++},resume:function(){this._suspendCount--;if(this._suspendCount<=0){this._setupIdle()}},_taskCountDidChange:function(){this._setupIdle()}.observes("taskCount"),_runWhenIdleDidChange:function(){this._setupIdle()}.observes("runWhenIdle"),_setupIdle:function(){if(!this._suspendCount&&this.get("runWhenIdle")&&!this._idleIsScheduled&&this.get("taskCount")>0){setTimeout(this._doIdleEntry,this.get("interval"));this._idleIsScheduled=YES}},_idleEntry:function(){this._idleIsScheduled=NO;var a=SC.RunLoop.lastRunLoopEnd;if(!this.get("runWhenIdle")&&!this._suspendCount){return}if(Date.now()-a>this.get("minimumIdleDuration")){SC.run(this.run,this);SC.RunLoop.lastRunLoopEnd=a}this._setupIdle()},run:function(a){this.set("isRunning",YES);if(!a){a=this.get("runLimit")}var b,c=Date.now();while(b=this.next()){b.run(this);if(Date.now()-c>a){break}}this.set("isRunning",NO)}});SC.backgroundTaskQueue=SC.TaskQueue.create({runWhenIdle:YES});SC.TextSelection=SC.Object.extend(SC.Copyable,SC.Freezable,{start:-1,end:-1,length:function(){var b=this.get("start");var a=this.get("end");if((b)===-1||(a===-1)){return -1}else{return a-b}}.property("start","end").cacheable(),init:function(){arguments.callee.base.apply(this,arguments);this.freeze()},copy:function(){return SC.TextSelection.create({start:this.get("start"),end:this.get("end")})},toString:function(){var a=this.get("length");if(a&&a>0){if(a===1){return"[%@ character selected: {%@, %@}]".fmt(a,this.get("start"),this.get("end"))}else{return"[%@ characters selected: {%@, %@}]".fmt(a,this.get("start"),this.get("end"))}}else{return"[no text selected; caret at %@]".fmt(this.get("start"))}}});SC.UserDefaults=SC.Object.extend({ready:NO,userDomain:null,appDomain:null,_defaults:null,_safari3DB:null,defaults:function(a){this._defaults=a;this.allPropertiesDidChange()},readDefault:function(i){var a,d,b,j,h,k,g;i=this._normalizeKeyName(i);b=this._userKeyName(i);if(this._written){d=this._written[b]}a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){j=document.body;try{j.load("SC.UserDefaults")}catch(c){SC.Logger.error("Couldn't load userDefaults in IE7: "+c.description)}}else{if(this.HTML5DB_noLocalStorage){g=this._safari3DB}else{j=window.localStorage;if(!j&&window.globalStorage){j=window.globalStorage[window.location.hostname]}}}if(j||g){h=["SC.UserDefaults",b].join("-at-");if(a){d=j.getAttribute(h.replace(/\W/gi,""))}else{if(g){d=this.dataHash[h]}else{d=j[h]}}if(!SC.none(d)){try{d=SC.json.decode(d)}catch(f){}}}k=this.delegate;if(k&&k.userDefaultsNeedsDefault){d=k.userDefaultsNeedsDefault(this,i,b)}if((d===undefined)&&this._defaults){d=this._defaults[b]||this._defaults[i]}return d},writeDefault:function(k,i){var b,f,c,l,j,m,h;k=this._normalizeKeyName(k);f=this._userKeyName(k);c=this._written;if(!c){c=this._written={}}c[f]=i;b=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(b){l=document.body}else{if(this.HTML5DB_noLocalStorage){h=this._safari3DB}else{l=window.localStorage;if(!l&&window.globalStorage){l=window.globalStorage[window.location.hostname]}}}j=["SC.UserDefaults",f].join("-at-");if(l||h){var a=SC.json.encode(i);if(b){l.setAttribute(j.replace(/\W/gi,""),a);l.save("SC.UserDefaults")}else{if(h){var d=this;h.transaction(function(n){n.executeSql("delete from SCLocalStorage where key = ?",[j],function(){n.executeSql("insert into SCLocalStorage(key, value) VALUES ('"+j+"', '"+a+"');",[],d._nullDataHandler,d.killTransaction)})});this.dataHash[j]=a}else{try{l[j]=a}catch(g){SC.Logger.error("Failed using localStorage. "+g)}}}}m=this.delegate;if(m&&m.userDefaultsDidChange){m.userDefaultsDidChange(this,k,i,f)}return this},resetDefault:function(j){var b,a,f,c,k,i,h;b=this._normalizeKeyName(j);f=this._userKeyName(b);this.propertyWillChange(j);this.propertyWillChange(b);c=this._written;if(c){delete c[f]}a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){k=document.body}else{if(this.HTML5DB_noLocalStorage){h=this._safari3DB}else{k=window.localStorage;if(!k&&window.globalStorage){k=window.globalStorage[window.location.hostname]}}}i=["SC.UserDefaults",f].join("-at-");if(k){if(a){k.setAttribute(i.replace(/\W/gi,""),null);k.save("SC.UserDefaults")}else{if(h){var d=this;h.transaction(function(l){l.executeSql("delete from SCLocalStorage where key = ?",[i],null)});delete this.dataHash[i]}else{try{delete k[i]}catch(g){SC.Logger.warn("Deleting local storage encountered a problem. "+g)}}}}this.propertyDidChange(j);this.propertyDidChange(b);return this},unknownProperty:function(a,b){if(b===undefined){return this.readDefault(a)}else{this.writeDefault(a,b);return b}},_normalizeKeyName:function(a){if(a.indexOf(":")<0){var b=this.get("appDomain")||"app";a=[b,a].join(":")}return a},_userKeyName:function(b){var a=this.get("userDomain")||"(anonymous)";return[a,b].join("-at-")},_domainDidChange:function(){var a=NO;if(this.get("userDomain")!==this._scud_userDomain){this._scud_userDomain=this.get("userDomain");a=YES}if(this.get("appDomain")!==this._scud_appDomain){this._scud_appDomain=this.get("appDomain");a=YES}if(a){this.allPropertiesDidChange()}}.observes("userDomain","appDomain"),init:function(){arguments.callee.base.apply(this,arguments);var a;jQuery.readyWait++;if(SC.userDefaults&&SC.userDefaults.get("dataHash")){var g=SC.userDefaults.get("dataHash");if(g){this.dataHash=SC.userDefaults.get("dataHash")}}this._scud_userDomain=this.get("userDomain");this._scud_appDomain=this.get("appDomain");a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){document.body.addBehavior("#default#userData")}this.HTML5DB_noLocalStorage=SC.browser.isWebkit&&SC.browser.compare(SC.browser.engineVersion,"523")>0&&SC.browser.compare(SC.browser.engineVersion,"528")<0;if(this.HTML5DB_noLocalStorage){var b;try{if(!window.openDatabase){SC.Logger.error("Trying to load a database with safari version 3.1 to get SC.UserDefaults to work. You are either in a previous version or there is a problem with your browser.");return}else{var h="scdb",f="1.0",i="SproutCore database",j=65536;b=openDatabase(h,f,i,j)}}catch(d){SC.Logger.error("Trying to load a database with safari version 3.1 to get SC.UserDefaults to work. You are either in a previous version or there is a problem with your browser.");return}if(b){var c=this;b.transaction(function(k){k.executeSql("CREATE TABLE IF NOT EXISTS SCLocalStorage(key TEXT NOT NULL PRIMARY KEY, value TEXT NOT NULL);",[],c._nullDataHandler,c.killTransaction)});b.transaction(function(k){k.parent=c;k.executeSql("SELECT * from SCLocalStorage;",[],function(q,n){var o={},p;for(var m=0,l=n.rows.length;m<l;m++){p=n.rows.item(m);o[p.key]=p.value}q.parent.dataHash=o;SC.run(function(){jQuery.ready(true)})},c.killTransaction)});this._safari3DB=b}}else{jQuery.ready(true)}},_killTransaction:function(b,a){return true},_nullDataHandler:function(b,a){}});SC.userDefaults=SC.UserDefaults.create();SC.mixin({convertHsvToHex:function(k,x,u){var a=0,l=0,o=0;if(u>0){var j=(k==1)?0:Math.floor(k*6),m=(k==1)?0:(k*6)-j,d=u*(1-x),c=u*(1-(x*m)),w=u*(1-(x*(1-m))),n=[[u,w,d],[c,u,d],[d,u,w],[d,c,u],[w,d,u],[u,d,c]];a=Math.round(255*n[j][0]);l=Math.round(255*n[j][1]);o=Math.round(255*n[j][2])}return this.parseColor("rgb("+a+","+l+","+o+")")},convertHexToHsv:function(i){var c=this.expandColor(i),a=Math.max(Math.max(c[0],c[1]),c[2]),d=Math.min(Math.min(c[0],c[1]),c[2]),g=(a===0)?0:(1-d/a),b=a/255,f=(a==d)?0:((a==c[0])?((c[1]-c[2])/(a-d)/6):((a==c[1])?((c[2]-c[0])/(a-d)/6+1/3):((c[0]-c[1])/(a-d)/6+2/3)));f=(f<0)?(f+1):((f>1)?(f-1):f);return[f,g,b]},PARSE_COLOR_RGBRE:/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i,PARSE_COLOR_HEXRE:/^\#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,expandColor:function(b){var c,f,d,a;c=this.parseColor(b);if(c){f=parseInt(c.slice(1,3),16);d=parseInt(c.slice(3,5),16);a=parseInt(c.slice(5,7),16);return[f,d,a]}},parseColor:function(d){var f=0,a="#",c,b;if(c=this.PARSE_COLOR_RGBRE.exec(d)){for(f=1;f<=3;f++){b=Math.max(0,Math.min(255,parseInt(c[f],0)));a+=this.toColorPart(b)}return a}if(c=this.PARSE_COLOR_HEXRE.exec(d)){if(c[1].length==3){for(f=0;f<3;f++){a+=c[1].charAt(f)+c[1].charAt(f)}return a}return"#"+c[1]}return false},toColorPart:function(a){if(a>255){a=255}var b=a.toString(16);if(a<16){return"0"+b}return b}});SC.mixin({_downloadFrames:0,download:function(d){var a=document.createElement("iframe"),c="DownloadFrame_"+this._downloadFrames;SC.$(a).attr("id",c);a.style.border="10px";a.style.width="0px";a.style.height="0px";a.style.position="absolute";a.style.top="-10000px";a.style.left="-10000px";if(!SC.browser.isSafari){SC.$(a).attr("src",d)}document.getElementsByTagName("body")[0].appendChild(a);if(SC.browser.isSafari){SC.$(a).attr("src",d)}this._downloadFrames=this._downloadFrames+1;if(!SC.browser.isSafari){var b=function(){document.body.removeChild(document.getElementById(c));c=null};b.invokeLater(null,2000)}a=null},getStyle:function(a,b){var c="";if(document.defaultView&&document.defaultView.getComputedStyle){c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b)}else{if(a.currentStyle){b=b.replace(/\-(\w)/g,function(d,f){return f.toUpperCase()});c=a.currentStyle[b]}}return c},uniJapaneseConvert:function(f){var a,c="",b,d;for(b=0,d=f.length;b<d;b++){a=f.charCodeAt(b);a=((a>=65281&&a<=65392)?a-65248:a);a=(a===12540?45:a);c=c+String.fromCharCode(a)}return c},pointInElement:function(b,h,c,g){var i,d,a,f;h=jQuery(h);c=c||"border";i=SC.offset(h,g);if(c==="padding"){d=h.innerWidth();a=h.innerHeight();i.x+=window.parseInt(h.css("border-left-width").replace("px",""));i.y+=window.parseInt(h.css("border-top-width").replace("px",""))}else{d=h.outerWidth(c==="margin");a=h.outerHeight(c==="margin");if(c==="margin"){i.x-=window.parseInt(h.css("margin-left").replace("px",""));i.y-=window.parseInt(h.css("margin-top").replace("px",""))}}f={x:i.x,y:i.y,width:d,height:a};return SC.pointInRect(b,f)},switchScale:function(){$("head meta[name=viewport]").remove();if(window.innerWidth===window.screen.width){$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5, user-scalable=0" />')}else{$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=0" />')}}});SC.mixin({ZERO_RANGE:{start:0,length:0},RANGE_NOT_FOUND:{start:0,length:-1},valueInRange:function(b,a){return(b>=0)&&(b>=a.start)&&(b<(a.start+a.length))},minRange:function(a){return a.start},maxRange:function(a){return(a.length<0)?-1:(a.start+a.length)},unionRanges:function(c,b){if((c==null)||(c.length<0)){return b}if((b==null)||(b.length<0)){return c}var d=Math.min(c.start,b.start),a=Math.max(SC.maxRange(c),SC.maxRange(b));return{start:d,length:a-d}},intersectRanges:function(c,b){if((c==null)||(b==null)){return SC.RANGE_NOT_FOUND}if((c.length<0)||(b.length<0)){return SC.RANGE_NOT_FOUND}var d=Math.max(SC.minRange(c),SC.minRange(b)),a=Math.min(SC.maxRange(c),SC.maxRange(b));if(a<d){return SC.RANGE_NOT_FOUND}return{start:d,length:a-d}},subtractRanges:function(c,b){if((c==null)||(b==null)){return SC.RANGE_NOT_FOUND}if((c.length<0)||(b.length<0)){return SC.RANGE_NOT_FOUND}var a=Math.max(SC.minRange(c),SC.minRange(b)),d=Math.min(SC.maxRange(c),SC.maxRange(b));if(a<d){return SC.RANGE_NOT_FOUND}return{start:d,length:a-d}},cloneRange:function(a){return{start:a.start,length:a.length}},rangesEqual:function(b,a){if(b===a){return true}if(b==null){return a.length<0}if(a==null){return b.length<0}return(b.start==a.start)&&(b.length==a.length)}});SC.mixin({bestStringMetricsForMaxWidth:function(a,z,o,B,y){if(!z){SC.warn("When calling bestMetricsForWidth, the second argument, maxWidth, is required. There's no reason to call this without a maxWidth.");return undefined}z=Math.ceil(parseFloat(z));var C=arguments.callee,j=SC.typeOf(o||(o=""))!==SC.T_STRING,n=j?o.style.maxWidth:undefined,p=(!j||o.cacheableForMetrics)?SC.cacheSlotFor(o,B,y,a):undefined,t=j?(C._applyMaxToEl||(C._applyMaxToEl=function(l,i){l.style.maxWidth=i+"px";return l})):(C._applyMaxToStr||(C._applyMaxToStr=function(l,i){return l.replace(/max-width:[^;]*;/g,"")+" max-width:"+i+"px"})),w=j?(C._removeMaxFromEl||(C._removeMaxFromEl=function(i){i.style.maxWidth="none";return i})):(C._removeMaxFromStr||(C._removeMaxFromStr=function(i){return i.replace(/max-width:[^;]*;/g,"")+" max-width:none"})),q=false;if(p){p.list||(p.list=[{width:Infinity,height:0}]);for(var x=1,v=p.list.length,E,b,F;x<v&&!F;x++){E=p.list[x];b=p.list[x-1];if(!E||!E.width){continue}if(z>=E.width){if((b&&b.width)||(z<=E.maxWidth)){return E}F=E}}}var r=t(o,z),u=SC.metricsForString(a,r,B,y),A=u.height,d=p?p.parent.height||(p.parent.height=SC.metricsForString("W",r,B).height):SC.metricsForString("W",r,B).height,c=Math.round(A/d);if(q){c--;A=c*d}if(A>d){var h=q?Math.ceil(u.width*2.5):u.width,m=q?u.width:Math.floor(u.width/2.5),D,g=new Date()*1,k=0;while(h-m>1||(u.height>A&&!q)||(u.height<A&&q)){k++;D=(h+m)/2;r=t(r,D);u=SC.metricsForString(a,r,B,y);if(u.height>A){m=D}else{h=D}}u.width=Math.ceil(D);u.height=A;u.maxWidth=z;u.lineHeight=d;u.lines=c;u.searchPerformed=true;u.searchTime=new Date()*1-g;u.searchCount=k}else{if(q){u=SC.metricsForString(a,r=w(r),B,y)}u.maxWidth=z;u.lineHeight=d;u.lines=c;u.searchPerformed=false}u.browserCorrection=0;if(SC.browser.isIE){u.browserCorrection=1}if(SC.browser.isMozilla){u.browserCorrection=1}u.width=Math.min(z,u.width+u.browserCorrection);if(p){var f=p.list[c];if(f&&f.maxWidth<z){f.maxWidth=z}if(!f){f=p.list[c]=u}}if(j){r.style.maxWidth=n}F=q?F:u;return F},cacheSlotFor:function(){var f=arguments.callee.caller,g=f.cache||(f.cache={});if(!arguments[0]){return g}var b=(arguments[0] instanceof Array||arguments[0].callee)?arguments[0]:arguments,d=b.length,a,c;for(c=0;c<d;c++){if(typeof(a=b[c])==="object"){a=SC.guidFor(a)}g=g[a]||(g[a]={parent:g})}return g},cachedVersionOf:function(){var a=function(c){var b=function(){var d=SC.cacheSlotFor(arguments);return d.result||(d.result=arguments.callee.func.apply(this,arguments))};b.func=c;return b};return a(a)}()});sc_require("tasks/task");SC.didPreloadBundle=function(){};SC.PreloadBundleTask=SC.Task.extend({bundle:null,target:"SC",action:"preloaded",run:function(a){var b;if(b=this.get("bundle")){var c=Date.now();SC.Module.loadModule(this.get("bundle"),this.get("target"),this.get("action"))}}});sc_require("system/string");SC.VALIDATE_OK=YES;SC.VALIDATE_NO_CHANGE=NO;SC.Validator=SC.Object.extend({fieldValueForObject:function(b,c,a){return b},objectForFieldValue:function(c,b,a){return c},validate:function(a,b){return true},validateError:function(a,b){return SC.$error(SC.String.loc("Invalid.General(%@)",b.get("fieldValue")),b.get("fieldKey"))},validateChange:function(b,c,a){return this.validate(b,c)?SC.VALIDATE_OK:this.validateError(b,c)},validateSubmit:function(a,b){return this.validate(a,b)?SC.VALIDATE_OK:this.validateError(a,b)},validatePartial:function(a,b){if(!b.get("isValid")){return this.validate(a,b)?SC.VALIDATE_OK:this.validateError(a,b)}else{return SC.VALIDATE_NO_CHANGE}},validateKeyDown:function(b,c,a){return true},attachTo:function(a,b){},detachFrom:function(a,b){}});SC.Validator.mixin({OK:true,NO_CHANGE:false,findFor:function(f,h,g){var c;if(!g){return}if(g instanceof SC.Validator){c=g}else{if(g.isClass){c=g.create()}else{if(SC.typeOf(g)===SC.T_STRING){var b=null;var a=g.match(/^(.+)\[(.*)\]/);if(a){g=a[1];b=a[2]}g=SC.String.classify(g);var d=SC.Validator[g];if(SC.none(d)){throw"validator %@ not found for %@".fmt(g,h)}else{if(b){if(!f){throw"named validator (%@) could not be found for field %@ because the field does not belong to a form".fmt(b,h)}if(!f._validatorHash){f._validatorHash={}}c=(b)?f._validatorHash[b]:null;if(!c){c=d.create()}if(b){f._validatorHash[b]=c}}else{c=d.create()}}}}}return c},fieldValueForObject:function(a,b,c){if(this.prototype&&this.prototype.fieldValueForObject){return this.prototype.fieldValueForObject(a,b,c)}else{return null}},objectForFieldValue:function(b,a,c){if(this.prototype&&this.prototype.objectForFieldValue){return this.prototype.objectForFieldValue(b,a,c)}else{return null}}});sc_require("validators/validator");SC.Validator.CreditCard=SC.Validator.extend({fieldValueForObject:function(a,b,c){if(typeof(a)=="string"&&a.length==16){a=[a.slice(0,4),a.slice(4,8),a.slice(8,12),a.slice(12,16)].join(" ")}return a},objectForFieldValue:function(b,a,c){return b.replace(/[\s-\.\:]/g,"")},validate:function(a,b){return this.checkNumber(b.get("fieldValue"))},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.CreditCard(%@)",a),a)},validateKeyDown:function(b,c,a){return !!a.match(/[0-9\- ]/)},checkNumber:function(k){if(!k||k.length===0){return YES}k=k.replace(/[^0-9]/g,"");var a="0123456789";var h=k.length;var g=parseInt(k,0);var m=k.toString();m=m.replace(/^\s+|\s+$/g,"");var l=0;var o=true;var b=false;var n;var d;for(var c=0;c<h;c++){n=""+m.substring(c,c+1);if(a.indexOf(n)=="-1"){o=false}}if(!o){b=false}if((h===0)&&(b)){b=false}else{if(h>=15){for(var f=h;f>0;f--){d=parseInt(g,0)%10;d=parseInt(d,0);l+=d;f--;g=g/10;d=parseInt(g,0)%10;d=d*2;switch(d){case 10:d=1;break;case 12:d=3;break;case 14:d=5;break;case 16:d=7;break;case 18:d=9;break;default:d=d}g=g/10;l+=d}if((l%10)===0){b=true}else{b=false}}}return b}});sc_require("validators/validator");SC.Validator.Date=SC.Validator.extend({format:"%b %d, %Y %i:%M:%S %p",fieldValueForObject:function(a,b,f){var d=this.get("format"),c;if(SC.typeOf(a)===SC.T_NUMBER){c=SC.DateTime.create(a)}else{if(a instanceof Date){c=a.getTime()}}if(c){a=c.toFormattedString(d)}return a},objectForFieldValue:function(c,a,f){var d=this.get("format"),b;if(c){b=SC.DateTime.parse(c,d);c=b?b._ms:null}return c}});sc_require("validators/validator");SC.Validator.DateTime=SC.Validator.extend({format:"%d/%m/%Y",fieldValueForObject:function(a,b,c){if(SC.kindOf(a,SC.DateTime)){a=a.toFormattedString(this.get("format"))}else{a=null}return a},objectForFieldValue:function(b,a,c){if(b){b=SC.DateTime.parse(b,this.get("format"))}return b}});sc_require("validators/validator");SC.Validator.Email=SC.Validator.extend({validate:function(a,b){return(b.get("fieldValue")||"").match(/.+@.+\...+/)},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Email(%@)",a),a)}});SC.Validator.EmailOrEmpty=SC.Validator.Email.extend({validate:function(a,c){var b=c.get("fieldValue");return(b&&b.length>0)?b.match(/.+@.+\...+/):true}});sc_require("validators/validator");SC.Validator.NotEmpty=SC.Validator.extend({validate:function(a,c){var b=c.get("fieldValue");if(SC.none(b)){return NO}if(!SC.none(b.length)){return b.length>0}return YES},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.NotEmpty(%@)",SC.String.capitalize(a)),c.get("errorLabel"))}});sc_require("validators/validator");sc_require("system/utils/misc");SC.Validator.Number=SC.Validator.extend({places:0,fieldValueForObject:function(a,b,c){switch(SC.typeOf(a)){case SC.T_NUMBER:a=a.toFixed(this.get("places"));break;case SC.T_NULL:case SC.T_UNDEFINED:a="";break}return a},objectForFieldValue:function(c,b,d){var a;c=c.replace(/,/g,"");switch(SC.typeOf(c)){case SC.T_STRING:if(c.length===0){c=null}else{if(this.get("places")>0){c=parseFloat(c)}else{if(c.length===1&&c.match(/-/)){c=null}else{a=parseInt(c,0);if(isNaN(a)){c=SC.uniJapaneseConvert(c);c=parseInt(c,0);if(isNaN(c)){c=""}}else{c=a}}}}break;case SC.T_NULL:case SC.T_UNDEFINED:c=null;break}return c},validate:function(a,c){var b=c.get("fieldValue");return(b==="")||!(isNaN(b)||isNaN(parseFloat(b)))},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(b,c,a){if(!a){a=""}var d=c.$input().val();if(!d){d=""}d+=a;if(this.get("places")===0){if(a.length===0){return true}else{return d.match(/^[\-{0,1}]?[0-9,\0]*/)[0]===d}}else{if(a.length===0){return true}else{return d.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)===d}}}});sc_require("validators/validator");SC.Validator.Password=SC.Validator.extend({attachTo:function(a,b){arguments.callee.base.apply(this,arguments);if(!this.fields){this.fields=[]}this.fields.push(b)},validate:function(f){if(!this.fields||this.fields.length===0){return true}var d=false;var b=false;var a=true;var c=this.fields[0].get("fieldValue");this.fields.forEach(function(h){var g=h.get("fieldValue");if(g!=c){a=false}if(!g||g.length===0){d=true}if(g&&g.length>0){b=true}});if(f){return(b===false)?false:a}else{return(d===true)?true:a}},updateFields:function(c,b){if(!this.fields||this.fields.length===0){return true}var a=SC.String.loc("Invalid.Password");var d=this._field;this.fields.forEach(function(g){var h=(b)?null:((g==d)?a:"");c.setErrorFor(g,h)});return(b)?SC.VALIDATE_OK:a},validateChange:function(b,c,a){return this.updateFields(b,this.validate(false))},validateSubmit:function(a,b){return this.updateFields(a,this.validate(true))},validatePartial:function(b,c){var a=!this._field.get("isValid");if(a){return this.updateFields(b,this.validate(false))}else{return SC.VALIDATE_NO_CHANGE}}});sc_require("validators/validator");SC.Validator.PositiveInteger=SC.Validator.extend({defaultValue:null,fieldValueForObject:function(a,b,c){switch(SC.typeOf(a)){case SC.T_NUMBER:a=a.toFixed(0);break;case SC.T_NULL:case SC.T_UNDEFINED:a=this.get("defaultValue");break}return a},objectForFieldValue:function(b,a,c){b=b.replace(/,/g,"");switch(SC.typeOf(b)){case SC.T_STRING:if(b.length===0){b=this.get("defaultValue")}else{b=parseInt(b,0)}break;case SC.T_NULL:case SC.T_UNDEFINED:b=this.get("defaultValue");break}if(isNaN(b)){return this.get("defaultValue")}return b},validate:function(a,c){var b=c.get("fieldValue");return(b==="")||!isNaN(b)},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(b,c,a){var d=c.$input().val();if(!d){d=""}d+=a;if(a.length===0){return true}else{return d.match(/^[0-9\0]*/)[0]===d}}});SC.ContainerView=SC.View.extend({classNames:["sc-container-view"],renderDelegateName:"containerRenderDelegate",nowShowing:null,contentView:null,contentViewBindingDefault:SC.Binding.single(),replaceContent:function(a){this.removeAllChildren();if(a){this.appendChild(a)}},createChildViews:function(){var a=this.get("contentView");if(a){a=this.contentView=this.createChildView(a);this.childViews=[a]}},awake:function(){arguments.callee.base.apply(this,arguments);var a=this.get("nowShowing");if(a&&a.length>0){this.nowShowingDidChange()}},nowShowingDidChange:function(){var c=this.get("nowShowing");if(c===SC.CONTENT_SET_DIRECTLY){return}var a=(this._instantiatedLastView===YES)?this.get("contentView"):null;this._instantiatedLastView=NO;if(SC.typeOf(c)===SC.T_STRING&&c.length>0){if(c.indexOf(".")>0){c=SC.objectForPropertyPath(c)}else{var b=this.getPath(c);c=SC.kindOf(b,SC.CoreView)?b:SC.objectForPropertyPath(c,this.get("page"))}}if(SC.typeOf(c)===SC.T_CLASS){if(c.kindOf(SC.CoreView)){c=this.createChildView(c);this._instantiatedLastView=YES}else{c=null}}if(c&&!(c instanceof SC.CoreView)){c=null}this.set("contentView",c);if(a){a.destroy()}}.observes("nowShowing"),contentViewDidChange:function(){this.replaceContent(this.get("contentView"))}.observes("contentView")});sc_require("mixins/validatable");SC.FieldView=SC.View.extend(SC.Control,SC.Validatable,{fieldValue:function(){var a=this.get("value");if(SC.typeOf(a)===SC.T_ERROR){a=a.get("errorValue")}return this.fieldValueForObject(a)}.property("value","validator").cacheable(),$input:function(){var a=this._inputElementTagName();return this.$(a).andSelf().filter(a)},_inputElementTagName:function(){return"input"},setFieldValue:function(b){if(SC.none(b)){b=""}var a=this.$input();if(a.val()!==b){a.val(b)}return this},getFieldValue:function(){return this.$input().val()},_field_fieldValueDidChange:function(a){SC.run(function(){this.fieldValueDidChange(NO)},this)},fieldValueDidChange:function(a){var c=this.getFieldValue();var b=this.objectForFieldValue(c,a);this.setIfChanged("value",b)},_field_valueDidChange:function(){this.setFieldValue(this.get("fieldValue"))}.observes("fieldValue"),didCreateLayer:function(){this.setFieldValue(this.get("fieldValue"));this._addChangeEvent()},willDestroyLayer:function(){SC.Event.remove(this.$input(),"change",this,this._field_fieldValueDidChange)},mouseDown:function(a){this._field_isMouseDown=YES;a.allowDefault();return YES},mouseExited:function(a){if(this._field_isMouseDown){this.set("isActive",NO)}a.allowDefault();return YES},mouseEntered:function(a){this.set("isActive",this._field_isMouseDown);a.allowDefault();return YES},mouseUp:function(a){if(this._field_isMouseDown){this.set("isActive",NO)}this._field_isMouseDown=NO;a.allowDefault();return YES},keyDown:function(b){if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(this.performValidateKeyDown(b)){this._isKeyDown=YES;b.allowDefault()}else{b.stop()}return YES},acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),_addChangeEvent:function(){SC.Event.add(this.$input(),"change",this,this._field_fieldValueDidChange)},_field_setFieldValue:function(b){this.propertyWillChange("fieldValue");if(this.fieldValueForObject){b=this.fieldValueForObject(b)}var a=this.setFieldValue(b);this.propertyDidChange("fieldValue");return a},_field_getFieldValue:function(){var a=this.getFieldValue();if(this.objectForFieldValue){a=this.objectForFieldValue(a)}return a}});SC.IMAGE_STATE_NONE="none";SC.IMAGE_STATE_LOADING="loading";SC.IMAGE_STATE_LOADED="loaded";SC.IMAGE_STATE_FAILED="failed";SC.IMAGE_TYPE_NONE="NONE";SC.IMAGE_TYPE_URL="URL";SC.IMAGE_TYPE_CSS_CLASS="CSS_CLASS";SC.BLANK_IMAGE_DATAURL="data:image/gif;base64,R0lGODlhAQABAJAAAP///wAAACH5BAUQAAAALAAAAAABAAEAAAICBAEAOw==";SC.BLANK_IMAGE_URL=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"8")<0?"/static/sproutcore/foundation/en/4fc00c271b9b4e4c502760f552e94ea580ecdf73/source/resources/blank.gif":SC.BLANK_IMAGE_DATAURL;SC.BLANK_IMAGE=new Image();SC.BLANK_IMAGE.src=SC.BLANK_IMAGE_URL;SC.BLANK_IMAGE.width=SC.BLANK_IMAGE.height=1;SC.ImageView=SC.View.extend(SC.Control,SC.InnerFrame,{classNames:"sc-image-view",displayProperties:["frame","image","innerFrame","toolTip","imageValue","type"],renderDelegateName:function(){return(this.get("useCanvas")?"canvasImage":"image")+"RenderDelegate"}.property("useCanvas").cacheable(),tagName:function(){return this.get("useCanvas")?"canvas":"div"}.property("useCanvas").cacheable(),canLoadInBackground:NO,image:SC.BLANK_IMAGE,imageValue:function(){var a=this.get("value");return a&&a.isEnumerable?a.firstObject():a}.property("value").cacheable(),innerFrame:function(){var c=this.get("image"),b=c.width,a=c.height,d=this.get("frame");if(SC.none(d)){return{x:0,y:0,width:0,height:0}}return this.innerFrameForSize(b,a,d.width,d.height)}.property("align","image","scale","frame").cacheable(),localize:YES,status:SC.IMAGE_STATE_NONE,type:function(){var a=this.get("imageValue");if(SC.ImageView.valueIsUrl(a)){return SC.IMAGE_TYPE_URL}else{if(!SC.none(a)){return SC.IMAGE_TYPE_CSS_CLASS}}return SC.IMAGE_TYPE_NONE}.property("imageValue").cacheable(),useCanvas:function(){return SC.platform.supportsCanvas&&!this.get("useStaticLayout")&&this.get("type")!==SC.IMAGE_TYPE_CSS_CLASS}.property("useStaticLayout","type").cacheable(),useImageQueue:YES,value:null,viewDidResize:function(){var b=this.get("layer"),c,a;if(b){c=b.offsetWidth;a=b.offsetHeight;if(this._cachedWidth!==c||this._cachedHeight!==a){this.notifyPropertyChange("frame");this._cachedWidth=c;this._cachedHeight=a}}},init:function(){arguments.callee.base.apply(this,arguments);this._image_valueDidChange();if(this.get("useImageCache")!==undefined){SC.Logger.warn("%@ has useImageCache set, please set useImageQueue instead".fmt(this));this.set("useImageQueue",this.get("useImageCache"))}},layerDidChange:function(){if(this.get("useCanvas")){this.set("layerNeedsUpdate",YES)}}.observes("layer"),_image_valueDidChange:function(){var b=this.get("imageValue"),a=this.get("type");if(b!==this._iv_value){this._iv_value=b;this.set("image",SC.BLANK_IMAGE);if(a!==SC.IMAGE_TYPE_CSS_CLASS){this.set("status",SC.IMAGE_STATE_LOADING);if(!this._loadImageUsingCache()){this._loadImage()}}}}.observes("imageValue"),_loadImageUsingCache:function(){var c=this.get("imageValue"),b=this.get("type");if(b===SC.IMAGE_TYPE_URL&&this.get("useImageQueue")){var a=this.get("isVisibleInWindow")||this.get("canLoadInBackground");SC.imageQueue.loadImage(c,this,this._loadImageUsingCacheDidComplete,a);return YES}return NO},_loadImageUsingCacheDidComplete:function(a,c){var b=this.get("imageValue");if(b===a){if(SC.ok(c)){this.didLoad(c)}else{this.didError(c)}}},_loadImage:function(){var d=this.get("imageValue"),b=this.get("type"),c=this,g,a;if(b===SC.IMAGE_TYPE_URL){g=new Image();var f=function(){SC.run(function(){c._loadImageDidComplete(d,SC.$error("SC.Image.FailedError","Image",-101))})};var h=function(){SC.run(function(){c._loadImageDidComplete(d,g)})};a=$(g);a.bind("error",f);a.bind("abort",f);a.bind("load",h);g.src=d;return YES}return NO},_loadImageDidComplete:function(a,c){var b=this.get("imageValue");if(b===a){if(SC.ok(c)){this.didLoad(c)}else{this.didError(c)}}},didLoad:function(a){this.set("status",SC.IMAGE_STATE_LOADED);if(!a){a=SC.BLANK_IMAGE}this.set("image",a)},didError:function(a){this.set("status",SC.IMAGE_STATE_FAILED);this.set("image",SC.BLANK_IMAGE)}});SC.ImageView.valueIsUrl=function(a){return a&&SC.typeOf(a)===SC.T_STRING?a.indexOf("/")>=0:NO};sc_require("views/field");sc_require("system/text_selection");sc_require("mixins/static_layout");sc_require("mixins/editable");SC.TextFieldView=SC.FieldView.extend(SC.StaticLayout,SC.Editable,{classNames:["sc-text-field-view"],isTextField:YES,applyImmediately:YES,commitOnBlur:YES,isPassword:NO,isTextArea:NO,hint:"",type:"text",isBrowserFocusable:YES,autoCorrect:true,autoCapitalize:true,formattedHint:function(){var a=this.get("hint");return typeof(a)==="string"&&this.get("localize")?SC.String.loc(a):a}.property("hint","localize").cacheable(),hintOnFocus:YES,localize:YES,isEditing:NO,defaultTabbingEnabled:YES,isContextMenuEnabled:YES,continuouslyUpdatesValue:null,allowsErrorAsValue:YES,leftAccessoryView:null,rightAccessoryView:null,spellCheckEnabled:YES,maxLength:5096,shouldRenderBorder:YES,supportsAutoResize:YES,autoResizeLayer:function(){return this.$input()[0]}.property("layer").cacheable(),autoResizeText:function(){return this.get("value")}.property("value").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",20),_hintON:YES,init:function(){var a=this.get("value");this._hintON=((!a||a&&a.length===0)&&!this.get("hintOnFocus"))?YES:NO;var b=this.get("continouslyUpdatesValue");if(b!==null&&b!==undefined){this.set("applyImmediately",b)}return arguments.callee.base.apply(this,arguments)},isEditable:YES,selection:function(l,j){var d=this.$input()[0],f,a,c;if(j===undefined){if(d){a=null;c=null;if(!d.value){a=c=0}else{try{if("selectionStart" in d){a=d.selectionStart}if("selectionEnd" in d){c=d.selectionEnd}}catch(g){return null}if(a===null||c===null){var k=document.selection;if(k){var i=k.type;if(i&&(i==="None"||i==="Text")){f=k.createRange();if(!this.get("isTextArea")){var b=f.text.length;a=Math.abs(f.moveStart("character",0-(d.value.length+1)));c=a+b}else{var h=f.duplicate();h.moveToElementText(d);h.setEndPoint("EndToStart",f);a=h.text.length;c=a+f.text.length}}}}}return SC.TextSelection.create({start:a,end:c})}else{return null}}else{if(!j||!j.kindOf||!j.kindOf(SC.TextSelection)){throw"When setting the selection, you must specify an SC.TextSelection instance."}if(d){if(d.setSelectionRange){d.setSelectionRange(j.get("start"),j.get("end"))}else{f=d.createTextRange();a=j.get("start");f.move("character",a);f.moveEnd("character",j.get("end")-a);f.select()}}return j}}.property("fieldValue").cacheable(),displayProperties:["isBrowserFocusable","formattedHint","fieldValue","isEditing","isEditable","leftAccessoryView","rightAccessoryView","isTextArea"],createChildViews:function(){arguments.callee.base.apply(this,arguments);this.accessoryViewObserver()},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),accessoryViewObserver:function(){var g,j=["leftAccessoryView","rightAccessoryView"],a=j.length,b,f,d,h;for(b=0;b<a;b++){f=j[b];d=this["_"+f];h=this.get(f);if(!(d&&h&&(d===h))){if(d){g=d.get("classNames");g=g.without("sc-text-field-accessory-view");d.set("classNames",g);this.removeChild(d);d=null;this["_"+f]=null}if(h){if(h.isClass){h=h.create({layoutView:this})}g=h.get("classNames");var c="sc-text-field-accessory-view";if(g.indexOf(c)<0){g=SC.clone(g);g.push(c);h.set("classNames",g)}this.appendChild(h);this["_"+f]=h}}}}.observes("leftAccessoryView","rightAccessoryView"),layoutChildViewsIfNeeded:function(a){if(!a){a=this.get("isVisibleInWindow")}if(a&&this.get("childViewsNeedLayout")){var b=this.get("rightAccessoryView");if(b&&b.get){var c=b.get("layout");if(c){c.left=null;if(!c.right){c.right=0}b.adjust({layout:c})}}}arguments.callee.base.apply(this,arguments)},render:function(f,g){arguments.callee.base.apply(this,arguments);var a,d,c,b;a=this.get("fieldValue");if(SC.none(a)){a=""}a=String(a);f.setClass("not-empty",a.length>0);d=this._getAccessoryViewWidths();c=d.left;b=d.right;if(c){c+="px"}if(b){b+="px"}this._renderField(f,g,a,c,b)},_forceRenderFirstTime:NO,_renderFieldLikeFirstTime:function(){this.set("_forceRenderFirstTime",YES)}.observes("isTextArea"),_renderField:function(g,l,y,j,r){var t=this.get("formattedHint"),b=this.get("hintOnFocus"),o="",k=this.get("maxLength"),w=this.get("isTextArea"),D=this.get("isEnabled"),p=this.get("isEditable"),u=this.get("autoCorrect"),E=this.get("autoCapitalize"),m=this.get("isBrowserFocusable"),H="",f="",d="",G,z,h,C,c,n,i,a,x,v;g.setClass("text-area",w);a=SC.browser.isWebkit&&SC.browser.compare(SC.browser.engineVersion,"532")<0;g.setClass("oldWebKitFieldPadding",a);if(l||this._forceRenderFirstTime){this._forceRenderFirstTime=NO;x=D?(p?"":'readonly="readonly"'):'disabled="disabled"';G=this.get("layerId");H=this.get("spellCheckEnabled")?' spellcheck="true"':' spellcheck="false"';if(SC.browser.mobileSafari){d=!u?' autocorrect="off"':"";f=!E?' autocapitalize="off"':""}if(m){v='tabindex="-1"'}if(SC.platform.input.placeholder&&!b){o=' placeholder="'+t+'"'}if(this.get("shouldRenderBorder")){g.push('<div class="border"></div>')}z="";if(j||r){z='style="';if(j){z+="left: "+j+"; "}if(r){z+="right: "+r+";"}z+='"'}g.push('<div class="padding" '+z+">");y=this.get("escapeHTML")?SC.RenderContext.escapeHTML(y):y;if(this._hintON&&!SC.platform.input.placeholder&&(!y||(y&&y.length===0))){y=t;g.setClass("sc-hint",YES)}if(b){var A='<div aria-hidden="true" class="hint '+(w?"":"ellipsis")+'%@">'+t+"</div>";g.push(A.fmt(y?" sc-hidden":""))}i="field";if(w){g.push('<textarea aria-label="'+t+'" aria-multiline="true" class="'+i+'" name="'+G+'" '+x+o+H+d+v+f+' maxlength="'+k+'">'+y+"</textarea></div>")}else{h=this.get("type");if(this.get("isPassword")){h="password"}g.push('<input aria-label="'+t+'" class="'+i+'" type="'+h+'" name="'+G+'" '+x+' value="'+y+'"'+o+H+v+' maxlength="'+k+'" '+d+" "+f+"/></div>")}}else{var q=this.$input(),B=q[0],F=this.get("value");if(b){this.$(".hint")[0].innerHTML=t}else{if(!b){B.placeholder=t}}if(!F||(F&&F.length===0)){if(this.get("isPassword")){B.type="password"}if(!SC.platform.input.placeholder&&this._hintON){if(!this.get("isFirstResponder")){g.setClass("sc-hint",YES);q.val(t)}else{g.setClass("sc-hint",NO);q.val("")}}}if(SC.browser.mobileSafari){q.attr("autoCapitalize",!E?"off":"true");q.attr("autoCorrect",!u?"off":"true")}if(!b&&SC.platform.input.placeholder){q.attr("placeholder",t)}if(m){q.removeAttr("tabindex")}else{q.attr("tabindex","-1")}c=q[0];if(c){if(!D){c.disabled="true";c.readOnly=null}else{if(!p){c.disabled=null;c.readOnly="true"}else{c.disabled=null;c.readOnly=null}}n=c.parentNode.style;if(j){if(n.left!==j){n.left=j}}else{n.left=null}if(r){if(n.right!==r){n.right=r}}else{n.right=null}}}},_getAccessoryViewWidths:function(){var c={},l=["left","right"],d=l.length,g,h,m,k,a,j,f,b;for(g=0;g<d;g++){h=l[g];m=this.get(h+"AccessoryView");if(m){if(m.isClass){m=m.create({layoutView:this})}if(m.get){b=m.get("frame");if(b){a=b.width;if(a){j=m.get("layout");if(j){f=j[h];a+=f}c[h]=a}}}}}return c},didCreateLayer:function(){arguments.callee.base.apply(this,arguments);if(!SC.platform.input.placeholder){this.invokeLast(this._setInitialPlaceHolderIE)}if(this.get("isTextArea")){this.invokeLast(this._addTextAreaEvents)}else{this._addTextAreaEvents();if(SC.browser.isMozilla){var a=this.$input();SC.Event.add(a,"keypress",this,this._firefox_dispatch_keypress)}}},_setInitialPlaceHolderIE:function(){if(!SC.platform.input.placeholder&&this._hintON){var a=this.$input(),b=a.val();if(!b||(b&&b.length===0)){a.val(this.get("formattedHint"))}}},_addTextAreaEvents:function(){var a=this.$input();SC.Event.add(a,"focus",this,this._textField_fieldDidFocus);SC.Event.add(a,"blur",this,this._textField_fieldDidBlur);SC.Event.add(a,"select",this,this._textField_selectionDidChange)},willDestroyLayer:function(){arguments.callee.base.apply(this,arguments);var a=this.$input();SC.Event.remove(a,"focus",this,this._textField_fieldDidFocus);SC.Event.remove(a,"blur",this,this._textField_fieldDidBlur);SC.Event.remove(a,"select",this,this._textField_selectionDidChange);SC.Event.remove(a,"keypress",this,this._firefox_dispatch_keypress)},_textField_fieldDidFocus:function(a){SC.run(function(){this.set("focused",YES);this.fieldDidFocus(a);var b=this.get("value");if(!SC.platform.input.placeholder&&((!b)||(b&&b.length===0))){this._hintON=NO}},this)},_textField_fieldDidBlur:function(a){SC.run(function(){this.set("focused",NO);this.fieldDidBlur(this._origEvent||a);var b=this.get("value");if(!SC.platform.input.placeholder&&!this.get("hintOnFocus")&&((!b)||(b&&b.length===0))){this._hintON=YES}},this)},fieldDidFocus:function(a){this.becomeFirstResponder();this.beginEditing(a);if(this._didHideInterceptForPane){this._didHideInterceptForPane.showTouchIntercept();this._didHideInterceptForPane=null}var b=this.get("pane");if(b&&b.get("hasTouchIntercept")){b.hideTouchIntercept();this._didHideInterceptForPane=this.get("pane")}},fieldDidBlur:function(a){this.resignFirstResponder(a);if(this.get("commitOnBlur")){this.commitEditing(a)}var b=this._didHideInterceptForPane;if(b){b.showTouchIntercept();b=null}},_field_fieldValueDidChange:function(a){if(this.get("focused")){SC.run(function(){this.fieldValueDidChange(NO)},this)}this.updateHintOnFocus()},updateHintOnFocus:function(){var a=this.get("hintOnFocus");if(!a){return}if(this.getFieldValue()){this.$(".hint").addClass("sc-hidden")}else{this.$(".hint").removeClass("sc-hidden")}}.observes("value"),_topOffsetForFirefoxCursorFix:3,_firefox_dispatch_keypress:function(a){var d=this.get("selection"),f=this.get("value"),c=f?f.length:0,b;if(!d||((d.get("length")===0&&(d.get("start")===0)||d.get("end")===c))){b=SC.RootResponder.responder;if(a.keyCode===9){return}b.keypress.call(b,a);a.stopPropagation()}},_textField_selectionDidChange:function(){this.notifyPropertyChange("selection")},didBecomeKeyResponderFrom:function(a){if(this.get("isVisibleInWindow")){var b=this.$input()[0];try{if(b){b.focus()}}catch(c){}if(!this._txtFieldMouseDown){this.invokeLast(this._selectRootElement)}}},_selectRootElement:function(){var b=this.$input()[0],a;if(b){a=SC.browser.os===SC.OS.mac&&SC.browser.compare(SC.browser.osVersion,"10.7")===0;if(!(SC.browser.name===SC.BROWSER.safari&&a&&SC.buildLocale==="ko-kr")){b.select()}}else{this._textField_selectionDidChange()}},didLoseKeyResponderTo:function(a){var b=this.$input()[0];if(b){b.blur()}this.invokeLater("scrollToOriginIfNeeded",100)},scrollToOriginIfNeeded:function(){var b=this.get("pane");if(!b){return}var a=b.get("firstResponder");if(!a||!a.get("isTextField")){document.body.scrollTop=document.body.scrollLeft=0}},keyDown:function(b){var i=b.which,g=b.keyCode,d=false,f,a;if((i===SC.Event.KEY_RETURN&&!b.isIMEInput)&&!this.get("isTextArea")){return NO}if(i===SC.Event.KEY_ESC){return NO}if((i===SC.Event.KEY_TAB||g===SC.Event.KEY_TAB)&&this.get("defaultTabbingEnabled")){a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(!SC.platform.input.maxlength&&this.get("isTextArea")){var h=this.get("value");if(h&&((!SC.browser.isMozilla&&i>47)||(SC.browser.isMozilla&&((i>32&&i<43)||i>47)&&!(g>36&&g<41)))&&(h.length>=this.get("maxLength"))){d=true}}if((this.performValidateKeyDown(b)||SC.platform.touch)&&!d){this._isKeyDown=YES;b.allowDefault()}else{b.stop()}if(this.get("applyImmediately")){var c=this;setTimeout(function(){c.fieldValueDidChange()},10)}return YES},keyUp:function(a){if(SC.browser.isMozilla&&a.keyCode===SC.Event.KEY_RETURN){this.fieldValueDidChange()}this.notifyPropertyChange("selection");this._isKeyDown=NO;a.allowDefault();return YES},mouseDown:function(a){var b=this.get("fieldValue");this._txtFieldMouseDown=YES;this.becomeFirstResponder();if(!this.get("isEnabled")){a.stop();return YES}else{return arguments.callee.base.apply(this,arguments)}},mouseUp:function(a){this._txtFieldMouseDown=NO;this.notifyPropertyChange("selection");if(!this.get("isEnabled")){a.stop();return YES}return arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},mouseWheel:function(a){if(this.get("isTextArea")){a.allowDefault();return YES}else{return NO}},selectStart:function(a){return YES},_inputElementTagName:function(){if(this.get("isTextArea")){return"textarea"}else{return"input"}},_valueObserver:function(){var b=this.get("value"),a;if(b&&b.length>0){this._hintON=NO;a=this.get("maxLength");if(!SC.platform.input.maxlength&&b.length>a){this.set("value",b.substr(0,a))}}else{if(!this.get("hintOnFocus")){this._hintON=YES}}}.observes("value")});sc_require("views/text_field");sc_require("system/utils/misc");sc_require("delegates/inline_text_field");sc_require("mixins/inline_editor");SC.InlineTextFieldView=SC.TextFieldView.extend(SC.InlineEditor,{classNames:["inline-editor"],_topOffsetForFirefoxCursorFix:0,blurOnMouseDown:YES,_updateViewStyle:function(b){var c="",a=SC.getStyle(b,"font-size");if(a&&a.length>0){c=c+"font-size: "+a+" !important; "}a=SC.getStyle(b,"font-family");if(a&&a.length>0){c=c+"font-family: "+a+" !important; "}a=SC.getStyle(b,"font-weight");if(a&&a.length>0){c=c+"font-weight: "+a+" !important; "}a=SC.getStyle(b,"z-index");if(a&&a.length>0){c=c+"z-index: "+a+" !important; "}a=SC.getStyle(b,"line-height");if(a&&a.length>0){c=c+"line-height: "+a+" !important; "}a=SC.getStyle(b,"text-align");if(a&&a.length>0){c=c+"text-align: "+a+" !important; "}a=SC.getStyle(b,"top-margin");if(a&&a.length>0){c=c+"top-margin: "+a+" !important; "}a=SC.getStyle(b,"bottom-margin");if(a&&a.length>0){c=c+"bottom-margin: "+a+" !important; "}a=SC.getStyle(b,"left-margin");if(a&&a.length>0){c=c+"left-margin: "+a+" !important; "}a=SC.getStyle(b,"right-margin");if(a&&a.length>0){c=c+"right-margin: "+a+" !important; "}return c},_updateViewPaddingStyle:function(b){var c="",a=SC.getStyle(b,"padding-top");if(a&&a.length>0){c=c+"top: "+a+" !important; "}a=SC.getStyle(b,"padding-bottom");if(a&&a.length>0){c=c+"bottom: "+a+" !important; "}a=SC.getStyle(b,"padding-left");if(a&&a.length>0){c=c+"left: "+a+" !important; "}a=SC.getStyle(b,"padding-right");if(a&&a.length>0){c=c+"right: "+a+" !important; "}return c},updateStyle:function(d){if(d.length){d=d[0]}var a=document.getElementById("sc-inline-text-field-style"),c=this._updateViewStyle(d),f=this._updateViewPaddingStyle(d),g=".inline-editor input{"+c+"}.inline-editor textarea{"+c+"}.inline-editor .padding{"+f+"}";if(!a){var b=document.getElementsByTagName("head")[0];a=document.createElement("style");a.type="text/css";a.media="screen";a.id="sc-inline-text-field-style";b.appendChild(a)}if(a.styleSheet){a.styleSheet.cssText=g}else{a.innerHTML=g}},positionOverTargetView:function(k,d,c,b,f){var h;if(!c){c=k.get("pane")}if(!f){f=k.$()[0]}if(!b){var i=k.get("frame");b=SC.offset(f);b.height=i.height;b.width=i.width}var j={},a=c.$()[0],g=k.get("layout");j.height=b.height;j.width=b.width;h=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(d&&g.left){j.left=b.x-g.left-a.offsetLeft-1;if(h){j.left--}}else{j.left=b.x-a.offsetLeft-1;if(h){j.left--}}if(d&&g.top){j.top=b.y-g.top-a.offsetTop;if(h){j.top=j.top-2}}else{j.top=b.y-a.offsetTop;if(h){j.top=j.top-2}}this.set("layout",j)},multiline:NO,isTextArea:function(){return this.get("multiline")}.property("multiline").cacheable(),beginEditing:function(b,a){if(!b(a)){return NO}var d=a.get("pane"),c=this.get("exampleElement");this.beginPropertyChanges();if(c){if(c.length){c=c[0]}}else{c=a.$()[0]}this.updateStyle(c);this.positionOverTargetView(a,this.get("isCollection"),d,this.get("exampleFrame"),c);this._previousFirstResponder=d?d.get("firstResponder"):null;this.becomeFirstResponder();this.endPropertyChanges();return YES}.enhance(),blurEditor:function(a){if(!this.get("isEditing")){return YES}return this.commitOnBlur?this.commitEditing():this.discardEditing()},_endEditing:function(b){var a=b();if(this.get("isFirstResponder")){var c=this.get("pane");if(c&&this._previousFirstResponder){c.makeFirstResponder(this._previousFirstResponder)}else{this.resignFirstResponder()}}this._previousFirstResponder=null;return a}.enhance(),mouseDown:function(a){arguments.callee.base.call(this,a);return this.get("isEditing")},touchStart:function(a){this.mouseDown(a)},keyDown:function(a){var b=this.interpretKeyEvents(a);this.fieldValueDidChange(true);return !b?NO:b},insertText:null,_scitf_blurInput:function(){var a=this.$input()[0];if(a){a.blur()}a=null},willRemoveFromParent:function(){return this._scitf_blurInput()},willLoseFirstResponder:function(b,a){if(b!==this){return}this._previousFirstResponder=null;this._origEvent=a;this._scitf_blurInput();return this.blurEditor(a)},cancel:function(){this.discardEditing();return YES},fieldValueDidChange:function(a){arguments.callee.base.call(this,a)},insertNewline:function(a){if(this.get("isTextArea")){a.allowDefault();return arguments.callee.base.call(this,a)}else{if(this.get("value")!=this.$input().val()){this.set("value",this.$input().val())}this.commitEditing();return YES}},insertTab:function(a){var c=this.target;this.resignFirstResponder();this.commitEditing();if(c){var b=c.get("nextValidKeyView");if(b&&b.beginEditing){b.beginEditing()}}return YES},insertBacktab:function(a){var c=this.target;this.resignFirstResponder();this.commitEditing();if(c){var b=c.get("previousValidKeyView");if(b&&b.beginEditing){b.beginEditing()}}return YES},deleteForward:function(a){a.allowDefault();return YES},deleteBackward:function(a){a.allowDefault();return YES}});SC.mixin(SC.InlineTextFieldView,{inlineEditorDelegate:SC.InlineTextFieldDelegate,label:null,editor:null,beginEditing:function(c){var a,d,b,f,g;if(SC.typeOf(c)===SC.T_HASH){b=c;if(!b.delegate||!b.exampleElement||!b.frame){SC.error("Delegate, exampleElement, and frame options are required.");return NO}c=b.delegate;f=b.value}else{f=c.get("value")}g=SC.beget(c);g.mixin({inlineEditorWillBeginEditing:function(){if(c.inlineEditorWillBeginEditing){c.inlineEditorWillBeginEditing.apply(c,arguments)}},inlineEditorDidBeginEditing:function(){if(c.inlineEditorDidBeginEditing){c.inlineEditorDidBeginEditing.apply(c,arguments)}},inlineEditorWillCommitEditing:function(i,j,h){if(c.inlineEditorWillCommitEditing){c.inlineEditorWillCommitEditing(i,j,h)}if(c.inlineEditorWillEndEditing){c.inlineEditorWillEndEditing(i,j)}},inlineEditorDidCommitEditing:function(i,j,h){if(c.inlineEditorDidCommitEditing){c.inlineEditorDidCommitEditing(i,j,h)}if(c.inlineEditorDidEndEditing){c.inlineEditorDidEndEditing(i,j)}SC.InlineTextFieldView._endEditing()},inlineEditorWillDiscardEditing:function(i,h){if(c.inlineEditorWillDiscardEditing){c.inlineEditorWillDiscardEditing(i,h)}if(c.inlineEditorWillEndEditing){c.inlineEditorWillEndEditing(i,this.get("value"))}},inlineEditorDidDiscardEditing:function(i,h){if(c.inlineEditorDidDiscardEditing){c.inlineEditorDidDiscardEditing(i,h)}if(c.inlineEditorDidEndEditing){c.inlineEditorDidEndEditing(i,this.get("value"))}SC.InlineTextFieldView._endEditing()}});if(c.inlineEditorShouldBeginEditing&&!c.inlineEditorShouldBeginEditing(c,f)){return NO}this.editor=d=this.inlineEditorDelegate.acquireEditor(c);d.set("value",f);if(b){d.set("exampleElement",b.exampleElement);d.set("exampleFrame",b.frame);d.set("multiline",b.multiline);d.set("escapeHTML",b.escapeHTML);d.set("isCollection",b.isCollection);d.set("commitOnBLur",b.commitOnBlur);d.set("validator",b.validator)}if(d){return d.beginEditing(g)}else{return NO}},commitEditing:function(){return this.inlineEditorDelegate.editor?this.inlineEditorDelegate.editor.commitEditing():NO},discardEditing:function(){return this.inlineEditorDelegate.editor?this.inlineEditorDelegate.editor.discardEditing():NO},_endEditing:function(){this.inlineEditorDelegate.releaseEditor(this.editor);this.editor=null}});sc_require("mixins/inline_editable");sc_require("mixins/inline_editor_delegate");sc_require("delegates/inline_text_field");SC.REGULAR_WEIGHT="normal";SC.BOLD_WEIGHT="bold";SC.LabelView=SC.View.extend(SC.Control,SC.InlineEditable,{classNames:["sc-label-view"],displayProperties:["displayTitle","textAlign","fontWeight","icon","escapeHTML","needsEllipsis","hint","toolTip"],inlineEditorDelegate:SC.InlineTextFieldDelegate,isEditable:NO,exampleEditor:SC.InlineTextFieldView,fontWeight:null,escapeHTML:YES,escapeHTMLBindingDefault:SC.Binding.oneWay().bool(),localize:NO,localizeBindingDefault:SC.Binding.oneWay().bool(),formatter:null,value:"",hint:null,hintEnabled:function(){return this.get("isEditable")}.property("isEditable").cacheable(),icon:null,textAlign:null,supportsAutoResize:YES,autoResizeLayer:function(){return this.get("layer")}.property("layer").cacheable(),autoResizeText:function(){return this.get("displayTitle")}.property("displayTitle").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",10),renderDelegateName:"labelRenderDelegate",displayTitle:function(){var h,f;h=this.get("value");f=this.getDelegateProperty("formatter",this.displayDelegate);if(f){var g=(SC.typeOf(f)===SC.T_FUNCTION)?f(h,this):f.fieldValueForObject(h,this);if(!SC.none(g)){h=g}}if(SC.typeOf(h)===SC.T_ARRAY){var d=[];for(var b=0,c=h.get("length");b<c;b++){var a=h.objectAt(b);if(!SC.none(a)&&a.toString){a=a.toString()}d.push(a)}h=d.join(",")}if(!SC.none(h)&&h.toString){h=h.toString()}if(h&&this.getDelegateProperty("localize",this.displayDelegate)){h=SC.String.loc(h)}return h}.property("value","localize","formatter").cacheable(),hintValue:function(){var a=this.get("hint");return a}.property("hint").cacheable(),doubleClick:function(a){return this.beginEditing()},inlineEditorDidBeginEditing:function(b,c,d,a){this._oldOpacity=this.get("layout").opacity||1;this.adjust("opacity",0);b(c,d,a)}.enhance(),inlineEditorDidEndEditing:function(){this.adjust("opacity",this._oldOpacity);this._oldOpacity=null}});SC.allowsBackspaceToPreviousPage=NO;SC.HORIZONTAL_ORIENTATION="horizontal";SC.VERTICAL_ORIENTATION="vertical";SC.BORDER_BEZEL="sc-bezel-border";SC.BORDER_BLACK="sc-black-border";SC.BORDER_GRAY="sc-gray-border";SC.BORDER_TOP="sc-top-border";SC.BORDER_BOTTOM="sc-bottom-border";SC.BORDER_NONE=null;SC.Border={borderTop:0,borderRight:0,borderBottom:0,borderLeft:0,borderStyle:SC.BORDER_GRAY,hasBorder:YES,displayProperties:["borderStyle"],_BORDER_REGEXP:(/-border$/),initMixin:function(){console.warn("SC.Border is deprecated, please set border in your layout");this._sc_border_borderStyleDidChange();this._sc_border_borderDimensionsDidChange()},renderMixin:function(a,c){var b=this.get("borderStyle");if(b){if(this._BORDER_REGEXP.exec(b)){a.addClass(b)}else{a.addStyle("border","1px "+b+" solid")}}},_sc_border_borderStyleDidChange:function(){var a=this.get("borderStyle"),b=SC.Border.dimensions[a];if(b){this.beginPropertyChanges();this.set("borderTop",b);this.set("borderRight",b);this.set("borderBottom",b);this.set("borderLeft",b);this.endPropertyChanges()}},_sc_border_borderDimensionsDidChange:function(){var d=this.get("borderTop"),a=this.get("borderRight"),b=this.get("borderBottom"),c=this.get("borderLeft");this.adjust({borderTop:d,borderRight:a,borderBottom:b,borderLeft:c})}.observes("borderTop","borderRight","borderBottom","borderLeft")};SC.mixin(SC.Border,{dimensions:{"sc-bezel-border":1,"sc-black-border":1,"sc-gray-border":1,"sc-top-border":1,"sc-bottom-border":1}});SC.CollectionFastPath={initMixin:function(){this._indexMap={}},poolForExampleView:function(a){var b="_pool_"+SC.guidFor(a);if(!this[b]){this[b]=[]}return this[b]},createItemViewFromExampleView:function(c,b){var a=this.createItemView(c,null,b);if(a.isPoolable){a.owningPool=this.poolForExampleView(c)}a.createdFromExampleView=c;return a},configureItemView:function(b,a){b.beginPropertyChanges();b.setIfChanged("content",a.content);b.setIfChanged("contentIndex",a.contentIndex);b.setIfChanged("parentView",a.parentView);b.setIfChanged("layerId",a.layerId);b.setIfChanged("isEnabled",a.isEnabled);b.setIfChanged("isSelected",a.isSelected);b.setIfChanged("outlineLevel",a.outlineLevel);b.setIfChanged("layout",a.layout);b.setIfChanged("disclosureState",a.disclosureState);b.setIfChanged("isVisibleInWindow",a.isVisibleInWindow);b.setIfChanged("isGroupView",a.isGroupView);b.setIfChanged("page",this.page);b.endPropertyChanges()},wakePooledView:function(b,a){this.configureItemView(b,a);if(b.awakeFromPool){b.awakeFromPool(b.owningPool,this)}},allocateItemView:function(d,b){var a;if(d.prototype.isPoolable){var c=this.poolForExampleView(d);if(c.length>0){a=c.pop();this.wakePooledView(a,b)}}if(!a){a=this.createItemViewFromExampleView(d,b)}return a},releaseItemView:function(b){if(!b.isPoolable){b.destroy();return}var a=b.owningPool;a.push(b);if(b.hibernateInPool){b.hibernateInPool(a,this)}},contentIndexIsGroup:function(a,d,c){var f=this.get("contentDelegate");var b=this.get("_contentGroupIndexes"),g=NO;g=b&&b.contains(c);if(g){g=f.contentIndexIsGroup(this,this.get("content"),c)}return g},exampleViewForItem:function(g,d){var b=this.get("contentDelegate"),c=this.get("_contentGroupIndexes"),f,a,h=this.contentIndexIsGroup(this,this.get("content"),d);if(h){f=this.get("contentGroupExampleViewKey");if(f&&g){a=g.get(f)}if(!a){a=this.get("groupExampleView")||this.get("exampleView")}}else{f=this.get("contentExampleViewKey");if(f&&g){a=g.get(f)}if(!a){a=this.get("exampleView")}}return a},setAttributesForItem:function(g,d,c){var b=this.get("contentDelegate"),h=this.contentIndexIsGroup(this,this.get("content"),d),a=this.exampleViewForItem(g,d),f=this.get("content");c.createdFromExampleView=a;c.parentView=this.get("containerView")||this;c.contentIndex=d;c.owner=c.displayDelegate=this;c.content=g;c.page=this.page;c.layerId=this.layerIdFor(d);c.isEnabled=b.contentIndexIsEnabled(this,f,d);c.isSelected=b.contentIndexIsSelected(this,f,d);c.outlineLevel=b.contentIndexOutlineLevel(this,f,d);c.disclosureState=b.contentIndexDisclosureState(this,f,d);c.isVisibleInWindow=this.get("isVisibleInWindow");c.isGroupView=h;c.layout=this.layoutForContentIndex(d);if(!c.layout){c.layout=a.prototype.layout}},mappedViewsForItem:function(a,b){if(!b){b=this._viewMap}return b[SC.guidFor(a)]},mappedViewForItem:function(c,b,d){if(!d){d=this._viewMap}var a=d[SC.guidFor(c)];if(!a){return undefined}return a[b]},mapView:function(f,c,b,h){if(!h){h=this._viewMap}var d=SC.guidFor(f),a=h[d];if(!a){a=h[d]={_length:0}}a[c]=b;a._length++},unmapView:function(f,c,h){if(!h){h=this._viewMap}var d=SC.guidFor(f),a=h[d];if(!a){return}if(a[c]){var b=a[c];delete a[c];a._length--;if(a._length<=0){delete h[d]}}},itemViewForContentIndex:function(b){var d=this.get("content");if(!d){return}var c=d.objectAt(b);if(!c){return null}var f=this.exampleViewForItem(c,b),a=this._indexMap[b];if(a&&a.createdFromExampleView!==f){this.removeItemView(a);this.unmapView(c,b);a=null}if(!a){a=this.addItemView(f,c,b)}return a},nearestMappedViewIndexForItem:function(f,c,g){var b=this.mappedViewsForItem(f,g);if(!b){return null}var d=null,i=-1,h=0;for(var a in b){a=parseInt(a,10);if(isNaN(a)){continue}h=Math.abs(c-a);if(i<0||h<i){i=h;d=a}}return d},remapItemViews:function(b){var k=this._viewMap||{},a=(this._viewMap={}),j=(this._indexMap={}),l=[],i=this.get("content"),o;if(!i){return}var g=this._itemsToAdd;b.forEach(function(p){o=i.objectAt(p);var r=this.mappedViewsForItem(o,k);if(r){if(r[p]){var q=r[p];this.unmapView(o,p,k);this.mapView(o,p,q,a);j[p]=q}else{l.push(p)}}else{g.push(p)}},this);for(var n=0,h=l.length;n<h;n++){var m=l[n];o=i.objectAt(m);var f=this.nearestMappedViewIndexForItem(o,m,k),c;if(!SC.none(f)){c=this.mappedViewForItem(o,f,k);var d=this.exampleViewForItem(o,m);if(d===c.createdFromExampleView){this.unmapView(o,f,k);this.mapView(o,m,c,a);j[m]=c}else{g.push(m)}}else{g.push(m)}}return k},reloadIfNeeded:function(g,b){var d=this.get("content"),f;if(!g||!g.isIndexSet){g=this.get("nowShowing")}if(!b){f=this._invalidIndexes;if(!f||!this.get("isVisibleInWindow")){return this}this._invalidIndexes=NO;if(f.isIndexSet&&f.contains(g)){f=YES}if(this.willReload){this.willReload(f===YES?null:f)}}var h=this._itemsToAdd||(this._itemsToAdd=[]);var a=this.remapItemViews(g);this.processRemovals(a);if(f){this.processUpdates(f===YES?g:f)}this.processAdds();if(!b){this.clearDOMPools()}h.length=0;if(!b){var c=this.computeLayout();if(c){this.adjust(c)}if(this.didReload){this.didReload(f===YES?null:f)}}return this},processRemovals:function(c){var g=this.get("content");for(var d in c){var b=c[d];for(var f in b){f=parseInt(f,10);if(isNaN(f)){continue}var a=b[f];if(this._indexMap[f]===a){delete this._indexMap[f]}a._isInCollection=NO;this.removeItemView(a)}}},processUpdates:function(f){var b=this._itemsToUpdate,d=this.get("content"),c,a;f.forEach(function(g){c=d.objectAt(g);if(a=this.mappedViewForItem(c,g)){if(!a._isInCollection){return}var h=this.exampleViewForItem(c,g);this.updateItemView(a,h,c,g)}},this)},processAdds:function(){var g=this.get("content");var h=this._itemsToAdd,b,a=h.length,f,d;for(b=0;b<a;b++){f=h[b];d=g.objectAt(f);var i=this.exampleViewForItem(d,f);var c=this.addItemView(i,d,f)}},clearDOMPools:function(){var a=this._domPools||(this._domPools={});for(var b in a){this.clearDOMPool(a[b])}},domPoolSize:10,clearDOMPool:function(c){var b,a=c.length,d;for(b=this.domPoolSize;b<a;b++){d=c[b];this.removeChild(d);this.releaseItemView(d)}c.length=Math.min(c.length,this.domPoolSize)},domPoolForExampleView:function(d){var c=this._domPools||(this._domPools={}),a=SC.guidFor(d);var b=c[a];if(!b){b=c[a]=[]}return b},itemFromDOMPool:function(c){var b=this.domPoolForExampleView(c);if(b.length<1){return null}var a=b.shift();if(a.wakeFromDOMPool){a.wakeFromDOMPool()}return a},sendToDOMPool:function(a){var b=this.domPoolForExampleView(a.createdFromExampleView);b.push(a);var c=a.get("frame");a.adjust({top:-c.height});a.set("layerId",SC.guidFor(a));if(a.sleepInDOMPool){a.sleepInDOMPool()}},addItemView:function(f,d,c){var a,b=this._TMP_ATTRS||(this._TMP_ATTRS={});this.setAttributesForItem(d,c,b);if(a=this.itemFromDOMPool(f)){this.configureItemView(a,b);a._isInCollection=YES;this.mapView(d,c,a);this._indexMap[c]=a;return a}a=this.allocateItemView(f,b);this.appendChild(a);a._isInCollection=YES;this.mapView(d,c,a);this._indexMap[c]=a;return a},removeItemView:function(a){if(a.get("layerIsCacheable")){this.sendToDOMPool(a)}else{this.removeChild(a)}a._isInCollection=NO},updateItemView:function(d,f,c,b){if(!d.get("layerIsCacheable")||d.createdFromExampleView!==f){this.unmapView(d,b);delete this._indexMap[b];this.removeItemView(d,c,b);var g=this.addItemView(f,c,b)}else{var a=this._TMP_ATTRS||(this._TMP_ATTRS={});this.setAttributesForItem(c,b,a);this.configureItemView(d,a)}},_lastTopUpdate:0,_lastLeftUpdate:0,_tolerance:100,touchScrollDidChange:function(h,g){if(Date.now()-this._lastTouchScrollTime<25){return}var i=this.get("clippingFrame");var f=this._inScrollClippingFrame||(this._inScrollClippingFrame={x:0,y:0,width:0,height:0});f.x=i.x;f.y=i.y;f.width=i.width;f.height=i.height;f.x=h;f.y=g;var d=this.contentIndexesInRect(f);if(!d){return}var b=this.get("length"),a=d.get("max"),c=d.get("min");if(a>b||c<0){d=d.copy();d.remove(b,a-b).remove(c,0-c).freeze()}if(this._lastNowShowing){if(d.contains(this._lastNowShowing)&&this._lastNowShowing.contains(d)){return}}this._lastNowShowing=d;this.reloadIfNeeded(d,YES);this._lastTouchScrollTime=Date.now()}};SC.CollectionGroup={classNames:["sc-collection-group"]};SC.CollectionRowDelegate={isCollectionRowDelegate:YES,itemHeight:24,rowSpacing:0,rowPadding:0,rowHeight:function(b,c){var a=this.get("rowPadding");var d=this.get("itemHeight");if(c!==undefined){this.set("itemHeight",c-a*2);return c}return d+a*2}.property("itemHeight","rowPadding"),customRowHeightIndexes:null,contentIndexRowHeight:function(a,b,c){return this.get("rowHeight")}};SC.CollectionViewDelegate={isCollectionViewDelegate:YES,collectionViewSelectionForProposedSelection:function(a,b){return b},collectionViewShouldSelectIndexes:function(a,b,c){return b},collectionViewShouldDeselectIndexes:function(a,b){return b},collectionViewShouldDeleteIndexes:function(a,b){return b},collectionViewDeleteContent:function(a,c,b){if(!c){return NO}if(SC.typeOf(c.destroyAt)===SC.T_FUNCTION){c.destroyAt(b);a.selectPreviousItem(NO,1);return YES}else{if(SC.typeOf(c.removeAt)===SC.T_FUNCTION){c.removeAt(b);a.selectPreviousItem(NO,1);return YES}else{return NO}}},collectionViewShouldBeginDrag:function(a){return YES},collectionViewDragDataTypes:function(a){return[]},collectionViewDragDataForType:function(a,c,b){return null},collectionViewComputeDragOperations:function(a,b,c){return c},collectionViewValidateDragOperation:function(b,d,f,c,a){return(a&SC.DROP_ON)?SC.DRAG_NONE:f},collectionViewPerformDragOperation:function(b,d,f,c,a){return SC.DRAG_NONE},collectionViewDragViewFor:function(a,b){return null},ghostActsLikeCursor:NO};SC.NavigationBuilder={isNavigationBuilder:YES,navigationTransitions:NO,initMixin:function(){var b=SC.Animatable;if(b&&!this.isAnimatable){this.mixin(b)}else{if(!b){SC.Logger.error("SC.NavigationView and SC.NavigationBuilder require SC.Animatable to perform animations, but it is not present. Please ensure your app or framework references it.")}}var a=this.get("navigationTransitions");if(!a&&SC.Animatable){a={left:{duration:0.25,timing:SC.Animatable.TRANSITION_EASE_IN_OUT,action:"navigationBuildDidFinish"},transform:{duration:0.25,timing:SC.Animatable.TRANSITION_EASE_IN_OUT,action:"navigationBuildDidFinish"}}}if(SC.Animatable){SC.mixin(this.transitions,a)}},metrics:function(){var a=this.computeFrameWithParentFrame();return a},transform:function(a){if(SC.platform.supportsCSS3DTransforms){this.adjust("transform","translate3d("+a+"px,0px,0px)")}else{this.adjust("transform","translate("+a+"px,0px)")}},buildInNavigation:function(){var a=this.metrics();this.disableAnimation();this.transform(this.get("buildDirection")===SC.TO_LEFT?a.width:-a.width);this.enableAnimation();this.invokeLater("transform",10,0)},buildOutNavigation:function(){var a=this.metrics();this.transform(this.get("buildDirection")===SC.TO_LEFT?-a.width:a.width)},buildIn:function(){this.buildInNavigation()},buildOut:function(){this.buildOutNavigation()},resetBuild:function(){this.transform(0)},navigationBuildDidFinish:function(){if(this.isBuildingIn){this.buildInDidFinish()}else{if(this.isBuildingOut){this.buildOutDidFinish()}}}};SC.Scrollable={isScrollable:true,verticalLineScroll:20,horizontalLineScroll:20,verticalPageScroll:function(){return this.get("innerFrame").height}.property("innerFrame"),horizontalPageScroll:function(){return this.get("innerFrame").width}.property("innerFrame"),hasVerticalScroller:function(){return this.get("scrollFrame").height>this.get("innerFrame").height}.property("scrollFrame"),hasHorizontalScroller:function(){return this.get("scrollFrame").width>this.get("innerFrame").width}.property("scrollFrame"),scrollBy:function(a){var b=this.get("scrollFrame");var c=this.get("innerFrame");if(!this.get("hasVerticalScroller")){a.y=0}if(b.height<=c.height){a.y=0}if(!this.get("hasHorizontalScroller")){a.x=0}if(b.width<=c.width){a.x=0}var d={x:b.x-(a.x||0),y:b.y-(a.y||0)};this.set("scrollFrame",d);d=this.get("scrollFrame");return{x:d.x-b.x,y:d.y-b.y}},scrollTo:function(a,b){this.set("scrollFrame",{x:0-a,y:0-b})},scrollToVisible:function(b){var g=this.get("innerFrame");var d=this.get("scrollFrame");var a=this.convertFrameFromView(b.get("frame"),b);a.x-=(g.x+d.x);a.y-=(g.y+d.y);var c={x:0-d.x,y:0-d.y,width:g.width,height:g.height};c.y-=Math.max(0,SC.minY(c)-SC.minY(a));c.x-=Math.max(0,SC.minX(c)-SC.minX(a));c.y+=Math.max(0,SC.maxY(a)-SC.maxY(c));c.x+=Math.max(0,SC.maxX(a)-SC.maxX(c));this.scrollTo(c.x,c.y)},scrollDownLine:function(a){if(a===undefined){a=1}return this.scrollBy({y:this.get("verticalLineScroll")*a}).y},scrollUpLine:function(a){if(a===undefined){a=1}return 0-this.scrollBy({y:0-this.get("verticalLineScroll")*a}).y},scrollRightLine:function(a){if(a===undefined){a=1}return this.scrollTo({y:this.get("horizontalLineScroll")*a}).x},scrollLeftLine:function(a){if(a===undefined){a=1}return 0-this.scrollTo({y:0-this.get("horizontalLineScroll")*a}).x},scrollDownPage:function(a){if(a===undefined){a=1}return this.scrollBy({y:this.get("verticalPageScroll")*a}).y},scrollUpPage:function(a){if(a===undefined){a=1}return 0-this.scrollBy({y:0-this.get("verticalPageScroll")*a}).y},scrollRightPage:function(a){if(a===undefined){a=1}return this.scrollTo({y:this.get("horizontalPageScroll")*a}).x},scrollLeftPage:function(a){if(a===undefined){a=1}return 0-this.scrollTo({y:0-this.get("horizontalPageScroll")*a}).x}};SC.ModalPane=SC.Pane.extend({classNames:"sc-modal",_openPaneCount:0,paneWillAppend:function(f){var d;this._openPaneCount++;if(!this.get("isVisibleInWindow")){this.append()}var c=SC.RootResponder.responder.panes;for(var b=0,a=c.length;b<a;b++){d=c[b];if(d!==f){this._hideShowTextfields(d,NO)}}return this},paneDidRemove:function(f){var d;this._openPaneCount--;var c=SC.RootResponder.responder.panes;for(var b=0,a=c.length;b<a;b++){d=c[b];if(d!==f){this._hideShowTextfields(d,YES)}}if(this._openPaneCount<=0){this._openPaneCount=0;if(this.get("isVisibleInWindow")){this.remove()}}},_hideShowTextfields:function(c,b){var a;for(a in SC.View.views){a=SC.View.views[a];if(a!==c&&a.get("pane")===c&&a.get("isTextField")){a.set("isBrowserFocusable",b)}}},mouseDown:function(b){var a=this.get("owner");if(a&&a.modalPaneDidClick){a.modalPaneDidClick(b)}},touchStart:function(a){this.mouseDown(a)}});sc_require("panes/modal");SC.PanelPane=SC.Pane.extend({isPanelPane:YES,classNames:["sc-panel"],acceptsKeyPane:YES,ariaRole:"dialog",ariaLabel:null,ariaLabelledBy:null,ariaDescribedBy:null,isModal:YES,modalPane:SC.ModalPane.extend({classNames:"for-sc-panel"}),contentView:null,contentViewBindingDefault:SC.Binding.single(),replaceContent:function(a){this.removeAllChildren();if(a){this.appendChild(a)}},createChildViews:function(){var a=this.contentView;if(a){a=this.contentView=this.createChildView(a);this.childViews=[a]}},contentViewDidChange:function(){this.replaceContent(this.get("contentView"))}.observes("contentView"),renderDelegateName:"panelRenderDelegate",_modalPane:function(){var a=this.get("modalPane");if(a&&a.isClass){a=a.create({owner:this});this.set("modalPane",a)}return a},appendTo:function(a){var b;if(!this.get("isVisibleInWindow")&&this.get("isModal")&&(b=this._modalPane())){this._isShowingModal=YES;b.paneWillAppend(this)}return arguments.callee.base.apply(this,arguments)},remove:function(){var b,a=arguments.callee.base.apply(this,arguments);if(this._isShowingModal){this._isShowingModal=NO;if(b=this._modalPane()){b.paneDidRemove(this)}}return a},destroy:function(){var a=this.get("modalPane");if(a&&!a.isClass){a.destroy()}arguments.callee.base.apply(this,arguments)},_isModalDidChange:function(){var b,a=this.get("isModal");if(a){if(!this._isShowingModal&&this.get("isVisibleInWindow")&&(b=this._modalPane())){this._isShowingModal=YES;b.paneWillAppend(this)}}else{if(this._isShowingModal&&(b=this._modalPane())){this._isShowingModal=NO;b.paneDidRemove(this)}}}.observes("isModal"),paneDidAttach:function(){var a=arguments.callee.base.apply(this,arguments);this.becomeKeyPane();return a},displayProperties:["ariaLabel","ariaLabelledBy","ariaDescribedBy"]});SC.TOGGLE_BEHAVIOR="toggle";SC.PUSH_BEHAVIOR="push";SC.TOGGLE_ON_BEHAVIOR="on";SC.TOGGLE_OFF_BEHAVIOR="off";SC.HOLD_BEHAVIOR="hold";SC.ButtonView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),classNames:["sc-button-view"],themeName:"square",value:null,toggleOnValue:YES,toggleOffValue:NO,localize:NO,localizeBindingDefault:SC.Binding.bool(),title:"",tooltip:"",contentTitleKey:null,icon:null,contentIconKey:null,needsEllipsis:YES,displayTitle:function(){var a=this.get("title");return(a&&this.get("localize"))?SC.String.loc(a):(a||"")}.property("title","localize").cacheable(),keyEquivalent:null,buttonBehavior:SC.PUSH_BEHAVIOR,holdInterval:100,isDefault:NO,isDefaultBindingDefault:SC.Binding.oneWay().bool(),isCancel:NO,isCancelBindingDefault:SC.Binding.oneWay().bool(),action:null,target:null,supportFocusRing:NO,supportsAutoResize:YES,autoResizeLayer:function(){var a=this.invokeRenderDelegateMethod("getRenderedAutoResizeLayer",this.$());return a||this.get("layer")}.property("layer").cacheable(),autoResizeText:function(){return this.get("displayTitle")}.property("displayTitle").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",10),_labelMinWidthIE7:0,triggerActionAfterDelay:function(a){if(!this.get("isEnabled")){return NO}this.set("isActive",YES);this.invokeLater("triggerAction",200,a);return YES},triggerAction:function(a){this._action(a,YES);this.didTriggerAction();this.set("isActive",NO)},didTriggerAction:function(){},init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("keyEquivalent");if(a){this._defaultKeyEquivalent=a}if(!SC.none(this.get("value"))){this._button_valueDidChange()}},ariaRole:"button",displayProperties:["icon","displayTitle","value","displayToolTip","isDefault","isCancel","escapeHTML","needsEllipsis","tooltip","supportFocusRing","buttonBehavior"],renderDelegateName:"buttonRenderDelegate",contentKeys:{contentValueKey:"value",contentTitleKey:"title",contentIconKey:"icon"},_button_displayObserver:function(){this.displayDidChange()}.observes("title","icon","value"),performKeyEquivalent:function(c,b){if(!this.get("isVisibleInWindow")){return NO}if(!this.get("isEnabled")){return NO}var a=this.get("keyEquivalent");if(a){if(a===c){return this.triggerAction(b)}}else{if((this.get("isDefault")&&(c==="return"))||(this.get("isCancel")&&(c==="escape"))){return this.triggerAction(b)}}return NO},computeIsSelectedForValue:function(d){var b=this.get("toggleOnValue"),c,a;if(SC.typeOf(d)===SC.T_ARRAY){if(d.length===1){c=(d[0]==b)}else{c=null;d.find(function(f){a=(f==b);if(c===null){c=a}else{if(a!==c){c=SC.MIXED_STATE}}return c===SC.MIXED_STATE})}}else{if(d===SC.MIXED_STATE){c=SC.MIXED_STATE}else{c=(d===b)}}return c},_button_valueDidChange:function(){var b=this.get("value"),a=this.computeIsSelectedForValue(b);this.set("isSelected",a)}.observes("value"),_button_isSelectedDidChange:function(){var c=this.get("isSelected"),b=this.computeIsSelectedForValue(this.get("value"));if((c!==SC.MIXED_STATE)&&(b!==c)){var a=(c)?"toggleOnValue":"toggleOffValue";this.set("value",this.get(a))}}.observes("isSelected"),_defaultKeyEquivalent:null,_isDefaultOrCancelDidChange:function(){var b=!!this.get("isDefault"),a=!b&&this.get("isCancel");if(b){this.set("keyEquivalent","return")}else{if(a){this.set("keyEquivalent","escape")}else{this.set("keyEquivalent",this._defaultKeyEquivalent)}}}.observes("isDefault","isCancel"),mouseDown:function(a){var b=this.get("buttonBehavior");if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;if(b===SC.HOLD_BEHAVIOR){this._action(a)}else{if(!this._isFocused&&(b!==SC.PUSH_BEHAVIOR)){this._isFocused=YES;this.becomeFirstResponder()}}return YES},mouseExited:function(a){if(this._isMouseDown){this.set("isActive",NO)}return YES},mouseEntered:function(a){if(this._isMouseDown){this.set("isActive",YES)}return YES},mouseUp:function(b){if(this._isMouseDown){this.set("isActive",NO)}this._isMouseDown=false;if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){var a=this.$().within(b.target);if(a&&this.get("isEnabled")){this._action(b)}}return YES},touchStart:function(b){var a=this.get("buttonBehavior");if(!this.get("isEnabled")){return YES}this.set("isActive",YES);if(a===SC.HOLD_BEHAVIOR){this._action(b)}else{if(!this._isFocused&&(a!==SC.PUSH_BEHAVIOR)){this._isFocused=YES;this.becomeFirstResponder()}}b.preventDefault();return YES},touchesDragged:function(a,b){if(!this.touchIsInBoundary(a)){if(!this._touch_exited){this.set("isActive",NO)}this._touch_exited=YES}else{if(this._touch_exited){this.set("isActive",YES)}this._touch_exited=NO}a.preventDefault();return YES},touchEnd:function(a){this._touch_exited=NO;this.set("isActive",NO);if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.touchIsInBoundary(a)&&this.get("isEnabled")){this._action()}}a.preventDefault();return YES},keyDown:function(b){if(!this.get("isEnabled")){return YES}if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(b.which===13||b.which===32){this.triggerActionAfterDelay(b);return YES}b.allowDefault();return NO},_action:function(a,c){switch(this.get("buttonBehavior")){case SC.TOGGLE_BEHAVIOR:var b=this.get("isSelected");if(b){this.set("value",this.get("toggleOffValue"))}else{this.set("value",this.get("toggleOnValue"))}break;case SC.TOGGLE_ON_BEHAVIOR:this.set("value",this.get("toggleOnValue"));break;case SC.TOGGLE_OFF_BEHAVIOR:this.set("value",this.get("toggleOffValue"));break;case SC.HOLD_BEHAVIOR:this._runHoldAction(a,c);break;default:this._runAction(a)}},_runAction:function(a){var c=this.get("action"),d=this.get("target")||null,b;if(c){if(c&&(SC.typeOf(c)===SC.T_FUNCTION)){this.action(a);return}else{b=this.getPath("pane.rootResponder");if(b){b.sendAction(c,d,this,this.get("pane"),null,this)}}}},_runHoldAction:function(a,b){if(this.get("isActive")){this._runAction();if(!b){SC.RunLoop.begin();this.invokeLater("_runHoldAction",this.get("holdInterval"),a);SC.RunLoop.end()}}},didBecomeKeyResponderFrom:function(a){if(!this._isFocused){this._isFocused=YES;this.becomeFirstResponder();if(this.get("isVisibleInWindow")){this.$().focus()}}},willLoseKeyResponderTo:function(a){if(this._isFocused){this._isFocused=NO}},didAppendToDocument:function(){if(SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0&&this.get("useStaticLayout")){var f=this.get("layout"),d=this.$(),a=0;if(d&&d[0]&&(a=d[0].clientWidth)&&a!==0&&this._labelMinWidthIE7===0){var c=this.$(".sc-button-label"),i=parseInt(c.css("paddingRight"),0),b=parseInt(c.css("paddingLeft"),0),h=parseInt(c.css("marginRight"),0),g=parseInt(c.css("marginLeft"),0);if(h=="auto"){SC.Logger.log(h+","+g+","+i+","+b)}if(!i&&isNaN(i)){i=0}if(!b&&isNaN(b)){b=0}if(!h&&isNaN(h)){h=0}if(!g&&isNaN(g)){g=0}this._labelMinWidthIE7=a-(i+b)-(h+g);c.css("minWidth",this._labelMinWidthIE7+"px")}else{this.invokeLater(this.didAppendToDocument,1)}}}});SC.ButtonView.CLICK_AND_HOLD_DELAY=SC.browser.isIE?600:300;SC.REGULAR_BUTTON_HEIGHT=24;sc_require("panes/panel");sc_require("views/button");SC.BUTTON1_STATUS="button1";SC.BUTTON2_STATUS="button2";SC.BUTTON3_STATUS="button3";SC.AlertPane=SC.PanelPane.extend({classNames:["sc-alert"],ariaRole:"alertdialog",delegate:null,icon:"sc-icon-alert-48",message:"",ariaLabel:function(){return this.get("message")}.property("message").cacheable(),description:"",displayDescription:function(){var a=this.get("description");if(!a||a.length===0){return a}a=SC.RenderContext.escapeHTML(a);return'<p class="description">'+a.split("\n").join('</p><p class="description">')+"</p>"}.property("description").cacheable(),caption:"",displayCaption:function(){var a=this.get("caption");if(!a||a.length===0){return a}a=SC.RenderContext.escapeHTML(a);return'<p class="caption">'+a.split("\n").join('</p><p class="caption">')+"</p>"}.property("caption").cacheable(),button1:SC.outlet("contentView.childViews.1.childViews.1"),button2:SC.outlet("contentView.childViews.1.childViews.0"),button3:SC.outlet("contentView.childViews.2.childViews.0"),buttonThreeWrapper:SC.outlet("contentView.childViews.2"),layout:{top:0.3,centerX:0,width:500},contentView:SC.View.extend({useStaticLayout:YES,layout:{left:0,right:0,top:0,height:"auto"},childViews:[SC.View.extend(SC.StaticLayout,{classNames:["info"],render:function(a,c){var b=this.get("pane");if(b.get("icon")=="blank"){a.addClass("plain")}a.push('<img src="'+SC.BLANK_IMAGE_URL+'" class="icon '+b.get("icon")+'" />');a.begin("h1").attr("class","header").text(b.get("message")||"").end();a.push(b.get("displayDescription")||"");a.push(b.get("displayCaption")||"");a.push('<div class="separator"></div>')}}),SC.View.extend({layout:{bottom:13,height:24,right:18,width:466},childViews:["cancelButton","okButton"],classNames:["text-align-right"],cancelButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON2_STATUS,localize:YES,layout:{right:5,height:"auto",width:"auto",bottom:0},isCancel:YES,action:"dismiss",isVisible:NO}),okButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON1_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},isDefault:YES,action:"dismiss",isVisible:NO})}),SC.View.extend({layout:{bottom:13,height:24,left:18,width:150},childViews:[SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON3_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},action:"dismiss",isVisible:NO})]})]}),dismiss:function(b){var a=this.delegate,c,d,f;if(a&&a.alertPaneDidDismiss){a.alertPaneDidDismiss(this,b.get("actionKey"))}if(d=(b&&b.get("customAction"))){if(SC.typeOf(d)===SC.T_FUNCTION){d.call(d)}else{c=this.getPath("pane.rootResponder");if(c){f=b.get("target");c.sendAction(d,f||a,this,this,null,this)}}}this.remove()},alertInfoDidChange:function(){var a=this.getPath("contentView.childViews.0");if(a){a.displayDidChange()}}.observes("icon","message","displayDescription","displayCaption")});SC.AlertPane.mixin({show:function(g){g=SC.AlertPane._argumentsCall.apply(this,arguments);var a=this.create(g),k=0,h=g.buttons,f,i,b,d,c;if(h){h.forEach(function(l){k++;if(!l){return}f=a.get("button%@".fmt(k));i=l.title;b=l.action;d=l.target;c=g.themeName||"capsule";f.set("title".fmt(k),i);if(b){f.set("customAction".fmt(k),b)}if(d){f.set("target".fmt(k),d)}f.set("isVisible",!!i);f.set("themeName",c)})}else{f=a.get("button1");f.set("title","OK");f.set("isVisible",YES)}var j=a.append();a.adjust("height",a.childViews[0].$().height());a.updateLayout();return j},warn:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-alert-48";return this.show(a)},info:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-info-48";return this.show(a)},error:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-error-48";return this.show(a)},plain:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="blank";return this.show(a)},_argumentsCall:function(b){var a=b;if(SC.typeOf(b)!==SC.T_HASH){var c=this._normalizeArguments(arguments);a={message:c[0],description:c[1],caption:c[2],delegate:c[7],icon:(c[6]||"sc-icon-alert-48"),themeName:"capsule"};if(SC.typeOf(c[3])===SC.T_STRING||SC.typeOf(c[4])===SC.T_STRING||SC.typeOf(c[5])===SC.T_STRING){a.buttons=[{title:c[3]},{title:c[4]},{title:c[5]}]}}return a},_normalizeArguments:function(b){b=SC.A(b);var a=b.length,c=b[a-1];if(SC.typeOf(c)!==SC.T_STRING){b[a-1]=null}else{c=null}b[7]=c;return b}});sc_require("panes/panel");SC.PalettePane=SC.PanelPane.extend({classNames:["sc-palette"],isModal:NO,modalPane:SC.ModalPane,isAnchored:NO,_mouseOffsetX:null,_mouseOffsetY:null,mouseDown:function(a){var b=this.get("frame");this._mouseOffsetX=b?(b.x-a.pageX):0;this._mouseOffsetY=b?(b.y-a.pageY):0;return YES},mouseDragged:function(a){if(!this.isAnchored){this.set("layout",{width:this.layout.width,height:this.layout.height,left:this._mouseOffsetX+a.pageX,top:this._mouseOffsetY+a.pageY});this.updateLayout()}return YES},touchStart:function(a){return this.mouseDown(a)},touchesDragged:function(a){return this.mouseDragged(a)}});sc_require("panes/palette");SC.PICKER_MENU="menu";SC.PICKER_FIXED="fixed";SC.PICKER_POINTER="pointer";SC.PICKER_MENU_POINTER="menu-pointer";SC.POINTER_LAYOUT=["perfectRight","perfectLeft","perfectTop","perfectBottom"];SC.PickerPane=SC.PalettePane.extend({classNames:["sc-picker"],isAnchored:YES,isModal:YES,pointerPos:"perfectRight",pointerPosX:0,pointerPosY:0,anchorElement:null,anchorCached:null,preferType:null,preferMatrix:null,pointerOffset:null,extraRightOffset:0,removeTarget:null,removeAction:null,repositionOnWindowResize:YES,_anchorView:null,_anchorHTMLElement:null,popup:function(c,b,d,a){if(c){if(c.isView){this._anchorView=c;this._setupScrollObservers(c)}else{this._anchorHTMLElement=c}}this.beginPropertyChanges();if(b){this.set("preferType",b)}if(d){this.set("preferMatrix",d)}if(a){this.set("pointerOffset",a)}this.endPropertyChanges();this.positionPane();this._hideOverflow();return this.append()},positionPane:function(g){g=g&&this.get("anchorCached");var b=g?this.get("anchorCached"):this.get("anchorElement"),c=this.get("preferType"),d=this.get("preferMatrix"),f=this.get("layout"),a;if(b){if(!g){b=this.computeAnchorRect(b);this.set("anchorCached",b)}if(b.x===0&&b.y===0){return}a=SC.cloneRect(b);if(c){switch(c){case SC.PICKER_MENU:case SC.PICKER_FIXED:if(!d||d.length!==3){this.set("preferMatrix",[1,4,3])}a.x+=((this.preferMatrix[2]===0)?a.width:0)+this.preferMatrix[0];a.y+=((this.preferMatrix[2]===3)?a.height:0)+this.preferMatrix[1];break;default:a.y+=a.height;break}}else{a.y+=a.height}a=this.fitPositionToScreen(a,this.get("frame"),b);this.adjust({width:a.width,height:a.height,left:a.x,top:a.y})}else{this.adjust({width:f.width,height:f.height,centerX:0,centerY:0})}this.updateLayout();return this},computeAnchorRect:function(c){var f,b,d,a=SC.RootResponder.responder.computeWindowSize();if(c.getBoundingClientRect){f=c.getBoundingClientRect();b={x:f.left,y:f.top,width:f.width,height:f.height};if(b.width===undefined||b.height===undefined){d=SC.$(c);b.width=d.outerWidth();b.height=d.outerHeight()}}else{b=SC.offset(c);d=SC.$(c);b.width=d.outerWidth();b.height=d.outerHeight()}b.height=(a.height-b.y)<b.height?(a.height-b.y):b.height;if(!SC.browser.isIE&&window.scrollX>0||window.scrollY>0){b.x+=window.scrollX;b.y+=window.scrollY}else{if(SC.browser.isIE&&(document.documentElement.scrollTop>0||document.documentElement.scrollLeft>0)){b.x+=document.documentElement.scrollLeft;b.y+=document.documentElement.scrollTop}}return b},fitPositionToScreen:function(i,c,b){var a=SC.RootResponder.responder.computeWindowSize(),h={x:0,y:0,width:a.width,height:a.height};var d=SC.RootResponder.responder.mainPane;if(d){var f=d.layout.minWidth,g=d.layout.minHeight;if(f&&h.width<f){h.width=d.layout.minWidth}if(g&&h.height<g){h.height=d.layout.minHeight}}c.x=i.x;c.y=i.y;if(this.preferType){switch(this.preferType){case SC.PICKER_MENU:c=this.fitPositionToScreenMenu(h,c,this.get("isSubMenu"));break;case SC.PICKER_MENU_POINTER:this.setupPointer(b);c=this.fitPositionToScreenMenuPointer(h,c,b);break;case SC.PICKER_POINTER:this.setupPointer(b);c=this.fitPositionToScreenPointer(h,c,b);break;case SC.PICKER_FIXED:break;default:break}}else{c=this.fitPositionToScreenDefault(h,c,b)}this.displayDidChange();return c},fitPositionToScreenDefault:function(c,d,b){if(SC.maxX(d)>c.width){var g=Math.max(SC.maxX(b),d.width);d.x=Math.min(g,c.width)-d.width}if(SC.minX(d)<0){d.x=SC.minX(Math.max(b,0));if(SC.maxX(d)>c.width){d.x=Math.max(0,c.width-d.width)}}if(SC.maxY(d)>c.height){g=Math.max((b.y-d.height),0);if(g>c.height){d.y=Math.max(0,c.height-d.height)}else{d.y=g}}if(SC.minY(d)<0){g=Math.min(SC.maxY(b),(c.height-b.height));d.y=Math.max(g,0)}return d},fitPositionToScreenMenu:function(c,b,a){if(a){b.x-=this.get("submenuOffsetX");b.y-=Math.floor(this.get("menuHeightPadding")/2)}if((b.x+b.width)>(c.width-20)){if(a){b.x=b.x-(b.width*2)}else{b.x=c.width-b.width-20}}if(b.x<7){b.x=7}if(b.y<7){b.height+=b.y;b.y=7}if(b.height+b.y+35>=c.height){if(b.height+50>=c.height){b.y=SC.MenuPane.VERTICAL_OFFSET;b.height=c.height-(SC.MenuPane.VERTICAL_OFFSET*2)}else{b.y+=(c.height-(b.height+b.y+35))}}return b},fitPositionToScreenMenuPointer:function(c,d,b){d=this.fitPositionToScreenPointer(c,d,b);if(d.height+d.y+35>=c.height){d.height=c.height-d.y-(SC.MenuPane.VERTICAL_OFFSET*2)}return d},fitPositionToScreenPointer:function(p,n,o){var j=[this.pointerOffset[0],this.pointerOffset[1],this.pointerOffset[2],this.pointerOffset[3]];var g=[[o.x+o.width+j[0],o.y+parseInt(o.height/2,0)-40],[o.x-n.width+j[1],o.y+parseInt(o.height/2,0)-40],[o.x+parseInt((o.width/2)-(n.width/2),0),o.y-n.height+j[2]],[o.x+parseInt((o.width/2)-(n.width/2),0),o.y+o.height+j[3]]];var c=[[o.x+o.width+n.width+j[0],o.y+parseInt(o.height/2,0)+n.height-24],[o.x+j[1],o.y+parseInt(o.height/2,0)+n.height-24],[o.x+parseInt((o.width/2)-(n.width/2),0)+n.width,o.y+j[2]],[o.x+parseInt((o.width/2)-(n.width/2),0)+n.width,o.y+o.height+n.height+j[3]]];var h=[[g[0][1]>0?0:0-g[0][1],c[0][0]<p.width?0:c[0][0]-p.width,c[0][1]<p.height?0:c[0][1]-p.height,g[0][0]>0?0:0-g[0][0]],[g[1][1]>0?0:0-g[1][1],c[1][0]<p.width?0:c[1][0]-p.width,c[1][1]<p.height?0:c[1][1]-p.height,g[1][0]>0?0:0-g[1][0]],[g[2][1]>0?0:0-g[2][1],c[2][0]<p.width?0:c[2][0]-p.width,c[2][1]<p.height?0:c[2][1]-p.height,g[2][0]>0?0:0-g[2][0]],[g[3][1]>0?0:0-g[3][1],c[3][0]<p.width?0:c[3][0]-p.width,c[3][1]<p.height?0:c[3][1]-p.height,g[3][0]>0?0:0-g[3][0]]];var d=this.preferMatrix;if(d[4]===-1){n.x=o.x+parseInt(o.width/2,0);n.y=o.y+parseInt(o.height/2,0)-parseInt(n.height/2,0);this.set("pointerPos",SC.POINTER_LAYOUT[0]+" fallback");this.set("pointerPosY",parseInt(n.height/2,0)-40)}else{n.x=g[d[4]][0];n.y=g[d[4]][1];this.set("pointerPos",SC.POINTER_LAYOUT[d[4]]);this.set("pointerPosY",0)}this.set("pointerPosX",0);for(var k=0,b,l=SC.POINTER_LAYOUT.length;k<l;k++){b=d[k];if(h[b][0]===0&&h[b][1]===0&&h[b][2]===0&&h[b][3]===0){if(d[4]!==b){n.x=g[b][0];n.y=g[b][1];this.set("pointerPosY",0);this.set("pointerPos",SC.POINTER_LAYOUT[b])}k=SC.POINTER_LAYOUT.length}else{if((b===0||b===1)&&h[b][0]===0&&h[b][1]===0&&h[b][2]<n.height-91&&h[b][3]===0){if(d[4]!==b){n.x=g[b][0];this.set("pointerPos",SC.POINTER_LAYOUT[b])}n.y=g[b][1]-h[b][2];this.set("pointerPosY",h[b][2]);k=SC.POINTER_LAYOUT.length}else{if((b===0||b===1)&&h[b][0]===0&&h[b][1]===0&&h[b][2]<=n.height-51&&h[b][3]===0){if(d[4]!==b){n.x=g[b][0]}n.y=g[b][1]-(n.height-51);this.set("pointerPosY",(n.height-53));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-low");k=SC.POINTER_LAYOUT.length}else{if((b===2||b===3)&&h[b][0]===0&&h[b][1]<=parseInt(n.width/2,0)-this.get("extraRightOffset")&&h[b][2]===0&&h[b][3]===0){if(d[4]!==b){n.y=g[b][1]}n.x=g[b][0]-(parseInt(n.width/2,0)-this.get("extraRightOffset"));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-right");k=SC.POINTER_LAYOUT.length}else{if((b===2||b===3)&&h[b][0]===0&&h[b][1]===0&&h[b][2]===0&&h[b][3]<=parseInt(n.width/2,0)-this.get("extraRightOffset")){if(d[4]!==b){n.y=g[b][1]}n.x=g[b][0]+(parseInt(n.width/2,0)-this.get("extraRightOffset"));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-left");k=SC.POINTER_LAYOUT.length}}}}}}return n},setupPointer:function(g){var h=this.pointerOffset,f=SC.PickerPane;if(!h||h.length!==4){if(this.get("preferType")==SC.PICKER_MENU_POINTER){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:this.set("pointerOffset",f.TINY_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.TINY_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.SMALL_CONTROL_SIZE:this.set("pointerOffset",f.SMALL_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.SMALL_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.REGULAR_CONTROL_SIZE:this.set("pointerOffset",f.REGULAR_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.REGULAR_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.LARGE_CONTROL_SIZE:this.set("pointerOffset",f.LARGE_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.LARGE_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.HUGE_CONTROL_SIZE:this.set("pointerOffset",f.HUGE_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.HUGE_PICKER_MENU_EXTRA_RIGHT_OFFSET);break}}else{var d=(g.width<16)?((g.width<4)?9:6):0,b=(g.height<16)?((g.height<4)?9:6):0,c=f.PICKER_POINTER_OFFSET;var i=[c[0]+d,c[1]-d,c[2]-b,c[3]+b];this.set("pointerOffset",i);this.set("extraRightOffset",f.PICKER_EXTRA_RIGHT_OFFSET)}}if(!this.preferMatrix||this.preferMatrix.length!==5){this.set("preferMatrix",this.get("preferType")===SC.PICKER_MENU_POINTER?[3,2,1,0,3]:[0,1,2,3,2])}},displayProperties:["preferType","pointerPos","pointerPosY"],renderDelegateName:"pickerRenderDelegate",modalPaneDidClick:function(a){var d=this.get("frame"),g=this.get("removeTarget")||null,c=this.get("removeAction"),b=this.get("rootResponder");if(!this.clickInside(d,a)){if(c){b.sendAction(c,g,this,this,null,this)}else{this.remove()}return YES}return NO},mouseDown:function(a){return this.modalPaneDidClick(a)},clickInside:function(b,a){return SC.pointInRect({x:a.pageX,y:a.pageY},b)},windowSizeDidChange:function(b,a){if(this.repositionOnWindowResize){this.positionPane()}},remove:function(){if(this.get("isVisibleInWindow")&&this.get("isPaneAttached")){this._withdrawOverflowRequest()}this._removeScrollObservers();return arguments.callee.base.apply(this,arguments)},anchorElement:function(a,b){var c;if(b===undefined){c=this._anchorView;return c?c.get("layer"):this._anchorHTMLElement}else{if(!b){throw"You must set 'anchorElement' to either a view or a DOM element"}else{if(b.isView){this._anchorView=b;this._anchorHTMLElement=null}else{this._anchorView=null;this._anchorHTMLElement=b}}}}.property("layer").cacheable(),_hideOverflow:function(){var b=SC.$(document.body),a=SC.$(".sc-main"),d=parseInt(a.css("minWidth"),0),f=parseInt(a.css("minHeight"),0),c=SC.RootResponder.responder.get("currentWindowSize");if(c.width>=d&&c.height>=f){SC.bodyOverflowArbitrator.requestHidden(this)}},_withdrawOverflowRequest:function(){SC.bodyOverflowArbitrator.withdrawRequest(this)},_getScrollViewOfView:function(b){var a=b;while(YES){if(!a){return null}if(a.isScrollable){return a}a=a.get("parentView")}},_setupScrollObservers:function(b){var a=this._getScrollViewOfView(b);if(a){a.addObserver("horizontalScrollOffset",this,this._scrollOffsetDidChange);a.addObserver("verticalScrollOffset",this,this._scrollOffsetDidChange);this._scrollView=a}},_removeScrollObservers:function(){var a=this._scrollView;if(a){a.removeObserver("horizontalScrollOffset",this,this._scrollOffsetDidChange);a.removeObserver("verticalScrollOffset",this,this._scrollOffsetDidChange)}},_scrollOffsetDidChange:function(){this.positionPane()}});SC.PickerPane.PICKER_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.PICKER_EXTRA_RIGHT_OFFSET=20;SC.PickerPane.TINY_PICKER_MENU_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.TINY_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.PickerPane.SMALL_PICKER_MENU_POINTER_OFFSET=[9,-9,-8,8];SC.PickerPane.SMALL_PICKER_MENU_EXTRA_RIGHT_OFFSET=11;SC.PickerPane.REGULAR_PICKER_MENU_POINTER_OFFSET=[9,-9,-12,12];SC.PickerPane.REGULAR_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.PickerPane.LARGE_PICKER_MENU_POINTER_OFFSET=[9,-9,-16,16];SC.PickerPane.LARGE_PICKER_MENU_EXTRA_RIGHT_OFFSET=17;SC.PickerPane.HUGE_PICKER_MENU_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.HUGE_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.SeparatorView=SC.View.extend({classNames:["sc-separator-view"],tagName:"span",layoutDirection:SC.LAYOUT_HORIZONTAL,render:function(a,b){if(b){a.push("<span></span>")}a.addClass(this.get("layoutDirection"))}});sc_require("views/button");sc_require("views/separator");SC.MenuItemView=SC.View.extend(SC.ContentDisplay,{classNames:["sc-menu-item"],displayProperties:["title","isEnabled","isSeparator","isChecked"],ariaRole:"menuitem",escapeHTML:YES,acceptsFirstResponder:YES,blocksIEDeactivate:YES,isContextMenuEnabled:NO,content:null,isSeparator:function(){return this.getContentProperty("itemSeparatorKey")===YES}.property("content").cacheable(),isEnabled:function(){return this.getContentProperty("itemIsEnabledKey")!==NO&&this.getContentProperty("itemSeparatorKey")!==YES}.property("content.isEnabled").cacheable(),isChecked:function(){return this.getContentProperty("itemCheckboxKey")}.property(),subMenu:function(){var c=this.get("content"),b,a;if(!c){return null}a=this.get("parentMenu");b=c.get(a.itemSubMenuKey);if(b){if(SC.kindOf(b,SC.MenuPane)){b.set("isModal",NO);b.set("isSubMenu",YES);b.set("parentMenu",a);return b}else{return SC.MenuPane.create({layout:{width:200},items:b,isModal:NO,isSubMenu:YES,parentMenu:a,controlSize:a.get("controlSize"),exampleView:a.get("exampleView")})}}return null}.property("content").cacheable(),hasSubMenu:function(){return !!this.get("subMenu")}.property("subMenu").cacheable(),init:function(){arguments.callee.base.apply(this,arguments);this.contentDidChange()},render:function(b,i){var c=this.get("content"),a,g,f=this.get("parentMenu"),d=this.get("itemWidth")||f.layout.width,h=this.get("itemHeight")||SC.DEFAULT_MENU_ITEM_HEIGHT;this.set("itemWidth",d);this.set("itemHeight",h);if(this.get("isSeparator")){b.attr("role","separator")}else{if(this.get("isChecked")){b.attr("role","menuitemcheckbox");b.attr("aria-checked",true)}}b=b.begin("a").addClass("menu-item");if(this.get("isSeparator")){b.push('<span class="separator"></span>');b.addClass("disabled")}else{g=c.get(f.itemIconKey);if(g){this.renderImage(b,g);b.addClass("has-icon")}g=this.get("title");if(SC.typeOf(g)!==SC.T_STRING){g=g.toString()}this.renderLabel(b,g);if(this.get("isChecked")){b.push('<div class="checkbox"></div>')}if(this.get("hasSubMenu")){this.renderBranch(b)}g=this.getContentProperty("itemShortCutKey");if(g){this.renderShortcut(b,g)}}b=b.end()},renderImage:function(b,d){var a,c;if(d&&SC.ImageView.valueIsUrl(d)){a=d;c=""}else{c=d;a=SC.BLANK_IMAGE_URL}b.begin("img").addClass("image").addClass(c).attr("src",a).end()},renderLabel:function(b,a){if(this.get("escapeHTML")){a=SC.RenderContext.escapeHTML(a)}b.push("<span class='value ellipsis'>"+a+"</span>")},renderBranch:function(a){a.push('<span class="has-branch"></span>')},renderShortcut:function(b,a){b.push('<span class = "shortcut">'+a+"</span>")},showSubMenu:function(){var a=this.get("subMenu");if(a){a.set("mouseHasEntered",NO);a.popup(this,[0,0,0])}this._subMenuTimer=null},title:function(){var b=this.getContentProperty("itemTitleKey"),a=this.getPath("parentMenu.localize");if(a&&b){b=SC.String.loc(b)}return b||""}.property("content.title").cacheable(),getContentProperty:function(b){var a=this.get("content"),c=this.get("parentMenu");if(a){return a.get(c.get(b))}},mouseUp:function(b){var a;a=this.getPath("parentMenu.rootMenu.targetMenuItem");if(a){a.performAction()}return YES},performAction:function(){if(!this.get("isEnabled")){this.getPath("parentMenu.rootMenu").remove();return YES}if(this.get("hasSubMenu")){return NO}var b=this.getContentProperty("itemDisableMenuFlashKey"),a;if(b){this.sendAction()}else{this._flashCounter=0;a=this.getPath("parentMenu.rootMenu");a._isFlashing=YES;this.invokeLater(this.flashHighlight,25);this.invokeLater(this.sendAction,150)}return YES},sendAction:function(){var c=this.getContentProperty("itemActionKey"),d=this.getContentProperty("itemTargetKey"),b=this.getPath("parentMenu.rootMenu"),a;this.getPath("parentMenu.rootMenu").remove();b._isFlashing=NO;c=(c===undefined)?b.get("action"):c;d=(d===undefined)?b.get("target"):d;b.set("selectedItem",this.get("content"));if(SC.typeOf(c)===SC.T_FUNCTION){c.apply(d,[b])}else{a=this.getPath("pane.rootResponder")||SC.RootResponder.responder;if(a){a.sendAction(c,d,b)}}},flashHighlight:function(){var a=this._flashCounter,b=this.$();if(a%2===0){b.addClass("focus")}else{b.removeClass("focus")}if(a<=2){this.invokeLater(this.flashHighlight,50);this._flashCounter++}},mouseDown:function(a){return YES},mouseEntered:function(a){var c=this.get("parentMenu"),b=c.get("rootMenu");if(b._isFlashing){return}c.set("mouseHasEntered",YES);this.set("mouseHasEntered",YES);c.set("currentMenuItem",this);if(this.get("isEnabled")){this.becomeFirstResponder()}if(this.get("hasSubMenu")){this._subMenuTimer=this.invokeLater(this.showSubMenu,100)}return YES},mouseExited:function(a){var b,c;if(this.get("hasSubMenu")){c=this._subMenuTimer;if(c){c.invalidate()}else{this.invokeLater(this.checkMouseLocation,100)}}else{b=this.get("parentMenu");if(b.get("currentMenuItem")===this){b.set("currentMenuItem",null)}}return YES},touchStart:function(a){this.mouseEntered(a);return YES},touchEnd:function(a){return this.mouseUp(a)},touchEntered:function(a){return this.mouseEntered(a)},touchExited:function(a){return this.mouseExited(a)},checkMouseLocation:function(){var b=this.get("subMenu"),c=this.get("parentMenu"),a,d;if(!b.get("mouseHasEntered")){a=c.get("currentMenuItem");if(a===this||a===null){d=c.get("previousMenuItem");if(d){d.resignFirstResponder()}this.resignFirstResponder();b.remove()}}},moveUp:function(b,a){var c=this.get("parentMenu");if(c){c.moveUp(this)}return YES},moveDown:function(b,a){var c=this.get("parentMenu");if(c){c.moveDown(this)}return YES},moveRight:function(b,a){this.showSubMenu();return YES},insertText:function(b,a){var c=this.get("parentMenu");if(c){c.insertText(b,a)}},keyDown:function(a){return this.interpretKeyEvents(a)},keyUp:function(a){return YES},cancel:function(a){this.getPath("parentMenu.rootMenu").remove();return YES},didBecomeFirstResponder:function(a){if(a!==this){return}var b=this.get("parentMenu");if(b){b.set("currentSelectedMenuItem",this)}},willLoseFirstResponder:function(a){if(a!==this){return}var b=this.get("parentMenu");if(b){b.set("currentSelectedMenuItem",null);b.set("previousSelectedMenuItem",this)}},insertNewline:function(b,a){this.mouseUp(a)},closeParent:function(){this.$().removeClass("focus");var a=this.get("parentMenu");if(a){a.remove()}},clickInside:function(b,a){return SC.pointInRect({x:a.pageX,y:a.pageY},b)},contentDidChange:function(){var b=this.get("content"),a=this._content;if(b===a){return}var c=this.contentPropertyDidChange;if(a&&a.removeObserver){a.removeObserver("*",this,c)}this._content=b;if(b&&b.addObserver){b.addObserver("*",this,c)}this.contentPropertyDidChange(b,"*")}.observes("content"),contentPropertyDidChange:function(h,k){var b=this.get("parentMenu");if(!b){return}var a=SC.MenuItemView._contentPropertyToMenuItemPropertyMapping,j=SC.keys(a),f,g,d,c;if(k==="*"){for(f=0,g=j.length;f<g;++f){d=j[f];c=a[d];this.notifyPropertyChange(c)}}else{for(f=0,g=j.length;f<g;++f){d=j[f];if(b.get(d)===k){c=a[d];this.notifyPropertyChange(c)}}}}});SC.MenuItemView._contentPropertyToMenuItemPropertyMapping={itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemSeparatorKey:"isSeparator",itemSubMenuKey:"subMenu"};sc_require("panes/picker");sc_require("views/menu_item");SC.MenuPane=SC.PickerPane.extend({classNames:["sc-menu"],ariaRole:"menu",items:[],controlSize:SC.REGULAR_CONTROL_SIZE,itemHeight:SC.propertyFromRenderDelegate("itemHeight",20),itemSeparatorHeight:SC.propertyFromRenderDelegate("itemSeparatorHeight",9),menuHeight:0,menuHeightPadding:SC.propertyFromRenderDelegate("menuHeightPadding",6),submenuOffsetX:SC.propertyFromRenderDelegate("submenuOffsetX",2),selectedItem:null,exampleView:SC.MenuItemView,anchor:null,isSubMenu:NO,localize:YES,acceptsMenuPane:YES,isContextMenuEnabled:NO,popup:function(b,c){var a;this.beginPropertyChanges();if(b){if(b.isView){this._anchorView=b;this._setupScrollObservers(b)}else{this._anchorHTMLElement=b}}if(c){this.set("preferMatrix",c)}this.adjust("height",this.get("menuHeight"));this.positionPane();this.set("defaultResponder",this);this.endPropertyChanges();this._hideOverflow();this.append()},remove:function(){var a=this.get("parentMenu");this.set("currentMenuItem",null);this.closeOpenMenus();this.resignMenuPane();if(a){a.becomeMenuPane()}return arguments.callee.base.apply(this,arguments)},itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemValueKey:"value",itemIconKey:"icon",itemHeightKey:"height",itemSubMenuKey:"subMenu",itemSeparatorKey:"separator",itemTargetKey:"target",itemActionKey:"action",itemCheckboxKey:"checkbox",itemShortCutKey:"shortcut",itemKeyEquivalentKey:"keyEquivalent",itemDisableMenuFlashKey:"disableMenuFlash",itemLayerIdKey:"layerId",itemExampleViewKey:"exampleView",menuItemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemSeparatorKey","itemActionKey","itemCheckboxKey","itemShortCutKey","itemHeightKey","itemSubMenuKey","itemKeyEquivalentKey","itemTargetKey","itemLayerIdKey"],preferType:SC.PICKER_MENU,isModal:YES,_menuView:null,init:function(){return arguments.callee.base.apply(this,arguments)},displayProperties:["controlSize"],renderDelegateName:"menuRenderDelegate",createChildViews:function(){var b,a,c;b=this.createChildView(SC.MenuScrollView,{borderStyle:SC.BORDER_NONE,controlSize:this.get("controlSize")});a=this._menuView=SC.View.create({parentViewDidResize:function(){this.notifyPropertyChange("frame")},viewDidResize:function(){}});c=this.get("menuItemViews");a.set("layout",{top:0,left:0,height:this.get("menuHeight")});a.replaceAllChildren(c);b.set("contentView",a);this.childViews=[b];return this},paneDidAttach:function(){var a=(this.rootResponder=SC.RootResponder.responder);a.panes.add(this);this.set("currentWindowSize",a.computeWindowSize());this.set("isPaneAttached",YES);this.parentViewDidChange();this._notifyDidAppendToDocument();this.becomeMenuPane();return this},becomeMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(this)}return this},resignMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(null)}return this},menuItemViews:function(){return this.createMenuItemViews()}.property("displayItems").cacheable(),createMenuItemViews:function(){var h=[],p=this.get("displayItems"),a=this.get("exampleView"),t,d,k,o,m,g,b,j,q,c,f,l,i,n,v,u,r;if(!p){return h}m=this.get("itemHeightKey");g=this.get("itemSeparatorKey");exampleViewKey=this.get("itemExampleViewKey");b=this.get("itemHeight");f=this.get("itemKeyEquivalentKey");j=this.get("itemSeparatorHeight");v=this.get("itemLayerIdKey");c=Math.floor(this.get("menuHeightPadding")/2);q=c;i=this.menuItemKeys.map(SC._menu_fetchKeys,this);r=p.get("length");for(n=0;n<r;n++){t=p[n];o=t.get(m);if(!o){o=t.get(g)?j:b}u={layout:{height:o,top:q},contentDisplayProperties:i,content:t,parentMenu:this};if(t.get(v)){u.layerId=t.get(v)}itemExampleView=t.get(exampleViewKey);if(itemExampleView){d=itemExampleView}else{d=a}k=this._menuView.createChildView(d,u);h[n]=k;q+=o;l=t.get(f);if(l){if(SC.typeOf(l)===SC.T_ARRAY){l.forEach(function(w){this._keyEquivalents[w]=k},this)}else{this._keyEquivalents[l]=k}}}this.set("menuHeight",q+c);return h},menuItemViewForContentIndex:function(a){var b=this.get("menuItemViews");if(!b){return undefined}return b.objectAt(a)},_keyEquivalents:{},rootMenu:function(){if(this.get("isSubMenu")){return this.getPath("parentMenu.rootMenu")}return this}.property("isSubMenu").cacheable(),windowSizeDidChange:function(b,a){this.remove();return arguments.callee.base.apply(this,arguments)},displayItems:function(){var d=this.get("items"),c=this.get("localize"),i=this.get("itemHeight"),b,f=[],a,g,h;if(!d){return null}b=d.get("length");for(a=0;a<b;a++){g=d.objectAt(a);if(!g){continue}h=SC.typeOf(g);if(h===SC.T_STRING){g=SC.Object.create({title:g,value:g,isEnabled:YES})}else{if(h===SC.T_HASH){g=SC.Object.create(g)}else{if(h===SC.T_ARRAY){g=this.convertArrayMenuItemToObject(g)}}}g.contentIndex=a;f.push(g)}return f}.property("items").cacheable(),_sc_menu_itemsDidChange:function(){var a=this.get("menuItemViews");this._menuView.replaceAllChildren(a);this._menuView.adjust("height",this.get("menuHeight"))}.observes("items"),convertArrayMenuItemToObject:function(g){SC.Logger.warn("Support for Array-based menu items has been deprecated.  Please update your menus to use a hash.");var f,c=SC._menu_fetchKeys,b=SC._menu_fetchItem,i,d=SC.Object.create(),a,h;f=this.menuItemKeys.map(c,this);d[f[0]]=g[0];d[f[1]]=g[1];d[f[2]]=g[2];d[f[3]]=g[3];d[f[4]]=g[4];d[f[5]]=g[5];d[f[6]]=g[6];d[f[7]]=g[7];d[f[8]]=g[8];d[f[9]]=g[9];d[f[10]]=g[10];d[f[11]]=g[11];d[f[12]]=g[12];return d},currentMenuItem:function(a,b){if(b!==undefined){if(this._currentMenuItem!==null){this.set("previousMenuItem",this._currentMenuItem)}this._currentMenuItem=b;this.setPath("rootMenu.targetMenuItem",b);return b}return this._currentMenuItem}.property().cacheable(),_sc_menu_currentMenuItemDidChange:function(){var a=this.get("currentMenuItem"),b=this.get("previousMenuItem");if(b){if(b.get("hasSubMenu")&&a===null){}else{b.resignFirstResponder();this.closeOpenMenusFor(b)}}if(a&&a.get("isEnabled")){a.scrollToVisible()}}.observes("currentMenuItem"),closeOpenMenusFor:function(a){if(!a){return}var b=a.get("parentMenu");while(b&&a){b=a.get("subMenu");if(b){b.remove();a.resignFirstResponder();a=b.get("previousMenuItem")}}},closeOpenMenus:function(){this.closeOpenMenusFor(this.get("previousMenuItem"))},mouseDown:function(a){this.modalPaneDidClick(a);return YES},mouseEntered:function(a){this.set("mouseHasEntered",YES)},keyUp:function(a){var b=this.interpretKeyEvents(a);return !b?NO:b},moveUp:function(){var c=this.get("currentMenuItem"),d=this.get("menuItemViews"),b,f,a;if(!c){a=d.get("length")-1}else{b=c.getPath("content.contentIndex");if(b===0){return YES}a=b-1}while(a>=0){if(d[a].get("isEnabled")){this.set("currentMenuItem",d[a]);d[a].becomeFirstResponder();break}a--}return YES},moveDown:function(){var d=this.get("currentMenuItem"),f=this.get("menuItemViews"),b=f.get("length"),c,g,a;if(!d){a=0}else{c=d.getPath("content.contentIndex");if(c===b){return YES}a=c+1}while(a<b){if(f[a].get("isEnabled")){this.set("currentMenuItem",f[a]);f[a].becomeFirstResponder();break}a++}return YES},insertText:function(b,a){var d=this._timer,c=this._keyBuffer;if(d){d.invalidate()}d=this._timer=SC.Timer.schedule({target:this,action:"clearKeyBuffer",interval:500,isPooled:NO});c=c||"";c+=b.toUpperCase();this.selectMenuItemForString(c);this._keyBuffer=c;return YES},performKeyEquivalent:function(d,a,b){if(!b&&!this.get("isVisibleInWindow")){return NO}var c=this._keyEquivalents[d];if(c){c.performAction(YES);return YES}if(d==="escape"||d==="return"){this.remove();return YES}return NO},selectMenuItemForString:function(c){var d=this.get("menuItemViews"),g,h,b,a,f;if(!d){return}f=c.length;a=d.get("length");for(b=0;b<a;b++){g=d.objectAt(b);h=g.get("title");if(!h){continue}h=h.replace(/ /g,"").substr(0,f).toUpperCase();if(h===c){this.set("currentMenuItem",g);g.becomeFirstResponder();break}}},clearKeyBuffer:function(){this._keyBuffer=""},modalPaneDidClick:function(a){this.remove();return YES}});SC._menu_fetchKeys=function(a){return this.get(a)};SC._menu_fetchItem=function(a){if(!a){return null}return this.get?this.get(a):this[a]};SC.MenuPane.VERTICAL_OFFSET=23;sc_require("panes/panel");SC.SheetPane=SC.PanelPane.extend({classNames:["sc-sheet"],modalPane:SC.ModalPane,transitionDuration:200,_state:"NO_VIEW",init:function(){arguments.callee.base.apply(this,arguments);if(SC.Animatable){SC.SheetPane.ANIMATABLE_AVAILABLE=YES;this.mixin(SC.Animatable);if(!this.transitions){this.transitions={}}if(!this.transitions.top){this.transitions.top={duration:this.transitionDuration===200?0.3:this.transitionDuration/1000,action:"_complete",target:this}}}},append:function(){var a=this.get("layout");if(!a.height||!a.top){a=SC.View.convertLayoutToAnchoredLayout(a,this.computeParentDimensions())}a.top=-1*a.height;if(this.disableAnimation){this.disableAnimation()}this.adjust(a);this.updateLayout();if(this.enableAnimation){this.enableAnimation()}return arguments.callee.base.apply(this,arguments)},remove:function(){var b=this,a=arguments;this.invokeLater(function(){a.callee.base.apply(b,a)},this.transitionDuration);this.slideUp();return this},paneDidAttach:function(){var a=arguments.callee.base.apply(this,arguments);this.slideDown();return a},slideDown:function(){this._state=SC.SheetPane.ANIMATING;this._direction=SC.SheetPane.SLIDE_DOWN;if(SC.SheetPane.ANIMATABLE_AVAILABLE){this.transitions.top.timing=SC.Animatable.TRANSITION_EASE_OUT;this.adjust("top",0)}else{this._start=Date.now();this._end=this._start+this.get("transitionDuration");this.tick()}},slideUp:function(){this._state=SC.SheetPane.ANIMATING;this._direction=SC.SheetPane.SLIDE_UP;if(SC.SheetPane.ANIMATABLE_AVAILABLE){var a=this.get("layout");this.transitions.top.timing=SC.Animatable.TRANSITION_EASE_IN;this.adjust("top",-1*a.height)}else{this._start=Date.now();this._end=this._start+this.get("transitionDuration");this.tick()}},_complete:function(){var a=this._direction;if(a===SC.SheetPane.SLIDE_DOWN){if(!SC.SheetPane.ANIMATABLE_AVAILABLE){this.adjust("top",0)}this.adjust({centerX:0,left:null});if(SC.browser.isMozilla){this.parentViewDidChange()}}else{var b=this.get("layout");if(!SC.SheetPane.ANIMATABLE_AVAILABLE){this.adjust("top",-1*b.height)}}this._state=SC.SheetPane.READY;this.updateLayout()},blurTo:function(a){this.setFirstResponder("")},tick:function(){this._timer=null;var b=Date.now();var f=(b-this._start)/(this._end-this._start),h=this,a=this._direction,c=this.get("layout"),d,g;if(f<0){f=0}if(f>=1){this._complete();return this}g=Math.floor(c.height*f);if(a==SC.SheetPane.SLIDE_DOWN){h.adjust("top",0-(c.height-g))}else{if(a==SC.SheetPane.SLIDE_UP){h.adjust("top",0-g)}}this._timer=this.invokeLater(this.tick,20);h.updateLayout();return this}});SC.SheetPane.mixin({ANIMATABLE_AVAILABLE:NO,NO_VIEW:"NO_VIEW",ANIMATING:"ANIMATING",READY:"READY",SLIDE_DOWN:"SLIDEDOWN",SLIDE_UP:"SLIDEUP"});SC.BaseTheme.buttonRenderDelegate=SC.RenderDelegate.create({className:"button","sc-small-size":{height:18,autoResizePadding:{width:15,height:0}},"sc-regular-size":{height:24,autoResizePadding:{width:20,height:0}},"sc-huge-size":{height:30,autoResizePadding:{width:30,height:0}},"sc-jumbo-size":{height:44,autoResizePadding:{width:50,height:0}},render:function(a,g){this.addSizeClassName(a,g);var f,b=a.get("toolTip"),h=a.get("isSelected")||NO,k=a.get("isActive")||NO,i=a.get("isDefault")||NO,j=a.get("isCancel")||NO,d=(a.get("buttonBehavior")===SC.TOGGLE_BEHAVIOR),c=SC.guidFor(a)+"-label";g.setClass({icon:!!a.get("icon"),def:i,cancel:j&&!i,active:k,sel:h});if(b){g.attr("title",b);g.attr("alt",b)}this.includeSlices(a,g,SC.THREE_SLICE);if(a.get("isSegment")){g.attr("aria-selected",h.toString())}else{if(d){g.attr("aria-pressed",k.toString())}}g.attr("aria-labelledby",c);g=g.begin("label").addClass("sc-button-label").id(c);a.get("theme").labelRenderDelegate.render(a,g);g=g.end();if(a.get("supportFocusRing")){g=g.begin("div").addClass("focus-ring");this.includeSlices(a,g,SC.THREE_SLICE);g=g.end()}},update:function(f,a){var d=(f.get("buttonBehavior")===SC.TOGGLE_BEHAVIOR);this.updateSizeClassName(f,a);if(f.get("isActive")){a.addClass("active")}var c=f.get("isDefault"),b=f.get("isCancel");if(f.get("isSegment")){a.attr("aria-selected",f.get("isSelected").toString())}else{if(d){a.attr("aria-pressed",f.get("isActive").toString())}}a.attr("title",f.get("toolTip"));a.setClass("icon",!!f.get("icon"));a.setClass("def",!!c);a.setClass("cancel",!!b&&!c);f.get("theme").labelRenderDelegate.update(f,a.find("label"))},getRenderedAutoResizeLayer:function(a,b){return b.find(".sc-button-label")[0]}});SC.BaseTheme.checkboxRenderDelegate=SC.RenderDelegate.create({className:"checkbox",render:function(a,c){this.addSizeClassName(a,c);var f=a.get("theme"),g,b;b=SC.guidFor(a)+"-label";var d=a.get("isSelected")||NO;var j=a.get("isActive");var i=!a.get("isEnabled");var h;if(d===SC.MIXED_STATE){h="mixed"}else{if(d){h="true"}else{h="false"}}c.attr("role","checkbox");c.attr("aria-checked",h);c.attr("aria-labelledby",b);c.setClass({sel:d,active:j,disabled:i});c.push('<span class = "button"></span>');c=c.begin("span").addClass("label").id(b);f.labelRenderDelegate.render(a,c);c=c.end()},update:function(h,c){this.updateSizeClassName(h,c);var g=h.get("theme");var d=h.get("isSelected");var f=h.get("isActive");var b=!h.get("isEnabled");var a;if(d===SC.MIXED_STATE){a="mixed"}else{if(d){a="true"}else{a="false"}}c.attr("aria-checked",a);g.labelRenderDelegate.update(h,c.find("span.label"));c.setClass({sel:d,active:f,disabled:b})}});SC.BaseTheme.collectionRenderDelegate=SC.RenderDelegate.create({className:"collection",render:function(b,a){a.setClass("focus",b.get("hasFirstResponder"));a.setClass("disabled",!b.get("isEnabled"));a.setClass("active",b.get("isActive"))},update:function(b,a){a.setClass("focus",b.get("hasFirstResponder"));a.setClass("disabled",!b.get("isEnabled"));a.setClass("active",b.get("isActive"))}});SC.BaseTheme.disclosureRenderDelegate=SC.RenderDelegate.create({className:"disclosure",render:function(h,a){this.addSizeClassName(h,a);var f=h.get("theme"),c=h.get("value"),g=h.get("title");var d=SC.guidFor(h)+"-label";a.attr("aria-expanded",c);a.attr("aria-labelledby",d);if(h.get("isSelected")){a.addClass("sel")}var b="";b+=h.get("isSelected")?"open":"closed";if(h.get("isActive")){b+=" active"}a.push('<img src = "'+SC.BLANK_IMAGE_URL+'" class = "disclosure button '+b+'" />');a=a.begin("span").addClass("sc-button-label").id(d);f.labelRenderDelegate.render(h,a);a=a.end()},update:function(f,a){this.updateSizeClassName(f,a);var c=f.get("theme"),b=f.get("value"),d=f.get("title");a.attr("aria-expanded",b);if(f.get("isSelected")){a.addClass("sel")}a.find("img").setClass({open:f.get("isSelected"),closed:!f.get("isSelected"),active:f.get("isActive")});c.labelRenderDelegate.update(f,a.find("span.sc-button-label"))}});SC.THREE_SLICE=["left","middle","right"];SC.NINE_SLICE=["top-left","top","top-right","left","middle","right","bottom-left","bottom","bottom-right"];SC.RenderDelegate.reopen({includeSlices:function(f,c,d){for(var b=0,a=d.length;b<a;b++){c.push('<div class="'+d[b]+'"></div>')}}});SC.BaseTheme.imageButtonRenderDelegate=SC.RenderDelegate.create({className:"image-button",render:function(d,b){var c=d.get("image"),a=d.get("toolTip");this.addSizeClassName(d,b);b.addClass("no-min-width");if(a){b.attr("title",a);b.attr("alt",a)}if(c){b.push("<div class='img "+c+"'></div>")}else{b.push("<div class='img'></div>")}},update:function(d,b){var c,a;this.updateSizeClassName(d,b);if(d.didChangeFor("imageButtonRenderDelegate","toolTip")){a=d.get("toolTip");b.attr("title",a);b.attr("alt",a)}c=d.get("image");if(c&&d.didChangeFor("imageButtonRenderDelegate","image")){b.children()[0].className="img "+c}}});SC.BaseTheme.MASTER_DETAIL_DIVIDER_WIDTH=1;SC.BaseTheme.masterDetailRenderDelegate=SC.RenderDelegate.create({className:"master-detail",dividerWidth:1,render:function(b,a){a.setClass("round-toolbars",SC.platform.touch)},update:function(b,a){a.setClass("round-toolbars",SC.platform.touch)}});SC.BaseTheme.panelRenderDelegate=SC.RenderDelegate.create({className:"panel",render:function(f,b){b=b.begin("div").addClass("panel-background");this.includeSlices(f,b,SC.NINE_SLICE);b=b.end();var a=f.get("ariaLabel"),c=f.get("ariaLabelledBy"),d=f.get("ariaDescribedBy");if(a){b.attr("aria-label",a)}if(c){b.attr("aria-labelledby",c)}if(d){b.attr("aria-describedby",d)}},update:function(f,c){var a=f.get("ariaLabel"),b=f.get("ariaLabelledBy"),d=f.get("ariaDescribedBy");if(a){c.attr("aria-label",a)}if(b){c.attr("aria-labelledby",b)}if(d){c.attr("aria-describedby",d)}}});sc_require("render_delegates/panel");SC.BaseTheme.pickerRenderDelegate=SC.RenderDelegate.create({className:"picker",render:function(g,c){var a=g.get("theme").panelRenderDelegate;a.render(g,c);var b=g.get("preferType");var f=g.get("pointerPos");var d=g.get("pointerPosY");if(b==SC.PICKER_POINTER||b==SC.PICKER_MENU_POINTER){c.push('<div class="sc-pointer '+f+'" style="margin-top: '+d+'px"></div>');c.addClass(f)}},update:function(h,g){var a=h.get("theme").panelRenderDelegate;a.update(h,g);var b=h.get("preferType");var f=h.get("pointerPos");var d=h.get("pointerPosY");if(b==SC.PICKER_POINTER||b==SC.PICKER_MENU_POINTER){var c=g.find(".sc-pointer");c.attr("class","sc-pointer "+f);c.attr("style","margin-top: "+d+"px");g.addClass(f)}}});sc_require("render_delegates/picker");SC.BaseTheme.menuRenderDelegate=SC.BaseTheme.pickerRenderDelegate.create({className:"menu",render:function(c,b,a){this.addSizeClassName(b,a);c(b,a)}.enhance(),update:function(c,b,a){this.updateSizeClassName(b,a);c(b,a)}.enhance(),itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:6,menuWidthPadding:50,minimumMenuWidth:50,submenuOffsetX:2,verticalOffset:23,"sc-tiny-size":{itemHeight:10,itemSeparatorHeight:2,menuHeightPadding:2,submenuOffsetX:0},"sc-small-size":{itemHeight:16,itemSeparatorHeight:7,menuHeightPadding:4,submenuOffsetX:2},"sc-large-size":{itemHeight:60,itemSeparatorHeight:20,menuHeightPadding:0,submenuOffsetX:4},"sc-huge-size":{itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:0,submenuOffsetX:0}});SC.BaseTheme.popupButtonRenderDelegate=SC.BaseTheme.buttonRenderDelegate.create({render:function(b,a){a.attr("aria-haspopup","true");arguments.callee.base.apply(this,arguments)},update:function(b,a){arguments.callee.base.apply(this,arguments)}});SC.BaseTheme.progressRenderDelegate=SC.RenderDelegate.create({className:"progress",render:function(h,b){this.addSizeClassName(h,b);var g=h.get("theme"),a=h.get("maximum"),d=h.get("minimum"),c=h.get("ariaValue");var f;if(h.get("isIndeterminate")){f=120}else{f=h.get("value")}b.attr("aria-valuemax",a);b.attr("aria-valuemin",d);b.attr("aria-valuenow",c);b.attr("aria-valuetext",c);b.setClass({indeterminate:h.get("isIndeterminate"),running:h.get("isRunning"),disabled:!h.get("isEnabled"),"sc-empty":(f<=0),"sc-complete":(f>=1)});b=b.begin("div").addClass("track");this.includeSlices(h,b,SC.THREE_SLICE);b=b.end();b=b.begin("div").addClass("content");b.css("width",(f*100)+"%");this.includeSlices(h,b,SC.THREE_SLICE);b=b.end()},update:function(h,f){this.updateSizeClassName(h,f);var g=h.get("theme"),a=h.get("maximum"),c=h.get("minimum"),b=h.get("ariaValue");f.attr("aria-valuemax",a);f.attr("aria-valuemin",c);f.attr("aria-valuenow",b);f.attr("aria-valuetext",b);var d;if(h.get("isIndeterminate")){d=120}else{d=h.get("value")}f.setClass({indeterminate:h.get("isIndeterminate"),running:h.get("isRunning"),disabled:!h.get("isEnabled"),"sc-empty":(d<=0),"sc-complete":(d>=1)});f.find(".content").css("width",(d*100)+"%")}});SC.BaseTheme.radioRenderDelegate=SC.RenderDelegate.create({className:"radio",render:function(g,b){this.addSizeClassName(g,b);var f=g.get("theme");var a=g.get("isSelected"),c=g.get("width"),d=SC.guidFor(g)+"-label";b.setClass({active:g.get("isActive"),mixed:g.get("isMixed"),sel:g.get("isSelected"),disabled:!g.get("isEnabled")});b.attr("role","radio");b.attr("aria-checked",a);b.attr("aria-labelledby",d);b.attr("aria-disabled",g.get("isEnabled")?"false":"true");if(c){b.css("width",c)}b.push('<span class = "button"></span>');b=b.begin("span").addClass("sc-button-label").id(d);f.labelRenderDelegate.render(g,b);b=b.end()},update:function(g,a){this.updateSizeClassName(g,a);var f=g.get("theme");var b=g.get("isSelected"),c=g.get("width"),d=g.get("value");a.setClass({active:g.get("isActive"),mixed:g.get("isMixed"),sel:g.get("isSelected"),disabled:!g.get("isEnabled")});a.attr("aria-disabled",g.get("isEnabled")?"false":"true");a.attr("aria-checked",b);a.css("width",c?c:null);f.labelRenderDelegate.update(g,a.find(".sc-button-label"))}});SC.BaseTheme.radioGroupRenderDelegate=SC.RenderDelegate.create({className:"radio-group",render:function(i,f){this.addSizeClassName(i,f);var h=i.get("theme"),d=SC.guidFor(this),c=i.get("items"),b,a=c.length,g;f.addClass(i.get("layoutDirection"));f.attr("role","radiogroup");f.attr("aria-disabled",i.get("isEnabled")?"false":"true");for(b=0;b<a;b++){g=c[b];f=f.begin("div").addClass("radio-"+b).attr("index",b).addClass(h.classNames).addClass(h.radioRenderDelegate.className).addClass("sc-radio-button");h.radioRenderDelegate.render(g,f);f=f.end()}i.get("renderState").radioCount=b},update:function(a,d){this.updateSizeClassName(a,d);var f=a.get("theme"),b=SC.guidFor(this),h=a.get("items"),i,g=h.length,j;d.addClass(a.get("layoutDirection"));d.attr("aria-disabled",a.get("isEnabled")?"false":"true");if(a.get("renderState").radioCount!==g){var c=SC.RenderContext(d[0]);this.render(a,c);c.update();return}for(i=0;i<g;i++){j=h[i];f.radioRenderDelegate.update(j,d.find(".radio-"+i))}},updateRadioAtIndex:function(d,a,b){var c=d.get("items")[b];d.get("theme").radioRenderDelegate.update(c,a.find(".radio-"+b))},indexForEvent:function(d,b,a){var c=$(a.target).closest(".sc-radio-button").attr("index");if(isNaN(c)){return undefined}return parseInt(c,0)}});SC.BaseTheme.segmentRenderDelegate=SC.RenderDelegate.create({className:"segment",render:function(f,b){var c=f.get("theme"),d,a;a={"sc-first-segment":f.get("isFirstSegment"),"sc-middle-segment":f.get("isMiddleSegment"),"sc-last-segment":f.get("isLastSegment"),"sc-overflow-segment":f.get("isOverflowSegment"),vertical:f.get("layoutDirection")!==SC.LAYOUT_HORIZONTAL};if(!SC.none(f.get("index"))){a["sc-segment-"+f.get("index")]=YES}b.setClass(a);d=c.buttonRenderDelegate;d.render(f,b)},update:function(f,a){var c=f.get("theme"),d,b={};b={"sc-first-segment":f.get("isFirstSegment"),"sc-middle-segment":f.get("isMiddleSegment"),"sc-last-segment":f.get("isLastSegment"),"sc-overflow-segment":f.get("isOverflowSegment")||NO,vertical:f.get("layoutDirection")!==SC.LAYOUT_HORIZONTAL};if(!SC.none(f.get("index"))){b["sc-segment-"+f.get("index")]=YES}a.setClass(b);d=c.buttonRenderDelegate;d.update(f,a)}});SC.BaseTheme.segmentedRenderDelegate=SC.RenderDelegate.create({className:"segmented",render:function(b,a){this.addSizeClassName(b,a);a.addStyle("text-align",b.get("align"))},update:function(b,a){this.updateSizeClassName(b,a);a.css("text-align",b.get("align"))}});SC.BaseTheme.sliderRenderDelegate=SC.RenderDelegate.create({className:"slider",render:function(g,c){this.addSizeClassName(g,c);var b=SC.BLANK_IMAGE_URL,a=g.get("maximum"),f=g.get("minimum"),d=g.get("ariaValue");c.attr("aria-valuemax",a);c.attr("aria-valuemin",f);c.attr("aria-valuenow",d);if(f!==0||a!==100){c.attr("aria-valuetext",d)}c.attr("aria-orientation","horizontal");c=c.begin("span").addClass("track");this.includeSlices(g,c,SC.THREE_SLICE);c.push('<img src="'+b+'" class="sc-handle" style="left: '+g.get("value")+'%" /></span>');c=c.end();g.get("renderState")._cachedHandle=null},update:function(i,b){this.updateSizeClassName(i,b);var a=i.get("maximum"),d=i.get("minimum"),c=i.get("ariaValue");b.attr("aria-valuemax",a);b.attr("aria-valuemin",d);b.attr("aria-valuenow",c);if(d!==0||a!==100){b.attr("aria-valuetext",c)}b.attr("aria-orientation","horizontal");if(i.didChangeFor("sliderRenderDelegate","value")){var g=i.get("renderState")._cachedHandle;if(!g){g=i.get("renderState")._cachedHandle=b.find(".sc-handle")}var h=i.get("frame"),f=i.get("value");g.css("left",f+"%")}}});SC.BaseTheme.SourceList=SC.BaseTheme.subtheme("source-list");SC.BaseTheme.toolbarRenderDelegate=SC.RenderDelegate.create({className:"toolbar",render:function(b,a){},update:function(){}});SC.BaseTheme.wellRenderDelegate=SC.RenderDelegate.create({className:"well",render:function(b,a){this.includeSlices(b,a,SC.NINE_SLICE)},update:function(){}});SC.BaseTheme.workspaceRenderDelegate=SC.RenderDelegate.create({className:"workspace",render:function(){},update:function(){}});SC.DRAG_LINK=4;SC.DRAG_COPY=1;SC.DRAG_MOVE=2;SC.DRAG_NONE=0;SC.DRAG_ANY=15;SC.DRAG_DATA=8;SC.DRAG_AUTOSCROLL_ZONE_THICKNESS=20;SC.View.reopen({init:function(a){a();if(this.get("isDropTarget")){SC.Drag.addDropTarget(this)}if(this.get("isScrollable")){SC.Drag.addScrollableView(this)}}.enhance(),destroy:function(a){if(this.get("isDropTarget")){SC.Drag.removeDropTarget(this)}if(this.get("isScrollable")){SC.Drag.removeScrollableView(this)}return a()}.enhance()});SC.Drag=SC.Object.extend({source:null,ghostView:null,ghostActsLikeCursor:NO,dragView:null,ghost:YES,sourceIsDraggable:YES,slideBack:YES,ghostOffset:{x:0,y:0},location:{},dataTypes:function(){if(this.dataSource){return this.dataSource.get("dragDataTypes")||[]}var d=this.data;if(d){var a=[];for(var b in d){if(d.hasOwnProperty(b)){a.push(b)}}return a}var c=this.get("source");if(c&&c.dragDataTypes){return c.get("dragDataTypes")||[]}return[]}.property().cacheable(),hasDataType:function(a){return(this.get("dataTypes").indexOf(a)>=0)},dataForType:function(a){if(this.dataSource){return this.dataSource.dragDataForType(this,a)}else{if(this.data){return this.data[a]}else{var b=this.get("source");if(b&&SC.typeOf(b.dragDataForType)===SC.T_FUNCTION){return b.dragDataForType(this,a)}else{return null}}}},dataSource:null,data:null,allowedDragOperations:SC.DRAG_ANY,_dragInProgress:YES,_dragViewWasVisible:null,startDrag:function(){if(this.get("sourceIsDraggable")){this._createGhostView()}var i=this.event;var f={x:i.pageX,y:i.pageY};this.set("location",f);if(this.get("sourceIsDraggable")){var b=this._getDragView();var j=b.get("parentView");var h=j?j.convertFrameToView(b.get("frame"),null):b.get("frame");if(this.get("ghost")){this._dragViewWasVisible=b.get("isVisible");b.set("isVisible",NO)}if(this.ghostActsLikeCursor){this.ghostOffset={x:14,y:14}}else{this.ghostOffset={x:(f.x-h.x),y:(f.y-h.y)}}if(!this._ghostViewHidden){this._positionGhostView(i)}if(i.makeTouchResponder){var k=this;SC.Timer.schedule({target:i,action:function(){if(!i.hasEnded){i.makeTouchResponder(k,YES)}},interval:1})}else{this.ghostView.rootResponder.dragDidStart(this,i)}}var a=this.source;if(a&&a.dragDidBegin){a.dragDidBegin(this,f)}var c=this._dropTargets();for(var g=0,d=c.length;g<d;g++){c[g].tryToPerform("dragStarted",this,i)}},cancelDrag:function(){var b=this._lastTarget,c=this.get("location");if(b&&b.dragExited){b.dragExited(this,this._lastMouseDraggedEvent)}if(this.get("sourceIsDraggable")){this._destroyGhostView();if(this.get("ghost")){if(this._dragViewWasVisible){this._getDragView().set("isVisible",YES)}this._dragViewWasVisible=null}}var a=this.source;if(a&&a.dragDidEnd){a.dragDidEnd(this,c,SC.DRAG_NONE)}this._lastTarget=null;this._dragInProgress=NO},touchStart:function(a){return YES},mouseDragged:function(a){var b=this._autoscroll(a);var g=this.get("location");if(!b&&(a.pageX===g.x)&&(a.pageY===g.y)){return}g={x:a.pageX,y:a.pageY};this.set("location",g);this._lastMouseDraggedEvent=a;var d=this.source;var c=this._lastTarget;var f=this._findDropTarget(a);var h=SC.DRAG_NONE;while(f&&(f!==c)&&(h===SC.DRAG_NONE)){if(f&&d&&d.dragSourceOperationMaskFor){h=d.dragSourceOperationMaskFor(this,f)}else{h=SC.DRAG_ANY}if((h!==SC.DRAG_NONE)&&f&&f.computeDragOperations){h=h&f.computeDragOperations(this,a,h)}else{h=SC.DRAG_NONE}this.allowedDragOperations=h;if(h===SC.DRAG_NONE){f=this._findNextDropTarget(f)}}if(f!==c){if(c&&c.dragExited){c.dragExited(this,a)}if(f){if(f.dragEntered){f.dragEntered(this,a)}if(f.dragUpdated){f.dragUpdated(this,a)}}this._lastTarget=f}else{if(f&&f.dragUpdated){f.dragUpdated(this,a)}}if(d&&d.dragDidMove){d.dragDidMove(this,g)}if(this.get("sourceIsDraggable")&&!this._ghostViewHidden){this._positionGhostView(a)}},touchesDragged:function(a){this.mouseDragged(a)},mouseUp:function(l){var g={x:l.pageX,y:l.pageY},h=this._lastTarget,d=this.allowedDragOperations;this.set("location",g);try{if(h&&h.acceptDragOperation&&h.acceptDragOperation(this,d)){d=h.performDragOperation?h.performDragOperation(this,d):SC.DRAG_NONE}else{d=SC.DRAG_NONE}}catch(i){SC.Logger.error("Exception in SC.Drag.mouseUp(acceptDragOperation|performDragOperation): %@".fmt(i))}try{if(h&&h.dragExited){h.dragExited(this,l)}}catch(j){SC.Logger.error("Exception in SC.Drag.mouseUp(target.dragExited): %@".fmt(j))}var c=this._dropTargets();for(var k=0,f=c.length;k<f;k++){try{c[k].tryToPerform("dragEnded",this,l)}catch(b){SC.Logger.error("Exception in SC.Drag.mouseUp(dragEnded on %@): %@".fmt(c[k],b))}}if(this.get("sourceIsDraggable")){this._destroyGhostView();if(this.get("ghost")){if(this._dragViewWasVisible){this._getDragView().set("isVisible",YES)}this._dragViewWasVisible=null}}var a=this.source;if(a&&a.dragDidEnd){a.dragDidEnd(this,g,d)}this._lastTarget=null;this._dragInProgress=NO},touchEnd:function(a){this.mouseUp(a)},_getDragView:function(){if(!this.dragView){if(!this.source||!this.source.isView){throw"Source can't be used as dragView, because it's not a view."}this.dragView=this.source}return this.dragView},_createGhostView:function(){var c=this,b=this._getDragView(),d=b.get("frame"),a;a=this.ghostView=SC.Pane.create({classNames:["sc-ghost-view"],layout:{top:d.y,left:d.x,width:d.width,height:d.height},owner:this,didCreateLayer:function(){if(b){var f=b.get("layer");if(f){f=f.cloneNode(true);f.style.top="0px";f.style.left="0px";this.get("layer").appendChild(f)}}}});a.append()},_positionGhostView:function(a){var c=this.get("location");c.x-=this.ghostOffset.x;c.y-=this.ghostOffset.y;var b=this.ghostView;if(b){b.adjust({top:c.y,left:c.x});b.invokeOnce("updateLayout")}},_ghostViewHidden:NO,hideGhostView:function(){if(this.ghostView&&!this._ghostViewHidden){this.ghostView.remove();this._ghostViewHidden=YES}},unhideGhostView:function(){if(this._ghostViewHidden){this._ghostViewHidden=NO;this._createGhostView()}},_destroyGhostView:function(){if(this.ghostView){this.ghostView.remove();this.ghostView=null;this._ghostViewHidden=NO}},_dropTargets:function(){if(this._cachedDropTargets){return this._cachedDropTargets}var b=[];var d=SC.Drag._dropTargets;for(var c in d){if(d.hasOwnProperty(c)){b.push(d[c])}}var g={};var f=SC.Drag._dropTargets;var a=function(h){if(!h){return 0}var j=SC.guidFor(h);var i=g[j];if(!i){i=1;while(h=h.get("parentView")){if(f[SC.guidFor(h)]!==undefined){i=i+1}if(h.isPane&&h.isMainPane){i=i+10000}}g[j]=i}return i};b.sort(function(i,h){if(i===h){return 0}i=a(i);h=a(h);return(i>h)?-1:1});this._cachedDropTargets=b;return b},_findDropTarget:function(c){var h={x:c.pageX,y:c.pageY};var f,g;var d=this._dropTargets();for(var b=0,a=d.length;b<a;b++){f=d[b];if(!f.get("isVisibleInWindow")){continue}g=f.convertFrameToView(f.get("clippingFrame"),null);if(SC.pointInRect(h,g)){return f}}return null},_findNextDropTarget:function(a){var b=SC.Drag._dropTargets;while(a=a.get("parentView")){if(b[SC.guidFor(a)]){return a}}return null},_autoscroll:function(m){if(!m){m=this._lastAutoscrollEvent}if(!this._dragInProgress){return NO}var h=m?{x:m.pageX,y:m.pageY}:this.get("location"),i=this._findScrollableView(h),n=null,l,c,d,j,b,a,g;while(i&&!n){l=i.get("canScrollVertical")?1:0;c=i.get("canScrollHorizontal")?1:0;if(l||c){a=i.get("containerView");if(a){g=i.convertFrameToView(a.get("frame"),null)}else{l=c=0}}if(l){j=SC.maxY(g);d=j-SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.y>=d&&h.y<=j){l=1}else{d=SC.minY(g);j=d+SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.y>=d&&h.y<=j){l=-1}else{l=0}}}if(c){j=SC.maxX(g);d=j-SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.x>=d&&h.x<=j){c=1}else{d=SC.minX(g);j=d+SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.x>=d&&h.x<=j){c=-1}else{c=0}}}if(l||c){n=i}else{i=this._findNextScrollableView(i)}}if(n&&(this._lastScrollableView===n)){if((Date.now()-this._hotzoneStartTime)>100){this._horizontalScrollAmount*=1.05;this._verticalScrollAmount*=1.05}}else{this._lastScrollableView=n;this._horizontalScrollAmount=15;this._verticalScrollAmount=15;this._hotzoneStartTime=(n)?Date.now():null;c=l=0}if(n&&(c||l)){var k={x:c*this._horizontalScrollAmount,y:l*this._verticalScrollAmount};n.scrollBy(k)}if(n){if(m){this._lastAutoscrollEvent={pageX:m.pageX,pageY:m.pageY}}this.invokeLater(this._autoscroll,100,null);return YES}else{this._lastAutoscrollEvent=null;return NO}},_scrollableViews:function(){if(this._cachedScrollableView){return this._cachedScrollableView}var a=[];var c=SC.Drag._scrollableViews;for(var b in c){if(c.hasOwnProperty(b)){a.push(c[b])}}a=a.sort(function(g,d){var f=g;while(f=f.get("parentView")){if(d===f){return -1}}return 1});this._cachedScrollableView=a;return a},_findScrollableView:function(g){var c=this._scrollableViews(),b=c?c.length:0,d,f,a;for(a=0;a<b;a++){d=c[a];if(!d.get("isVisibleInWindow")){continue}f=d.convertFrameToView(d.get("clippingFrame"),null);if(SC.pointInRect(g,f)){return d}}return null},_findNextScrollableView:function(a){var b=SC.Drag._scrollableViews;while(a=a.get("parentView")){if(b[SC.guidFor(a)]){return a}}return null}});SC.Drag.mixin({start:function(b){var a=this.create(b);a.startDrag();return a},_dropTargets:{},_scrollableViews:{},addDropTarget:function(a){this._dropTargets[SC.guidFor(a)]=a},removeDropTarget:function(a){delete this._dropTargets[SC.guidFor(a)]},addScrollableView:function(a){this._scrollableViews[SC.guidFor(a)]=a},removeScrollableView:function(a){delete this._scrollableViews[SC.guidFor(a)]}});SC.MODIFIED_KEY_BINDINGS={"ctrl_.":"cancel",shift_tab:"insertBacktab",shift_left:"moveLeftAndModifySelection",shift_right:"moveRightAndModifySelection",shift_up:"moveUpAndModifySelection",shift_down:"moveDownAndModifySelection",alt_left:"moveLeftAndModifySelection",alt_right:"moveRightAndModifySelection",alt_up:"moveUpAndModifySelection",alt_down:"moveDownAndModifySelection",ctrl_a:"selectAll"};SC.BASE_KEY_BINDINGS={escape:"cancel",backspace:"deleteBackward","delete":"deleteForward","return":"insertNewline",tab:"insertTab",left:"moveLeft",right:"moveRight",up:"moveUp",down:"moveDown",home:"moveToBeginningOfDocument",end:"moveToEndOfDocument",pagedown:"pageDown",pageup:"pageUp"};SC.UndoManager=SC.Object.extend({undoActionName:function(){return this.undoStack?this.undoStack.name:null}.property("undoStack"),redoActionName:function(){return this.redoStack?this.redoStack.name:null}.property("redoStack"),canUndo:function(){return this.undoStack!=null}.property("undoStack"),canRedo:function(){return this.redoStack!=null}.property("redoStack"),undo:function(){this._undoOrRedo("undoStack","isUndoing")},redo:function(){this._undoOrRedo("redoStack","isRedoing")},isUndoing:NO,isRedoing:NO,groupingLevel:0,registerUndo:function(b,a){this.beginUndoGroup(a);this._activeGroup.actions.push(b);this.endUndoGroup(a)},beginUndoGroup:function(b){if(this._activeGroup){this.groupingLevel++}else{var a=this.isUndoing?"redoStack":"undoStack";this._activeGroup={name:b,actions:[],prev:this.get(a)};this.set(a,this._activeGroup);this.groupingLevel=1}},endUndoGroup:function(a){if(!this._activeGroup){raise("endUndoGroup() called outside group.")}if(this.groupingLevel>1){this.groupingLevel--}else{this._activeGroup=null;this.groupingLevel=0}this.propertyDidChange(this.isUndoing?"redoStack":"undoStack")},setActionName:function(a){if(!this._activeGroup){raise("setActionName() called outside group.")}this._activeGroup.name=a},_activeGroup:null,undoStack:null,redoStack:null,_undoOrRedo:function(a,c){if(this._activeGroup){return false}if(this.get(a)==null){return true}this.set(c,true);var f=this.get(a);this.set(a,f.prev);var b;var d=f.actions.length>1;if(d){this.beginUndoGroup(f.name)}while(b=f.actions.pop()){b()}if(d){this.endUndoGroup(f.name)}this.set(c,false)}});SC.CheckboxView=SC.ButtonView.extend(SC.StaticLayout,{classNames:["sc-checkbox-view","sc-checkbox-control"],ariaRole:"checkbox",themeName:null,renderDelegateName:"checkboxRenderDelegate",needsEllipsis:NO,acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),_toggleValue:function(){var a=this.get("value")===this.get("toggleOnValue");this.set("value",a?this.get("toggleOffValue"):this.get("toggleOnValue"))},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;if(a&&this.get("acceptsFirstResponder")){a.allowDefault()}return YES},mouseUp:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",NO);this._isMouseDown=NO;if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.$().within(a.target)){this._toggleValue();this._action(a)}}return YES},keyDown:function(b){if(!this.get("isEnabled")){return YES}if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(b.which===13||b.which===32){this._toggleValue();if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.$().within(b.target)){this._action(b)}}return YES}b.allowDefault();return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)}});SC.LIST_ITEM_ACTION_CANCEL="sc-list-item-cancel-action";SC.LIST_ITEM_ACTION_REFRESH="sc-list-item-cancel-refresh";SC.LIST_ITEM_ACTION_EJECT="sc-list-item-cancel-eject";SC.ListItemView=SC.View.extend(SC.InlineEditable,SC.Control,{classNames:["sc-list-item-view"],displayProperties:["disclosureState","escapeHTML"],content:null,contentIndex:null,hasContentIcon:NO,hasContentRightIcon:NO,hasContentBranch:NO,contentCheckboxKey:null,icon:null,contentIconKey:null,rightIcon:null,contentRightIconKey:null,contentValueKey:null,escapeHTML:YES,contentUnreadCountKey:null,contentIsBranchKey:null,outlineIndent:16,outlineLevel:0,disclosureState:SC.LEAF_NODE,validator:null,contentKeys:{contentValueKey:"title",contentCheckboxKey:"checkbox",contentIconKey:"icon",contentRightIconKey:"rightIcon",contentUnreadCountKey:"count",contentIsBranchKey:"branch"},contentPropertyDidChange:function(){if(this.get("contentIsEditable")!==this.contentIsEditable()){this.notifyPropertyChange("contentIsEditable")}this.displayDidChange()},contentIsEditable:function(){var a=this.get("content");return a&&(a.get?a.get("isEditable")!==NO:NO)}.property("content").cacheable(),inlineEditorDelegate:SC.InlineTextFieldDelegate,$label:function(){return this.$("label")},_isInsideElementWithClassName:function(f,a){var c=this.get("layer");if(!c){return NO}var d=SC.$(a.target);var b=NO,g;while(!b&&d.length>0&&(d[0]!==c)){if(d.hasClass(f)){b=YES}d=d.parent()}d=c=null;return b},_isInsideCheckbox:function(b){var a=this.displayDelegate;var c=this.getDelegateProperty("contentCheckboxKey",a);return c&&this._isInsideElementWithClassName("sc-checkbox-view",b)},_isInsideDisclosure:function(a){if(this.get("disclosureState")===SC.LEAF_NODE){return NO}return this._isInsideElementWithClassName("sc-disclosure-view",a)},_isInsideRightIcon:function(c){var b=this.displayDelegate;var a=this.getDelegateProperty("hasContentRightIcon",b)||!SC.none(this.rightIcon);return a&&this._isInsideElementWithClassName("right-icon",c)},mouseDown:function(a){if(!this.get("contentIsEditable")){return NO}if(this._isInsideCheckbox(a)){this._addCheckboxActiveState();this._isMouseDownOnCheckbox=YES;this._isMouseInsideCheckbox=YES;return YES}else{if(this._isInsideDisclosure(a)){this._addDisclosureActiveState();this._isMouseDownOnDisclosure=YES;this._isMouseInsideDisclosure=YES;return YES}else{if(this._isInsideRightIcon(a)){this._addRightIconActiveState();this._isMouseDownOnRightIcon=YES;this._isMouseInsideRightIcon=YES;return YES}}}return NO},mouseUp:function(i){var c=NO,j,d,b,a,h,g;if(this._isMouseDownOnCheckbox){if(this._isInsideCheckbox(i)){j=this.displayDelegate;d=this.getDelegateProperty("contentCheckboxKey",j);b=this.get("content");if(b&&b.get){var f=b.get(d);f=(f===SC.MIXED_STATE)?YES:!f;b.set(d,f);this.displayDidChange()}}this._removeCheckboxActiveState();c=YES}else{if(this._isMouseDownOnDisclosure){if(this._isInsideDisclosure(i)){a=this.get("disclosureState");h=this.get("contentIndex");g=(!SC.none(h))?SC.IndexSet.create(h):null;j=this.get("displayDelegate");if(a===SC.BRANCH_OPEN){if(g&&j&&j.collapse){j.collapse(g)}else{this.set("disclosureState",SC.BRANCH_CLOSED)}this.displayDidChange()}else{if(a===SC.BRANCH_CLOSED){if(g&&j&&j.expand){j.expand(g)}else{this.set("disclosureState",SC.BRANCH_OPEN)}this.displayDidChange()}}}this._removeDisclosureActiveState();c=YES}else{if(this._isMouseDownOnRightIcon){this._removeRightIconActiveState();c=YES}}}this._isMouseInsideCheckbox=this._isMouseDownOnCheckbox=NO;this._isMouseDownOnDisclosure=this._isMouseInsideDisclosure=NO;this._isMouseInsideRightIcon=this._isMouseDownOnRightIcon=NO;return c},mouseMoved:function(a){if(this._isMouseDownOnCheckbox&&this._isInsideCheckbox(a)){this._addCheckboxActiveState();this._isMouseInsideCheckbox=YES}else{if(this._isMouseDownOnCheckbox){this._removeCheckboxActiveState();this._isMouseInsideCheckbox=NO}else{if(this._isMouseDownOnDisclosure&&this._isInsideDisclosure(a)){this._addDisclosureActiveState();this._isMouseInsideDisclosure=YES}else{if(this._isMouseDownOnDisclosure){this._removeDisclosureActiveState();this._isMouseInsideDisclosure=NO}else{if(this._isMouseDownOnRightIcon&&this._isInsideRightIcon(a)){this._addRightIconActiveState();this._isMouseInsideRightIcon=YES}else{if(this._isMouseDownOnRightIcon){this._removeRightIconActiveState();this._isMouseInsideRightIcon=NO}}}}}}return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},touchEntered:function(a){return this.mouseEntered(a)},touchExited:function(a){return this.mouseExited(a)},_addCheckboxActiveState:function(){if(this.get("isEnabled")){if(this._checkboxRenderDelegate){var a=this._checkboxRenderSource;a.set("isActive",YES);this._checkboxRenderDelegate.update(a,this.$(".sc-checkbox-view"))}else{this.$(".sc-checkbox-view").addClass("active")}}},_removeCheckboxActiveState:function(){if(this._checkboxRenderer){var a=this._checkboxRenderSource;a.set("isActive",NO);this._checkboxRenderDelegate.update(a,this.$(".sc-checkbox-view"))}else{this.$(".sc-checkbox-view").removeClass("active")}},_addDisclosureActiveState:function(){if(this.get("isEnabled")){if(this._disclosureRenderDelegate){var a=this._disclosureRenderSource;a.set("isActive",YES);this._disclosureRenderDelegate.update(a,this.$(".sc-disclosure-view"))}else{this.$(".sc-disclosure-view").addClass("active")}}},_removeDisclosureActiveState:function(){if(this._disclosureRenderer){var a=this._disclosureRenderSource;a.set("isActive",NO);this._disclosureRenderDelegate.update(a,this.$(".sc-disclosure-view"))}else{this.$(".sc-disclosure-view").addClass("active")}},_addRightIconActiveState:function(){this.$("img.right-icon").setClass("active",YES)},_removeRightIconActiveState:function(){this.$("img.right-icon").removeClass("active")},contentHitTest:function(b){var a=this.displayDelegate;var c=this.getDelegateProperty("contentValueKey",a);if(!c){return NO}var f=this.$label()[0];if(!f){return NO}var g=b.target,d=this.get("layer");while(g&&(g!==d)&&(g!==window)){if(g===f){return YES}g=g.parentNode}return NO},beginEditing:function(d,c){var g=this.$label(),f=this.get("parentView");if(c&&this.scrollToVisible()){var b=this.get("owner"),a=this.get("contentIndex");this.invokeLast(function(){var h=b.itemViewForContentIndex(a);if(h&&h.beginEditing){h.beginEditing(NO)}});return YES}else{if(!f||!g||g.get("length")===0){return NO}else{return d()}}}.enhance(),inlineEditorWillBeginEditing:function(d,p,o){var q=this.get("content"),j=this.get("displayDelegate"),i=this.getDelegateProperty("contentValueKey",j),k=this.get("parentView"),a=this.$label(),g=this.get("validator"),t,l,h,b,m,c,n,u,r,w;l=(i&&q)?(q.get?q.get(i):q[i]):q;t=this.computeFrameWithParentFrame(null);c=this._oldLineHeight=a.css("lineHeight");b=a.css("fontSize");m=this.$().css("top");if(m){m=parseInt(m.substring(0,m.length-2),0)}else{m=0}u=0;if(b&&c){r=b*1.5;if(r<c){a.css({lineHeight:"1.5"});u=(c-r)/2}else{oldLineHeight=null}}a=a[0];h=SC.offset(a);t.x=h.x;t.y=h.y+m+u;t.height=a.offsetHeight;t.width=a.offsetWidth;n=this.get("escapeHTML");d.set({value:l,exampleFrame:t,exampleElement:a,multiline:NO,isCollection:YES,validator:g,escapeHTML:n})},inlineEditorShouldBeginEditing:function(a){return YES},inlineEditorDidBeginEditing:function(b,d,f,a){b(d,f,a);var c=this.$label();this._oldOpacity=c.css("opacity");c.css("opacity",0);if(this._oldLineHeight){c.css({lineHeight:this._oldLineHeight})}}.enhance(),inlineEditorDidCommitEditing:function(d,g,c){var f=this.get("content");var a=this.displayDelegate;var b=this.getDelegateProperty("contentValueKey",a);if(b&&f){if(f.set){f.set(b,g)}else{f[b]=g}}else{this.set("content",g)}this.displayDidChange();this._endEditing()},_endEditing:function(a){this.$label().css("opacity",this._oldOpacity);a()}.enhance(),render:function(c,a){var g=this.get("content"),n=this.displayDelegate,b=this.get("outlineLevel"),f=this.get("outlineIndent"),m,k,j,o=[];o.push((this.get("contentIndex")%2===0)?"even":"odd");c.setClass("disabled",!this.get("isEnabled"));j=c.begin("div").addClass("sc-outline");if(b>=0&&f>0){j.addStyle("left",f*(b+1))}k=this.get("disclosureState");if(k!==SC.LEAF_NODE){this.renderDisclosure(j,k);o.push("has-disclosure")}m=this.getDelegateProperty("contentCheckboxKey",n);if(m){k=g?(g.get?g.get(m):g[m]):NO;if(k!==null){this.renderCheckbox(j,k);o.push("has-checkbox")}}if(this.getDelegateProperty("hasContentIcon",n)){m=this.getDelegateProperty("contentIconKey",n);k=(m&&g)?(g.get?g.get(m):g[m]):null;this.renderIcon(j,k);o.push("has-icon")}else{if(this.get("icon")){k=this.get("icon");this.renderIcon(j,k);o.push("has-icon")}}m=this.getDelegateProperty("contentValueKey",n);k=(m&&g)?(g.get?g.get(m):g[m]):g;if(k&&SC.typeOf(k)!==SC.T_STRING){k=k.toString()}if(this.get("escapeHTML")){k=SC.RenderContext.escapeHTML(k)}this.renderLabel(j,k);if(this.getDelegateProperty("hasContentRightIcon",n)){m=this.getDelegateProperty("contentRightIconKey",n);k=(m&&g)?(g.get?g.get(m):g[m]):null;this.renderRightIcon(j,k);o.push("has-right-icon")}m=this.getDelegateProperty("contentUnreadCountKey",n);k=(m&&g)?(g.get?g.get(m):g[m]):null;if(!SC.none(k)&&(k!==0)){this.renderCount(j,k);var d=["zero","one","two","three","four","five"];var l=k.toString().length;var i=d.length;var h=(l<i)?d[l]:d[i-1];o.push("has-count "+h+"-digit")}m=this.getDelegateProperty("listItemActionProperty",n);k=(m&&g)?(g.get?g.get(m):g[m]):null;if(k){this.renderAction(j,k);o.push("has-action")}if(this.getDelegateProperty("hasContentBranch",n)){m=this.getDelegateProperty("contentIsBranchKey",n);k=(m&&g)?(g.get?g.get(m):g[m]):NO;this.renderBranch(j,k);o.push("has-branch")}c.addClass(o);c=j.end()},renderDisclosure:function(a,d){var c=this.get("theme").disclosureRenderDelegate;a=a.begin("div").addClass("sc-disclosure-view").addClass("sc-regular-size").addClass(this.get("theme").classNames).addClass(c.get("className"));var b=this._disclosureRenderSource;if(!b){this._disclosureRenderSource=b=SC.Object.create({renderState:{},theme:this.get("theme")})}b.set("isSelected",d===SC.BRANCH_OPEN).set("isEnabled",this.get("isEnabled")).set("title","");c.render(b,a);a=a.end();this._disclosureRenderDelegate=c},renderCheckbox:function(a,d){var c=this.get("theme").checkboxRenderDelegate;a=a.begin("div").addClass("sc-checkbox-view").addClass("sc-regular-size").addClass(this.get("theme").classNames).addClass(c.get("className"));var b=this._checkboxRenderSource;if(!b){b=this._checkboxRenderSource=SC.Object.create({renderState:{},theme:this.get("theme")})}b.set("isSelected",d&&(d!==SC.MIXED_STATE)).set("isEnabled",this.get("isEnabled")&&this.get("contentIsEditable")).set("isActive",this._checkboxIsActive).set("title","");c.render(b,a);a=a.end();this._checkboxRenderDelegate=c},renderIcon:function(c,f){var b=null,d=null,a=[];if(f&&SC.ImageView.valueIsUrl(f)){b=f;d=""}else{d=f;b=SC.BLANK_IMAGE_URL}a.push(d,"icon");c.begin("img").addClass(a).attr("src",b).end()},renderLabel:function(b,a){b.push("<label>",a||"","</label>")},renderRightIcon:function(c,f){var b=null,d=null,a=[];if(f&&SC.ImageView.valueIsUrl(f)){b=f;d=""}else{d=f;b=SC.BLANK_IMAGE_URL}a.push("right-icon",d);c.begin("img").addClass(a).attr("src",b).end()},renderCount:function(a,b){a.push('<span class="count"><span class="inner">',b.toString(),"</span></span>")},renderAction:function(a,b){a.push('<img src="',SC.BLANK_IMAGE_URL,'" class="action" />')},renderBranch:function(c,b){var a=[];a.push("branch",b?"branch-visible":"branch-hidden");c.begin("span").addClass(a).push("&nbsp;").end()}});SC.ListItemView._deprecatedRenderWarningHasBeenIssued=false;sc_require("mixins/collection_view_delegate");sc_require("views/list_item");SC.DRAG_REORDER=16;SC.BENCHMARK_RELOAD=NO;SC.CollectionView=SC.View.extend(SC.CollectionViewDelegate,SC.CollectionContent,{classNames:["sc-collection-view"],displayProperties:["hasFirstResponder","isEnabled","isActive"],renderDelegateName:"collectionRenderDelegate",ACTION_DELAY:200,useFastPath:NO,content:null,contentBindingDefault:SC.Binding.multiple(),length:0,nowShowing:function(){return this.computeNowShowing()}.property("length","clippingFrame").cacheable(),selection:null,isSelectable:YES,isSelectableBindingDefault:SC.Binding.bool(),isEnabled:YES,isEnabledBindingDefault:SC.Binding.bool(),isEditable:YES,isEditableBindingDefault:SC.Binding.bool(),canReorderContent:NO,canReorderContentBindingDefault:SC.Binding.bool(),canDeleteContent:NO,canDeleteContentBindingDefault:SC.Binding.bool(),canEditContent:NO,canEditContentBindingDefault:SC.Binding.bool(),isDropTarget:NO,useToggleSelection:NO,actOnSelect:NO,selectOnMouseDown:YES,exampleView:SC.ListItemView,contentExampleViewKey:null,groupExampleView:null,contentGroupExampleViewKey:null,action:null,target:null,contentValueKey:null,acceptsFirstResponder:NO,isActive:NO,calculatedHeight:0,calculatedWidth:0,computeLayout:function(){return null},layoutForContentIndex:function(a){return null},allContentIndexes:function(){return SC.IndexSet.create(0,this.get("length")).freeze()}.property("length").cacheable(),contentIndexesInRect:function(a){return null},computeNowShowing:function(){var c=this.contentIndexesInRect(this.get("clippingFrame"));if(!c){c=this.get("allContentIndexes")}else{var b=this.get("length"),a=c.get("max");if(a>b){c=c.copy().remove(b,a-b).freeze()}}return c},showInsertionPoint:function(a,b){},hideInsertionPoint:function(){},delegate:null,selectionDelegate:function(){var a=this.get("delegate"),b=this.get("content");return this.delegateFor("isCollectionViewDelegate",a,b)}.property("delegate","content").cacheable(),contentDelegate:function(){var a=this.get("delegate"),b=this.get("content");return this.delegateFor("isCollectionContent",a,b)}.property("delegate","content").cacheable(),_contentGroupIndexes:function(){return this.get("contentDelegate").contentGroupIndexes(this,this.get("content"))}.property("contentDelegate","content").cacheable(),contentRangeDidChange:function(d,b,c,a){if(!b&&(c==="[]")){this.notifyPropertyChange("_contentGroupIndexes");this.reload(a)}else{this.contentPropertyDidChange(b,c,a)}},contentPropertyDidChange:function(c,b,a){},updateContentRangeObserver:function(){var d=this.get("nowShowing"),a=this._cv_contentRangeObserver,c=this.get("content");if(!c){return}if(a){c.updateRangeObserver(a,d)}else{var b=this.contentRangeDidChange;a=c.addRangeObserver(d,this,b,null);this._cv_contentRangeObserver=a}},removeContentRangeObserver:function(){var b=this.get("content"),a=this._cv_contentRangeObserver;if(a){if(b){b.removeRangeObserver(a)}this._cv_contentRangeObserver=null}},contentLengthDidChange:function(){var a=this.get("content");this.set("length",a?a.get("length"):0);this.computeLayout()},_cv_contentDidChange:function(){var b=this.get("content"),a=this.contentLengthDidChange;if(b===this._content){return}this.removeContentRangeObserver();if(this._content){this._content.removeObserver("length",this,a)}this._content=b;if(b){b.addObserver("length",this,a)}this.contentLengthDidChange();this.contentRangeDidChange(b,null,"[]",null)}.observes("content"),_invalidIndexes:NO,reload:function(a){var b=this._invalidIndexes;if(a&&b!==YES){if(b){b.add(a)}else{b=this._invalidIndexes=a.clone()}}else{this._invalidIndexes=YES}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}return this},reloadIfNeeded:function(){var z=this._invalidIndexes;if(!z||!this.get("isVisibleInWindow")){return this}this._invalidIndexes=NO;var w=this.get("content"),x,y,o,B=this.computeLayout(),A=SC.BENCHMARK_RELOAD,c=this.get("nowShowing"),C=this._sc_itemViews,p=this.get("containerView")||this,a,t,v,u,m,q,j,r,f,n,l,D,d,b,h,k,g;if(z.isIndexSet&&z.contains(c)){z=YES}if(this.willReload){this.willReload(z===YES?null:z)}a=this.get("exampleView");v=a?a.isReusableInCollections:NO;t=this.get("groupExampleView");u=t?t.isReusableInCollections:NO;if(z.isIndexSet){if(A){SC.Benchmark.start(A="%@#reloadIfNeeded (Partial)".fmt(this),YES)}q=[];j=[];r=[];z.forEach(function(i){o=C?C[i]:null;if(c.contains(i)){if(o&&o.parentView===p){j.push(i)}else{r.push(i)}}else{if(o&&o.parentView===p){q.push(i)}}},this);for(x=0,y=q.length;x<y;++x){n=q[x];o=C?C[n]:null;delete C[n];h=this.get("contentDelegate");k=this.get("_contentGroupIndexes");g=k&&k.contains(n);if(g){g=h.contentIndexIsGroup(this,w,n)}m=g?u:v;if(m){b=g?this._GROUP_VIEW_POOL:this._VIEW_POOL;b.push(o);o.destroyLayer()}D=o.get("layer");if(D&&D.parentNode){D.parentNode.removeChild(D)}p.removeChild(o);if(!m){o.destroy()}}for(x=0,y=j.length;x<y;++x){n=j[x];o=C?C[n]:null;l=this.itemViewForContentIndex(n,YES);o.destroyLayer();p.replaceChild(l,o)}for(x=0,y=r.length;x<y;++x){n=r[x];l=this.itemViewForContentIndex(n,YES);p.insertBefore(l,null)}if(A){SC.Benchmark.end(A)}}else{if(A){SC.Benchmark.start(A="%@#reloadIfNeeded (Full)".fmt(this),YES)}if(C){C.length=0}f=p.get("childViews");if(f){f=f.copy()}p.beginPropertyChanges();if(this.willRemoveAllChildren){this.willRemoveAllChildren()}p.destroyLayer().removeAllChildren();if(f){for(x=0,y=f.length;x<y;++x){l=f[x];g=l.get("isGroupView");m=g?u:v;if(m){b=g?this._GROUP_VIEW_POOL:this._VIEW_POOL;b.push(l);l.destroyLayer()}else{l.destroy()}}}f=[];c.forEach(function(i){f.push(this.itemViewForContentIndex(i,YES))},this);p.set("childViews",f);p.replaceLayer();p.endPropertyChanges();if(A){SC.Benchmark.end(A)}}if(B){this.adjust(B)}if(this.didReload){this.didReload(z===YES?null:z)}return this},_TMP_ATTRS:{},_COLLECTION_CLASS_NAMES:["sc-collection-item"],_GROUP_COLLECTION_CLASS_NAMES:["sc-collection-item","sc-group-item"],_VIEW_POOL:null,_GROUP_VIEW_POOL:null,itemViewForContentIndex:function(m,a){var x;var w=this._sc_itemViews;if(!w){w=this._sc_itemViews=[]}else{if(!a&&(x=w[m])){return x}}var o=this.get("content"),q=o.objectAt(m),i=this.get("contentDelegate"),k=this.get("_contentGroupIndexes"),j=NO,y,l,r,g,t,d,b,c,v,h,f,p,u;j=k&&k.contains(m);if(j){j=i.contentIndexIsGroup(this,o,m)}if(j){y=this.get("contentGroupExampleViewKey");if(y&&q){l=q.get(y)}if(!l){l=this.get("groupExampleView")||this.get("exampleView")}t="_GROUP_VIEW_POOL"}else{y=this.get("contentExampleViewKey");if(y&&q){l=q.get(y)}if(!l){l=this.get("exampleView")}t="_VIEW_POOL"}c=this.get("containerView")||this;g=this.layerIdFor(m);v=i.contentIndexIsEnabled(this,o,m);h=i.contentIndexIsSelected(this,o,m);f=i.contentIndexOutlineLevel(this,o,m);p=i.contentIndexDisclosureState(this,o,m);u=this.isVisibleInWindow;r=this.layoutForContentIndex(m);if(l&&l.isReusableInCollections){d=this[t];if(!d){d=this[t]=[]}if(d.length>0){x=d.pop();b=x.prepareForReuse;if(b){b.call(x)}x.beginPropertyChanges();x.set("contentIndex",m);x.set("layerId",g);x.set("isEnabled",v);x.set("isSelected",h);x.set("outlineLevel",f);x.set("disclosureState",p);x.set("isVisibleInWindow",u);x.set("parentView",c);SC.View.views[g]=x;if(r){x.set("layout",r)}else{x.set("layout",l.prototype.layout)}x.set("content",q);x.endPropertyChanges()}}if(!x){var n=this._TMP_ATTRS;n.contentIndex=m;n.content=q;n.owner=n.displayDelegate=this;n.parentView=c;n.page=this.page;n.layerId=g;n.isEnabled=v;n.isSelected=h;n.outlineLevel=f;n.disclosureState=p;n.isGroupView=j;n.isVisibleInWindow=u;if(j){n.classNames=this._GROUP_COLLECTION_CLASS_NAMES}else{n.classNames=this._COLLECTION_CLASS_NAMES}if(r){n.layout=r}else{delete n.layout}x=this.createItemView(l,m,n)}w[m]=x;return x},itemViewForContentObject:function(a){return this.itemViewForContentIndex(this.get("content").indexOf(a))},_TMP_LAYERID:[],createItemView:function(c,a,b){return c.create(b)},layerIdFor:function(a){var b=this._TMP_LAYERID;b[0]=SC.guidFor(this);b[1]=a;return b.join("-")},contentIndexForLayerId:function(c){if(!c||!(c=c.toString())){return null}var b=this._baseLayerId;if(!b){b=this._baseLayerId=SC.guidFor(this)+"-"}if((c.length<=b.length)||(c.indexOf(b)!==0)){return null}var a=Number(c.slice(c.lastIndexOf("-")+1));return isNaN(a)?null:a},itemViewForEvent:function(k){var d=this.getPath("pane.rootResponder");if(!d){return null}var c=SC.guidFor(this)+"-",a=c.length,f=k.target,h=this.get("layer"),g=null,b,j,i;while(f&&f!==document&&f!==h){b=f?SC.$(f).attr("id"):null;if(b&&(g=this.contentIndexForLayerId(b))!==null){break}f=f.parentNode}if(g===null||(f===h)){f=h=null;return null}if(g>=this.get("length")){throw"layout for item view %@ was found when item view does not exist (%@)".fmt(b,this)}return this.itemViewForContentIndex(g)},expand:function(b){if(!b){return this}var a=this.get("contentDelegate"),c=this.get("content");b.forEach(function(d){var f=a.contentIndexDisclosureState(this,c,d);if(f===SC.BRANCH_CLOSED){a.contentIndexExpand(this,c,d)}},this);return this},collapse:function(b){if(!b){return this}var a=this.get("contentDelegate"),c=this.get("content");b.forEach(function(d){var f=a.contentIndexDisclosureState(this,c,d);if(f===SC.BRANCH_OPEN){a.contentIndexCollapse(this,c,d)}},this);return this},_cv_selectionDidChange:function(){var c=this.get("selection"),b=this._cv_selection,a=this._cv_selectionContentDidChange;if(c===b){return}if(b){b.removeObserver("[]",this,a)}if(c){c.addObserver("[]",this,a)}this._cv_selection=c;this._cv_selectionContentDidChange()}.observes("selection"),_cv_selectionContentDidChange:function(){var c=this.get("selection"),b=this._cv_selindexes,a=this.get("content"),d;this._cv_selindexes=c?c.frozenCopy():null;if(b){b=b.indexSetForSource(a)}if(c){c=c.indexSetForSource(a)}if(c&&b){d=c.without(b).add(b.without(c))}else{d=c||b}if(d&&d.get("length")>0){this.reloadSelectionIndexes(d)}},_invalidSelection:NO,reloadSelectionIndexes:function(a){var b=this._invalidSelection;if(a&&(b!==YES)){if(b){b.add(a)}else{b=this._invalidSelection=a.copy()}}else{this._invalidSelection=YES}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadSelectionIndexesIfNeeded)}return this},reloadSelectionIndexesIfNeeded:function(){var f=this._invalidSelection;if(!f||!this.get("isVisibleInWindow")){return this}var d=this.get("nowShowing"),b=this._invalidIndexes,a=this.get("content"),c=this.get("selection");this._invalidSelection=NO;if(b===YES||!d){return this}if(f===YES){f=d}if(b&&b.isIndexSet){f=f.without(b)}f.forEach(function(g){if(!d.contains(g)){return}var h=this.itemViewForContentIndex(g,NO);if(h){h.set("isSelected",c?c.contains(a,g):NO)}},this);return this},select:function(c,g){var d=this.get("content"),a=this.get("selectionDelegate"),b=this.get("_contentGroupIndexes"),f;if(!this.get("isSelectable")||!this.get("isEnabled")){return this}if(SC.typeOf(c)===SC.T_NUMBER){c=SC.IndexSet.create(c,1)}if(c&&c.get("length")>0){if(b&&b.get("length")>0){c=c.copy().remove(b)}c=a.collectionViewShouldSelectIndexes(this,c,g);if(!c||c.get("length")===0){return this}}else{c=null}if(g&&(f=this.get("selection"))){f=f.copy()}else{f=SC.SelectionSet.create()}if(c&&c.get("length")>0){if(c.get("length")===1){f.addObject(d.objectAt(c.get("firstObject")))}else{f.add(d,c)}}f=a.collectionViewSelectionForProposedSelection(this,f);if(!f){f=SC.SelectionSet.create()}this._selectionAnchor=null;this.set("selection",f.freeze());return this},deselect:function(b){var d=this.get("selection"),c=this.get("content"),a=this.get("selectionDelegate");if(!this.get("isSelectable")||!this.get("isEnabled")){return this}if(!d||d.get("length")===0){return this}if(SC.typeOf(b)===SC.T_NUMBER){b=SC.IndexSet.create(b,1)}b=a.collectionViewShouldDeselectIndexes(this,b);if(!b||b.get("length")===0){return this}d=d.copy().remove(c,b);d=a.collectionViewSelectionForProposedSelection(this,d);if(!d){d=SC.SelectionSet.create()}this.set("selection",d.freeze());return this},_findNextSelectableItemFromIndex:function(i,a){var c=this.get("length"),d=SC.IndexSet.create(),f=this.get("content"),j=this.get("selectionDelegate"),h=this.get("_contentGroupIndexes"),g,b;if(!h&&(j.collectionViewShouldSelectIndexes===this.collectionViewShouldSelectIndexes)){return i}while(i<c){if(!h||!h.contains(i)){d.add(i);g=j.collectionViewShouldSelectIndexes(this,d);if(g&&g.get("length")>=1){return i}d.remove(i)}i++}if(a===undefined){b=this.get("selection");a=b?b.get("max"):-1}return a},_findPreviousSelectableItemFromIndex:function(b,i){var c=SC.IndexSet.create(),g=this.get("content"),a=this.get("selectionDelegate"),f=this.get("_contentGroupIndexes"),d;if(SC.none(b)){b=-1}if(!f&&(a.collectionViewShouldSelectIndexes===this.collectionViewShouldSelectIndexes)){return b}while(b>=0){if(!f||!f.contains(b)){c.add(b);d=a.collectionViewShouldSelectIndexes(this,c);if(d&&d.get("length")>=1){return b}c.remove(b)}b--}if(i===undefined){var h=this.get("selection");i=h?h.get("min"):-1}if(SC.none(i)){i=-1}return i},selectPreviousItem:function(i,b){if(SC.none(b)){b=1}if(SC.none(i)){i=false}var g=this.get("selection"),f=this.get("content");if(g){g=g.indexSetForSource(f)}var h=g?g.get("min"):-1,a=g?g.get("max")-1:-1,d=this._selectionAnchor;if(SC.none(d)){d=h}if(i){if(a>d){a=a-b}else{h=this._findPreviousSelectableItemFromIndex(h-b)}if(SC.none(h)||(h<0)){h=0}if(!f.objectAt(h)){h=g?g.get("min"):-1}if(a<h){a=h}}else{h=this._findPreviousSelectableItemFromIndex(h-b);if(SC.none(h)||(h<0)){h=0}if(!f.objectAt(h)){h=g?g.get("min"):-1}a=h;d=null}var c=h;g=SC.IndexSet.create(h,a+1-h);this.scrollToContentIndex(c);this.select(g);this._selectionAnchor=d;return this},selectNextItem:function(i,j){if(SC.none(j)){j=1}if(SC.none(i)){i=false}var b=this.get("selection"),h=this.get("content");if(b){b=b.indexSetForSource(h)}var a=b?b.get("min"):-1,d=b?b.get("max")-1:-1,f=this._selectionAnchor,c=this.get("length");if(SC.none(f)){f=a}if(i){if(a<f){a=a+j}else{d=this._findNextSelectableItemFromIndex(d+j,d)}if(d>=c){d=c-1}if(!h.objectAt(d)){d=b?b.get("max")-1:-1}if(a>d){a=d}}else{d=this._findNextSelectableItemFromIndex(d+j,d);if(d>=c){d=c-1}if(!h.objectAt(d)){d=b?b.get("max")-1:-1}a=d;f=null}var g=d;b=SC.IndexSet.create(a,d-a+1);this.scrollToContentIndex(g);this.select(b);this._selectionAnchor=f;return this},deleteSelection:function(){if(!this.get("canDeleteContent")){return NO}var d=this.get("selection"),c=this.get("content"),a=this.get("selectionDelegate"),b=d&&c?d.indexSetForSource(c):null;if(!c||!b||b.get("length")===0){return NO}b=a.collectionViewShouldDeleteIndexes(this,b);if(!b||b.get("length")===0){return NO}a.collectionViewDeleteContent(this,this.get("content"),b);return YES},scrollToContentIndex:function(b){var a=this.itemViewForContentIndex(b);if(a){this.scrollToItemView(a)}return this},scrollToItemView:function(a){if(a){a.scrollToVisible()}return this},keyDown:function(a){var b=this.interpretKeyEvents(a);return !b?NO:b},keyUp:function(){return true},insertText:function(b,a){if(b===" "){var c=this.get("selection");if(c&&c.get("length")>0){this.invokeLater(this._cv_action,0,null,a)}return YES}else{return NO}},selectAll:function(a){var b=this.get("content"),c=b?SC.IndexSet.create(0,b.get("length")):null;this.select(c,NO);return YES},deselectAll:function(){var a=this.get("content"),b=a?SC.IndexSet.create(0,a.get("length")):null;this.deselect(b,NO);return YES},deleteBackward:function(a){return this.deleteSelection()},deleteForward:function(a){return this.deleteSelection()},moveDown:function(b,a){this.selectNextItem(false,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveUp:function(b,a){this.selectPreviousItem(false,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveLeft:function(l){if(l.ctrlKey||l.metaKey){return NO}if((this.get("itemsPerRow")||1)>1){this.selectPreviousItem(false,1);this._cv_performSelectAction(null,l,this.ACTION_DELAY)}else{var c=this.get("selection"),j=this.get("content"),h=c?c.indexSetForSource(j):null;if(h){var m=undefined,g=false,i=undefined;if(h.get("length")===1){i=h.get("firstObject");m=this.get("contentDelegate");var b=m.contentIndexDisclosureState(this,j,i);if(b!==SC.BRANCH_OPEN){g=true}}if(g){var a=m.contentIndexOutlineLevel(this,j,i)-1;if(a>=0){var f=-1;while(f<0){var d=this._findPreviousSelectableItemFromIndex(i-1);if(d<0){return false}i=d;var k=m.contentIndexOutlineLevel(this,j,i);if(k===a){f=d}}if(f!==-1){this.select(i)}}}else{this.collapse(h)}}}return true},moveRight:function(a){if(a.ctrlKey||a.metaKey){return NO}if((this.get("itemsPerRow")||1)>1){this.selectNextItem(false,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}else{var d=this.get("selection"),c=this.get("content"),b=d?d.indexSetForSource(c):null;if(b){this.expand(b)}}return true},moveDownAndModifySelection:function(b,a){this.selectNextItem(true,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveUpAndModifySelection:function(b,a){this.selectPreviousItem(true,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveLeftAndModifySelection:function(b,a){if((this.get("itemsPerRow")||1)>1){this.selectPreviousItem(true,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}return true},moveRightAndModifySelection:function(b,a){if((this.get("itemsPerRow")||1)>1){this.selectNextItem(true,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}return true},insertNewline:function(d,c){var b=this.get("isEditable")&&this.get("canEditContent"),h,g,i,a,f;if(b){h=this.get("selection");g=this.get("content");if(h&&h.get("length")===1){i=h.indexSetForSource(g);a=i?i.get("min"):-1;b=a>=0}}if(b){f=this.itemViewForContentIndex(a);b=f&&SC.typeOf(f.beginEditing)===SC.T_FUNCTION}if(b){this.scrollToContentIndex(a);f=this.itemViewForContentIndex(a);f.beginEditing()}else{this.invokeLater(this._cv_action,0,f,null)}return YES},insertTab:function(b){var a=this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertBacktab:function(b){var a=this.get("previousValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},mouseDown:function(k){var i=this.itemViewForEvent(k),h=this.get("content"),f=i?i.get("contentIndex"):-1,c,d,b,a,l,g=NO,j=h.get("allowsMultipleSelection");if(!this.get("isEnabled")){return f>-1}if(!this.get("isSelectable")){return NO}this.becomeFirstResponder();if(this.get("useToggleSelection")){if(this.get("selectOnMouseDown")){if(!i){return}b=this.get("selection");a=b&&b.containsObject(i.get("content"));if(a){this.deselect(f)}else{if(!j){this.select(f,NO);g=YES}else{this.select(f,YES);g=YES}}if(g&&this.get("actOnSelect")){this._cv_performSelectAction(i,k)}}return YES}if(!i){if(this.get("allowDeselectAll")){this.select(null,false)}return YES}b=this.get("selection");if(b){b=b.indexSetForSource(h)}c=this.mouseDownInfo={event:k,itemView:i,contentIndex:f,at:Date.now()};a=b?b.contains(f):NO;c.modifierKeyPressed=l=k.ctrlKey||k.metaKey;if(l&&a){c.shouldDeselect=f>=0}else{if(k.shiftKey&&b&&b.get("length")>0&&j){b=this._findSelectionExtendedByShift(b,f);d=this._selectionAnchor;this.select(b);this._selectionAnchor=d}else{if(!l&&a){c.shouldReselect=f>=0}else{if((k.shiftKey||l)&&!j){this.select(null,false)}if(this.get("selectOnMouseDown")){this.select(f,l)}else{c.shouldSelect=f>=0}}}}c.previousContentIndex=f;return YES},mouseUp:function(j){var k=this.itemViewForEvent(j),d=this.mouseDownInfo,g=this.get("content"),f=k?k.get("contentIndex"):-1,c,a,b,h,l,i=g.get("allowsMultipleSelection");if(!this.get("isEnabled")){return f>-1}if(!this.get("isSelectable")){return NO}if(this.get("useToggleSelection")){if(!k||this.get("selectOnMouseDown")){return NO}c=this.get("selection");a=c&&c.containsObject(k.get("content"));if(a){this.deselect(f)}else{if(!i){this.select(f,NO)}else{this.select(f,YES)}}}else{if(d){l=d.contentIndex;f=(k)?k.get("contentIndex"):-1;if(d.shouldSelect){this.select(l,d.modifierKeyPressed)}if(d.shouldDeselect){this.deselect(l)}if(d.shouldReselect){b=this.get("isEditable")&&this.get("canEditContent");if(b){c=this.get("selection");b=c&&(c.get("length")===1)}if(b){h=this.itemViewForContentIndex(l);b=h&&(!h.contentHitTest||h.contentHitTest(j));b=(b&&h.beginEditing)?h.beginEditing():NO}if(!b){if(this._cv_reselectTimer){this._cv_reselectTimer.invalidate()}this._cv_reselectTimer=this.invokeLater(this.select,300,l,false)}}this._cleanupMouseDown()}}this._cv_performSelectAction(k,j,0,j.clickCount);return NO},_cleanupMouseDown:function(){var b=this.mouseDownInfo,a;if(b){for(a in b){if(!b.hasOwnProperty(a)){continue}delete b[a]}}this.mouseDownInfo=null},mouseMoved:function(c){var a=this.itemViewForEvent(c),b=this._lastHoveredItem;if(a!==b){if(b&&b.mouseExited){b.mouseExited(c)}if(a&&a.mouseEntered){a.mouseEntered(c)}}this._lastHoveredItem=a;if(a&&a.mouseMoved){a.mouseMoved(c)}return YES},mouseExited:function(b){var a=this._lastHoveredItem;this._lastHoveredItem=null;if(a&&a.mouseExited){a.mouseExited(b)}return YES},touchStart:function(d,a){var b=this.itemViewForEvent(d),c=b?b.get("contentIndex"):-1;if(!this.get("isEnabled")){return c>-1}this.becomeFirstResponder();this._touchSelectedView=b;if(!this.get("useToggleSelection")){if(b&&!b.get("isSelected")){b.set("isSelected",YES)}}return YES},touchesDragged:function(a,b){b.forEach(function(c){if(Math.abs(c.pageX-c.startX)>5||Math.abs(c.pageY-c.startY)>5){c.makeTouchResponder(c.nextTouchResponder)}},this)},touchEnd:function(f){var b=this._touchSelectedView,d=b?b.get("contentIndex"):-1,a=NO,c;if(!this.get("isEnabled")){return d>-1}if(b){b.set("isSelected",NO)}if(d>-1){if(this.get("useToggleSelection")){c=this.get("selection");a=c&&c.containsObject(b.get("content"))}if(a){this.deselect(d)}else{this.select(d,NO);this._cv_performSelectAction(b,f,0)}}this._touchSelectedView=null},touchCancelled:function(a){if(this._touchSelectedView){this._touchSelectedView.set("isSelected",NO);this._touchSelectedView=null}},_findSelectionExtendedByShift:function(f,i){if(!f||f.get("length")===0){return SC.IndexSet.create(i)}var d=this.get("content"),h=d.get("length")-1,c=f.get("min"),a=f.get("max")-1,g=this.mouseDownInfo,b=this._selectionAnchor;if(SC.none(b)){b=-1}if(i<c){c=i;if(b<0){this._selectionAnchor=b=a}}else{if(i>a){a=i;if(b<0){this._selectionAnchor=b=c}}else{if(i>=c&&i<=a){if(b<0){this._selectionAnchor=b=c}if(i===b){c=a=i}else{if(i>b){c=b;a=i}else{if(i<b){c=i;a=b}}}}}}return SC.IndexSet.create(c,a-c+1)},reorderDataType:function(){return"SC.CollectionView.Reorder."+SC.guidFor(this)}.property().cacheable(),dragContent:null,proposedInsertionIndex:null,proposedDropOperation:null,mouseDragged:function(i){var j=this.get("selectionDelegate"),f=this.get("content"),a=this.get("selection"),c=this.mouseDownInfo,g=this.get("_contentGroupIndexes"),d,b,h;if(!c||c.contentIndex<0){return YES}if((Date.now()-c.at)<123){return YES}if(j.collectionViewShouldBeginDrag(this)){if(!this.get("selectOnMouseDown")){d=SC.IndexSet.create(c.contentIndex)}else{d=a?a.indexSetForSource(f):null}if(d&&g&&g.get("length")>0){d=d.copy().remove(g);if(d.get("length")===0){d=null}else{d.freeze()}}if(!d){return YES}else{d=d.frozenCopy()}d={content:f,indexes:d};this.set("dragContent",d);b=this.get("dragDataTypes");if(b&&b.get("length")>0){h=j.collectionViewDragViewFor(this,d.indexes);if(!h){h=this._cv_dragViewFor(d.indexes)}h.createLayer();SC.Drag.start({event:c.event,source:this,dragView:h,ghost:NO,ghostActsLikeCursor:j.ghostActsLikeCursor,slideBack:YES,dataSource:this});this._cleanupMouseDown();this._lastInsertionIndex=null}else{this.set("dragContent",null)}return YES}},_cv_dragViewFor:function(g){var c=this.get("nowShowing").without(g),d=this.get("layer").cloneNode(false),b=SC.View.create({layer:d,parentView:this}),a=0,f;c=this.get("nowShowing").without(c);SC.$(d).css("backgroundColor","transparent").css("border","none").css("top",0).css("left",0);c.forEach(function(k){var l=this.itemViewForContentIndex(k),h,j;if(l){h=l.get("isSelected");l.set("isSelected",NO);l.updateLayerIfNeeded();j=l.get("layer");if(j){j=j.cloneNode(true)}l.set("isSelected",h);l.updateLayerIfNeeded()}if(j){d.appendChild(j);f=l.get("layout");if(f.height+f.top>a){a=f.height+f.top}}j=null},this);b.set("layout",{height:a});d=null;return b},dragDataTypes:function(){var a=this.get("selectionDelegate"),b=a.collectionViewDragDataTypes(this),c;if(this.get("canReorderContent")){b=b?b.copy():[];c=this.get("reorderDataType");if(b.indexOf(c)<0){b.push(c)}}return b?b:[]}.property(),dragDataForType:function(c,b){if(this.get("canReorderContent")){if(b===this.get("reorderDataType")){return this.get("dragContent")}}var a=this.get("selectionDelegate");return a.collectionViewDragDataForType(this,c,b)},computeDragOperations:function(c,b){var d=SC.DRAG_NONE,a=this.get("selectionDelegate");if(this.get("canReorderContent")){if(c.get("dataTypes").indexOf(this.get("reorderDataType"))>=0){d=SC.DRAG_REORDER}}d=a.collectionViewComputeDragOperations(this,c,d);if(d&SC.DRAG_REORDER){d=SC.DRAG_MOVE}return d},_computeDropOperationState:function(c,m,f){var h=this.convertFrameFromView(c.get("location"),null),l=SC.DROP_BEFORE,n=this.get("selectionDelegate"),d=this.get("canReorderContent"),o,i,a,j,g,b;var k=this.insertionIndexForLocation(h,SC.DROP_ON);if(SC.typeOf(k)===SC.T_ARRAY){l=k[1];k=k[0]}if(l===SC.DROP_ON){this.set("proposedInsertionIndex",k);this.set("proposedDropOperation",l);b=n.collectionViewValidateDragOperation(this,c,f,k,l);k=this.get("proposedInsertionIndex");l=this.get("proposedDropOperation");this._dropInsertionIndex=this._dropOperation=null;if(b!==SC.DRAG_NONE){return[k,l,b]}else{l=SC.DROP_BEFORE;k=this.insertionIndexForLocation(h,SC.DROP_BEFORE);if(SC.typeOf(k)===SC.T_ARRAY){l=k[1];k=k[0]}}}if((k>=0)&&d&&(l!==SC.DROP_ON)){o=c.dataForType(this.get("reorderDataType"));if(o){i=this.get("content");if(l===SC.DROP_BEFORE){a=o.indexes.contains(k-1);j=o.indexes.contains(k)}else{a=o.indexes.contains(k);j=o.indexes.contains(k-1)}if(a&&j){if(SC.none(this._lastInsertionIndex)){if(l===SC.DROP_BEFORE){while((k>=0)&&o.indexes.contains(k)){k--}}else{g=i?i.get("length"):0;while((k<g)&&o.indexes.contains(k)){k++}}}else{k=this._lastInsertionIndex}}if(k>=0){f=SC.DRAG_REORDER}}}this.set("proposedInsertionIndex",k);this.set("proposedDropOperation",l);f=n.collectionViewValidateDragOperation(this,c,f,k,l);k=this.get("proposedInsertionIndex");l=this.get("proposedDropOperation");this._dropInsertionIndex=this._dropOperation=null;return[k,l,f]},dragUpdated:function(g,b){var i=g.get("allowedDragOperations"),h=this._computeDropOperationState(g,b,i),a=h[0],c=h[1],f=h[2];if(f!==SC.DRAG_NONE){if((this._lastInsertionIndex!==a)||(this._lastDropOperation!==c)){var d=this.itemViewForContentIndex(a);this.showInsertionPoint(d,c)}this._lastInsertionIndex=a;this._lastDropOperation=c}else{this.hideInsertionPoint();this._lastInsertionIndex=this._lastDropOperation=null}return(f&SC.DRAG_REORDER)?SC.DRAG_MOVE:f},dragExited:function(){this.hideInsertionPoint();this._lastInsertionIndex=this._lastDropOperation=null},acceptDragOperation:function(a,b){return YES},performDragOperation:function(f,h){var a=this._computeDropOperationState(f,null,h),l=a[0],k=a[1],i=a[2],m=this.get("selectionDelegate"),c,n,d,j,b,g;if(i&SC.DRAG_REORDER){h=(h&SC.DRAG_MOVE)?SC.DRAG_REORDER:SC.DRAG_NONE}else{h=h&i}if(h===SC.DRAG_NONE){return h}c=m.collectionViewPerformDragOperation(this,f,h,l,k);if((c===SC.DRAG_NONE)&&(h&SC.DRAG_REORDER)){d=f.dataForType(this.get("reorderDataType"));if(!d){return SC.DRAG_NONE}j=this.get("content");g=d.indexes;if(g.get("length")===1){if(((k===SC.DROP_BEFORE)||(k===SC.DROP_AFTER))&&(g.get("min")===l)){return SC.DRAG_MOVE}}j.beginPropertyChanges();n=[];b=0;d.indexes.forEach(function(o){n.push(j.objectAt(o-b));j.removeAt(o-b);b++;if(o<l){l--}},this);if(k===SC.DROP_AFTER){l++}j.replace(l,0,n,k);this.select(SC.IndexSet.create(l,n.length));j.endPropertyChanges();h=SC.DRAG_MOVE}return h},collectionViewShouldBeginDrag:function(a){return this.get("canReorderContent")},insertionIndexForLocation:function(a,b){return -1},_cv_isVisibleInWindowDidChange:function(){if(this.get("isVisibleInWindow")){if(this._invalidIndexes){this.invokeOnce(this.reloadIfNeeded)}if(this._invalidSelection){this.invokeOnce(this.reloadSelectionIndexesIfNeeded)}}}.observes("isVisibleInWindow"),collectionViewShouldSelectItem:function(a,b){return this.get("isSelectable")},_TMP_DIFF1:SC.IndexSet.create(),_TMP_DIFF2:SC.IndexSet.create(),_cv_nowShowingDidChange:function(){var b=this.get("nowShowing"),a=this._sccv_lastNowShowing,d,f,c;if(a!==b){if(a&&b){f=this._TMP_DIFF1.add(a).remove(b);c=this._TMP_DIFF2.add(b).remove(a);d=f.add(c)}else{d=a||b}}if(d&&d.get("length")>0){this._sccv_lastNowShowing=b?b.frozenCopy():null;this.updateContentRangeObserver();this.reload(d)}if(f){f.clear()}if(c){c.clear()}}.observes("nowShowing"),init:function(){arguments.callee.base.apply(this,arguments);if(this.useFastPath){this.mixin(SC.CollectionFastPath)}if(this.get("canReorderContent")){this._cv_canReorderContentDidChange()}this._sccv_lastNowShowing=this.get("nowShowing").clone();if(this.content){this._cv_contentDidChange()}if(this.selection){this._cv_selectionDidChange()}},_cv_canReorderContentDidChange:function(){if(this.get("canReorderContent")){if(!this.get("isDropTarget")){this.set("isDropTarget",YES)}SC.Drag.addDropTarget(this)}}.observes("canReorderContent"),_cv_performSelectAction:function(b,d,c,a){var f;if(c===undefined){c=0}if(a===undefined){a=1}if((a>1)||this.get("actOnSelect")){if(this._cv_reselectTimer){this._cv_reselectTimer.invalidate()}f=this.get("selection");f=f?f.toArray():[];if(this._cv_actionTimer){this._cv_actionTimer.invalidate()}this._cv_actionTimer=this.invokeLater(this._cv_action,c,b,d,f)}},_cv_action:function(b,a,c){var d=this.get("action");var f=this.get("target")||null;this._cv_actionTimer=null;if(d){if(SC.typeOf(d)===SC.T_FUNCTION){return this.action(b,a)}var g=this.get("pane");if(g){g.rootResponder.sendAction(d,f,this,g,c)}}else{if(!b){return}else{if(SC.typeOf(b._action)==SC.T_FUNCTION){return b._action(a)}else{if(SC.typeOf(b.action)==SC.T_FUNCTION){return b.action(a)}}}}}});SC.DateFieldView=SC.TextFieldView.extend({value:null,showDate:YES,showTime:NO,formatTime:"%I:%M %p",formatDate:"%d/%m/%Y",formatDateTime:"%d/%m/%Y %I:%M %p",_dtConstants:["%a","%b","%d","%H","%I","%j","%m","%M","%p","%S","%U","%W","%y","%Y"],_wtConstants:[3,3,2,2,2,3,2,2,2,2,2,2,2,4],activeSelection:0,format:function(){var a=this.get("showTime");var b=this.get("showDate");if(a===YES&&b===YES){return this.get("formatDateTime")}if(a===YES){return this.get("formatTime")}return this.get("formatDate")}.property("showTime","showDate").cacheable(),validator:function(){return SC.Validator.DateTime.extend({format:this.get("format")})}.property("format").cacheable(),tabsSelections:function(){var g=[];var d=this.get("format");var j=this.get("_dtConstants");var b=this.get("_wtConstants");if(SC.empty(d)){throw"The format string is empty, and must be a valid string."}var h,k,c,f=0,a=0,i=0;while(f<d.length&&d.indexOf("%",f)!==-1){h=d.indexOf("%",f);k=d.substring(h,h+2);f=h+2;c=j.indexOf(k);if(c===-1){throw"SC.DateFieldView: The format's key '%@' is not supported.".fmt(k)}a=a+h-i;g.push(SC.Object.create({key:k,textSelection:SC.TextSelection.create({start:a,end:a+b[c]})}));a=a+b[c];i=f}h=k=c=null;return g}.property("format").cacheable(),updateTextSelectionObserver:function(){var a=this.get("activeSelection");var b=this.get("tabsSelections");if(this.get("isEditing")){this.selection(null,b[a].get("textSelection"))}}.observes("activeSelection","value"),updateValue:function(b,c){var f=(c===0)?-1:1;var d=this.get("value"),a;switch(b){case"%a":case"%d":case"%j":this.set("value",d.advance({day:f}));break;case"%b":case"%m":this.set("value",d.advance({month:f}));break;case"%H":case"%I":this.set("value",d.advance({hour:f}));break;case"%M":this.set("value",d.advance({minute:f}));break;case"%p":a=d.get("hour")>=12?-12:12;this.set("value",d.advance({hour:a}));break;case"%S":this.set("value",d.advance({second:f}));break;case"%U":this.set("value",d.advance({week1:f}));break;case"%W":this.set("value",d.advance({week0:f}));break;case"%y":case"%Y":this.set("value",d.advance({year:f}));break}},_selectRootElement:function(){},keyDown:function(a){if(this.interpretKeyEvents(a)){a.stop();return YES}return arguments.callee.base.apply(this,arguments)},ctrl_a:function(){return YES},moveUp:function(b){var a=this.get("activeSelection");var c=this.get("tabsSelections");this.updateValue(c[a].get("key"),1);return YES},moveDown:function(b){var a=this.get("activeSelection");var c=this.get("tabsSelections");this.updateValue(c[a].get("key"),0);return YES},insertText:function(a){return YES},moveRight:function(a){var c=this.get("tabsSelections");var b=this.get("activeSelection")+1;if(b===c.length){b=0}this.set("activeSelection",b);return YES},moveLeft:function(a){var c=this.get("tabsSelections");var b=this.get("activeSelection")-1;if(b===-1){b=c.length-1}this.set("activeSelection",b);return YES},insertTab:function(a){var c=this.get("tabsSelections");var b=this.get("activeSelection")+1;if(b<c.length){this.set("activeSelection",b);return YES}return NO},insertBacktab:function(a){var b=this.get("activeSelection")-1;if(b!==-1){this.set("activeSelection",b);return YES}return NO},mouseUp:function(b){var c=arguments.callee.base.apply(this,arguments);var f=this.get("selection");if(SC.none(f)){this.set("activeSelection",0)}else{var j=f.get("start");var h=this.get("tabsSelections");var a=h.length,g;for(var d=0;d<a;d++){g=h[d].get("textSelection");if(j>=g.get("start")&&j<=g.get("end")){this.set("activeSelection",d)}}}return c},deleteBackward:function(a){return YES},deleteForward:function(a){return YES}});SC.DisclosureView=SC.ButtonView.extend({classNames:["sc-disclosure-view"],renderDelegateName:"disclosureRenderDelegate",buttonBehavior:SC.TOGGLE_BEHAVIOR,toggleOnValue:YES,toggleOffValue:NO,valueBindingDefault:SC.Binding.bool(),keyDown:function(a){if(a.which===37||a.which===38){this.set("value",this.get("toggleOffValue"));return YES}if(a.which===39||a.which===40){this.set("value",this.get("toggleOnValue"));return YES}arguments.callee.base.apply(this,arguments)}});sc_require("views/collection");sc_require("mixins/collection_row_delegate");SC.ListView=SC.CollectionView.extend(SC.CollectionRowDelegate,{classNames:["sc-list-view"],acceptsFirstResponder:YES,showAlternatingRows:NO,render:function(a,b){a.setClass("alternating",this.get("showAlternatingRows"));return arguments.callee.base.apply(this,arguments)},rowDelegate:function(){var a=this.delegate,b=this.get("content");return this.delegateFor("isCollectionRowDelegate",a,b)}.property("delegate","content").cacheable(),_sclv_rowDelegateDidChange:function(){var d=this._sclv_rowDelegate,b=this.get("rowDelegate"),c=this._sclv_rowHeightDidChange,a=this._sclv_customRowHeightIndexesDidChange;if(d===b){return this}this._sclv_rowDelegate=b;if(d){d.removeObserver("rowHeight",this,c);d.removeObserver("customRowHeightIndexes",this,a)}if(!b){throw"Internal Inconsistancy: ListView must always have CollectionRowDelegate"}b.addObserver("rowHeight",this,c);b.addObserver("customRowHeightIndexes",this,a);this._sclv_rowHeightDidChange()._sclv_customRowHeightIndexesDidChange();return this}.observes("rowDelegate"),_sclv_rowHeightDidChange:function(){var b=this.get("rowDelegate"),a=b.get("rowHeight"),c;if(a===this._sclv_rowHeight){return this}this._sclv_rowHeight=a;c=SC.IndexSet.create(0,this.get("length"));this.rowHeightDidChangeForIndexes(c);return this},_sclv_customRowHeightIndexesDidChange:function(){var a=this.get("rowDelegate"),b=a.get("customRowHeightIndexes"),d=this._sclv_customRowHeightIndexes,c=this._sclv_customRowHeightIndexesContentDidChange;if((b===d)||(d&&d.isEqual(b))){return this}if(d&&this._sclv_isObservingCustomRowHeightIndexes){d.removeObserver("[]",this,c)}if(this._sclv_isObservingCustomRowHeightIndexes=b&&!b.get("isFrozen")){b.addObserver("[]",this,c)}this._sclv_customRowHeightIndexesContentDidChange();return this},_sclv_customRowHeightIndexesContentDidChange:function(){var a=this.get("rowDelegate"),b=a.get("customRowHeightIndexes"),c=this._sclv_customRowHeightIndexes,d;if(b&&c){d=b.copy().add(c)}else{d=b||c}this._sclv_customRowHeightIndexes=b?b.frozenCopy():null;this.rowHeightDidChangeForIndexes(d);return this},rowOffsetForContentIndex:function(i){if(i===0){return 0}var k=this.get("rowDelegate"),a=k.get("rowHeight"),g,f,c,b,j,h,d;f=i*a;g=this.get("rowSpacing");if(g){f+=i*g}if(k.customRowHeightIndexes&&(c=k.get("customRowHeightIndexes"))){b=this._sclv_offsetCache;if(!b){b=[];j=h=0;c.forEach(function(l){j+=this.rowHeightForContentIndex(l)-a;b[l+1]=j;h=l},this);this._sclv_max=h+1;this._sclv_offsetCache=b}j=b[i];if(j===undefined){j=b[i]=b[i-1];if(j===undefined){h=this._sclv_max;if(i<h){h=c.indexBefore(i)+1}j=b[i]=b[h]||0}}f+=j}return f},rowHeightForContentIndex:function(a){var b=this.get("rowDelegate"),f,c,g,d;if(b.customRowHeightIndexes&&(d=b.get("customRowHeightIndexes"))){c=this._sclv_heightCache;if(!c){c=[];g=this.get("content");d.forEach(function(h){c[h]=b.contentIndexRowHeight(this,g,h)},this);this._sclv_heightCache=c}f=c[a];if(f===undefined){f=b.get("rowHeight")}}else{f=b.get("rowHeight")}return f},rowHeightDidChangeForIndexes:function(b){var a=this.get("length");this._sclv_heightCache=this._sclv_offsetCache=null;if(b&&b.isIndexSet){b=b.get("min")}this.reload(SC.IndexSet.create(b,a-b));return this},_sclv_lengthDidChange:function(){this.adjust(this.computeLayout())}.observes("length"),computeLayout:function(){var a=this._sclv_layout;if(!a){a=this._sclv_layout={}}a.minHeight=this.rowOffsetForContentIndex(this.get("length"));this.set("calculatedHeight",a.minHeight);return a},layoutForContentIndex:function(b){var a=this.get("rowDelegate");return{top:this.rowOffsetForContentIndex(b),height:this.rowHeightForContentIndex(b)-a.get("rowPadding")*2,left:0,right:0}},contentIndexesInRect:function(i){var a=this.get("rowDelegate").get("rowHeight"),h=SC.minY(i),b=SC.maxY(i),j=i.height||0,g=this.get("length"),f,c,d;c=(h-(h%a))/a;f=this.rowOffsetForContentIndex(c);while(c>0&&f>h){c--;f-=this.rowHeightForContentIndex(c)}f+=this.rowHeightForContentIndex(c);while(c<g&&f<=h){c++;f+=this.rowHeightForContentIndex(c)}if(c<0){c=0}if(c>=g){c=g}d=c+((j-(j%a))/a);if(d>g){d=g}f=this.rowOffsetForContentIndex(d);while(d>=c&&f>=b){d--;f-=this.rowHeightForContentIndex(d)}f+=this.rowHeightForContentIndex(d);while(d<g&&f<b){d++;f+=this.rowHeightForContentIndex(d)}d++;if(d<c){d=c}if(d>g){d=g}return SC.IndexSet.create(c,d-c)},insertionPointView:SC.View.extend({classNames:"sc-list-insertion-point",render:function(a,b){if(b){a.push('<div class="anchor"></div>')}}}),showInsertionPoint:function(h,g){var i=this._insertionPointView;if(!i){i=this._insertionPointView=this.get("insertionPointView").create()}var d=h.get("contentIndex"),f=this.get("length"),c=SC.clone(h.get("layout")),a=h.get("outlineLevel"),b=h.get("outlineIndent")||0,j;if((d>=f)&&d>0){j=this.itemViewForContentIndex(f-1);if(j.get("isGroupView")){a=1;b=j.get("outlineIndent")}}if(SC.none(a)){a=-1}if(g&SC.DROP_ON){this.hideInsertionPoint();h.set("isSelected",YES);this._lastDropOnView=h}else{if(this._lastDropOnView){this._lastDropOnView.set("isSelected",NO);this._lastDropOnView=null}if(g&SC.DROP_AFTER){c.top+=c.height}c.height=2;c.right=0;c.left=((a+1)*b)+12;delete c.width;i.set("layout",c);this.appendChild(i)}},hideInsertionPoint:function(){if(this._lastDropOnView){this._lastDropOnView.set("isSelected",NO);this._lastDropOnView=null}var a=this._insertionPointView;if(a){a.removeFromParent().destroy()}this._insertionPointView=null},insertionIndexForLocation:function(h,l){var b={x:h.x,y:h.y,width:1,height:1},g=this.contentIndexesInRect(b),i=g.get("min"),j=this.get("length"),c,m,n,f,p,d,o,k,a;if(SC.none(i)||i<0){if((j===0)||(h.y<=this.rowOffsetForContentIndex(0))){i=0}else{if(h.y>=this.rowOffsetForContentIndex(j)){i=j}}}c=this.rowOffsetForContentIndex(i);m=c+this.rowHeightForContentIndex(i);if(l==SC.DROP_ON){if(this.get("isEditable")){n=Math.min(Math.floor((m-c)*0.2),5)}else{n=0}if(h.y>=(c+n)||h.y<=(m+n)){return[i,SC.DROP_ON]}}if(i>0){k=this.itemViewForContentIndex(i-1);o=(k?k.get("outlineIndent"):0)||0;d=k?k.get("outlineLevel"):0;if(i<j){k=this.itemViewForContentIndex(i);f=k?k.get("outlineLevel"):0;p=(k?k.get("outlineIndent"):0)||0;p*=f}else{f=k.get("isGroupView")?1:0;p=o*f}o*=d;if((f!==d)&&(p!==o)){if(o>p){i--;l=SC.DROP_AFTER}}}if(l===SC.DROP_BEFORE){k=(i<j)?this.itemViewForContentIndex(i):null;if(!k||k.get("isGroupView")){if(i>0){k=this.itemViewForContentIndex(i-1);if(!k.get("isGroupView")||(k.get("disclosureState")===SC.BRANCH_OPEN)){i=i-1;l=SC.DROP_AFTER}else{i=-1}}else{i=-1}}if(i<0){l=SC.DRAG_NONE}}return[i,l]},mouseWheel:function(a){var b=SC.InlineTextFieldView.editor;if(b&&b.get("isEditing")){if(b.get("delegate").get("displayDelegate")===this){SC.InlineTextFieldView.commitEditing()}}return NO},init:function(){arguments.callee.base.apply(this,arguments);this._sclv_rowDelegateDidChange()}});sc_require("views/list");SC.GridView=SC.ListView.extend({classNames:["sc-grid-view"],layout:{left:0,right:0,top:0,bottom:0},rowHeight:48,columnWidth:64,exampleView:SC.LabelView,insertionOrientation:SC.HORIZONTAL_ORIENTATION,itemsPerRow:function(){var b=this.get("frame"),a=this.get("columnWidth")||0;return(a<=0)?1:Math.floor(b.width/a)}.property("clippingFrame","columnWidth").cacheable(),contentIndexesInRect:function(f){var d=this.get("rowHeight")||48,b=this.get("itemsPerRow"),c=Math.floor(SC.minY(f)/d)*b,a=Math.ceil(SC.maxY(f)/d)*b;return SC.IndexSet.create(c,a-c)},layoutForContentIndex:function(h){var d=this.get("rowHeight")||48,a=this.get("clippingFrame").width,b=this.get("itemsPerRow"),f=Math.floor(a/b),g=Math.floor(h/b),c=h-(b*g);return{left:c*f,top:g*d,height:d,width:f}},computeLayout:function(){var f=this.get("content"),d=(f)?f.get("length"):0,c=this.get("rowHeight")||48,a=this.get("itemsPerRow"),g=Math.ceil(d/a);var b=this._cachedLayoutHash;if(!b){b=this._cachedLayoutHash={}}b.minHeight=g*c;this.calculatedHeight=b.minHeight;return b},insertionPointClass:SC.View.extend({classNames:["grid-insertion-point"],render:function(a,b){if(b){a.push('<span class="anchor"></span>')}}}),showInsertionPoint:function(c,g){if(!c){return}if(g===SC.DROP_ON){if(c!==this._dropOnInsertionPoint){this.hideInsertionPoint();this._dropOnInsertionPoint=c}}else{if(this._dropOnInsertionPoint){this._dropOnInsertionPoint=null}if(!this._insertionPointView){this._insertionPointView=this.insertionPointClass.create()}var b=this._insertionPointView;var a=c.get("frame");var d={height:a.height-6,x:a.x,y:a.y+6,width:0};if(!SC.rectsEqual(b.get("frame"),d)){b.set("frame",d)}if(b.parentNode!==c.parentNode){c.parentNode.appendChild(b)}}},hideInsertionPoint:function(){var a=this._insertionPointView;if(a){a.removeFromParent()}if(this._dropOnInsertionPoint){this._dropOnInsertionPoint=null}},insertionIndexForLocation:function(d,k){var g=this.get("frame"),h=this.get("clippingFrame"),l=this.get("itemsPerRow"),a=Math.floor(g.width/l),n=Math.floor((d.y-g.y-h.y)/this.get("rowHeight"));var j=SC.DROP_BEFORE,c=(d.x-g.x-h.x),b=Math.floor(c/a),m=(c/a)-b;if(k===SC.DROP_ON){if(m>0.8){b++}if((m>=0.2)&&(m<=0.8)){j=SC.DROP_ON}}else{if(m>0.45){b++}}var i=(n*l)+b;return[i,j]},_gv_clippingFrameDidChange:function(){var d=this.get("nowShowing"),c,b,a;this.notifyPropertyChange("itemsPerRow");a=d.get("length");for(b=0;b<a;b++){c=this.itemViewForContentIndex(b);c.adjust(this.layoutForContentIndex(b))}}.observes("clippingFrame")});SC.ImageButtonView=SC.ButtonView.extend({classNames:["sc-image-button-view"],themeName:null,renderDelegateName:"imageButtonRenderDelegate",displayProperties:["image"],image:null});SC.ANCHOR_TOP={top:0};SC.ANCHOR_LEFT={left:0};SC.ANCHOR_TOP_LEFT={top:0,left:0};SC.ANCHOR_BOTTOM={bottom:0};SC.ANCHOR_RIGHT={right:0};SC.ANCHOR_BOTTOM_RIGHT={bottom:0,right:0};SC.ToolbarView=SC.View.extend({classNames:["sc-toolbar-view"],ariaRole:"toolbar",renderDelegateName:"toolbarRenderDelegate",anchorLocation:null,layout:{left:0,height:32,right:0},init:function(){if(this.anchorLocation){this.layout=SC.merge(this.layout,this.anchorLocation)}arguments.callee.base.apply(this,arguments)}});sc_require("views/toolbar");SC.WorkspaceView=SC.View.extend({classNames:["sc-workspace-view"],displayProperties:["hasTopToolbar","hasBottomToolbar"],renderDelegateName:"workspaceRenderDelegate",topToolbar:SC.ToolbarView.extend(),bottomToolbar:null,contentView:SC.View.extend(),autoResizeToolbars:NO,defaultToolbarSize:44,largeToolbarSize:44,smallToolbarSize:30,toolbarSize:function(){if(!this.get("autoResizeToolbars")){return this.get("defaultToolbarSize")}if(this.get("orientation")===SC.HORIZONTAL_ORIENTATION){return this.get("smallToolbarSize")}return this.get("largeToolbarSize")}.property("autoHideMaster","orientation"),orientation:function(){var a=this.get("frame");if(a.width>a.height){return SC.HORIZONTAL_ORIENTATION}else{return SC.VERTICAL_ORIENTATION}}.property("frame").cacheable(),masterIsHidden:NO,masterIsHiddenDidChange:function(){var a,b=this.get("masterIsHidden");if(a=this.get("topToolbar")){a.set("masterIsHidden",b)}if(a=this.get("bottomToolbar")){a.set("masterIsHidden",b)}}.observes("masterIsHidden"),_scmd_tilePropertyDidChange:function(){this.invokeOnce("_scws_tile")}.observes("toolbarSize"),createChildViews:function(){arguments.callee.base.apply(this,arguments);var a=this.get("topToolbar");if(a){a=this.topToolbar=this.activeTopToolbar=this.createChildView(a);this.appendChild(a)}var c=this.get("bottomToolbar");if(c){c=this.bottomToolbar=this.activeBottomToolbar=this.createChildView(c);this.appendChild(c)}var b=this.get("contentView");b=this.contentView=this.activeContentView=this.createChildView(b);this.appendChild(b);this.invokeOnce("_scws_tile")},_scws_tile:function(){var b=0,f=0,a=this.get("topToolbar"),g=this.get("bottomToolbar"),d=this.get("contentView"),c=this.get("toolbarSize");if(a){a.set("layout",{left:0,right:0,top:0,height:c});b+=c}if(g){g.set("layout",{left:0,right:0,bottom:0,height:c});f+=c}this.contentView.set("layout",{left:0,right:0,top:b,bottom:f})},hasTopToolbar:function(){if(this.get("topToolbar")){return YES}return NO}.property("topToolbar").cacheable(),hasBottomToolbar:function(){if(this.get("bottomToolbar")){return YES}return NO}.property("bottomToolbar").cacheable(),childDidChange:function(){this._scws_tile()},activeTopToolbar:null,activeBottomToolbar:null,activeContentView:null,topToolbarDidChange:function(){var b=this.activeTopToolbar,a=this.get("topToolbar");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeTopToolbar=a;this.invokeLast("childDidChange")}.observes("topToolbar"),bottomToolbarDidChange:function(){var b=this.activeBottomToolbar,a=this.get("bottomToolbar");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeBottomToolbar=a;this.invokeLast("childDidChange")}.observes("bottomToolbar"),contentViewDidChange:function(){var b=this.activeContentView,a=this.get("contentView");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeContentView=a;this.invokeLast("childDidChange")}.observes("contentView")});sc_require("views/workspace");sc_require("views/toolbar");SC.MasterDetailView=SC.View.extend({classNames:["sc-master-detail-view"],renderDelegateName:"masterDetailRenderDelegate",masterView:SC.WorkspaceView.extend({topToolbar:SC.ToolbarView.extend({}),contentView:SC.View.extend({backgroundColor:"white"})}),detailView:SC.WorkspaceView.extend({topToolbar:SC.ToolbarView.extend({childViews:["showHidePicker"],showHidePicker:SC.ButtonView.extend({layout:{left:7,centerY:0,height:30,width:100},controlSize:SC.AUTO_CONTROL_SIZE,title:"Picker",action:"toggleMasterPicker",isVisible:NO,isVisibleBinding:".parentView.masterIsHidden"})})}),autoHideMaster:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),masterWidth:250,dividerWidth:SC.propertyFromRenderDelegate("dividerWidth",1),masterIsHidden:function(){if(!this.get("autoHideMaster")){return NO}if(this.get("orientation")===SC.HORIZONTAL_ORIENTATION){return NO}return YES}.property("autoHideMaster","orientation"),orientation:SC.VERTICAL_ORIENTATION,_scmd_frameDidChange:function(){var b=this.get("frame"),a;if(b.width>b.height){a=SC.HORIZONTAL_ORIENTATION}else{a=SC.VERTICAL_ORIENTATION}this.setIfChanged("orientation",a)}.observes("frame"),init:function(){arguments.callee.base.apply(this,arguments);this._scmd_frameDidChange();this._scmd_masterIsHiddenDidChange()},toggleMasterPicker:function(a){if(!this.get("masterIsHidden")){return}if(this._picker&&this._picker.get("isVisibleInWindow")){this.hideMasterPicker()}else{this.showMasterPicker(a)}},showMasterPicker:function(b){if(this._picker&&this._picker.get("isVisibleInWindow")){return}if(!this._picker){var a=this.get("pickerPane");this._picker=a.create({})}this._picker.set("contentView",this.get("masterView"));this._picker.set("extraRightOffset",this.get("pointerDistanceFromEdge"));this.showPicker(this._picker,b)},hideMasterPicker:function(){if(this._picker&&this._picker.get("isVisibleInWindow")){this.hidePicker(this._picker)}},showPicker:function(b,a){b.popup(a,SC.PICKER_POINTER,[3,0,1,2,3],[9,-9,-18,18])},hidePicker:function(a){a.remove()},pickerPane:SC.PickerPane.extend({layout:{width:250,height:480},themeName:"popover"}),_picker:null,pointerDistanceFromEdge:46,_scmd_masterIsHiddenDidChange:function(){var a=this.get("masterIsHidden");this.get("masterView").set("masterIsHidden",a);this.get("detailView").set("masterIsHidden",a)}.observes("masterIsHidden"),_scmd_orientationDidChange:function(){this.invokeOnce("_scmd_tile")}.observes("orientation"),_scmd_retileProperties:function(){this.invokeOnce("_scmd_tile")}.observes("masterIsHidden","masterWidth"),createChildViews:function(){var b=this.get("masterView");b=this.masterView=this.createChildView(b);var a=this.get("detailView");a=this.detailView=this.createChildView(a);this.appendChild(a);this.invokeOnce("_scmd_tile")},_masterIsDrawn:NO,_scmd_tile:function(){var b=!this.get("masterIsHidden");var f=this.get("masterWidth"),d=this.get("masterView"),c=this.get("detailView");if(b){this.hideMasterPicker();if(!this._masterIsDrawn){if(this._picker){this._picker.set("contentView",null)}this.appendChild(d);this._masterIsDrawn=YES}d.set("layout",{left:0,top:0,bottom:0,width:f});var a=this.get("dividerWidth");c.set("layout",{left:f+a,right:0,top:0,bottom:0})}else{if(this._masterIsDrawn){this.removeChild(d);this._masterIsDrawn=NO}c.set("layout",{left:0,right:0,top:0,bottom:0})}}});SC.ScrollerView=SC.View.extend({classNames:["sc-scroller-view"],displayProperties:["thumbPosition","thumbLength","isEnabled","controlsHidden"],ariaRole:"scrollbar",shouldScrollToClick:NO,_touchScrollValue:NO,value:function(a,c){var b=this.get("minimum");if(c!==undefined){this._scs_value=c}c=this._scs_value||b;return Math.max(Math.min(c,this.get("maximum")),b)}.property("maximum","minimum").cacheable(),displayValue:function(){var a;if(this.get("_touchScrollValue")){a=this.get("_touchScrollValue")}else{a=this.get("value")}return a}.property("value","_touchScrollValue").cacheable(),proportion:0,maximum:100,minimum:0,isEnabled:function(a,b){if(b!==undefined){this._scsv_isEnabled=b}if(this._scsv_isEnabled!==undefined){return this._scsv_isEnabled}return this.get("proportion")<1}.property("proportion").cacheable(),_scsv_isEnabled:undefined,layoutDirection:SC.LAYOUT_VERTICAL,hasButtons:YES,scrollbarThickness:14,capLength:18,capOverlap:14,buttonLength:41,buttonOverlap:11,minimumThumbLength:20,render:function(c,a){var b={},k="",p=this.get("parentView"),i=this.get("layoutDirection"),f,m,h,g,n,l,j,d,o;switch(i){case SC.LAYOUT_VERTICAL:b["sc-vertical"]=YES;break;case SC.LAYOUT_HORIZONTAL:b["sc-horizontal"]=YES;break}b.disabled=!this.get("isEnabled");b["controls-hidden"]=this.get("controlsHidden");c.setClass(b);m=this.get("thumbLength");f=this.get("thumbPosition");if(a){c.push('<div class="track"></div>','<div class="cap"></div>');this.renderButtons(c,this.get("hasButtons"));this.renderThumb(c,i,m,f);c.attr("aria-orientation","vertical");c.attr("aria-valuemax",this.get("maximum"));c.attr("aria-valuemin",this.get("minimum"));c.attr("aria-valuenow",this.get("value"));c.attr("aria-controls",p.getPath("contentView.layerId"))}else{if(this.get("controlsHidden")){return}g=this.$(".thumb");this.adjustThumb(g,f,m);c.attr("aria-valuenow",this.get("value"))}},renderThumb:function(d,f,b,c){var a;if(f===SC.LAYOUT_HORIZONTAL){a="width: "+b+"px; left: "+c+"px;"}else{a="height: "+b+"px; top: "+c+"px;"}d.push('<div class="thumb" style="%@">'.fmt(a),'<div class="thumb-center"></div>','<div class="thumb-top"></div>','<div class="thumb-bottom"></div></div>')},renderButtons:function(b,a){if(a){b.push('<div class="button-bottom"></div><div class="button-top"></div>')}else{b.push('<div class="endcap"></div>')}},touchScrollDidStart:function(a){this.set("_touchScrollValue",a)},touchScrollDidEnd:function(a){this.set("_touchScrollValue",NO)},touchScrollDidChange:function(a){this.set("_touchScrollValue",a)},adjustThumb:function(b,a,c){this.adjustThumbPosition(b,a);this.adjustThumbSize(b,c)},adjustThumbPosition:function(b,a){if(this._thumbPosition===a){return}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:b.css("top",a);break;case SC.LAYOUT_HORIZONTAL:b.css("left",a);break}this._thumbPosition=a},adjustThumbSize:function(a,b){if(this._thumbSize===b){return}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:a.css("height",Math.max(b,this.get("minimumThumbLength")));break;case SC.LAYOUT_HORIZONTAL:a.css("width",Math.max(b,this.get("minimumThumbLength")));break}this._thumbSize=b},trackLength:function(){var a=this.get("scrollerLength");a-=this.capLength-this.capOverlap;a-=this.buttonLength-this.buttonOverlap;return a}.property("scrollerLength").cacheable(),scrollerLength:function(){switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:return this.get("frame").height;case SC.LAYOUT_HORIZONTAL:return this.get("frame").width}return 0}.property("frame").cacheable(),thumbLength:function(){var a;a=Math.floor(this.get("trackLength")*this.get("proportion"));a=isNaN(a)?0:a;return Math.max(a,this.get("minimumThumbLength"))}.property("trackLength","proportion").cacheable(),thumbPosition:function(){var h=this.get("displayValue"),c=this.get("maximum"),b=this.get("trackLength"),d=this.get("thumbLength"),g=this.get("capLength"),f=this.get("capOverlap"),a;a=(h/c)*(b-d);a+=g-f;return Math.floor(isNaN(a)?0:a)}.property("displayValue","maximum","trackLength","thumbLength").cacheable(),controlsHidden:function(){return this.get("proportion")>=1}.property("proportion").cacheable(),valueForPosition:function(h){var b=this.get("maximum"),a=this.get("trackLength"),c=this.get("thumbLength"),g=this.get("capLength"),d=this.get("capOverlap"),f;f=h-(g-d);f=f/(a-c);f=f*b;return f},mouseDown:function(k){if(!this.get("isEnabled")){return NO}this._altIsDown=k.altKey;this._shiftIsDown=k.shiftKey;var f=k.target,c=this.get("thumbPosition"),j,d,h,g=this.get("scrollerLength");if(f.className.indexOf("thumb")>=0){d=this.convertFrameFromView({x:k.pageX,y:k.pageY});d.x-=c;d.y-=c;this._thumbDragging=YES;this._thumbOffset=d;this._mouseDownLocation={x:k.pageX,y:k.pageY};this._thumbPositionAtDragStart=this.get("thumbPosition");this._valueAtDragStart=this.get("value")}else{if(f.className.indexOf("button-top")>=0){this.decrementProperty("value",(this._altIsDown?g:30));this.makeButtonActive(".button-top");this.startMouseDownTimer("scrollUp");this._isScrollingUp=YES}else{if(f.className.indexOf("button-bottom")>=0){this.incrementProperty("value",(this._altIsDown?g:30));this.makeButtonActive(".button-bottom");this.startMouseDownTimer("scrollDown");this._isScrollingDown=YES}else{var m=this.get("shouldScrollToClick");if(k.altKey){m=!m}var a=this.get("trackLength"),i=this.get("thumbLength"),b=this.convertFrameFromView({x:k.pageX,y:k.pageY}),l;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:this._mouseDownLocation=l=b.y;break;case SC.LAYOUT_HORIZONTAL:this._mouseDownLocation=l=b.x;break}if(m){this.set("value",this.valueForPosition(l-(i/2)));c=this.get("thumbPosition");this._thumbDragging=YES;this._thumbOffset={x:b.x-c,y:b.y-c};this._mouseDownLocation={x:k.pageX,y:k.pageY};this._thumbPositionAtDragStart=c;this._valueAtDragStart=this.get("value")}else{if(l<c){this.decrementProperty("value",g);this.startMouseDownTimer("page")}else{this.incrementProperty("value",g);this.startMouseDownTimer("page")}}}}}return YES},mouseUp:function(a){var c=this._scs_buttonActive,b=NO,d;if(c){c.removeClass("active");b=YES}d=this._mouseDownTimer;if(d){d.invalidate();this._mouseDownTimer=null}this._thumbDragging=NO;this._isScrollingDown=NO;this._isScrollingUp=NO;return b},mouseDragged:function(n){var l,b,m,c,j=n.target,f=this._thumbPositionAtDragStart,h=this._isScrollingUp,p=this._isScrollingDown,d=this._scs_buttonActive,a;if(this._thumbDragging){switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:m=(n.pageY-this._mouseDownLocation.y);break;case SC.LAYOUT_HORIZONTAL:m=(n.pageX-this._mouseDownLocation.x);break}if(n.altKey){if(!this._altIsDown||(this._shiftIsDown!==n.shiftKey)){f=this._thumbPositionAtDragStart=f+m;m=0;this._mouseDownLocation={x:n.pageX,y:n.pageY};this._valueAtDragStart=this.get("value")}if(n.shiftKey){m=-m}this.set("value",Math.round(this._valueAtDragStart+m*2))}else{c=f+m;b=this.get("trackLength")-this.get("thumbLength");this.set("value",Math.round((c/b)*this.get("maximum")))}}else{if(h||p){var o=NO,g=NO;var k=this.$(".button-top")[0].getBoundingClientRect();var i=this.$(".button-bottom")[0].getBoundingClientRect();switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:if(n.clientY<k.bottom){o=YES}else{g=YES}break;case SC.LAYOUT_HORIZONTAL:if(n.clientX<k.right){o=YES}else{g=YES}break}if((o||g)&&o!==h){if(d){d.removeClass("active")}this._mouseDownTimerAction=o?"scrollUp":"scrollDown";if(o){this.makeButtonActive(".button-top")}else{if(g){this.makeButtonActive(".button-bottom")}}this._isScrollingUp=o;this._isScrollingDown=g}}}this._altIsDown=n.altKey;this._shiftIsDown=n.shiftKey;return YES},startMouseDownTimer:function(b,a){var c;this._mouseDownTimerAction=b;this._mouseDownTimer=SC.Timer.schedule({target:this,action:this.mouseDownTimerDidFire,interval:a?0:300})},mouseDownTimerDidFire:function(){var d=this.get("scrollerLength"),a=SC.device.get("mouseLocation"),c=this.get("thumbPosition"),b=this.get("thumbLength"),f=50;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:a=this.convertFrameFromView(a).y;break;case SC.LAYOUT_HORIZONTAL:a=this.convertFrameFromView(a).x;break}switch(this._mouseDownTimerAction){case"scrollDown":this.incrementProperty("value",this._altIsDown?d:30);break;case"scrollUp":this.decrementProperty("value",this._altIsDown?d:30);break;case"page":f=150;if(a<c){this.decrementProperty("value",d)}else{if(a>c+b){this.incrementProperty("value",d)}}}this._mouseDownTimer=SC.Timer.schedule({target:this,action:this.mouseDownTimerDidFire,interval:f})},makeButtonActive:function(a){this._scs_buttonActive=this.$(a).addClass("active")}});SC.TouchScrollerView=SC.ScrollerView.extend({classNames:["sc-touch-scroller-view"],scrollbarThickness:12,capLength:5,capOverlap:0,hasButtons:NO,buttonOverlap:36,adjustThumb:function(d,b,g){var c=this.$(".thumb-inner");var a=this.get("scrollerLength")-this.capLength,f=this.get("minimum")+this.capLength;if(b+g>a){b=Math.min(a-20,b);g=a-b}if(b<f){g-=f-b;b=f}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:if(this._thumbPosition!==b){d.css("-webkit-transform","translate3d(0px,"+b+"px,0px)")}if(this._thumbSize!==g){c.css("-webkit-transform","translate3d(0px,"+Math.round(g-1044)+"px,0px)")}break;case SC.LAYOUT_HORIZONTAL:if(this._thumbPosition!==b){d.css("-webkit-transform","translate3d("+b+"px,0px,0px)")}if(this._thumbSize!==g){c.css("-webkit-transform","translate3d("+Math.round(g-1044)+"px,0px,0px)")}break}this._thumbPosition=b;this._thumbSize=g},render:function(c,a){var b=[],f,k,h,g,l,j,i,d,m;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:b.push("sc-vertical");break;case SC.LAYOUT_HORIZONTAL:b.push("sc-horizontal");break}if(!this.get("isEnabled")){b.push("disabled")}if(this.get("controlsHidden")){b.push("controls-hidden")}c.addClass(b);k=this.get("thumbLength");f=this.get("thumbPosition");if(a){c.push('<div class="track"></div><div class="cap"></div>');this.renderButtons(c,this.get("hasButtons"));this.renderThumb(c,this.get("layoutDirection"),k)}else{if(this.get("controlsHidden")){return}g=this.$(".thumb");this.adjustThumb(g,f,k)}},renderThumb:function(b,c,a){a-=1044;c=(c===SC.LAYOUT_HORIZONTAL?"X":"Y");b.push('<div class="thumb"><div class="thumb-top"></div><div class="thumb-clip">'+'<div class="thumb-inner" style="-webkit-transform: translate%@(%@px);">'.fmt(c,a)+'<div class="thumb-center"></div><div class="thumb-bottom"></div></div></div></div>')}});sc_require("views/scroller");SC.NORMAL_SCROLL_DECELERATION=0.95;SC.FAST_SCROLL_DECELERATION=0.85;SC.ScrollView=SC.View.extend({classNames:["sc-scroll-view"],isScrollable:YES,contentView:null,horizontalAlign:SC.ALIGN_LEFT,verticalAlign:SC.ALIGN_TOP,horizontalScrollOffset:function(b,d){if(d!==undefined){var c=this.minimumHorizontalScrollOffset(),a=this.get("maximumHorizontalScrollOffset");this._scroll_horizontalScrollOffset=Math.max(c,Math.min(a,d))}return this._scroll_horizontalScrollOffset||0}.property().cacheable(),verticalScrollOffset:function(b,d){if(d!==undefined){var c=this.get("minimumVerticalScrollOffset"),a=this.get("maximumVerticalScrollOffset");this._scroll_verticalScrollOffset=Math.max(c,Math.min(a,d))}return this._scroll_verticalScrollOffset||0}.property().cacheable(),maximumScrollOffset:function(b,a,c){if(b>=a){return b-a}if(c===SC.ALIGN_LEFT||c===SC.ALIGN_TOP){return 0}else{if(c===SC.ALIGN_MIDDLE||c===SC.ALIGN_CENTER){return 0-Math.round((a-b)/2)}else{return 0-(a-b)}}},minimumScrollOffset:function(b,a,c){if(b>a){return 0}if(c===SC.ALIGN_LEFT||c===SC.ALIGN_TOP){return 0}else{if(c===SC.ALIGN_MIDDLE||c===SC.ALIGN_CENTER){return 0-Math.round((a-b)/2)}else{return 0-(a-b)}}},maximumHorizontalScrollOffset:function(){var c=this.get("contentView");var b=c?c.get("frame").width:0,a=c?c.get("calculatedWidth"):0;if(a){b=c.calculatedWidth}b*=this._scale;var d=this.get("containerView").get("frame").width;if(!this.get("canScrollHorizontal")){b=Math.min(b,d)}return this.maximumScrollOffset(b,d,this.get("horizontalAlign"))}.property(),maximumVerticalScrollOffset:function(){var a=this.get("contentView"),c=(a&&a.get("frame"))?a.get("frame").height:0,b=a?a.get("calculatedHeight"):0;if(b){c=b}c*=this._scale;var d=this.get("containerView").get("frame").height;if(!this.get("canScrollVertical")){c=Math.min(c,d)}return this.maximumScrollOffset(c,d,this.get("verticalAlign"))}.property(),minimumHorizontalScrollOffset:function(){var c=this.get("contentView");var b=c?c.get("frame").width:0,a=c?c.get("calculatedWidth"):0;if(a){b=a}b*=this._scale;var d=this.get("containerView").get("frame").width;if(!this.get("canScrollHorizontal")){b=Math.min(b,d)}return this.minimumScrollOffset(b,d,this.get("horizontalAlign"))}.property(),minimumVerticalScrollOffset:function(){var a=this.get("contentView");var c=(a&&a.get("frame"))?a.get("frame").height:0,b=a?a.get("calculatedHeight"):0;if(b){c=a.calculatedHeight}c*=this._scale;var d=this.get("containerView").get("frame").height;if(!this.get("canScrollVertical")){c=Math.min(c,d)}return this.minimumScrollOffset(c,d,this.get("verticalAlign"))}.property(),verticalLineScroll:20,horizontalLineScroll:20,verticalPageScroll:function(){return this.get("frame").height}.property("frame"),horizontalPageScroll:function(){return this.get("frame").width}.property("frame"),hasHorizontalScroller:YES,horizontalScrollerView:SC.ScrollerView,horizontalTouchScrollerView:SC.TouchScrollerView,isHorizontalScrollerVisible:YES,canScrollHorizontal:function(){return !!(this.get("hasHorizontalScroller")&&this.get("horizontalScrollerView")&&this.get("isHorizontalScrollerVisible"))}.property("isHorizontalScrollerVisible").cacheable(),autohidesHorizontalScroller:YES,hasVerticalScroller:YES,verticalScrollerView:SC.ScrollerView,verticalTouchScrollerView:SC.TouchScrollerView,isVerticalScrollerVisible:YES,canScrollVertical:function(){return !!(this.get("hasVerticalScroller")&&this.get("verticalScrollerView")&&this.get("isVerticalScrollerVisible"))}.property("isVerticalScrollerVisible").cacheable(),autohidesVerticalScroller:YES,verticalScrollerBottom:0,verticalOverlay:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),horizontalOverlay:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),verticalScrollerLayout:null,horizontalScrollerLayout:null,containerView:SC.ContainerView.extend({}),scrollTo:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){b=a.y;a=a.x}if(!SC.none(a)){this.set("horizontalScrollOffset",a)}if(!SC.none(b)){this.set("verticalScrollOffset",b)}return this},scrollBy:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){b=a.y;a=a.x}a=(a)?this.get("horizontalScrollOffset")+a:null;b=(b)?this.get("verticalScrollOffset")+b:null;return this.scrollTo(a,b)},scrollToVisible:function(b){if(arguments.length===0){return arguments.callee.base.apply(this,arguments)}var c=this.get("contentView");if(!c){return NO}var a=b.get("frame");if(!a){return NO}a=c.convertFrameFromView(a,b.get("parentView"));return this.scrollToRect(a)},scrollToRect:function(b){var a=SC.cloneRect(this.get("containerView").get("frame"));a.x=this.get("horizontalScrollOffset");a.y=this.get("verticalScrollOffset");var d=a.x,c=a.y;a.y-=Math.max(0,SC.minY(a)-SC.minY(b));a.x-=Math.max(0,SC.minX(a)-SC.minX(b));a.y+=Math.max(0,SC.maxY(b)-SC.maxY(a));a.x+=Math.max(0,SC.maxX(b)-SC.maxX(a));if((d!==a.x)||(c!==a.y)){this.scrollTo(a.x,a.y);return YES}else{return NO}},scrollDownLine:function(a){if(a===undefined){a=1}return this.scrollBy(null,this.get("verticalLineScroll")*a)},scrollUpLine:function(a){if(a===undefined){a=1}return this.scrollBy(null,0-this.get("verticalLineScroll")*a)},scrollRightLine:function(a){if(a===undefined){a=1}return this.scrollTo(this.get("horizontalLineScroll")*a,null)},scrollLeftLine:function(a){if(a===undefined){a=1}return this.scrollTo(0-this.get("horizontalLineScroll")*a,null)},scrollDownPage:function(a){if(a===undefined){a=1}return this.scrollBy(null,this.get("verticalPageScroll")*a)},scrollUpPage:function(a){if(a===undefined){a=1}return this.scrollBy(null,0-(this.get("verticalPageScroll")*a))},scrollRightPage:function(a){if(a===undefined){a=1}return this.scrollBy(this.get("horizontalPageScroll")*a,null)},scrollLeftPage:function(a){if(a===undefined){a=1}return this.scrollBy(0-(this.get("horizontalPageScroll")*a),null)},tile:function(){var c=this.get("hasHorizontalScroller")?this.get("horizontalScrollerView"):null;var i=c&&this.get("isHorizontalScrollerVisible");var k=this.get("hasVerticalScroller")?this.get("verticalScrollerView"):null;var g=k&&this.get("isVerticalScrollerVisible");var f=this.get("containerView");var n={left:0,top:0};var m,h,b,o,d,a;var j=((i)?c.get("scrollbarThickness"):0);var l=(g)?k.get("scrollbarThickness"):0;if(i){a=this.get("horizontalScrollerLayout");h={left:(a?a.left:0),bottom:(a?a.bottom:0),right:(a?a.right+l-1:l-1),height:j};c.set("layout",h);o=this.get("horizontalOverlay");n.bottom=o?0:(h.bottom+j)}else{n.bottom=0}if(c){c.set("isVisible",i)}if(g){j=j+this.get("verticalScrollerBottom");d=this.get("verticalScrollerLayout");h={top:(d?d.top:0),bottom:(d?d.bottom+j:j),right:(d?d.right:0),width:l};k.set("layout",h);b=this.get("verticalOverlay");n.right=b?0:(h.right+l)}else{n.right=0}if(k){k.set("isVisible",g)}f.adjust(n)},scrollerVisibilityDidChange:function(){this.tile()}.observes("isVerticalScrollerVisible","isHorizontalScrollerVisible"),_scroll_wheelDeltaX:0,_scroll_wheelDeltaY:0,mouseWheel:function(a){this._scroll_wheelDeltaX+=a.wheelDeltaX;this._scroll_wheelDeltaY+=a.wheelDeltaY;this.invokeLater(this._scroll_mouseWheel,10);return this.get("canScrollHorizontal")||this.get("canScrollVertical")},_scroll_mouseWheel:function(){this.scrollBy(this._scroll_wheelDeltaX,this._scroll_wheelDeltaY);if(SC.WHEEL_MOMENTUM&&this._scroll_wheelDeltaY>0){this._scroll_wheelDeltaY=Math.floor(this._scroll_wheelDeltaY*0.95);this._scroll_wheelDeltaY=Math.max(this._scroll_wheelDeltaY,0);this.invokeLater(this._scroll_mouseWheel,10)}else{if(SC.WHEEL_MOMENTUM&&this._scroll_wheelDeltaY<0){this._scroll_wheelDeltaY=Math.ceil(this._scroll_wheelDeltaY*0.95);this._scroll_wheelDeltaY=Math.min(this._scroll_wheelDeltaY,0);this.invokeLater(this._scroll_mouseWheel,10)}else{this._scroll_wheelDeltaY=0;this._scroll_wheelDeltaX=0}}},canScale:NO,_scale:1,scale:function(a,b){if(b!==undefined){this._scale=Math.min(Math.max(this.get("minimumScale"),b),this.get("maximumScale"))}return this._scale}.property().cacheable(),minimumScale:0.25,maximumScale:2,autoScaleRange:NO,_scale_css:"",updateScale:function(b){var a=this.get("contentView");if(!a){return}if(a.isScalable){this.get("contentView").applyScale(b);this._scale_css=""}else{this._scale_css="scale3d("+b+", "+b+", 1)"}},acceptsMultitouch:YES,decelerationRate:SC.NORMAL_SCROLL_DECELERATION,alwaysBounceHorizontal:NO,alwaysBounceVertical:YES,delaysContentTouches:YES,_touchScrollDidChange:function(){if(this.get("contentView").touchScrollDidChange){this.get("contentView").touchScrollDidChange(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidChange){this.verticalScrollerView.touchScrollDidChange(this._scroll_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidChange){this.horizontalScrollerView.touchScrollDidChange(this._scroll_horizontalScrollOffset)}},_touchScrollDidStart:function(){if(this.get("contentView").touchScrollDidStart){this.get("contentView").touchScrollDidStart(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidStart){this.verticalScrollerView.touchScrollDidStart(this._touch_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidStart){this.horizontalScrollerView.touchScrollDidStart(this._touch_horizontalScrollOffset)}},_touchScrollDidEnd:function(){if(this.get("contentView").touchScrollDidEnd){this.get("contentView").touchScrollDidEnd(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidEnd){this.verticalScrollerView.touchScrollDidEnd(this._touch_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidEnd){this.horizontalScrollerView.touchScrollDidEnd(this._touch_horizontalScrollOffset)}},_applyCSSTransforms:function(b){var a="";this.updateScale(this._scale);a+="translate3d("+-this._scroll_horizontalScrollOffset+"px, "+-Math.round(this._scroll_verticalScrollOffset)+"px,0) ";a+=this._scale_css;if(b){var c=b.style;c.webkitTransform=a;c.webkitTransformOrigin="top left"}},captureTouch:function(a){return YES},touchGeneration:0,touchStart:function(b){var a=++this.touchGeneration;if(!this.tracking&&this.get("delaysContentTouches")){this.invokeLater(this.beginTouchesInContent,150,a)}else{if(!this.tracking){this.invokeLater(this.beginTouchesInContent,1,a)}}this.beginTouchTracking(b,YES);return YES},beginTouchesInContent:function(b){if(b!==this.touchGeneration){return}var c=this.touch,a;if(c&&this.tracking&&!this.dragging&&!c.touch.scrollHasEnded&&!c.touch.hasEnded){c.touch.captureTouch(this,YES);if(!c.touch.touchResponder){c.touch.makeTouchResponder(this)}else{if(c.needsScrollEnd){this._touchScrollDidEnd()}}}},beginTouchTracking:function(g,r){var q=g.averagedTouchesForView(this,r);var k=this._scroll_verticalScrollOffset||0,a=this._scroll_horizontalScrollOffset||0,m=a,l=k,f=NO,p=0,t=0,o,j;if(this.touch&&this.touch.timeout){clearTimeout(this.touch.timeout);this.touch.timeout=null;m=this.touch.startClipOffset.x;l=this.touch.startClipOffset.y;f=YES}j=this.get("contentView");if(j){o=j.get("frame");p=o.width;t=o.height}if(j.calculatedWidth&&j.calculatedWidth!==0){p=j.calculatedWidth}if(j.calculatedHeight&&j.calculatedHeight!==0){t=j.calculatedHeight}var h=this.get("containerView").get("frame"),i=h.width,n=h.height;var b=this.convertFrameToView(this.get("frame"),null),d=(a+(q.x-b.x))/this._scale,c=(k+(q.y-b.y))/this._scale;this.touch={startTime:g.timeStamp,notCalculated:YES,enableScrolling:{x:p*this._scale>i||this.get("alwaysBounceHorizontal"),y:t*this._scale>n||this.get("alwaysBounceVertical")},scrolling:{x:NO,y:NO},enableBouncing:SC.platform.bounceOnScroll,startClipOffset:{x:m,y:l},lastScrollOffset:{x:a,y:k},startTouchOffset:{x:q.x,y:q.y},scrollVelocity:{x:0,y:0},startTouchOffsetInContent:{x:d,y:c},containerSize:{width:i,height:n},contentSize:{width:p,height:t},startScale:this._scale,startDistance:q.d,canScale:this.get("canScale")&&SC.platform.pinchToZoom,minimumScale:this.get("minimumScale"),maximumScale:this.get("maximumScale"),globalFrame:b,layer:j.get("layer"),resistanceCoefficient:0.998,resistanceAsymptote:320,decelerationFromEdge:0.05,accelerationToEdge:0.1,scrollTolerance:{x:15,y:15},scaleTolerance:5,secondaryScrollTolerance:30,scrollLock:500,decelerationRate:this.get("decelerationRate"),lastEventTime:g.timeStamp,touch:(r?g:(this.touch?this.touch.touch:null)),needsScrollEnd:f};if(!this.tracking){this.tracking=YES;this.dragging=NO}},_adjustForEdgeResistance:function(g,d,b,c,a){var f;if(g<d){f=g-d}else{if(g>b){f=b-g}else{return g}}f=Math.pow(c,Math.abs(f))*a;if(g<d){f=f-a}else{f=-f+a}return Math.min(Math.max(d,g),b)+f},touchesDragged:function(a,c){var b=a.averagedTouchesForView(this);this.updateTouchScroll(b.x,b.y,b.d,a.timeStamp)},updateTouchScroll:function(l,k,f,i){var h=this.touch,a=l-h.globalFrame.x,n=k-h.globalFrame.y,x,o,y,p,E,C,c=h.scrolling,t=this.get("horizontalAlign"),m=this.get("verticalAlign");var d=((this._scroll_horizontalScrollOffset||0)+a)/this._scale,b=((this._scroll_verticalScrollOffset||0)+n)/this._scale;var B=d-h.startTouchOffsetInContent.x,A=b-h.startTouchOffsetInContent.y;var j=h.dragging;if(!c.x&&Math.abs(B)>h.scrollTolerance.x&&h.enableScrolling.x){j=YES;c.x=YES;h.scrollTolerance.y=h.secondaryScrollTolerance;h.startTouchOffset.x=l;B=0}if(!c.y&&Math.abs(A)>h.scrollTolerance.y&&h.enableScrolling.y){j=YES;c.y=YES;h.scrollTolerance.x=h.secondaryScrollTolerance;h.startTouchOffset.y=k;A=0}if(j&&!h.dragging){h.dragging=YES;this.dragging=YES;this._touchScrollDidStart()}if(!c.x&&!c.y&&!h.canScale){return}if(c.x&&!c.y){if(B>h.scrollLock&&!c.y){h.enableScrolling.y=NO}}if(c.y&&!c.x){if(A>h.scrollLock&&!c.x){h.enableScrolling.x=NO}}if(h.canScale){var r=h.startDistance,z=f-r;if(Math.abs(z)>h.scaleTolerance){c.y=YES;c.x=YES;var D=h.startScale*(f/Math.max(r,50));var u=this._adjustForEdgeResistance(D,h.minimumScale,h.maximumScale,h.resistanceCoefficient,h.resistanceAsymptote);this.dragging=YES;this._scale=u;var w=d*this._scale,v=b*this._scale}}E=this.minimumScrollOffset(h.contentSize.width*this._scale,h.containerSize.width,t);C=this.minimumScrollOffset(h.contentSize.height*this._scale,h.containerSize.height,m);p=this.maximumScrollOffset(h.contentSize.width*this._scale,h.containerSize.width,t);o=this.maximumScrollOffset(h.contentSize.height*this._scale,h.containerSize.height,m);y=h.startTouchOffsetInContent.x*this._scale-a;x=h.startTouchOffsetInContent.y*this._scale-n;if(h.enableBouncing){y=this._adjustForEdgeResistance(y,E,p,h.resistanceCoefficient,h.resistanceAsymptote);x=this._adjustForEdgeResistance(x,C,o,h.resistanceCoefficient,h.resistanceAsymptote)}else{y=Math.max(E,Math.min(p,y));x=Math.max(C,Math.min(o,x))}if(c.x){this._scroll_horizontalScrollOffset=y}if(c.y){this._scroll_verticalScrollOffset=x}this._applyCSSTransforms(h.layer);this._touchScrollDidChange();if(i-h.lastEventTime>=1||h.notCalculated){h.notCalculated=NO;var g=this._scroll_horizontalScrollOffset;var q=this._scroll_verticalScrollOffset;h.scrollVelocity.x=((g-h.lastScrollOffset.x)/Math.max(1,i-h.lastEventTime));h.scrollVelocity.y=((q-h.lastScrollOffset.y)/Math.max(1,i-h.lastEventTime));h.lastScrollOffset.x=g;h.lastScrollOffset.y=q;h.lastEventTime=i}},touchEnd:function(c){var a=this.touch,b=c.averagedTouchesForView(this);c.scrollHasEnded=YES;if(b.touchCount>0){this.beginTouchTracking(c,NO)}else{if(this.dragging){a.dragging=NO;a.lastEventTime=c.timeStamp;this.startDecelerationAnimation()}else{if(a.needsScrollEnd){this._touchScrollDidEnd()}c.captureTouch(this,YES);if(c.touchResponder&&c.touchResponder!==this){c.end()}else{if(!c.touchResponder||c.touchResponder===this){if(c.nextTouchResponder){c.makeTouchResponder(c.nextTouchResponder)}}else{}}this.touch=null}this.tracking=NO;this.dragging=NO}},touchCancelled:function(c){var a=this.touch,b=c.averagedTouchesForView(this);if(!this.touch||!this.touch.timeout){this.beginPropertyChanges();this.set("scale",this._scale);this.set("verticalScrollOffset",this._scroll_verticalScrollOffset);this.set("horizontalScrollOffset",this._scroll_horizontalScrollOffset);this.endPropertyChanges();this.tracking=NO;if(this.dragging){this._touchScrollDidEnd()}this.dragging=NO;this.touch=null}},startDecelerationAnimation:function(a){var b=this.touch;b.decelerationVelocity={x:b.scrollVelocity.x*10,y:b.scrollVelocity.y*10};this.decelerateAnimation()},bouncyBounce:function(c,f,d,g,h,b,a){if(f<d){if(c<0){c=c+((d-f)*h)}else{c=Math.min((d-f)*b+a,d-f-0.01)}}else{if(f>g){if(c>0){c=c-((f-g)*h)}else{c=-Math.min((f-g)*b+a,f-g-0.01)}}}return c},decelerateAnimation:function(){var c=this.touch,A=this._scale,o=c.contentSize,p=c.containerSize,n=this.get("horizontalAlign"),f=this.get("verticalAlign"),z=this.minimumScrollOffset(o.width*this._scale,p.width,n),y=this.minimumScrollOffset(o.height*this._scale,p.height,f),j=this.maximumScrollOffset(o.width*this._scale,p.width,n),i=this.maximumScrollOffset(o.height*this._scale,p.height,f),a=Date.now(),g=Math.max(a-c.lastEventTime,1),v=this._scroll_horizontalScrollOffset+c.decelerationVelocity.x*(g/10),r=this._scroll_verticalScrollOffset+c.decelerationVelocity.y*(g/10);var u=c.decelerationFromEdge,w=c.accelerationToEdge;var m=!c.enableBouncing,l=!c.enableBouncing;if(v>=z&&v<=j){m=YES}if(r>=y&&r<=i){l=YES}v/=this._scale;r/=this._scale;var k=0;k=this.bouncyBounce(k,A,c.minimumScale,c.maximumScale,u,w,0);this._scale=A=A+k;v*=this._scale;r*=this._scale;z=this.minimumScrollOffset(o.width*this._scale,p.width,n);y=this.minimumScrollOffset(o.height*this._scale,p.height,f);j=this.maximumScrollOffset(o.width*this._scale,p.width,n);i=this.maximumScrollOffset(o.height*this._scale,p.height,f);if(m&&(v<z||v>j)){v=Math.max(z,Math.min(v,j));c.decelerationVelocity.x=0}if(l&&(r<y||r>i)){r=Math.max(y,Math.min(r,i));c.decelerationVelocity.y=0}this._scroll_horizontalScrollOffset=v;this._scroll_verticalScrollOffset=r;this._applyCSSTransforms(c.layer);this._touchScrollDidChange();var x=c.decelerationRate,b=Math.pow(x,(g/10));c.decelerationVelocity.y*=b;c.decelerationVelocity.x*=b;c.decelerationVelocity.x=this.bouncyBounce(c.decelerationVelocity.x,v,z,j,u,w,0.3);c.decelerationVelocity.y=this.bouncyBounce(c.decelerationVelocity.y,r,y,i,u,w,0.3);var q=Math.abs(c.decelerationVelocity.x),d=Math.abs(c.decelerationVelocity.y);if(d<0.05&&q<0.05&&Math.abs(k)<0.05){c.timeout=null;this.touch=null;this._touchScrollDidEnd();this.beginPropertyChanges();this.set("scale",this._scale);this.set("verticalScrollOffset",this._scroll_verticalScrollOffset);this.set("horizontalScrollOffset",this._scroll_horizontalScrollOffset);this.endPropertyChanges();return}var h=this;c.lastEventTime=Date.now();this.touch.timeout=setTimeout(function(){SC.run(h.decelerateAnimation(),h)},30)},createChildViews:function(){var b=[],a;if(SC.none(a=this.containerView)){a=SC.ContainerView}b.push(this.containerView=this.createChildView(a,{contentView:this.contentView,isScrollContainer:YES}));this.contentView=this.containerView.get("contentView");a=SC.platform.touch?this.get("horizontalTouchScrollerView"):this.get("horizontalScrollerView");if(a){if(this.get("hasHorizontalScroller")){a=this.horizontalScrollerView=this.createChildView(a,{layoutDirection:SC.LAYOUT_HORIZONTAL,valueBinding:"*owner.horizontalScrollOffset"});b.push(a)}else{this.horizontalScrollerView=null}}a=SC.platform.touch?this.get("verticalTouchScrollerView"):this.get("verticalScrollerView");if(a){if(this.get("hasVerticalScroller")){a=this.verticalScrollerView=this.createChildView(a,{layoutDirection:SC.LAYOUT_VERTICAL,valueBinding:"*owner.verticalScrollOffset"});b.push(a)}else{this.verticalScrollerView=null}}this.childViews=b;this.contentViewDidChange();this.tile()},init:function(){arguments.callee.base.apply(this,arguments);this._scroll_contentView=this.get("contentView");var a=this._scroll_contentView;if(a){a.addObserver("frame",this,this.contentViewFrameDidChange);a.addObserver("calculatedWidth",this,this.contentViewFrameDidChange);a.addObserver("calculatedHeight",this,this.contentViewFrameDidChange)}if(this.get("isVisibleInWindow")){this._scsv_registerAutoscroll()}},_scsv_registerAutoscroll:function(){if(this.get("isVisibleInWindow")){SC.Drag.addScrollableView(this)}else{SC.Drag.removeScrollableView(this)}}.observes("isVisibleInWindow"),contentViewDidChange:function(){var d=this.get("contentView"),a=this._scroll_contentView,b=this.contentViewFrameDidChange,c=this.contentViewLayerDidChange;if(d!==a){if(a){a.removeObserver("calculatedWidth",this,this.contentViewFrameDidChange);a.removeObserver("calculatedHeight",this,this.contentViewFrameDidChange);a.removeObserver("frame",this,b);a.removeObserver("layer",this,c)}this._scroll_contentView=d;if(d){d.addObserver("frame",this,b);d.addObserver("calculatedWidth",this,this.contentViewFrameDidChange);d.addObserver("calculatedHeight",this,this.contentViewFrameDidChange);d.addObserver("layer",this,c)}this.containerView.set("contentView",d);this.contentViewFrameDidChange()}}.observes("contentView"),render:function(a,b){this.invokeLast(this.adjustElementScroll);if(b){a.push('<div class="corner"></div>')}return arguments.callee.base.apply(this,arguments)},oldMaxHOffset:0,oldMaxVOffset:0,contentViewFrameDidChange:function(b){var p=this.get("contentView"),m=(p)?p.get("frame"):null,i=this._scale,c=0,r=0,k,j,n,t,o;if(!p||!m){return}c=p.get("calculatedWidth")||m.width||0;r=p.get("calculatedHeight")||m.height||0;c*=i;r*=i;if(!b&&(c===this._scroll_contentWidth)&&(r===this._scroll_contentHeight)){return}this._scroll_contentWidth=c;this._scroll_contentHeight=r;k=this.getPath("containerView.frame");j=k.width;n=k.height;if(this.get("hasHorizontalScroller")&&(p=this.get("horizontalScrollerView"))){if(this.get("autohidesHorizontalScroller")){this.set("isHorizontalScrollerVisible",c>j)}p.setIfChanged("maximum",c-j);p.setIfChanged("proportion",j/c)}if(this.get("hasVerticalScroller")&&(p=this.get("verticalScrollerView"))){if(this.get("autohidesVerticalScroller")){this.set("isVerticalScrollerVisible",r>n)}p.setIfChanged("maximum",r-n);p.setIfChanged("proportion",n/r)}if(!this.get("isVerticalScrollerVisible")&&(this.get("verticalScrollOffset")!==0)&&this.get("autohidesVerticalScroller")){this.set("verticalScrollOffset",0)}if(!this.get("isHorizontalScrollerVisible")&&(this.get("horizontalScrollOffset")!==0)&&this.get("autohidesHorizontalScroller")){this.set("horizontalScrollOffset",0)}var q=this.get("maximumVerticalScrollOffset"),l=this.get("verticalScrollOffset"),h=this.get("maximumHorizontalScrollOffset"),a=this.get("horizontalScrollOffset"),g=q<l,d=h<a;if(g||d){this.forceDimensionsRecalculation(d,g,l,a)}this.notifyPropertyChange("maximumVerticalScrollOffset");this.notifyPropertyChange("maximumHorizontalScrollOffset")},frameDidChange:function(){this.contentViewFrameDidChange(YES)}.observes("frame"),contentViewLayerDidChange:function(){if(this._verticalScrollOffset!==0){this._verticalScrollOffset=-1}if(this._horizontalScrollOffset!==0){this._horizontalScrollOffset=-1}this.invokeLast(this.adjustElementScroll)},_scroll_horizontalScrollOffsetDidChange:function(){this.invokeLast(this.adjustElementScroll)}.observes("horizontalScrollOffset"),_scroll_verticalScrollOffsetDidChange:function(){this.invokeLast(this.adjustElementScroll)}.observes("verticalScrollOffset"),adjustElementScroll:function(){var a=this.get("containerView"),d=this.get("contentView"),c=this.get("verticalScrollOffset"),b=this.get("horizontalScrollOffset");if(d){if(SC.platform.touch){this._applyCSSTransforms(d.get("layer"))}if(d._viewFrameDidChange){d._viewFrameDidChange()}}if(a&&!SC.platform.touch){a=a.$()[0];if(a){if(c!==this._verticalScrollOffset){a.scrollTop=c;this._verticalScrollOffset=c}if(b!==this._horizontalScrollOffset){a.scrollLeft=b;this._horizontalScrollOffset=b}}}},forceDimensionsRecalculation:function(b,c,f,a){var g=a;var d=f;this.scrollTo(0,0);if(b&&c){this.scrollTo(this.get("maximumHorizontalScrollOffset"),this.get("maximumVerticalScrollOffset"))}if(b&&!c){this.scrollTo(this.get("maximumHorizontalScrollOffset"),d)}if(!b&&c){this.scrollTo(g,this.get("maximumVerticalScrollOffset"))}},_scroll_verticalScrollOffset:0,_scroll_horizontalScrollOffset:0});sc_require("views/scroll");SC.MenuScrollerView=SC.ScrollerView.extend({classNames:["sc-menu-scroller-view"],scrollDown:NO,value:function(a,c){if(c!==undefined){this._value=c}else{var b=this._value||0;return Math.min(b,this.get("maximum"))}}.property("maximum").cacheable(),maximum:0,isEnabled:YES,layoutDirection:SC.LAYOUT_VERTICAL,verticalLineScroll:20,ownerScrollValueKey:function(){return"verticalScrollOffset"}.property("layoutDirection").cacheable(),init:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.TINY_SCROLLER_THICKNESS);break;case SC.SMALL_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.SMALL_SCROLLER_THICKNESS);break;case SC.REGULAR_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.REGULAR_SCROLLER_THICKNESS);break;case SC.LARGE_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.LARGE_SCROLLER_THICKNESS);break;case SC.HUGE_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.HUGE_SCROLLER_THICKNESS);break}return arguments.callee.base.apply(this,arguments)},render:function(a,c){a.addClass("sc-vertical");a.addClass(this.get("controlSize"));if(c){var b=this.get("scrollDown")?"arrowDown":"arrowUp";a.push('<span class="scrollArrow '+b+'">&nbsp;</span>')}a.setClass("disabled",!this.get("isEnabled"))},didCreateLayer:function(){},willDestroyLayer:function(){var a=this._sc_scroller_scrollDidChange;SC.Event.remove(this.$(),"scroll",this,a)},mouseEntered:function(a){this.set("isMouseOver",YES);this._invokeScrollOnMouseOver()},mouseExited:function(a){this.set("isMouseOver",NO)},_sc_scroller_valueDidChange:function(){}.observes("value"),_sc_scroller_armScrollTimer:function(){if(!this._sc_scrollTimer){SC.RunLoop.begin();var a=this._sc_scroller_scrollDidChange;this._sc_scrollTimer=this.invokeLater(a,50);SC.RunLoop.end()}},_sc_scroller_scrollDidChange:function(){var b=Date.now(),d=this._sc_lastScroll,c=this.get("layer"),a=0;if(d&&(b-d)<50){return this._sc_scroller_armScrollTimer()}this._sc_scrollTimer=null;this._sc_lastScroll=b;SC.RunLoop.begin();if(!this.get("isEnabled")){return}this._sc_scrollValue=a=c.scrollTop;this.set("value",a);SC.RunLoop.end()},_scrollMenu:function(){var b=this.get("value"),a;if(this.get("scrollDown")){a=b+this.verticalLineScroll;if(a<=this.get("maximum")){this.set("value",a)}}else{a=b-this.verticalLineScroll;if(a>=0){this.set("value",a)}else{if(b<=this.verticalLineScroll&&b>0){this.set("value",0)}}}return YES},_invokeScrollOnMouseOver:function(){this._scrollMenu();if(this.get("isMouseOver")){this.invokeLater(this._invokeScrollOnMouseOver,50)}}});SC.MenuScrollerView.REGULAR_SCROLLER_THICKNESS=18;SC.MenuScrollerView.TINY_SCROLLER_THICKNESS=10;SC.MenuScrollerView.SMALL_SCROLLER_THICKNESS=14;SC.MenuScrollerView.LARGE_SCROLLER_THICKNESS=23;SC.MenuScrollerView.HUGE_SCROLLER_THICKNESS=26;SC.MenuScrollView=SC.ScrollView.extend({classNames:["sc-menu-scroll-view"],maximumHorizontalScrollOffset:0,hasHorizontalScroller:NO,horizontalScrollerView:SC.MenuScrollerView,isHorizontalScrollerVisible:NO,canScrollHorizontal:NO,autohidesHorizontalScroller:NO,hasVerticalScroller:YES,verticalScrollerView:SC.MenuScrollerView,verticalScrollerView2:SC.MenuScrollerView,isVerticalScrollerVisible:YES,canScrollVertical:YES,autohidesVerticalScroller:YES,verticalScrollerBottom:0,controlSize:SC.REGULAR_CONTROL_SIZE,containerView:SC.ContainerView,scrollToVisible:function(b){if(arguments.length===0){return arguments.callee.base.apply(this,arguments)}var f=this.get("contentView");if(!f){return NO}var a=b.get("frame");if(!a){return NO}a=f.convertFrameFromView(a,b.get("parentView"));var c=this.get("verticalScrollerView2");if(c&&c.get("isVisible")){a.height+=c.get("frame").height}var d=this.get("verticalScrollerView");if(d&&d.get("isVisible")){a.top-=d.get("frame").height}return this.scrollToRect(a)},tile:function(){var h,u,i,b,r,j,c;h=this.get("hasVerticalScroller");u=h?this.get("verticalScrollerView"):null;i=h?this.get("verticalScrollerView2"):null;b=u&&this.get("isVerticalScrollerVisible");r=this.get("containerView");j={left:0,top:0};if(b){c=0;var a=u.get("scrollerThickness")||i.get("scrollerThickness");var k=this.get("contentView"),p,q=(k)?k.get("frame"):null,l=(q)?q.height:0,t=this.containerView.$()[0],m=this.get("verticalScrollOffset"),g={height:0,top:0,right:0,left:0},o={height:a,top:0,right:0,left:0},d={height:a,bottom:0,right:0,left:0},n={height:0,bottom:0,right:0,left:0};if(t){c=t.offsetHeight}if(m===0){j.top=0;j.bottom=a;u.set("layout",g);i.set("layout",d)}else{if(m>=(l-c-a)){j.top=a;j.bottom=0;u.set("layout",o);i.set("layout",n)}else{j.top=a;j.bottom=a;u.set("layout",o);i.set("layout",d)}}}if(u){u.set("isVisible",b);i.set("isVisible",b)}r.set("layout",j)},scrollerVisibilityDidChange:function(){this.tile()}.observes("isVerticalScrollerVisible","isHorizontalScrollerVisible","verticalScrollOffset"),createChildViews:function(){var c=[],b,a,d=this.get("controlSize");if(SC.none(b=this.containerView)){b=SC.ContainerView}c.push(this.containerView=this.createChildView(b,{contentView:this.contentView}));this.contentView=this.containerView.get("contentView");if((b=this.verticalScrollerView)&&(a=this.verticalScrollerView2)){if(this.get("hasVerticalScroller")){b=this.verticalScrollerView=this.createChildView(b,{layout:{top:0,left:0,right:0},controlSize:d,valueBinding:"*owner.verticalScrollOffset"});c.push(b);a=this.verticalScrollerView2=this.createChildView(a,{scrollDown:YES,layout:{bottom:0,left:0,right:0},controlSize:d,valueBinding:"*owner.verticalScrollOffset"});c.push(a)}else{this.verticalScrollerView=null;this.verticalScrollerView2=null}}this.childViews=c;this.contentViewFrameDidChange();this.tile()},init:function(){arguments.callee.base.apply(this,arguments);this._scroll_contentView=this.get("contentView");var a=this._scroll_contentView;if(a){a.addObserver("frame",this,this.contentViewFrameDidChange)}if(this.get("isVisibleInWindow")){this._scsv_registerAutoscroll()}},_scsv_registerAutoscroll:function(){if(this.get("isVisibleInWindow")){SC.Drag.addScrollableView(this)}else{SC.Drag.removeScrollableView(this)}}.observes("isVisibleInWindow"),contentViewFrameDidChange:function(){var c=this.get("contentView"),b,i=(c)?c.get("frame"):null,g=(i)?i.width:0,a=(i)?i.height:0,j=this.get("frame"),d,h;this._scroll_contentWidth=g;this._scroll_contentHeight=a;if(this.get("hasVerticalScroller")&&(c=this.get("verticalScrollerView"))&&(b=this.get("verticalScrollerView2"))){a-=1;if(this.get("autohidesVerticalScroller")){this.set("isVerticalScrollerVisible",a>j.height)}a-=this.get("verticalScrollerBottom");d=0;h=this.containerView.$()[0];if(h){d=h.offsetHeight}a=a-d;c.setIfChanged("maximum",a);b.setIfChanged("maximum",a)}},_scroll_horizontalScrollOffsetDidChange:function(){},_scroll_verticalScrollOffsetDidChange:function(){var b=this.get("verticalScrollOffset");var a=this.get("contentView");if(a){a.$().css("top",(0-b)+"px")}}.observes("verticalScrollOffset")});sc_require("views/workspace");SC.TO_LEFT="TOLEFT";SC.TO_RIGHT="TORIGHT";SC.NavigationView=SC.WorkspaceView.extend({_views:null,_current:null,navigationContentView:SC.View,init:function(){arguments.callee.base.apply(this,arguments);this._views=[]},createChildViews:function(){arguments.callee.base.apply(this,arguments);var a=this.get("navigationContentView");if(a.isClass){a=this.createChildView(a)}this._defaultContent=this.navigationContentView=a;this.contentView.appendChild(a)},changeNavigationContent:function(a){var c=null,b=null;if(a){c=a.get("topToolbar");b=a.get("bottomToolbar")}if(c&&c.isClass){a.set("topToolbar",c=c.create())}if(b&&b.isClass){a.set("bottomToolbar",b=b.create())}this.beginPropertyChanges();this._current=a;this.set("navigationContentView",a?a:this._defaultContent);this.set("topToolbar",c);this.set("bottomToolbar",b);this.endPropertyChanges()},push:function(a){this._currentDirection=this._current?SC.TO_LEFT:null;if(this._current){this._views.push(this._current)}this.changeNavigationContent(a)},pop:function(){this._currentDirection=SC.TO_RIGHT;var a=this._views.pop();this.changeNavigationContent(a)},popToView:function(b){this._currentDirection=SC.TO_RIGHT;var d=this._views,a=d.length-1,c=d[a];while(c&&c!==b){this._views.pop();a--;c=d[a]}this.changeNavigationContent(c)},topToolbarDidChange:function(){var b=this.activeTopToolbar,a=this.get("topToolbar");if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.buildOutChild(b)}else{this.removeChild(b)}}if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.buildInChild(a)}else{this.appendChild(a)}}this.activeTopToolbar=a;this.invokeOnce("childDidChange")}.observes("topToolbar"),bottomToolbarDidChange:function(){var b=this.activeBottomToolbar,a=this.get("bottomToolbar");if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.buildOutChild(b)}else{this.removeChild(b)}}if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.buildInChild(a)}else{this.appendChild(a)}}this.activeBottomToolbar=a;this.invokeOnce("childDidChange")}.observes("topToolbar"),contentViewDidChange:function(){var b=this.activeNavigationContentView,a=this.get("navigationContentView");if(!a.isNavigationBuilder){a.mixin(SC.NavigationBuilder)}this._pendingBuildOut=b;this._pendingBuildIn=a;this.activeNavigationContentView=a;this.invokeOnce("childDidChange")}.observes("navigationContentView"),childDidChange:function(){var a=this._pendingBuildIn,b=this._pendingBuildOut;if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.contentView.buildOutChild(b)}else{this.contentView.removeChild(b)}}this._scws_tile();if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.contentView.buildInChild(a)}else{this.contentView.appendChild(a)}}}});sc_require("views/toolbar");SC.NavigationBarView=SC.ToolbarView.extend(SC.Gesturable,{init:function(){arguments.callee.base.apply(this,arguments);if(!SC.Animatable){SC.Logger.error("NavigationBarView requires SC.Animatable. Please make your app or framework require the animation framework. CRASH.")}},mixinAnimatable:function(){this.mixin(SC.Animatable);this.transitions=this.navigationTransitions},navigationTransitions:{opacity:{duration:0.25,action:"didFinishTransition"}},style:{opacity:1},gestures:["swipeGesture"],swipeGesture:SC.SwipeGesture,swipe:function(d,i,g){var f=(g===SC.SWIPE_LEFT)?"isSwipeLeft":"isSwipeRight",c=this.get("childViews"),h,b,a=c.get("length");for(b=0;b<a;b++){h=c[b];if(h.get(f)){i.makeTouchResponder(h);i.end();return}}},resetBuild:function(){if(!this.isAnimatable){this.mixinAnimatable()}},didFinishTransition:function(){if(this.isBuildingIn){this.buildInDidFinish()}else{if(this.isBuildingOut){this.buildOutDidFinish()}}},preBuildIn:function(){this.disableAnimation();this.adjust("opacity",0).updateLayout();this.enableAnimation();var c=this.get("childViews"),d,b,a=c.get("length");for(b=0;b<a;b++){d=c[b];if(d.disableNavigationTransition){continue}if(!d._nv_mixedIn){this.mixinNavigationChild(d)}d.disableAnimation();d.transform(this.buildDirection===SC.TO_LEFT?100:-100);d.enableAnimation()}},buildIn:function(){this.preBuildIn();this.invokeLater("startBuildIn",10)},startBuildIn:function(){this.adjust("opacity",1);var c=this.get("childViews"),d,b,a=c.get("length");for(b=0;b<a;b++){d=c[b];if(d.disableNavigationTransition){continue}d.transform(0)}},buildOut:function(){this.adjust("opacity",0);var c=this.get("childViews"),d,b,a=c.get("length");for(b=0;b<a;b++){d=c[b];if(d.disableNavigationTransition){continue}if(!d._nv_mixedIn){this.mixinNavigationChild(d)}d.transform(this.buildDirection===SC.TO_LEFT?-100:100)}},mixinNavigationChild:function(a){if(a.isAnimatable){return}a.mixin(SC.Animatable);a.mixin({transitions:{transform:{timing:SC.Animatable.TRANSITION_EASE_IN_OUT,duration:0.25}},naturalLayout:a.get("layout"),transform:function(b){if(SC.platform.supportsCSS3DTransforms){this.adjust("transform","translate3d("+b+"px,0px,0px)")}else{this.adjust("transform","translate("+b+"px,0px)")}}});a._nv_mixedIn=YES}});sc_require("views/button");SC.PopupButtonView=SC.ButtonView.extend({classNames:["sc-popup-button"],renderDelegateName:"popupButtonRenderDelegate",preferMatrix:null,menu:null,shouldLoadInBackground:NO,init:function(){arguments.callee.base.apply(this,arguments);this._setupMenu();if(this.get("shouldLoadInBackground")){SC.backgroundTaskQueue.push(SC.PopupButtonMenuLoader.create({popupButton:this}))}},_setupMenu:function(){var a=this.get("instantiatedMenu");if(this.isActiveBinding){this.isActiveBinding.disconnect()}this.isActiveBinding=null;if(a&&!a.isClass){this.isActiveBinding=this.bind("isActive",a,"isVisibleInWindow")}},_popup_menuDidChange:function(){this._setupMenu()}.observes("menu"),isActive:NO,_instantiateMenu:function(){var a=this.get("menu");if(!a||!a.isClass){return}this.menu=a.create();this._setupMenu()},instantiatedMenu:function(){var a=this.get("menu");if(a&&a.isClass){this._instantiateMenu();a=this.get("menu")}return a}.property("menu").cacheable(),action:function(a){var b=this.get("instantiatedMenu");if(!b){return NO}b.popup(this,this.get("preferMatrix"));return YES},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this._isMouseDown=YES;this._action();this._menuRenderedTimestamp=0;var b=this;setTimeout(function(){SC.run(function(){b._menuRenderedTimestamp=Date.now()})},1);this.becomeFirstResponder();return YES},mouseUp:function(b){var d=new Date().getTime(),c=this._menuRenderedTimestamp,f=this.get("instantiatedMenu"),g=SC.platform.touch,a;if(c===0){c=Date.now()}if(f){a=f.getPath("rootMenu.targetMenuItem");if(a){if(!a.performAction()){f.remove()}}else{if(!g&&(d-c>SC.ButtonView.CLICK_AND_HOLD_DELAY)){f.remove()}}}this._isMouseDown=NO;arguments.callee.base.apply(this,arguments);return YES},mouseExited:function(a){return YES},performKeyEquivalent:function(b,a){if(!this.get("isEnabled")){return NO}var c=this.get("instantiatedMenu");return(!!c&&c.performKeyEquivalent(b,a,YES))}});SC.PopupButtonMenuLoader=SC.Task.extend({popupButton:null,run:function(){if(this.popupButton){this.popupButton._instantiateMenu()}}});SC.ProgressView=SC.View.extend(SC.Control,{classNames:["sc-progress-view"],displayProperties:["displayValue","ariaValue","minimum","maximum","isRunning","isEnabled","isIndeterminate","animatedBackgroundMatrix","offsetRange"],renderDelegateName:"progressRenderDelegate",value:0.5,valueBindingDefault:SC.Binding.single().notEmpty(),displayValue:function(){var b=this.get("minimum")||0,c=this.get("maximum")||1,a=this.get("value")||0;a=(a-b)/(c-b);if(a>1){a=1}if(isNaN(a)){a=0}if(a<b){a=0}if(a>c){a=1}return a}.property("value","maximum","minimum").cacheable(),ariaRole:"progressbar",ariaValue:function(){return this.get("value")}.property("value").cacheable(),minimum:0,minimumBindingDefault:SC.Binding.single().notEmpty(),contentMinimumKey:null,maximum:1,maximumBindingDefault:SC.Binding.single().notEmpty(),offsetRange:undefined,contentMaximumKey:null,isIndeterminate:NO,isIndeterminateBindingDefault:SC.Binding.bool(),isRunning:NO,isRunningBindingDefault:SC.Binding.bool(),animatedBackgroundMatrix:null,contentIsIndeterminateKey:null,_backgroundOffset:0,_currentBackground:1,_nextBackground:1,init:function(){arguments.callee.base.apply(this,arguments);this.animateProgressBar()},animateProgressBar:function(){if(this.get("isRunning")&&this.get("isVisibleInWindow")){this._animateProgressBar(500)}}.observes("isRunning","isVisibleInWindow"),_animateProgressBar:function(a){if(a===0){a=1000/30}if(this.get("isRunning")&&this.get("isVisibleInWindow")){this.displayDidChange();this.invokeLater(this._animateProgressBar,a,600)}},contentPropertyDidChange:function(c,a){var b=this.get("content");this.beginPropertyChanges().updatePropertyFromContent("value",a,"contentValueKey",b).updatePropertyFromContent("minimum",a,"contentMinimumKey",b).updatePropertyFromContent("maximum",a,"contentMaximumKey",b).updatePropertyFromContent("isIndeterminate",a,"contentIsIndeterminateKey",b).endPropertyChanges()}});SC.RadioView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),classNames:["sc-radio-view"],ariaRole:"radiogroup",displayProperties:["displayItems","isEnabled","layoutDirection"],renderDelegateName:"radioGroupRenderDelegate",itemAriaLabeledByKey:null,itemAriaLabelKey:null,value:null,layoutDirection:SC.LAYOUT_VERTICAL,escapeHTML:YES,items:[],itemTitleKey:null,itemWidthKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemsDidChange:function(){if(this._items){this._items.removeObserver("[]",this,this.itemContentDidChange)}this._items=this.get("items");if(this._items){this._items.addObserver("[]",this,this.itemContentDidChange)}this.itemContentDidChange()}.observes("items"),itemContentDidChange:function(){this._renderAsFirstTime=YES;this.notifyPropertyChange("displayItems")},displayItems:function(){var l=this.get("items"),q=this.get("value"),i=SC.isArray(q),g=this.get("localize"),d=this.get("itemTitleKey"),f=this.get("itemValueKey"),p=this.get("itemWidthKey"),c=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,k=this.get("itemIsEnabledKey"),y=this.get("itemIconKey"),h=this.get("itemAriaLabeledByKey"),A=this.get("itemAriaLabelKey"),x=this._displayItems||[],r=(l)?l.get("length"):0,v,z,m,n,j,w,u,o,b,a,t;for(j=0;j<r;j++){v=l.objectAt(j);if(SC.typeOf(v)===SC.T_ARRAY){z=v[0];n=v[1]}else{if(v){if(d){z=v.get?v.get(d):v[d]}else{z=(v.toString)?v.toString():null}if(p&&c){m=v.get?v.get(p):v[p]}if(f){n=v.get?v.get(f):v[f]}else{n=v}if(k){w=v.get?v.get(k):v[k]}else{w=YES}if(y){u=v.get?v.get(y):v[y]}else{u=null}if(h){a=v.get?v.get(h):v[h]}else{a=null}if(A){t=v.get?v.get(A):v[A]}else{t=null}}else{z=n=u=null;w=NO}}w=w&&this.get("isEnabled");if(v){o=(i)?(q.indexOf(n)>=0):(q===n)}else{o=NO}if(g){z=SC.String.loc(z)}x.push(SC.Object.create({title:z,icon:u,width:m,value:n,isEnabled:w,isSelected:(i&&q.indexOf(n)>=0&&q.length===1)||(q===n),isMixed:(i&&q.indexOf(n)>=0),isActive:this._activeRadioButton===j,theme:this.get("theme"),renderState:{}}))}return x}.property("isEnabled","value","items","itemTitleKey","itemWidthKey","itemValueKey","itemIsEnabledKey","localize","itemIconKey","itemAriaLabeledByKey","itemAriaLabelKey").cacheable(),mouseDown:function(a){if(!this.get("isEnabled")){return YES}var d=this.get("renderDelegate"),c=this.get("renderDelegateProxy"),g=this.$(),b=d.indexForEvent(c,g,a);this._activeRadioButton=b;if(b!==undefined){var f=this.get("displayItems")[b];if(f.get("isEnabled")){f.set("isActive",YES);d.updateRadioAtIndex(c,g,b)}}a.allowDefault();return YES},mouseUp:function(a){if(!this.get("isEnabled")){return YES}var d=this.get("renderDelegate"),c=this.get("renderDelegateProxy"),g=this.$(),h=this.get("displayItems"),b=d.indexForEvent(c,g,a);if(this._activeRadioButton!==undefined&&b!==this._activeRadioButton){h[this._activeRadioButton].set("isActive",NO);d.updateRadioAtIndex(c,g,this._activeRadioButton)}this._activeRadioButton=undefined;if(b!==undefined){var f=this.get("displayItems")[b];if(f.get("isEnabled")){f.set("isActive",NO);d.updateRadioAtIndex(c,g,b);this.set("value",f.value)}}a.allowDefault();return YES},keyDown:function(k){if(!this.get("isEnabled")){return YES}if(k.which===9||k.keyCode===9){var j=k.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(j){j.becomeFirstResponder()}else{k.allowDefault()}return YES}if(k.which>=37&&k.which<=40){var h=this.get("renderDelegate"),g=this.get("renderDelegateProxy"),c=this.$(),f=this.get("displayItems"),b=this.get("value");for(var d=0,a=f.length;d<a;d++){if(b===f[d].value){break}}if(k.which===37||k.which===38){if(d<=0){d=f.length-1}else{d--}}if(k.which===39||k.which===40){if(d>=f.length-1){d=0}else{d++}}h.updateRadioAtIndex(g,c,d);this.set("value",f[d].value)}k.allowDefault();return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)}});SC.SceneView=SC.ContainerView.extend({scenes:["master","detail"],nowShowing:null,transitionDuration:200,_state:"NO_VIEW",replaceContent:function(a){if(a&&this._state===this.READY){this.animateScene(a)}else{this.replaceScene(a)}return this},replaceScene:function(c){var d=this._targetView,f=this.STANDARD_LAYOUT,b=this.get("scenes"),a=b?b.indexOf(this.get("nowShowing")):-1;this._targetView=c;this._targetIndex=a;if(this._timer){this._timer.invalidate()}this._leftView=this._rightView=this._start=this._end=null;this._timer=null;this.removeAllChildren();if(d){d.set("layout",f)}if(c){c.set("layout",f)}if(c){this.appendChild(c)}this._state=c?this.READY:this.NO_VIEW},animateScene:function(b){var c=this._targetView,g=this._targetIndex,a=this.get("scenes"),f=a?a.indexOf(this.get("nowShowing")):-1,d;if(g<0||f<0||g===f){return this.replaceScene(b)}this._targetView=b;this._targetIndex=f;if(f>g){this._leftView=c;this._rightView=b;this._target=-1}else{this._leftView=b;this._rightView=c;this._target=1}this.removeAllChildren();if(c){this.appendChild(c)}if(b){this.appendChild(b)}this._start=Date.now();this._end=this._start+this.get("transitionDuration");this._state=this.ANIMATING;this.tick()},tick:function(){this._timer=null;var a=Date.now(),d=(a-this._start)/(this._end-this._start),h=this._target,g=this._leftView,b=this._rightView,c,f;if(d<0){d=0}if(!this.get("isVisibleInWindow")||(d>=1)){return this.replaceScene(this._targetView)}c=SC.clone(this.get("frame"));f=Math.floor(c.width*d);if(h>0){c.left=0-(c.width-f);g.set("layout",c);c=SC.clone(c);c.left=f;b.set("layout",c)}else{c.left=0-f;g.set("layout",c);c=SC.clone(c);c.left=c.width-f;b.set("layout",c)}this._timer=this.invokeLater(this.tick,20);return this},NO_VIEW:"NO_VIEW",ANIMATING:"ANIMATING",READY:"READY",STANDARD_LAYOUT:{top:0,left:0,bottom:0,right:0}});SC.SegmentView=SC.View.extend(SC.Control,{ariaRole:"button",isSegment:YES,classNames:["sc-segment-view"],toolTip:null,isEnabled:YES,isActive:NO,isSelected:NO,layoutDirection:SC.LAYOUT_HORIZONTAL,controlSize:null,supportFocusRing:NO,displayProperties:["icon","displayTitle","value","displayToolTip","isDefault","isCancel","width","isSegment","isFirstSegment","isMiddleSegment","isLastSegment","isOverflowSegment","index","layoutDirection"],renderDelegateName:"segmentRenderDelegate",useStaticLayout:YES,title:"",value:null,icon:null,localize:NO,keyEquivalent:null,escapeHTML:YES,needsEllipsis:YES,displayTitle:function(){var a=this.get("title");if(this.get("localize")){a=SC.String.loc(a)}return a}.property("title","localize").cacheable(),width:null,localItem:null,widthDidChange:function(){this.adjust("width",this.get("width"))}.observes("width"),updateItem:function(d,c){var h=d.get("itemKeys"),g,a=d.get("viewKeys"),f,b;for(b=h.get("length")-1;b>=0;b--){g=d.get(h.objectAt(b));f=a.objectAt(b);if(!SC.none(c.get(g))){this.set(f,c.get(g))}}this.set("localItem",c)}});sc_require("views/segment");SC.SegmentedView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled").cacheable(),ariaRole:"group",classNames:["sc-segmented-view"],theme:"square",value:null,isEnabled:YES,allowsEmptySelection:NO,allowsMultipleSelection:NO,selectSegmentWhenTriggeringAction:NO,localize:YES,align:SC.ALIGN_CENTER,layoutDirection:SC.LAYOUT_HORIZONTAL,items:null,itemTitleKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemWidthKey:null,itemActionKey:null,itemTargetKey:null,itemLayerIdKey:null,itemKeyEquivalentKey:null,shouldHandleOverflow:YES,overflowTitle:"&raquo;",overflowToolTip:"More&hellip;",overflowIcon:null,segmentViewClass:SC.SegmentView,itemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemWidthKey","itemToolTipKey","itemKeyEquivalentKey","itemLayerIdKey"],viewKeys:["title","value","isEnabled","icon","width","toolTip","keyEquivalent","layerId"],init:function(){arguments.callee.base.apply(this,arguments);var d=this.get("overflowTitle"),a=this.get("overflowToolTip"),b=this.get("overflowIcon"),c;c=this.get("segmentViewClass").create({controlSize:this.get("controlSize"),localize:this.get("localize"),title:d,toolTip:a,icon:b,isLastSegment:YES,isOverflowSegment:YES,layoutDirection:this.get("layoutDirection"),isVisible:this.get("shouldHandleOverflow")});this.set("overflowView",c);this.appendChild(c);this.itemsDidChange()},shouldHandleOverflowDidChange:function(){if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}else{this.get("overflowView").set("isVisible",NO)}}.observes("shouldHandleOverflow"),itemsDidChange:function(){var m=this.get("items")||[],r,c,o=this.get("childViews"),k,d=o.lastObject(),p=this.get("value"),b,q=this.get("itemKeys"),a,n=this.get("viewKeys"),g,l=this.get("segmentViewClass"),h,f;if(o.get("length")-1>m.get("length")){for(h=o.get("length")-2;h>=m.get("length");h--){k=o.objectAt(h);if(SC.isArray(p)){p.removeObject(k.get("value"))}else{if(p===k.get("value")){p=null}}this.removeChild(k)}this.set("value",p)}else{if(o.get("length")-1<m.get("length")){for(h=o.get("length")-1;h<m.get("length");h++){k=l.create({controlSize:this.get("controlSize"),localize:this.get("localize"),layoutDirection:this.get("layoutDirection")});this.insertBefore(k,d)}}}o=this.get("childViews");for(h=0;h<m.get("length");h++){c=m.objectAt(h);k=o.objectAt(h);if(SC.none(c)){continue}if(SC.typeOf(c)===SC.T_STRING){c=SC.Object.create({title:c.humanize().titleize(),value:c});this.set("itemTitleKey","title");this.set("itemValueKey","value")}else{if(SC.typeOf(c)===SC.T_HASH){c=SC.Object.create(c)}else{if(c instanceof SC.Object){for(f=q.get("length")-1;f>=0;f--){a=this.get(q.objectAt(f));if(a){c.removeObserver(a,this,this.itemContentDidChange);c.addObserver(a,this,this.itemContentDidChange,h)}}}else{SC.Logger.error("SC.SegmentedView items may be Strings, Objects (ie. Hashes) or SC.Objects only")}}}b=NO;if(SC.isArray(p)?p.indexOf(c.get(this.get("itemValueKey")))>=0:p===c.get(this.get("itemValueKey"))){b=YES}k.set("isSelected",b);k.set("index",h);k.set("isFirstSegment",h===0);k.set("isMiddleSegment",h<m.get("length")-1&&h>0);k.set("isLastSegment",h===m.get("length")-1);k.updateItem(this,c)}if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}}.observes("*items.[]"),itemContentDidChange:function(f,d,b,c){var a=this.get("items"),g=this.get("childViews"),h;h=g.objectAt(c);if(h){h.updateItem(this,f)}else{SC.Logger.warn("Item content change was observed on item without matching segment child view.")}if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}},viewDidResize:function(){var b=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,a=b?this.$().width():this.$().height();if(this.get("shouldHandleOverflow")&&(this.isOverflowing||a<=this.cachedMinimumDim)){this.adjustOverflow()}},isVisibleInWindowDidChange:function(){if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}}.observes("isVisibleInWindow"),remeasure:function(){if(!this.get("shouldHandleOverflow")){return}var a=this.get("renderDelegate"),d=this.get("childViews"),c;if(this.get("isVisibleInWindow")){c=d.lastObject();c.set("isVisible",YES);for(var b=d.get("length")-1;b>=0;b--){d.objectAt(b).set("isVisible",YES)}this.cachedDims=this.segmentDimensions();this.cachedOverflowDim=this.overflowSegmentDim();this.adjustOverflow()}},adjustOverflow:function(){if(!this.get("shouldHandleOverflow")){return}var g=this.get("childViews"),f,j=this.get("value"),b=g.lastObject(),h=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,l=h?this.$().width():this.$().height(),d=0,k,a,c;this.isOverflowing=NO;b.set("isSelected",NO);this.overflowItems=[];a=this.cachedDims.length;for(c=0;c<a;c++){f=g.objectAt(c);d+=this.cachedDims[c];k=(c===a-1)?d:d+this.cachedOverflowDim;if(k>l){this.overflowItems.pushObject(f.get("localItem"));this.isOverflowing=YES;f.set("isVisible",NO);if(c===0){b.set("isFirstSegment",YES)}if(SC.isArray(j)?j.indexOf(f.get("value"))>=0:j===f.get("value")){b.set("isSelected",YES)}}else{f.set("isVisible",YES);if(c===0){b.set("isFirstSegment",NO)}}}if(this.isOverflowing){b.set("isVisible",YES)}else{b.set("isVisible",NO)}this.cachedMinimumDim=d+this.cachedOverflowDim},segmentDimensions:function(){var b=this.get("childViews"),a,g,j=[],h=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL;for(var c=0,d=b.length;c<d-1;c++){a=b[c];g=a.get("frame");j[c]=h?g.width:g.height}return j},overflowSegmentDim:function(){var b=this.get("childViews"),a,c,d=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL;a=b.length&&b[b.length-1];if(a){c=a.get("frame");return d?c.width:c.height}return 0},indexForClientPosition:function(b,j){var d=this.get("childViews"),h,f,c,g,a;a={x:b,y:j};for(f=0,h=d.length;f<h;f++){c=d[f];g=c.get("layer").getBoundingClientRect();g={x:g.left,y:g.top,width:(g.right-g.left),height:(g.bottom-g.top)};if(SC.pointInRect(a,g)){return f}}return -1},displayProperties:["align"],renderDelegateName:"segmentedRenderDelegate",displayItemIndexForEvent:function(b){var c=this.get("renderDelegate");var a=b.clientX;var g=b.clientY;if(a===0&&g===0){var d=b.target;if(d){var f=SC.offset(d);a=f.x+Math.round(d.offsetWidth/2);g=f.y+Math.round(d.offsetHeight/2)}}if(c&&c.indexForClientPosition){return c.indexForClientPosition(this,a,g)}return this.indexForClientPosition(b.clientX,b.clientY)},keyDown:function(c){var h,j,d,f,g,b;if(c.which===9||c.keyCode===9){var a=c.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{c.allowDefault()}return YES}if(!this.get("allowsMultipleSelection")){h=this.get("childViews");f=h.get("length");g=this.get("value");b=SC.isArray(g);if(c.which===39||c.which===40){if(g){for(d=0;d<f-2;d++){j=h.objectAt(d);if(b?(g.indexOf(j.get("value"))>=0):(j.get("value")===g)){this.triggerItemAtIndex(d+1)}}}else{this.triggerItemAtIndex(0)}return YES}else{if(c.which===37||c.which===38){if(g){for(d=1;d<f-1;d++){j=h.objectAt(d);if(b?(g.indexOf(j.get("value"))>=0):(j.get("value")===g)){this.triggerItemAtIndex(d-1)}}}else{this.triggerItemAtIndex(f-2)}return YES}}}return NO},mouseDown:function(a){var c=this.get("childViews"),f,d=c.get("length")-1,b;if(!this.get("isEnabled")){return YES}b=this.displayItemIndexForEvent(a);if(b>=0){f=c.objectAt(b);f.set("isActive",YES);this.activeChildView=f;if(b===d){this.showOverflowMenu()}else{this._isMouseDown=YES}}return YES},mouseUp:function(a){var c,b;b=this.displayItemIndexForEvent(a);if(this._isMouseDown&&(b>=0)){this.triggerItemAtIndex(b);c=this.activeChildView;c.set("isActive",NO);this.activeChildView=null}this._isMouseDown=NO;return YES},mouseMoved:function(a){var d=this.get("childViews"),f=d.get("length")-1,c,g,b;if(this._isMouseDown){b=this.displayItemIndexForEvent(a);c=this.activeChildView;g=d.objectAt(b);if(g&&g!==c){if(c){c.set("isActive",NO)}g.set("isActive",YES);this.activeChildView=g;if(b===f){this.showOverflowMenu();this._isMouseDown=NO}}}return YES},mouseEntered:function(a){var c=this.get("childViews"),f,d=c.get("length")-1,b;if(this._isMouseDown){b=this.displayItemIndexForEvent(a);if(b===d){this.showOverflowMenu();this._isMouseDown=NO}else{if(b>=0){f=c.objectAt(b);f.set("isActive",YES);this.activeChildView=f}}}return YES},mouseExited:function(a){var b;if(this._isMouseDown){b=this.activeChildView;if(b){b.set("isActive",NO)}this.activeChildView=null}return YES},touchStart:function(f){var b=this.get("childViews"),d,c=b.get("length")-1,a;if(!this.get("isEnabled")){return YES}a=this.displayItemIndexForEvent(f);if(a>=0){d=b.objectAt(a);d.set("isActive",YES);this.activeChildView=d;if(a===c){this.showOverflowMenu()}else{this._isTouching=YES}}return YES},touchEnd:function(c){var b,a;a=this.displayItemIndexForEvent(c);if(this._isTouching&&(a>=0)){this.triggerItemAtIndex(a);b=this.activeChildView;b.set("isActive",NO);this.activeChildView=null;this._isTouching=NO}return YES},touchesDragged:function(a,f){var i=this.touchIsInBoundary(a),d=this.get("childViews"),g=d.get("length")-1,c,h,b;if(i){if(!this._isTouching){this._touchDidEnter(a)}b=this.displayItemIndexForEvent(a);c=this.activeChildView;h=d[b];if(h&&h!==c){if(c){c.set("isActive",NO)}h.set("isActive",YES);this.activeChildView=h;if(b===g){this.showOverflowMenu();this._isMouseDown=NO}}}else{if(this._isTouching){this._touchDidExit(a)}}this._isTouching=i;return YES},_touchDidExit:function(a){var b;if(this.isTouching){b=this.activeChildView;b.set("isActive",NO);this.activeChildView=null}return YES},_touchDidEnter:function(a){var c=this.get("childViews"),f,d=c.get("length")-1,b;b=this.displayItemIndexForEvent(a);if(b===d){this.showOverflowMenu();this._isTouching=NO}else{if(b>=0){f=c.objectAt(b);f.set("isActive",YES);this.activeChildView=f}}return YES},triggerItemAtIndex:function(j){var l=this.get("childViews"),h,b,m,c,i,g;h=l.objectAt(j);if(!h.get("isEnabled")){return this}i=this.get("allowsEmptySelection");g=this.get("allowsMultipleSelection");b=h.get("value");m=c=this.get("value");if(SC.empty(m)){m=[]}else{if(!SC.isArray(m)){m=[m]}}if(!g){if(i&&(m.get("length")===1)&&(m.objectAt(0)===b)){m=[]}else{m=[b]}}else{if(m.indexOf(b)>=0){if(m.get("length")>1||(m.objectAt(0)!==b)||i){m=m.without(b)}}else{m=m.concat([b])}}switch(m.get("length")){case 0:m=null;break;case 1:m=m.objectAt(0);break;default:break}var o=this.get("itemActionKey"),a=this.get("itemTargetKey"),f,k=null,d=this.getPath("pane.rootResponder"),n;if(o&&(n=this.get("items").objectAt(j))){f=n.get?n.get(o):n[o];if(a){k=n.get?n.get(a):n[a]}if(d){d.sendAction(f,k,this,this.get("pane"),m)}}if(c!==undefined&&(!f||this.get("selectSegmentWhenTriggeringAction"))){this.set("value",m)}f=this.get("action");if(f&&d){d.sendAction(f,this.get("target"),this,this.get("pane"),m)}},selectOverflowItem:function(b){var a=b.get("selectedItem");this.triggerItemAtIndex(a.get("index"));b.removeObserver("selectedItem",this,"selectOverflowItem");this.activeChildView.set("isActive",NO);this.activeChildView=null},showOverflowMenu:function(){var g=this.get("childViews"),b=g.get("length")-1,p=this.overflowItems,l,k,f,j;l=p.get("length");k=g.get("length")-1-l;j=this.get("value");f=SC.isArray(j);for(var c=0;c<l;c++){var o=p.objectAt(c),m=this.get("itemValueKey");if(f?j.indexOf(o.get(m))>=0:j===o.get(m)){o.set("isChecked",YES)}else{o.set("isChecked",NO)}o.set("index",k+c)}var n=this;var a=SC.MenuPane.create({layout:{width:200},items:p,itemTitleKey:this.get("itemTitleKey"),itemIconKey:this.get("itemIconKey"),itemIsEnabledKey:this.get("itemIsEnabledKey"),itemKeyEquivalentKey:this.get("itemKeyEquivalentKey"),itemCheckboxKey:"isChecked",modalPaneDidClick:function(){arguments.callee.base.apply(this,arguments);this.removeObserver("selectedItem",n,"selectOverflowItem");n.activeChildView.set("isActive",NO);n.activeChildView=null}});var d=this.get("layer");var h=d.childNodes[d.childNodes.length-1];a.popup(h);a.addObserver("selectedItem",this,"selectOverflowItem")},valueDidChange:function(){var d=this.get("value"),c,g=this.get("childViews"),h=Infinity,f=g.lastObject(),j,a;if(this.overflowItems){c=this.overflowItems.get("length");h=g.get("length")-1-c;f.set("isSelected",NO)}for(var b=g.get("length")-2;b>=0;b--){j=g.objectAt(b);if(SC.isArray(d)?d.indexOf(j.get("value"))>=0:d===j.get("value")){j.set("isSelected",YES);if(b>=h){f.set("isSelected",YES)}}else{j.set("isSelected",NO)}}}.observes("value")});sc_require("views/button");SC.SelectView=SC.ButtonView.extend({acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),escapeHTML:YES,escapeHTMLBindingDefault:SC.Binding.oneWay().bool(),items:[],itemsBindingDefault:SC.Binding.multiple(),itemTitleKey:null,itemSortKey:null,itemValueKey:null,itemIconKey:null,itemSeparatorKey:"separator",itemIsEnabledKey:"isEnabled",localize:YES,disableSort:YES,classNames:["sc-select-view"],menu:null,_itemList:[],_itemIdx:null,value:null,checkboxEnabled:YES,showCheckbox:YES,emptyName:null,_defaultVal:null,_defaultTitle:null,_defaultIcon:null,theme:"popup",displayProperties:["icon","value","controlSize","items","escapeHTML","emptyName"],preferMatrix:null,CUSTOM_MENU_ITEM_HEIGHT:20,isActiveBinding:"*menu.isVisibleInWindow",isDefaultPosition:NO,lastMenuWidth:null,exampleView:null,customViewMenuOffsetWidth:0,needsEllipsis:YES,menuPaneHeightPadding:0,menuItemPadding:35,isContextMenuEnabled:NO,supportFocusRing:YES,leftAlign:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:return SC.SelectView.TINY_OFFSET_X;case SC.SMALL_CONTROL_SIZE:return SC.SelectView.SMALL_OFFSET_X;case SC.REGULAR_CONTROL_SIZE:return SC.SelectView.REGULAR_OFFSET_X;case SC.LARGE_CONTROL_SIZE:return SC.SelectView.LARGE_OFFSET_X;case SC.HUGE_CONTROL_SIZE:return SC.SelectView.HUGE_OFFSET_X}return 0}.property("controlSize"),sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("itemSortKey")||this.get("itemTitleKey");b=b.sort(function(d,c){if(a){d=d.get?d.get(a):d[a];c=c.get?c.get(a):c[a]}return(d<c)?-1:((d>c)?1:0)})}return b},render:function(b,h){arguments.callee.base.apply(this,arguments);var r,d,m,t,v,A,i,g,y,j,p,a,o,f,l,z,u,q,w,n,k,x,c;m=this.get("items");m=this.sortObjects(m);t=m.length;v=this.get("itemTitleKey");A=this.get("itemIconKey");i=this.get("itemValueKey");g=this.get("itemSeparatorKey");y=this.get("showCheckbox");k=this.get("itemIsEnabledKey");r=this.get("escapeHTML");j=this.get("value");p=this.get("localize");o=[];f=YES;l=0;x=this.get("emptyName");if(!SC.none(x)){x=p?SC.String.loc(x):x;x=r?SC.RenderContext.escapeHTML(x):x;w=SC.Object.create({separator:NO,title:x,icon:null,value:null,isEnabled:YES,checkbox:NO,target:this,action:"displaySelectedItem"});if(SC.none(j)){this.set("title",x)}o.push(w)}m.forEach(function(B){if(B||B===0){z=v?(B.get?B.get(v):B[v]):B.toString();z=p?SC.String.loc(z):z;z=r?SC.RenderContext.escapeHTML(z):z;u=A?(B.get?B.get(A):B[A]):null;if(SC.none(B[A])){u=null}q=(i)?(B.get?B.get(i):B[i]):B;if(!SC.none(j)&&!SC.none(q)){c=false;if(SC.kindOf(j,SC.Record)&&SC.kindOf(q,SC.Record)){c=j.get("storeKey")===q.get("storeKey")}if(j===q||c){this.set("title",z);this.set("icon",u)}}if(q===this.get("value")){this.set("_itemIdx",l);f=!y?NO:YES}else{f=NO}n=(B.get?B.get(k):B[k]);if(NO!==n){n=YES}a=g?(B.get?B.get(g):B[g]):NO;if(l===0){this._defaultVal=q;this._defaultTitle=z;this._defaultIcon=u}w=SC.Object.create({separator:a,title:z,icon:u,value:q,isEnabled:n,checkbox:f,target:this,action:"displaySelectedItem"});o.push(w)}l+=1;this.set("_itemList",o)},this);if(h){this.invokeLast(function(){var B=this.get("value");if(SC.none(B)){if(SC.none(x)){this.set("value",this._defaultVal);this.set("title",this._defaultTitle);this.set("icon",this._defaultIcon)}else{this.set("title",x)}}})}this.changeSelectPreferMatrix(this.get("_itemIdx"))},_action:function(m){var j,a,k,l,r,o,A,f,z,c,n,u,p,x,g,h,b,y,i,t;j=this.$(".sc-button-label")[0];var B=SC.SelectView.MENU_WIDTH_OFFSET;if(!this.get("isDefaultPosition")){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:B+=SC.SelectView.TINY_POPUP_MENU_WIDTH_OFFSET;break;case SC.SMALL_CONTROL_SIZE:B+=SC.SelectView.SMALL_POPUP_MENU_WIDTH_OFFSET;break;case SC.REGULAR_CONTROL_SIZE:B+=SC.SelectView.REGULAR_POPUP_MENU_WIDTH_OFFSET;break;case SC.LARGE_CONTROL_SIZE:B+=SC.SelectView.LARGE_POPUP_MENU_WIDTH_OFFSET;break;case SC.HUGE_CONTROL_SIZE:B+=SC.SelectView.HUGE_POPUP_MENU_WIDTH_OFFSET;break}}a=this.get("layer").offsetWidth+B;a=this.get("layer").offsetWidth;k=j.scrollWidth;l=this.get("lastMenuWidth");if(k){r=j.offsetWidth;if(k&&r){a=a+k-r}}if(!l||(a>l)){l=a}o=this.get("_itemList");var v=this.get("customViewClassName");var q=this.get("customViewMenuOffsetWidth");var d="sc-view sc-pane sc-panel sc-palette sc-picker sc-menu select-button sc-scroll-view sc-menu-scroll-view sc-container-view menuContainer sc-button-view sc-menu-item sc-regular-size";d=v?(d+" "+v):d;SC.prepareStringMeasurement("",d);for(n=0,y=o.length;n<y;++n){z=o.objectAt(n);A=SC.measureString(z.title).width;if(!f||(A>f)){f=A}}SC.teardownStringMeasurement();l=(f+this.menuItemPadding>l)?f+this.menuItemPadding:l;var w=SC.RootResponder.responder.get("currentWindowSize").width;if(l>w){l=(w-25)}this.set("lastMenuWidth",l);u=this.get("value");p=this.get("_itemList");x=this.get("controlSize");g=this.get("menuPaneHeightPadding");t=this.get("escapeHTML");h=this.get("exampleView")||SC.MenuItemView.extend({escapeHTML:t});b=SC.MenuPane.create({classNames:["select-button"],items:p,exampleView:h,isEnabled:YES,menuHeightPadding:g,preferType:SC.PICKER_MENU,itemHeightKey:"height",layout:{width:l},controlSize:x,itemWidth:l});if(!b){return NO}b.popup(this,this.preferMatrix);this.set("menu",b);i=this._itemIdx;if(!SC.empty(i)&&i>-1){h=b.menuItemViewForContentIndex(i);if(h){h.becomeFirstResponder()}}this.set("isActive",YES);return YES},displaySelectedItem:function(a){var b=a.get("selectedItem");this.set("value",b.get("value"));this.set("title",b.get("title"));this.set("_itemIdx",b.get("contentIndex"))},changeSelectPreferMatrix:function(){var c=0,h=0;switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:c=SC.SelectView.TINY_OFFSET_Y;h=SC.MenuPane.TINY_MENU_ITEM_HEIGHT;break;case SC.SMALL_CONTROL_SIZE:c=SC.SelectView.SMALL_OFFSET_Y;h=SC.MenuPane.SMALL_MENU_ITEM_HEIGHT;break;case SC.REGULAR_CONTROL_SIZE:c=SC.SelectView.REGULAR_OFFSET_Y;h=SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT;break;case SC.LARGE_CONTROL_SIZE:c=SC.SelectView.LARGE_OFFSET_Y;h=SC.MenuPane.LARGE_MENU_ITEM_HEIGHT;break;case SC.HUGE_CONTROL_SIZE:c=SC.SelectView.HUGE_OFFSET_Y;h=SC.MenuPane.HUGE_MENU_ITEM_HEIGHT;break}var f=c,b=this.get("_itemIdx"),a=this.get("leftAlign"),g,d;if(this.get("isDefaultPosition")){g=[1,0,3];this.set("preferMatrix",g)}else{if(b){f=b*h+c}d=[a,-f,2];this.set("preferMatrix",d)}},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;this.becomeFirstResponder();this._action();return YES},mouseUp:function(b){var d=this.get("menu"),a,c;if(d){a=d.getPath("rootMenu.targetMenuItem");if(a&&d.get("mouseHasEntered")){if(!a.performAction()){d.remove()}}else{if(b.timeStamp-this._mouseDownTimestamp>400){d.remove()}}}this._isMouseDown=NO;this.set("isActive",NO);return YES},mouseExited:function(){return YES},keyDown:function(a){if(this.interpretKeyEvents(a)){return YES}else{return arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(a){if(a){if((a.keyCode===38||a.keyCode===40)){this._action()}else{if(a.keyCode===27){this.resignFirstResponder()}}}return arguments.callee.base.apply(this,arguments)},_button_isSelectedDidChange:function(){}.observes("isSelected")});SC.SelectView.TINY_OFFSET_X=0;SC.SelectView.TINY_OFFSET_Y=0;SC.SelectView.TINY_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectView.SMALL_OFFSET_X=-18;SC.SelectView.SMALL_OFFSET_Y=3;SC.SelectView.SMALL_POPUP_MENU_WIDTH_OFFSET=7;SC.SelectView.REGULAR_OFFSET_X=-17;SC.SelectView.REGULAR_OFFSET_Y=0;SC.SelectView.REGULAR_POPUP_MENU_WIDTH_OFFSET=4;SC.SelectView.LARGE_OFFSET_X=-17;SC.SelectView.LARGE_OFFSET_Y=6;SC.SelectView.LARGE_POPUP_MENU_WIDTH_OFFSET=3;SC.SelectView.HUGE_OFFSET_X=0;SC.SelectView.HUGE_OFFSET_Y=0;SC.SelectView.HUGE_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectView.MENU_WIDTH_OFFSET=-2;sc_require("views/button");SC.SelectButtonView=SC.ButtonView.extend({init:function(){arguments.callee.base.apply(this,arguments)},escapeHTML:YES,objects:[],objectsBindingDefault:SC.Binding.multiple(),nameKey:null,sortKey:null,valueKey:null,iconKey:null,isEnabledKey:"isEnabled",localize:YES,disableSort:YES,classNames:["select-button"],menu:null,itemList:[],itemIdx:null,value:null,checkboxEnabled:YES,separatorPosition:null,_defaultVal:null,_defaultTitle:null,_defaultIcon:null,theme:"popup",displayProperties:["icon","value","controlSize","objects","objects.[]"],preferMatrix:null,SELECT_BUTTON_SPRITE_WIDTH:28,isActiveBinding:"*menu.isVisibleInWindow",isDefaultPosition:NO,lastMenuWidth:null,customView:null,customViewClassName:null,customViewMenuOffsetWidth:0,needsEllipsis:YES,menuPaneHeightPadding:0,supportFocusRing:YES,isContextMenuEnabled:NO,leftAlign:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:return SC.SelectButtonView.TINY_OFFSET_X;case SC.SMALL_CONTROL_SIZE:return SC.SelectButtonView.SMALL_OFFSET_X;case SC.REGULAR_CONTROL_SIZE:return SC.SelectButtonView.REGULAR_OFFSET_X;case SC.LARGE_CONTROL_SIZE:return SC.SelectButtonView.LARGE_OFFSET_X;case SC.HUGE_CONTROL_SIZE:return SC.SelectButtonView.HUGE_OFFSET_X}return 0}.property("controlSize"),sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("sortKey")||this.get("nameKey");b=b.sort(function(d,c){if(a){d=d.get?d.get(a):d[a];c=c.get?c.get(a):c[a]}return(d<c)?-1:((d>c)?1:0)})}return b},render:function(b,f){arguments.callee.base.apply(this,arguments);var c,a,o,q,v,g,t,h,m,u,l,d,j,w,p,n,r,k,i;c=this.layout.width;if(f&&c){this.adjust({width:c-this.SELECT_BUTTON_SPRITE_WIDTH})}a=this.get("objects");a=this.sortObjects(a);o=a.length;q=this.get("nameKey");v=this.get("iconKey");g=this.get("valueKey");i=this.get("isEnabledKey");t=this.get("checkboxEnabled");h=this.get("value");m=this.get("localize");u=this.get("separatorPosition");l=[];d=YES;j=0;a.forEach(function(x){if(x){w=q?(x.get?x.get(q):x[q]):x.toString();w=m?SC.String.loc(w):w;p=v?(x.get?x.get(v):x[v]):null;if(SC.none(x[v])){p=null}n=(g)?(x.get?x.get(g):x[g]):x;if(!SC.none(h)&&!SC.none(n)){if(this._equals(h,n)){this.set("title",w);this.set("icon",p)}}if(this._equals(n,this.get("value"))){if(u>0&&u<o&&j>=o-u){j++}this.set("itemIdx",j);d=!t?NO:YES}else{d=NO}k=(i)?(x.get?x.get(i):x[i]):x;if(NO!==k){k=YES}if(j===0){this._defaultVal=n;this._defaultTitle=w;this._defaultIcon=p}var y=SC.Object.create({title:w,icon:p,value:n,isEnabled:k,checkbox:d,target:this,action:"displaySelectedItem"});l.push(y)}j+=1;if(u&&j===(o-u)){var z=SC.Object.create({separator:YES});l.push(z)}this.set("itemList",l)},this);if(f){b.attr("aria-haspopup","true");this.invokeLast(function(){var x=this.get("value");if(SC.none(x)){this.set("value",this._defaultVal);this.set("title",this._defaultTitle);this.set("icon",this._defaultIcon)}})}this.changeSelectButtonPreferMatrix(this.itemIdx)},_equals:function(b,a){var c=YES;if(b&&SC.typeOf(b)===SC.T_HASH&&a&&SC.typeOf(a)===SC.T_HASH){for(var d in b){if(b[d]!==a[d]){c=NO}}}else{c=(b===a)}return c},_action:function(p){var j,a,m,n,v,r,C,f,B,c,q,w,t,z,g,h,o,b,A,i,l,D,k;j=this.$(".sc-button-label")[0];D=SC.SelectButtonView.MENU_WIDTH_OFFSET;if(!this.get("isDefaultPosition")){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:D+=SC.SelectButtonView.TINY_POPUP_MENU_WIDTH_OFFSET;break;case SC.SMALL_CONTROL_SIZE:D+=SC.SelectButtonView.SMALL_POPUP_MENU_WIDTH_OFFSET;break;case SC.REGULAR_CONTROL_SIZE:D+=SC.SelectButtonView.REGULAR_POPUP_MENU_WIDTH_OFFSET;break;case SC.LARGE_CONTROL_SIZE:D+=SC.SelectButtonView.LARGE_POPUP_MENU_WIDTH_OFFSET;break;case SC.HUGE_CONTROL_SIZE:D+=SC.SelectButtonView.HUGE_POPUP_MENU_WIDTH_OFFSET;break}}a=this.get("layer").offsetWidth+D;m=j.scrollWidth;n=this.get("lastMenuWidth");if(m){v=j.offsetWidth;if(m&&v){a=a+m-v}}if(!n||(a>n)){n=a}r=this.get("itemList");var x=this.get("customViewClassName"),u=this.get("customViewMenuOffsetWidth"),d="sc-view sc-pane sc-panel sc-palette sc-picker sc-menu select-button menu sc-scroll-view sc-menu-scroll-view sc-container-view sc-menu-item menu-item value sc-regular-size";d=x?(d+" "+x):d;i=(this.get("customView")||SC.MenuItemView).create();l=i.get("escapeHTML");k=document.body;for(q=0,A=r.length;q<A;++q){B=r.objectAt(q);c=document.createElement("div");c.style.cssText="top:-10000px; left: -10000px;  position: absolute;";c.className=d;c.innerHTML=l?SC.RenderContext.escapeHTML(B.title):B.title;k.appendChild(c);C=c.offsetWidth+u;if(!f||(C>f)){f=C}k.removeChild(c)}f=(f>n)?f:n;var y=SC.RootResponder.responder.get("currentWindowSize").width;if(f>y){f=(y-25)}this.set("lastMenuWidth",n);w=this.get("value");t=this.get("itemList");z=this.get("controlSize");h=this.get("customView");o=h?h:SC.MenuItemView;b=SC.MenuPane.create({classNames:["select-button"],items:t,exampleView:o,isEnabled:YES,preferType:SC.PICKER_MENU,itemHeightKey:"height",layout:{width:f},controlSize:z,itemWidth:n,performKeyEquivalent:function(F,E){switch(F){case"tab":case"shift_tab":return YES;default:return arguments.callee.base.apply(this,arguments)}}});if(!b){return NO}b.popup(this,this.preferMatrix);this.set("menu",b);h=b.menuItemViewForContentIndex(this.get("itemIdx"));b.set("currentMenuItem",h);if(h){h.becomeFirstResponder()}this.set("isActive",YES);return YES},displaySelectedItem:function(a){var b=this.getPath("menu.selectedItem");if(!b){return NO}this.set("value",b.get("value"));this.set("title",b.get("title"));this.set("itemIdx",b.get("contentIndex"));return YES},changeSelectButtonPreferMatrix:function(){var b=0,i=0,d=0,f=0,j,g;switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:b=SC.SelectButtonView.TINY_OFFSET_Y;i=SC.MenuPane.TINY_MENU_ITEM_HEIGHT;d=SC.MenuPane.TINY_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.SMALL_CONTROL_SIZE:b=SC.SelectButtonView.SMALL_OFFSET_Y;i=SC.MenuPane.SMALL_MENU_ITEM_HEIGHT;d=SC.MenuPane.SMALL_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.REGULAR_CONTROL_SIZE:b=SC.SelectButtonView.REGULAR_OFFSET_Y;i=SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT;d=SC.MenuPane.REGULAR_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.LARGE_CONTROL_SIZE:b=SC.SelectButtonView.LARGE_OFFSET_Y;i=SC.MenuPane.LARGE_MENU_ITEM_HEIGHT;d=SC.MenuPane.LARGE_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.HUGE_CONTROL_SIZE:b=SC.SelectButtonView.HUGE_OFFSET_Y;i=SC.MenuPane.HUGE_MENU_ITEM_HEIGHT;d=SC.MenuPane.HUGE_MENU_ITEM_SEPARATOR_HEIGHT;break}var h=b,a=this.get("itemIdx"),l=this.get("leftAlign"),k,c;if(this.get("isDefaultPosition")){k=[1,0,3];this.set("preferMatrix",k)}else{if(a){h=a*i+b;j=this.get("separatorPosition");g=this.get("objects").length;if(j>0&&j<g&&a>=g-j){f=i-d;h-=f}}c=[l,-h,2];this.set("preferMatrix",c)}},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;this.becomeFirstResponder();this._action();this._menuRenderedTimestamp=0;var b=this;setTimeout(function(){SC.run(function(){b._menuRenderedTimestamp=Date.now()})},1);return YES},_recordMouseDownTimestamp:function(){this._menuRenderedTimestamp=new Date().getTime()},mouseUp:function(b){var d=new Date().getTime(),c=this._menuRenderedTimestamp,f=this.get("menu"),g=SC.platform.touch,a;if(c===0){c=Date.now()}if(f){a=f.getPath("rootMenu.targetMenuItem");if(a&&a.get("mouseHasEntered")){if(!a.performAction()){f.remove()}}else{if(!g&&(d-c>SC.ButtonView.CLICK_AND_HOLD_DELAY)){if(!f.get("mouseHasEntered")&&!this.get("isDefaultPosition")){a=f.get("currentMenuItem");if(a&&!a.performAction()){f.remove()}}else{f.remove()}}}}this._isMouseDown=NO;this.set("isActive",NO);return YES},mouseExited:function(){return YES},keyDown:function(a){if(this.interpretKeyEvents(a)){return YES}else{return arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(a){if(a){if((a.keyCode===38||a.keyCode===40)){this._action()}else{if(a.keyCode===27){this.resignFirstResponder()}}}return arguments.callee.base.apply(this,arguments)},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),insertTab:function(b){var a=this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertBacktab:function(b){var a=this.get("previousValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},_button_isSelectedDidChange:function(){}.observes("isSelected"),didAppendToDocument:function(){}});SC.SelectButtonView.TINY_OFFSET_X=0;SC.SelectButtonView.TINY_OFFSET_Y=0;SC.SelectButtonView.TINY_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectButtonView.SMALL_OFFSET_X=-18;SC.SelectButtonView.SMALL_OFFSET_Y=3;SC.SelectButtonView.SMALL_POPUP_MENU_WIDTH_OFFSET=7;SC.SelectButtonView.REGULAR_OFFSET_X=-17;SC.SelectButtonView.REGULAR_OFFSET_Y=3;SC.SelectButtonView.REGULAR_POPUP_MENU_WIDTH_OFFSET=4;SC.SelectButtonView.LARGE_OFFSET_X=-17;SC.SelectButtonView.LARGE_OFFSET_Y=6;SC.SelectButtonView.LARGE_POPUP_MENU_WIDTH_OFFSET=3;SC.SelectButtonView.HUGE_OFFSET_X=0;SC.SelectButtonView.HUGE_OFFSET_Y=0;SC.SelectButtonView.HUGE_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectButtonView.MENU_WIDTH_OFFSET=-2;SC.MenuPane.TINY_MENU_ITEM_HEIGHT=10;SC.MenuPane.TINY_MENU_ITEM_SEPARATOR_HEIGHT=2;SC.MenuPane.TINY_MENU_HEIGHT_PADDING=2;SC.MenuPane.TINY_SUBMENU_OFFSET_X=0;SC.MenuPane.SMALL_MENU_ITEM_HEIGHT=16;SC.MenuPane.SMALL_MENU_ITEM_SEPARATOR_HEIGHT=7;SC.MenuPane.SMALL_MENU_HEIGHT_PADDING=4;SC.MenuPane.SMALL_SUBMENU_OFFSET_X=2;SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT=22;SC.MenuPane.REGULAR_MENU_ITEM_SEPARATOR_HEIGHT=9;SC.MenuPane.REGULAR_MENU_HEIGHT_PADDING=6;SC.MenuPane.REGULAR_SUBMENU_OFFSET_X=2;SC.MenuPane.LARGE_MENU_ITEM_HEIGHT=31;SC.MenuPane.LARGE_MENU_ITEM_SEPARATOR_HEIGHT=20;SC.MenuPane.LARGE_MENU_HEIGHT_PADDING=0;SC.MenuPane.LARGE_SUBMENU_OFFSET_X=4;SC.MenuPane.HUGE_MENU_ITEM_HEIGHT=20;SC.MenuPane.HUGE_MENU_ITEM_SEPARATOR_HEIGHT=9;SC.MenuPane.HUGE_MENU_HEIGHT_PADDING=0;SC.MenuPane.HUGE_SUBMENU_OFFSET_X=0;SC.SelectFieldView=SC.FieldView.extend({displayProperties:["objects","nameKey","valueKey","isEnabled"],acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),tagName:"select",classNames:["sc-select-field-view"],objects:[],objectsBindingDefault:SC.Binding.multiple(),nameKey:null,sortKey:null,valueKey:null,emptyName:null,localize:NO,cpDidChange:YES,disableSort:NO,validateMenuItem:function(b,a){return YES},sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("sortKey")||this.get("nameKey");if(a){b=b.sortProperty(a)}else{b=b.sort(function(d,c){if(a){d=d.get?d.get(a):d[a];c=c.get?c.get(a):c[a]}return(d<c)?-1:((d>c)?1:0)})}}return b},render:function(c,a){if(a||this.get("cpDidChange")){this.set("cpDidChange",NO);var g=this.get("nameKey");var k=this.get("valueKey");var j=this.get("objects");var b=this.get("value");var d,h;if(!this.get("isEnabled")){c.attr("disabled","disabled")}var i=this.get("localize");if(!k&&b){b=SC.guidFor(b)}if((b===null)||(b==="")){b="***"}if(j){j=this.sortObjects(j);if(!a){h=this.$input()[0];if(!h){return}h.innerHTML=""}var f=this.get("emptyName");if(f){if(i){f=SC.String.loc(f)}if(a){c.push('<option value="***">'+f+"</option>",'<option disabled="disabled"></option>')}else{d=document.createElement("option");d.value="***";d.innerHTML=f;h.appendChild(d);d=document.createElement("option");d.disabled="disabled";h.appendChild(d)}}j.forEach(function(o,n){if(o){var m=g?(o.get?o.get(g):o[g]):o.toString();if(i){m=SC.String.loc(m)}var p=(k)?(o.get?o.get(k):o[k]):o;if(!f&&n===0&&b==="***"){this.set("value",p)}if(p!==null&&p!==undefined){p=(SC.guidFor(p))?SC.guidFor(p):p.toString()}var l=(this.validateMenuItem&&this.validateMenuItem(p,m))?"":'disabled="disabled" ';if(a){c.push("<option "+l+'value="'+p+'">'+m+"</option>")}else{d=document.createElement("option");d.value=p;d.innerHTML=m;if(l.length>0){d.disable="disabled"}h.appendChild(d)}}else{if(a){c.push('<option disabled="disabled"></option>')}else{d=document.createElement("option");d.disabled="disabled";h.appendChild(d)}}},this);this.setFieldValue(b)}else{this.set("value",null)}}else{this.$().prop("disabled",!this.get("isEnabled"))}},_objectsObserver:function(){this.set("cpDidChange",YES)}.observes("objects"),_objectArrayObserver:function(){this.set("cpDidChange",YES);this.propertyDidChange("objects")}.observes("*objects.[]"),_nameKeyObserver:function(){this.set("cpDidChange",YES)}.observes("nameKey"),_valueKeyObserver:function(){this.set("cpDidChange",YES)}.observes("valueKey"),_isEnabledObserver:function(){this.set("cpDidChange",YES)}.observes("isEnabled"),$input:function(){return this.$()},mouseDown:function(a){if(!this.get("isEnabled")){a.stop();return YES}else{return arguments.callee.base.apply(this,arguments)}},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},getFieldValue:function(){var g=arguments.callee.base.apply(this,arguments);var c=this.get("valueKey");var f=this.get("objects");var d=null;var a;if(g=="***"){g=null}else{if(g&&f){var h=(SC.typeOf(f.length)===SC.T_FUNCTION)?f.length():f.length;while(!d&&(--h>=0)){a=f.objectAt?f.objectAt(h):f[h];if(a===null||a===undefined){continue}if(c){a=(a.get)?a.get(c):a[c]}var b=(a!==null&&a!==undefined)?(SC.guidFor(a)?SC.guidFor(a):a.toString()):null;if(g==b){d=a}}}}return(c||d)?d:g},setFieldValue:function(a){if(SC.none(a)){a="***"}else{a=((a!==null&&a!==undefined)?(SC.guidFor(a)?SC.guidFor(a):a.toString()):null)}this.$input().val(a);return this},fieldDidFocus:function(){var a=this.get("isFocused");if(!a){this.set("isFocused",true)}},fieldDidBlur:function(){var a=this.get("isFocused");if(a){this.set("isFocused",false)}},_isFocusedObserver:function(){this.$().setClass("focus",this.get("isFocused"))}.observes("isFocused"),didCreateLayer:function(){var a=this.$input();if(this.get("isEnabled")===false){this.$()[0].disabled=true}SC.Event.add(a,"blur",this,this.fieldDidBlur);SC.Event.add(a,"focus",this,this.fieldDidFocus);SC.Event.add(a,"change",this,this._field_fieldValueDidChange)},willDestroyLayer:function(){var a=this.$input();SC.Event.remove(a,"focus",this,this.fieldDidFocus);SC.Event.remove(a,"blur",this,this.fieldDidBlur);SC.Event.remove(a,"change",this,this._field_fieldValueDidChange)}});SC.SliderView=SC.View.extend(SC.Control,{classNames:"sc-slider-view",ariaRole:"slider",value:0.5,valueBindingDefault:SC.Binding.single().notEmpty(),minimum:0,minimumBindingDefault:SC.Binding.single().notEmpty(),contentMinimumKey:null,maximum:1,maximumBindingDefault:SC.Binding.single().notEmpty(),contentMaximumKey:null,step:0.1,displayProperties:["displayValue","ariaValue","minimum","maximum","step","frame"],ariaValue:function(){return this.get("value")}.property("value").cacheable(),renderDelegateName:"sliderRenderDelegate",displayValue:function(){var b=this.get("minimum"),a=this.get("maximum"),d=this.get("value"),c=this.get("step");d=Math.min(Math.max(d,b),a);if(!SC.none(c)&&c!==0){d=Math.round(d/c)*c}if(d!==0){d=Math.floor((d-b)/(a-b)*100)}return d}.property("value","minimum","maximum","step").cacheable(),_isMouseDown:NO,mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;return this._triggerHandle(a,YES)},mouseDragged:function(a){return this._isMouseDown?this._triggerHandle(a):YES},mouseUp:function(a){if(this._isMouseDown){this.set("isActive",NO)}var b=this._isMouseDown?this._triggerHandle(a):YES;this._isMouseDown=NO;return b},mouseWheel:function(b){if(!this.get("isEnabled")){return YES}var d=this.get("minimum"),a=this.get("maximum"),f=this.get("step"),c=this.get("value")+((b.wheelDeltaX+b.wheelDeltaY)*f),g=Math.round(c/f)*f;if(c<d){this.setIfChanged("value",d)}else{if(c>a){this.setIfChanged("value",a)}else{this.setIfChanged("value",c)}}return YES},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},touchesDragged:function(a){return this.mouseDragged(a)},_triggerHandle:function(j,f){var a=this.get("frame").width,c=this.get("minimum"),g=this.get("maximum"),b=this.get("step"),i=this.get("value"),d;if(f){d=this.convertFrameFromView({x:j.pageX}).x;this._evtDiff=j.pageX-d}else{d=j.pageX-this._evtDiff}d=Math.max(0,Math.min(d/a,1));if(f){var h=this.get("value");h=(h-c)/(g-c);if(Math.abs(h*a-d*a)<16){this._offset=h-d}else{this._offset=0}}d=Math.max(0,Math.min(d+this._offset,1));d=c+((g-c)*d);if(b!==0){d=Math.round(d/b)*b}if(Math.abs(i-d)>=0.01){this.set("value",d)}return YES},acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),keyDown:function(i){if(i.which===9||i.keyCode===9){var g=i.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(g){g.becomeFirstResponder()}else{i.allowDefault()}return YES}if(i.which>=33&&i.which<=40){var d=this.get("minimum"),h=this.get("maximum"),b=this.get("step"),j=h-d,a=0,c,f=this.get("value");if(i.which===37||i.which===38||i.which===34){if(b===0){if(j<100){a=f-1}else{c=Math.abs(j/100);if(c<2){c=2}a=f-c}}else{a=f-b}}if(i.which===39||i.which===40||i.which===33){if(b===0){if(j<100){a=f+2}else{c=Math.abs(j/100);if(c<2){c=2}a=f+c}}else{a=f+b}}if(i.which===36){a=h}if(i.which===35){a=d}if(a>=d&&a<=h){this.set("value",a)}}else{i.allowDefault();return NO}return YES},contentKeys:{contentValueKey:"value",contentMinimumKey:"minimum",contentMaximumKey:"maximum",contentIsIndeterminateKey:"isIndeterminate"}});sc_require("mixins/collection_group");sc_require("views/disclosure");SC.SourceListGroupView=SC.View.extend(SC.Control,SC.CollectionGroup,{classNames:["sc-source-list-group"],content:null,isGroupVisible:YES,hasGroupTitle:YES,groupTitleKey:null,groupVisibleKey:null,render:function(a,b){a.push('<div role="button" class="sc-source-list-label sc-disclosure-view sc-button-view button disclosure no-disclosure">','<img src="'+SC.BLANK_IMAGE_URL+'" class="button" />','<span class="label"></span></div>')},createChildViews:function(){},contentPropertyDidChange:function(g,c){var f=this.get("content");var i=this.outlet("labelView");if(f===null){i.setIfChanged("isVisible",NO);this.setIfChanged("hasGroupTitle",NO);return}else{i.setIfChanged("isVisible",YES);this.setIfChanged("hasGroupTitle",YES)}var b=this.getDelegateProperty("groupTitleKey",this.displayDelegate);if((c=="*")||(b&&(c==b))){var h=(f&&f.get&&b)?f.get(b):f;if(h!=this._title){this._title=h;if(h){h=h.capitalize()}i.set("title",h)}}var d=this.getDelegateProperty("groupVisibleKey",this.displayDelegate);if((c=="*")||(d&&(c==d))){if(d){i.removeClassName("no-disclosure");var a=(f&&f.get)?!!f.get(d):YES;if(a!=this.get("isGroupVisible")){this.set("isGroupVisible",a);i.set("value",a)}}else{i.addClassName("no-disclosure")}}},disclosureValueDidChange:function(c){if(c==this.get("isGroupVisible")){return}var b=this.get("content");var a=this.getDelegateProperty("groupVisibleKey",this.displayDelegate);if(b&&b.set&&a){b.set(a,c)}this.set("isGroupVisible",c);if(this.owner&&this.owner.updateChildren){this.owner.updateChildren(true)}},labelView:SC.DisclosureView.extend({value:YES,_valueObserver:function(){if(this.owner){this.owner.disclosureValueDidChange(this.get("value"))}}.observes("value")})});sc_require("views/list");sc_require("views/source_list_group");SC.SourceListView=SC.ListView.extend({theme:"source-list",classNames:["sc-source-list"],rowHeight:32,selectOnMouseDown:NO,actOnSelect:YES});SC.SplitDividerView=SC.View.extend({classNames:["sc-split-divider-view"],mouseDown:function(a){var b=this.get("splitView");return(b)?b.mouseDownInThumbView(a,this):arguments.callee.base.apply(this,arguments)},doubleClick:function(a){var b=this.get("splitView");return(b)?b.doubleClickInThumbView(a,this):arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)}});sc_require("views/split_divider");SC.RESIZE_BOTH="resize-both";SC.RESIZE_TOP_LEFT="resize-top-left";SC.RESIZE_BOTTOM_RIGHT="resize-bottom-right";SC.SplitView=SC.View.extend({classNames:["sc-split-view"],displayProperties:["layoutDirection"],delegate:null,layoutDirection:SC.LAYOUT_HORIZONTAL,canCollapseViews:YES,autoresizeBehavior:SC.RESIZE_BOTTOM_RIGHT,defaultThickness:0.5,topLeftMinThickness:null,topLeftMaxThickness:null,bottomRightMinThickness:null,bottomRightMaxThickness:null,dividerThickness:null,isSplitView:YES,topLeftView:SC.View,dividerView:SC.SplitDividerView,bottomRightView:SC.View,topLeftThickness:function(){var a=this.get("topLeftView");return a?this.thicknessForView(a):0}.property("topLeftView").cacheable(),bottomRightThickness:function(){var a=this.get("bottomRightView");return a?this.thicknessForView(a):0}.property("bottomRightView").cacheable(),thumbViewCursor:null,canCollapseView:function(a){return this.invokeDelegateMethod(this.delegate,"splitViewCanCollapse",this,a)},thicknessForView:function(a){var c=this.get("layoutDirection"),b=a.get("frame");return(c===SC.LAYOUT_HORIZONTAL)?b.width:b.height},createChildViews:function(){var f=[],c=["topLeftView","dividerView","bottomRightView"],b=c.length,a,d;for(d=0;d<b;++d){if(a=this.get(c[d])){a=this[c[d]]=this.createChildView(a,{layoutView:this,rootElementPath:[d]});f.push(a)}}this.set("childViews",f);return this},updateChildLayout:function(){var b=this.get("topLeftView"),c=this.get("bottomRightView"),j=this.get("dividerView"),f=this.get("autoresizeBehavior"),k=this.get("layoutDirection"),a=this.get("frame"),d=this._desiredTopLeftThickness,l=this.get("dividerThickness"),i=(k===SC.LAYOUT_HORIZONTAL)?a.width:a.height,m=i-l-d,h,g;l=(!SC.none(l))?l:7;g=b.get("isCollapsed")||NO;b.setIfChanged("isVisible",!g);h=SC.clone(b.get("layout"));if(k===SC.LAYOUT_HORIZONTAL){h.top=0;h.left=0;h.bottom=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.right=m+l;delete h.width;break;case SC.RESIZE_BOTTOM_RIGHT:delete h.right;delete h.height;h.width=d;break}}else{h.top=0;h.left=0;h.right=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.bottom=m+l;delete h.height;break;case SC.RESIZE_BOTTOM_RIGHT:h.height=d;delete h.bottom;delete h.width;break}}b.set("layout",h);if(j){h=SC.clone(j.get("layout"));if(k===SC.LAYOUT_HORIZONTAL){h.width=l;h.top=0;h.bottom=0;delete h.height;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.right=m;delete h.left;delete h.centerX;delete h.centerY;break;case SC.RESIZE_BOTTOM_RIGHT:h.left=d;delete h.right;delete h.centerX;delete h.centerY;break}}else{h.height=l;h.left=0;h.right=0;delete h.width;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.bottom=m;delete h.top;delete h.centerX;delete h.centerY;break;case SC.RESIZE_BOTTOM_RIGHT:h.top=d;delete h.bottom;delete h.centerX;delete h.centerY;break}}j.set("layout",h)}g=c.get("isCollapsed")||NO;c.setIfChanged("isVisible",!g);h=SC.clone(c.get("layout"));if(k===SC.LAYOUT_HORIZONTAL){h.top=0;h.bottom=0;h.right=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_BOTTOM_RIGHT:h.left=d+l;delete h.width;break;case SC.RESIZE_TOP_LEFT:h.width=m;delete h.left;break}}else{h.left=0;h.right=0;h.bottom=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_BOTTOM_RIGHT:h.top=d+l;delete h.height;break;case SC.RESIZE_TOP_LEFT:delete h.top;h.height=m;break}}c.set("layout",h);this.notifyPropertyChange("topLeftThickness").notifyPropertyChange("bottomRightThickness")},renderLayout:function(b,a){if(a||this._recalculateDivider){var g=this.get("layoutDirection"),c=this.get("frame"),f=this.$(),j=this.get("defaultThickness"),d=this.get("autoresizeBehavior"),i=this.get("dividerThickness"),h;if(!this.get("thumbViewCursor")){this.set("thumbViewCursor",SC.Cursor.create())}i=!SC.none(i)?i:7;if(this._recalculateDivider===undefined&&j<1){this._recalculateDivider=YES}else{if(this._recalculateDivider){this._recalculateDivider=NO}}if(f[0]){h=(g===SC.LAYOUT_HORIZONTAL)?f[0].offsetWidth:f[0].offsetHeight}else{h=(g===SC.LAYOUT_HORIZONTAL)?c.width:c.height}if(SC.none(j)||(j>0&&j<1)){j=Math.floor((h-(i))*(j||0.5))}if(d===SC.RESIZE_BOTTOM_RIGHT){this._desiredTopLeftThickness=j}else{this._desiredTopLeftThickness=h-i-j}this._topLeftView=this.get("topLeftView");this._bottomRightView=this.get("bottomRightView");this._topLeftViewThickness=this.thicknessForView(this.get("topLeftView"));this._bottomRightThickness=this.thicknessForView(this.get("bottomRightView"));this._dividerThickness=this.get("dividerThickness");this._layoutDirection=this.get("layoutDirection");this._updateTopLeftThickness(0);this._setCursorStyle();this.updateChildLayout()}arguments.callee.base.apply(this,arguments)},render:function(a,b){arguments.callee.base.apply(this,arguments);if(this._inLiveResize){this._setCursorStyle()}if(this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL){a.addClass("sc-horizontal")}else{a.addClass("sc-vertical")}},mouseDownInThumbView:function(a,c){var b=this.getPath("pane.rootResponder");if(!b){return NO}b.dragDidStart(this);this._mouseDownX=a.pageX;this._mouseDownY=a.pageY;this._thumbView=c;this._topLeftView=this.get("topLeftView");this._bottomRightView=this.get("bottomRightView");this._topLeftViewThickness=this.thicknessForView(this.get("topLeftView"));this._bottomRightThickness=this.thicknessForView(this.get("bottomRightView"));this._dividerThickness=this.get("dividerThickness");this._layoutDirection=this.get("layoutDirection");this.beginLiveResize();this._inLiveResize=YES;return YES},mouseDragged:function(a){var b=(this._layoutDirection===SC.LAYOUT_HORIZONTAL)?a.pageX-this._mouseDownX:a.pageY-this._mouseDownY;this._updateTopLeftThickness(b);return YES},mouseUp:function(a){if(this._inLiveResize===YES){this._thumbView=null;this._inLiveResize=NO;this.endLiveResize();return YES}this._setCursorStyle();return NO},touchesDragged:function(a){return this.mouseDragged(a)},touchEnd:function(a){return this.mouseUp(a)},doubleClickInThumbView:function(b,d){var a=this._topLeftView,c=a.get("isCollapsed")||NO;if(!c&&!this.canCollapseView(a)){a=this._bottomRightView;c=a.get("isCollapsed")||NO;if(!c&&!this.canCollapseView(a)){return NO}}if(!c){this._uncollapsedThickness=this.thicknessForView(a);if(a===this._topLeftView){this._updateTopLeftThickness(this.topLeftThickness()*-1)}else{this._updateBottomRightThickness(this.bottomRightThickness()*-1)}if(!a.get("isCollapsed")){this._uncollapsedThickness=null}}else{if(a===this._topLeftView){this._updateTopLeftThickness(this._uncollapsedThickness)}else{this._updateBottomRightThickness(this._uncollapsedThickness)}a._uncollapsedThickness=null}this._setCursorStyle();return true},_updateTopLeftThickness:function(f){var a=this._topLeftView,c=this._bottomRightView,g=this.thicknessForView(a),h=this.thicknessForView(c),k=this._dividerThickness,j=0,b=this._topLeftViewThickness+f,n=this._layoutDirection,p=this.canCollapseView(c),m=b,l=this.get("topLeftMaxThickness"),d=this.get("topLeftMinThickness"),o,i,q;if(!a.get("isCollapsed")){j+=g}if(!c.get("isCollapsed")){j+=h}if(!SC.none(l)){m=Math.min(l,m)}if(!SC.none(d)){m=Math.max(d,m)}l=this.get("bottomRightMaxThickness");d=this.get("bottomRightMinThickness");o=j-m;if(!SC.none(l)){o=Math.min(l,o)}if(!SC.none(d)){o=Math.max(d,o)}m=j-o;m=this.invokeDelegateMethod(this.delegate,"splitViewConstrainThickness",this,a,m);m=Math.min(m,j);m=Math.max(0,m);i=a.get("collapseAtThickness");if(!i){i=0}q=c.get("collapseAtThickness");q=SC.none(q)?j:(j-q);if((b<=i)&&this.canCollapseView(a)){l=c.get("maxThickness");if(!l||(k+j)<=l){m=0}}else{if(b>=q&&this.canCollapseView(c)){l=a.get("maxThickness");if(!l||(k+j)<=l){m=j}}}if(m!=this.thicknessForView(a)){this._desiredTopLeftThickness=m;a.set("isCollapsed",m===0);c.set("isCollapsed",m>=j);this.updateChildLayout();this.displayDidChange()}},_updateBottomRightThickness:function(f){var a=this._topLeftView,c=this._bottomRightView,g=this.thicknessForView(a),h=this.thicknessForView(c),k=this._dividerThickness,j=0,b=this._topLeftViewThickness+f,n=this._layoutDirection,p=this.canCollapseView(c),m=b,l=this.get("topLeftMaxThickness"),d=this.get("topLeftMinThickness"),o,i,q;if(!a.get("isCollapsed")){j+=g}if(!c.get("isCollapsed")){j+=h}if(!SC.none(l)){m=Math.min(l,m)}if(!SC.none(d)){m=Math.max(d,m)}l=this.get("bottomRightMaxThickness");d=this.get("bottomRightMinThickness");o=j-m;if(!SC.none(l)){o=Math.min(l,o)}if(!SC.none(d)){o=Math.max(d,o)}m=j-o;m=this.invokeDelegateMethod(this.delegate,"splitViewConstrainThickness",this,a,m);m=Math.min(m,j);m=Math.max(0,m);i=a.get("collapseAtThickness");if(!i){i=0}q=c.get("collapseAtThickness");q=SC.none(q)?j:(j-q);if((b<=i)&&this.canCollapseView(a)){l=c.get("maxThickness");if(!l||(k+j)<=l){m=0}}else{if(b>=q&&this.canCollapseView(c)){l=a.get("maxThickness");if(!l||(k+j)<=l){m=j}}}if(m!=this.thicknessForView(a)){this._desiredTopLeftThickness=m;a.set("isCollapsed",m===0);c.set("isCollapsed",m>=j);this.updateChildLayout();this.displayDidChange()}},_setCursorStyle:function(){var f=this._topLeftView,g=this._bottomRightView,b=this.get("thumbViewCursor"),c=this.thicknessForView(f),d=this.thicknessForView(g),a=this.get("dividerView");this._layoutDirection=this.get("layoutDirection");if(f.get("isCollapsed")||c===this.get("topLeftMinThickness")||d==this.get("bottomRightMaxThickness")){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"e-resize":"s-resize")}else{if(g.get("isCollapsed")||c===this.get("topLeftMaxThickness")||d==this.get("bottomRightMinThickness")){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"w-resize":"n-resize")}else{if(SC.browser.isIE){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"e-resize":"n-resize")}else{b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"ew-resize":"ns-resize")}}}a.set("cursor",b);if(this._inLiveResize){this.set("cursor",b)}}.observes("layoutDirection"),splitViewCanCollapse:function(b,a){if(b.get("canCollapseViews")===NO){return NO}if(a.get("canCollapse")===NO){return NO}return YES},splitViewConstrainThickness:function(c,a,b){return b},_forceSplitCalculation:function(){this.updateLayout()}.observes("*pane.isPaneAttached"),viewDidResize:function(){arguments.callee.base.apply(this,arguments);this.notifyPropertyChange("topLeftThickness").notifyPropertyChange("bottomRightThickness")}.observes("layout")});SC.mixin(SC.View.prototype,{splitView:function(){var a=this;while(a&&!a.isSplitView){a=a.get("parentView")}return a}.property("parentView").cacheable()});sc_require("views/collection");SC.StackedView=SC.CollectionView.extend({classNames:["sc-stacked-view"],layout:{top:0,left:0,right:0,height:1},computeNowShowing:function(a){return this.get("allContentIndexes")},updateHeight:function(a){if(a){this._updateHeight()}else{this.invokeLast(this._updateHeight)}return this},_updateHeight:function(){var f=this.get("childViews"),b=f.get("length"),c,d,a;if(b===0){a=1}else{c=f.objectAt(b-1);d=c?c.get("layer"):null;a=d?(d.offsetTop+d.offsetHeight):1;d=null}this.adjust("height",a)},didReload:function(a){return this.updateHeight()},didCreateLayer:function(){return this.updateHeight()}});SC.StaticContentView=SC.View.extend(SC.StaticLayout,{classNames:["sc-static-content-view"],displayProperties:["content"],content:null,contentLayoutDidChange:function(){this._viewFrameDidChange()},useStaticLayout:YES,frame:function(){var a=this.get("layer"),b;if(!a){return{x:0,y:0,width:0,height:0}}if(a.getBoundingClientRect&&!SC.browser.isIE8OrLower){b=a.getBoundingClientRect();return{x:0,y:0,width:b.width,height:b.height}}else{return{x:0,y:0,width:a.clientWidth,height:a.clientHeight}}}.property("content").cacheable(),parentViewDidResize:function(){this.contentLayoutDidChange()},didUpdateLayer:function(){this.contentLayoutDidChange()},render:function(a,c){var b=this.get("content");if(b){a.push(b||"")}},touchStart:function(a){a.allowDefault();return YES},touchEnd:function(a){a.allowDefault();return YES}});sc_require("views/segmented");SC.TOP_LOCATION="top";SC.TOP_TOOLBAR_LOCATION="top-toolbar";SC.BOTTOM_LOCATION="bottom";SC.TabView=SC.View.extend({classNames:["sc-tab-view"],displayProperties:["nowShowing"],nowShowing:null,items:[],isEnabled:YES,itemTitleKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemWidthKey:null,itemToolTipKey:null,tabHeight:SC.REGULAR_BUTTON_HEIGHT,tabLocation:SC.TOP_LOCATION,userDefaultKey:null,_tab_nowShowingDidChange:function(){var a=this.get("nowShowing");this.get("containerView").set("nowShowing",a);this.get("segmentedView").set("value",a);return this}.observes("nowShowing"),_tab_saveUserDefault:function(){var a=this.get("nowShowing");var b=this.get("userDefaultKey");if(b){SC.userDefaults.set([b,"nowShowing"].join(":"),a)}}.observes("nowShowing"),_tab_itemsDidChange:function(){this.get("segmentedView").set("items",this.get("items"));return this}.observes("items"),init:function(){arguments.callee.base.apply(this,arguments);this._tab_nowShowingDidChange()._tab_itemsDidChange()},awake:function(){arguments.callee.base.apply(this,arguments);var a=this.get("userDefaultKey");if(a){a=[a,"nowShowing"].join(":");var b=SC.userDefaults.get(a);if(!SC.none(b)){this.set("nowShowing",b)}}},createChildViews:function(){var f=[],d,c,b=this.get("tabLocation"),a=this.get("tabHeight"),g=this.get("controlSize");if(b===SC.TOP_LOCATION){c={top:a/2+1,left:0,right:0,bottom:0,border:1}}else{if(b===SC.TOP_TOOLBAR_LOCATION){c={top:a+1,left:0,right:0,bottom:0,border:1}}else{c={top:0,left:0,right:0,bottom:(a/2)-1,border:1}}}d=this.containerView.extend({layout:c,ariaRole:"tabpanel"});this.containerView=this.createChildView(d);c=(b===SC.TOP_LOCATION||b===SC.TOP_TOOLBAR_LOCATION)?{height:a,left:0,right:0,top:0}:{height:a,left:0,right:0,bottom:0};this.segmentedView=this.get("segmentedView").extend({layout:c,controlSize:g,_sc_tab_segmented_valueDidChange:function(){var h=this.get("parentView");if(h){h.set("nowShowing",this.get("value"))}}.observes("value"),init:function(){var h=this.get("parentView");if(h){SC._TAB_ITEM_KEYS.forEach(function(i){this[i]=h.get(i)},this)}return arguments.callee.base.apply(this,arguments)}});this.segmentedView=this.createChildView(this.segmentedView);f.push(this.segmentedView);f.push(this.containerView);this.set("childViews",f);return this},containerView:SC.ContainerView.extend({renderDelegateName:"wellRenderDelegate"}),segmentedView:SC.SegmentedView});SC._TAB_ITEM_KEYS=["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemWidthKey","itemToolTipKey","itemActionKey","itemTargetKey"];SC.ThumbView=SC.View.extend({classNames:["sc-thumb-view"],isEnabled:YES,isEnabledBindingDefault:SC.Binding.bool(),prepareContext:function(a,c){var b=this.get("splitView");if(b){this.set("cursor",b.get("thumbViewCursor"))}return arguments.callee.base.apply(this,arguments)},mouseDown:function(a){if(!this.get("isEnabled")){return NO}var b=this.get("splitView");return(b)?b.mouseDownInThumbView(a,this):arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)}});SC.WebView=SC.View.extend(SC.Control,{classNames:"sc-web-view",displayProperties:["value","shouldAutoResize"],shouldAutoResize:NO,render:function(a,d){var c=this.get("value"),b;if(d){a.push('<iframe src="'+c+'" style="position: absolute; width: 100%; height: 100%; border: 0px; margin: 0px; padding: 0px;"></iframe>')}else{if(c!==this._lastSrc){b=this.$("iframe");b.attr("src","javascript:;");b.attr("src",c)}}this._lastSrc=c},didCreateLayer:function(){var a=this.$("iframe");SC.Event.add(a,"load",this,this.iframeDidLoad)},willDestroyLayer:function(){var a=this.$("iframe");SC.Event.remove(a,"load",this,this.iframeDidLoad)},iframeDidLoad:function(){if(this.get("shouldAutoResize")===YES){var a;var c=this.$("iframe")[0];if(c&&c.contentWindow){a=c.contentWindow;if(a&&a.document&&a.document.documentElement){var b=a.document.documentElement;if(!SC.browser.isIE){this.$().width(b.scrollWidth);this.$().height(b.scrollHeight)}else{this.$().width(b.scrollWidth+12);this.$().height(b.scrollHeight+5)}}}}}});SC.WELL_CONTAINER_PADDING=15;SC.WellView=SC.ContainerView.extend({classNames:"sc-well-view",contentLayout:{top:SC.WELL_CONTAINER_PADDING,bottom:SC.WELL_CONTAINER_PADDING,left:SC.WELL_CONTAINER_PADDING,right:SC.WELL_CONTAINER_PADDING},renderDelegateName:"wellRenderDelegate",createChildViews:function(){var a=this.get("contentView");if(a){a=this.contentView=this.createChildView(a);a.set("layout",this.contentLayout);this.childViews=[a]}},contentViewDidChange:function(){var a=this.get("contentView");a.set("layout",this.contentLayout);this.replaceContent(a)}.observes("contentView")});SC.MIXED_STATE="__MIXED__";SC.DataSource=SC.Object.extend({fetch:function(a,b){return NO},retrieveRecords:function(a,c,b){return this._handleEach(a,c,this.retrieveRecord,b)},commitRecords:function(c,b,h,g,i){var f,a,d;if(b.length>0){d=this.createRecords.call(this,c,b,i)}if(h.length>0){f=this.updateRecords.call(this,c,h,i);d=SC.none(d)?f:(d===f)?d:SC.MIXED_STATE}if(g.length>0){a=this.destroyRecords.call(this,c,g,i);d=SC.none(d)?a:(d===a)?d:SC.MIXED_STATE}return d||NO},cancel:function(a,b){return NO},updateRecords:function(a,b,c){return this._handleEach(a,b,this.updateRecord,null,c)},createRecords:function(a,b,c){return this._handleEach(a,b,this.createRecord,null,c)},destroyRecords:function(a,b,c){return this._handleEach(a,b,this.destroyRecord,null,c)},_handleEach:function(i,f,c,a,b){var g=f.length,j,h,k,d;for(j=0;j<g;j++){d=a?a[j]:b;k=c.call(this,i,f[j],d);if(h===undefined){h=k}else{if(h===YES){h=(k===YES)?YES:SC.MIXED_STATE}else{if(h===NO){h=(k===NO)?NO:SC.MIXED_STATE}}}}return !SC.none(h)?h:null},updateRecord:function(a,b,c){return NO},retrieveRecord:function(a,b,c){return NO},createRecord:function(a,b,c){return NO},destroyRecord:function(a,b,c){return NO}});sc_require("data_sources/data_source");SC.CascadeDataSource=SC.DataSource.extend({dataSources:null,from:function(a){var b=this.get("dataSources");if(!b){this.set("dataSources",b=[])}b.push(a);return this},fetch:function(c,h){var f=this.get("dataSources"),b=f?f.length:0,d=NO,i,g,a;for(a=0;(d!==YES)&&a<b;a++){g=f.objectAt(a);i=g.fetch?g.fetch.apply(g,arguments):NO;d=this._handleResponse(d,i)}return d},retrieveRecords:function(i,d,b){var c=this.get("dataSources"),f=c?c.length:0,g=NO,j,a,h;for(h=0;(g!==YES)&&h<f;h++){a=c.objectAt(h);j=a.retrieveRecords.apply(a,arguments);g=this._handleResponse(g,j)}return g},commitRecords:function(k,c,i,f,d){var b=this.get("dataSources"),g=b?b.length:0,h=NO,l,a,j;for(j=0;(h!==YES)&&j<g;j++){a=b.objectAt(j);l=a.commitRecords.apply(a,arguments);h=this._handleResponse(h,l)}return h},cancel:function(c,g){var f=this.get("dataSources"),b=f?f.length:0,d=NO,i,h,a;for(a=0;(d!==YES)&&a<b;a++){h=f.objectAt(a);i=h.cancel.apply(h,arguments);d=this._handleResponse(d,i)}return d},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("dataSources"),a=b?b.get("length"):0,c;while(--a>=0){c=b[a];if(SC.typeOf(c)===SC.T_STRING){b[a]=this.get(c)}}},_handleResponse:function(b,a){if(a===YES){return YES}else{if(b===NO){return(a===NO)?NO:SC.MIXED_STATE}else{return SC.MIXED_STATE}}}});sc_require("core");sc_require("models/record");SC.Query=SC.Object.extend(SC.Copyable,SC.Freezable,{isQuery:YES,conditions:null,orderBy:null,recordType:null,recordTypes:null,expandedRecordTypes:function(){var b=SC.CoreSet.create(),a,c;if(a=this.get("recordType")){this._scq_expandRecordType(a,b)}else{if(a=this.get("recordTypes")){a.forEach(function(d){this._scq_expandRecordType(d,b)},this)}else{this._scq_expandRecordType(SC.Record,b)}}c=SC.Query._scq_queriesWithExpandedRecordTypes;if(!c){c=SC.Query._scq_queriesWithExpandedRecordTypes=SC.CoreSet.create()}c.add(this);return b.freeze()}.property("recordType","recordTypes").cacheable(),_scq_expandRecordType:function(b,a){if(a.contains(b)){return}a.add(b);if(SC.typeOf(b)===SC.T_STRING){b=SC.objectForPropertyPath(b)}b.subclasses.forEach(function(c){this._scq_expandRecordType(c,a)},this)},parameters:null,location:"local",scope:null,isRemote:function(){return this.get("location")===SC.Query.REMOTE}.property("location").cacheable(),isLocal:function(){return this.get("location")===SC.Query.LOCAL}.property("location").cacheable(),isEditable:NO,contains:function(a,d){var f,b=YES;if(f=this.get("recordTypes")){b=f.find(function(g){return SC.kindOf(a,g)})}else{if(f=this.get("recordType")){b=SC.kindOf(a,f)}}if(!b){return NO}var c=this.get("scope");if(c&&!c.contains(a)){return NO}if(!this._isReady){this.parse()}if(!this._isReady){return NO}if(d===undefined){d=this.parameters||this}return this._tokenTree.evaluate(a,d)},containsRecordTypes:function(a){var b=this.get("recordType");if(b){return !!a.find(function(c){return SC.kindOf(c,b)})}else{if(b=this.get("recordTypes")){return !!b.find(function(c){return !!a.find(function(d){return SC.kindOf(d,c)})})}else{return YES}}},compare:function(g,d){var c=0,f,b,a,h;if(g===d){return 0}if(!this._isReady){this.parse()}if(!this._isReady){return SC.compare(g.get("storeKey"),d.get("storeKey"))}b=this._order;if(SC.typeOf(b)===SC.T_FUNCTION){c=b.call(null,g,d)}else{a=b?b.length:0;for(h=0;c===0&&(h<a);h++){f=b[h].propertyName;if(SC.Query.comparisons[f]){c=SC.Query.comparisons[f](g.get(f),d.get(f))}else{c=SC.compare(g.get(f),d.get(f))}if((c!==0)&&b[h].descending){c=(-1)*c}}}if(c!==0){return c}else{return SC.compare(g.get("storeKey"),d.get("storeKey"))}},_isReady:NO,parse:function(){var c=this.get("conditions"),d=this.get("queryLanguage"),b,a;b=this._tokenList=this.tokenizeString(c,d);a=this._tokenTree=this.buildTokenTree(b,d);this._order=this.buildOrder(this.get("orderBy"));this._isReady=!!a&&!a.error;if(a&&a.error){throw a.error}return this._isReady},queryWithScope:function(c){var b=SC.keyFor("__query__",SC.guidFor(this)),a=c[b];if(!a){c[b]=a=this.copy();a.set("scope",c);a.freeze()}return a},copyKeys:["conditions","orderBy","recordType","recordTypes","parameters","location","scope"],concatenatedProperties:["copyKeys"],copy:function(){var d={},c=this.get("copyKeys"),g=c?c.length:0,b,f,a;while(--g>=0){b=c[g];f=this.get(b);if(f!==undefined){d[b]=f}}a=this.constructor.create(d);d=null;return a},queryLanguage:{UNKNOWN:{firstCharacter:/[^\s'"\w\d\(\)\{\}]/,notAllowed:/[\-\s'"\w\d\(\)\{\}]/},PROPERTY:{firstCharacter:/[a-zA-Z_]/,notAllowed:/[^a-zA-Z_0-9\.]/,evalType:"PRIMITIVE",evaluate:function(f,b){var g=this.tokenValue.split(".");var a=g.length;if(a<2){return f.get(this.tokenValue)}var c=f;for(var d=0;d<a;d++){if(!c){return}if(c.get){c=c.get(g[d])}else{c=c[g[d]]}}return c}},NUMBER:{firstCharacter:/[\d\-]/,notAllowed:/[^\d\-\.]/,format:/^-?\d+$|^-?\d+\.\d+$/,evalType:"PRIMITIVE",evaluate:function(b,a){return parseFloat(this.tokenValue)}},STRING:{firstCharacter:/['"]/,delimited:true,evalType:"PRIMITIVE",evaluate:function(b,a){return this.tokenValue}},PARAMETER:{firstCharacter:/\{/,lastCharacter:"}",delimited:true,evalType:"PRIMITIVE",evaluate:function(b,a){return a[this.tokenValue]}},"%@":{rememberCount:true,reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return a[this.tokenValue]}},OPEN_PAREN:{firstCharacter:/\(/,singleCharacter:true},CLOSE_PAREN:{firstCharacter:/\)/,singleCharacter:true},AND:{reservedWord:true,leftType:"BOOLEAN",rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return d&&b}},OR:{reservedWord:true,leftType:"BOOLEAN",rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return d||b}},NOT:{reservedWord:true,rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(c,a){var b=this.rightSide.evaluate(c,a);return !b}},"=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.isEqual(d,b)}},"!=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return !SC.isEqual(d,b)}},"<":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)==-1}},"<=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)!=1}},">":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)==1}},">=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)!=-1}},BEGINS_WITH:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var b=this.leftSide.evaluate(c,a);var d=this.rightSide.evaluate(c,a);return(b&&b.indexOf(d)===0)}},ENDS_WITH:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,b){var c=this.leftSide.evaluate(d,b);var a=this.rightSide.evaluate(d,b);return(c&&c.length>=a.length&&c.lastIndexOf(a)===(c.length-a.length))}},CONTAINS:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(f,a){var d=this.leftSide.evaluate(f,a)||[];var h=this.rightSide.evaluate(f,a);var c=SC.typeOf(d);if(c===SC.T_STRING){return(d.indexOf(h)!==-1)}else{if(c===SC.T_ARRAY||d.toArray){if(c!==SC.T_ARRAY){d=d.toArray()}var g=false;var b=0;while(g===false&&b<d.length){if(h==d[b]){g=true}b++}return g}}}},ANY:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var g=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);var f=false;var c=0;while(f===false&&c<b.length){if(g==b[c]){f=true}c++}return f}},MATCHES:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return b.test(d)}},TYPE_IS:{reservedWord:true,rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var c=SC.Store.recordTypeFor(d.storeKey);var b=this.rightSide.evaluate(d,a);var f=SC.objectForPropertyPath(b);return c==f}},"null":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return null}},"undefined":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return undefined}},"false":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return false}},"true":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return true}},YES:{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return true}},NO:{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return false}}},tokenizeString:function(w,q){var k=[],u=null,h=null,g=null,v=null,a=null,j=null,d=null,x=null,r=false,b=false,m=false,n=false,o={};function f(t,c){h=q[t];if(h.format&&!h.format.test(c)){t="UNKNOWN"}if(h.delimited){n=true}if(!h.delimited){for(var i in q){if(q[i].reservedWord&&i==c){t=i}}}h=q[t];if(h&&h.rememberCount){if(!o[t]){o[t]=0}c=o[t];o[t]+=1}k.push({tokenType:t,tokenValue:c});a=null;j=null;d=null}if(!w){return[]}var l=w.length;for(var p=0;p<l;p++){r=(p===l-1);u=w.charAt(p);n=false;if(a){h=q[a];b=h.delimited?u===x:h.notAllowed.test(u);if(!b){d+=u}if(b||r){f(a,d)}if(r&&!b){n=true}}if(!a&&!n){for(g in q){h=q[g];if(h.firstCharacter&&h.firstCharacter.test(u)){a=g}}if(a){h=q[a];d=u;if(h.delimited){d="";if(h.lastCharacter){x=h.lastCharacter}else{x=u}}if(h.singleCharacter||r){f(a,d)}}}}return k},buildTokenTree:function(m,a){var p=m.slice();var r=0;var u=[];var c=false;var q=[];if(!m||m.length===0){return{evaluate:function(){return true}}}function t(i){var x=i;if(x<0){return false}var l=a[p[x].tokenType];if(!l){q.push("logic for token '"+p[x].tokenType+"' is not defined");return false}p[x].evaluate=l.evaluate;return l}function b(x,i){var y=i;var l=t(y);if(!l){return false}if(x=="left"){return l.leftType}if(x=="right"){return l.rightType}}function o(i){var x=i;var l=t(x);if(!l){return false}else{return l.evalType}}function g(i){p.splice(i,1);if(i<=r){r--}}function v(i){var l=i||r;if(l>0){return true}else{return false}}function k(i){var l=i;if(l<0){return true}return(b("left",l)&&!p[l].leftSide)||(b("right",l)&&!p[l].rightSide)}function j(l,x){var i=(x<l)?"left":"right";if(l<0||x<0){return false}if(!b(i,l)){return false}if(!o(x)){return false}if(b(i,l)==o(x)){return true}else{return false}}function n(i){var l=i;if(!k(l)){return false}if(!v(l)){return false}if(j(l,l-1)){return true}else{return false}}function d(i){var l=i;if(k(l)){return false}if(!v(l)){return false}if(!k(l-1)){return false}if(j(l-1,l)){return true}else{return false}}function h(i){var l=i;if(l<1){return false}p[l].leftSide=p[l-1];g(l-1)}function w(i){var l=i;if(l<1){return false}p[l-1].rightSide=p[l];g(l)}function f(i){g(i);g(u.pop())}for(r=0;r<p.length;r++){c=false;if(p[r].tokenType=="UNKNOWN"){q.push("found unknown token: "+p[r].tokenValue)}if(p[r].tokenType=="OPEN_PAREN"){u.push(r)}if(p[r].tokenType=="CLOSE_PAREN"){f(r)}if(n(r)){h(r)}if(d(r)){w(r);c=true}if(c){r--}}if(p.length==1){p=p[0]}else{q.push("string did not resolve to a single tree")}if(q.length>0){return{error:q.join(",\n"),tree:p}}else{return p}},buildOrder:function(a){if(!a){return[]}else{if(SC.typeOf(a)===SC.T_FUNCTION){return a}else{var d=a.split(",");for(var b=0;b<d.length;b++){var c=d[b];c=c.replace(/^\s+|\s+$/,"");c=c.replace(/\s+/,",");c=c.split(",");d[b]={propertyName:c[0]};if(c[1]&&c[1]=="DESC"){d[b].descending=true}}return d}}}});SC.Query.mixin({LOCAL:"local",REMOTE:"remote",storeKeyFor:function(a){return a?a.get("storeKey"):null},containsRecords:function(h,f,d){var g=[];for(var b=0,a=f.get("length");b<a;b++){var c=f.objectAt(b);if(c&&h.contains(c)){g.push(c.get("storeKey"))}}g=SC.Query.orderStoreKeys(g,h,d);return g},orderStoreKeys:function(c,d,a){if(c){var b=c.sort(function(g,f){return SC.Query.compareStoreKeys(d,a,g,f)})}return c},compareStoreKeys:function(g,c,f,d){var b=c.materializeRecord(f),a=c.materializeRecord(d);return g.compare(b,a)},build:function(i,c,h,d){var a=null,g,b,j,f;if(c&&c.isQuery){if(c.get("location")===i){return c}else{return c.copy().set("location",i).freeze()}}if(typeof c===SC.T_STRING){g=SC.objectForPropertyPath(c);if(!g){throw"%@ did not resolve to a class".fmt(c)}c=g}else{if(c&&c.isEnumerable){g=[];c.forEach(function(k){if(typeof k===SC.T_STRING){k=SC.objectForPropertyPath(k)}if(!k){throw"cannot resolve record types: %@".fmt(c)}g.push(k)},this);c=g}else{if(!c){c=SC.Record}}}if(d===undefined){d=null}if(h===undefined){h=null}if(!d&&(typeof h!==SC.T_STRING)){a=h;h=null}if(!d&&!a){f=SC.Query._scq_recordTypeCache;if(!f){f=SC.Query._scq_recordTypeCache={}}b=f[i];if(!b){b=f[i]={}}if(c.isEnumerable){j=c.map(function(l){return SC.guidFor(l)});j=j.sort().join(":")}else{j=SC.guidFor(c)}if(h){j=[j,h].join("::")}g=b[j];if(!g){if(c.isEnumerable){a={recordTypes:c.copy()}}else{a={recordType:c}}a.location=i;a.conditions=h;g=b[j]=SC.Query.create(a).freeze()}}else{if(!a){a={}}if(!a.location){a.location=i}if(c&&c.isEnumerable){a.recordTypes=c}else{a.recordType=c}if(h){a.conditions=h}if(d){a.parameters=d}g=SC.Query.create(a).freeze()}return g},local:function(c,a,b){return this.build(SC.Query.LOCAL,c,a,b)},remote:function(c,a,b){return this.build(SC.Query.REMOTE,c,a,b)},_scq_didDefineRecordType:function(){var a=SC.Query._scq_queriesWithExpandedRecordTypes;if(a){a.forEach(function(b){b.notifyPropertyChange("expandedRecordTypes")},this);a.clear()}}});SC.Query.comparisons={};SC.Query.registerComparison=function(a,b){SC.Query.comparisons[a]=b};SC.Query.registerQueryExtension=function(b,a){SC.Query.prototype.queryLanguage[b]=a};SC.Q=SC.Query.from;sc_require("system/query");SC.Record=SC.Object.extend({isRecord:YES,isParentRecord:NO,primaryKey:"guid",id:function(a,b){if(b!==undefined){this.writeAttribute(this.get("primaryKey"),b);return b}else{return SC.Store.idFor(this.storeKey)}}.property("storeKey").cacheable(),status:function(){return this.store.readStatus(this.storeKey)}.property("storeKey").cacheable(),store:null,storeKey:null,isDestroyed:function(){return !!(this.get("status")&SC.Record.DESTROYED)}.property("status").cacheable(),isEditable:function(a,b){if(b!==undefined){this._screc_isEditable=b}if(this.get("status")&SC.Record.READY){return this._screc_isEditable}else{return NO}}.property("status").cacheable(),_screc_isEditable:YES,isLoaded:function(){var b=SC.Record,a=this.get("status");return !((a===b.EMPTY)||(a===b.BUSY_LOADING)||(a===b.ERROR))}.property("status").cacheable(),relationships:null,attributes:function(){var a=this.get("store"),b=this.storeKey;return a.readEditableDataHash(b)}.property(),readOnlyAttributes:function(){var a=this.get("store"),c=this.storeKey,b=a.readDataHash(c);if(b){b=SC.clone(b,YES)}return b}.property(),nestedRecordNamespace:null,isNestedRecord:function(){var c=this.get("store"),d,b=this.get("storeKey"),a=c.parentStoreKeyExists(b);d=a?YES:NO;return d}.property().cacheable(),parentRecord:function(){var a=this.storeKey,b=this.get("store");return b.materializeParentRecord(a)}.property(),refresh:function(f,h){var c=this.get("store"),g,d,b=this.get("storeKey"),a=c.parentStoreKeyExists();d=f||(SC.none(f)&&SC.none(a));if(d){c.refreshRecord(null,null,b,h)}else{if(a){g=c.materializeRecord(a);g.refresh(f,h)}}return this},destroy:function(f){var c=this.get("store"),g,d,b=this.get("storeKey"),a=c.parentStoreKeyExists();d=f||(SC.none(f)&&SC.none(a));if(d){c.destroyRecord(null,null,b);this.notifyPropertyChange("status");this.propagateToAggregates()}else{if(a){g=c.materializeRecord(a);g.destroy(f)}}return this},recordDidChange:function(a){var b=this.get("parentRecord");if(b){b.recordDidChange()}this.get("store").recordDidChange(null,null,this.get("storeKey"),a);this.notifyPropertyChange("status");this.propagateToAggregates();return this},toJSON:function(){return this.get("attributes")},_editLevel:0,beginEditing:function(){this._editLevel++;return this},endEditing:function(a){if(--this._editLevel<=0){this._editLevel=0;this.recordDidChange(a)}return this},readAttribute:function(c){var a=this.get("store"),d=this.storeKey;var b=a.readDataHash(d);return b?b[c]:undefined},writeAttribute:function(c,g,f){var a=this.get("store"),d=this.storeKey,b;b=a.readEditableDataHash(d);if(!b){throw SC.Record.BAD_STATE_ERROR}if(g!==b[c]){if(!f){this.beginEditing()}b[c]=g;if(c===this.get("primaryKey")){SC.Store.replaceIdFor(d,g);this.propertyDidChange("id")}if(!f){this.endEditing(c)}}return this},propagateToAggregates:function(){var n=this.get("storeKey"),d=SC.Store.recordTypeFor(n),g=d.__sc_aggregate_keys,l,h,m,b,c,k;if(!g){g=[];for(m in this){b=this[m];if(b&&b.isRecordAttribute&&b.aggregate===YES){g.push(m)}}d.__sc_aggregate_keys=g}var j=SC.Record,a=j.DIRTY,f=j.READY_NEW,o=j.DESTROYED,p=j.READY_CLEAN,i;i=function(v){var q,r,t,u;if(v){q=this.get("status");if((q&a)||(q&f)||(q&o)){r=v.get("store");t=v.get("storeKey");u=r.peekStatus(t);if(u===p){v.get("store").recordDidChange(v.constructor,null,v.get("storeKey"),null,YES)}}}};for(l=0,h=g.length;l<h;++l){m=g[l];c=this.get(m);k=SC.kindOf(c,SC.ManyArray)?c:[c];k.forEach(i,this)}},storeDidChangeProperties:function(a,b){if(a){this.notifyPropertyChange("status")}else{if(b){this.beginPropertyChanges();b.forEach(function(f){this.notifyPropertyChange(f)},this);this.notifyPropertyChange("status");this.endPropertyChanges()}else{this.allPropertiesDidChange()}var d=this.relationships,c=d?d.length:0;while(--c>=0){d[c].recordPropertyDidChange(b)}}},normalize:function(a){var c=this.primaryKey,b=this.get("id"),g=this.get("store"),f=this.get("storeKey"),j={},t,p,d,r,k,q,m,h,o,i,n;var l=g.readEditableDataHash(f)||{};l[c]=b;r=g.readDataHash(f);for(t in this){p=this[t];if(p){d=p.typeClass;if(d){i=p.get("key")||t;j[i]=YES;m=SC.typeOf(d.call(p))===SC.T_CLASS;h=p.isNestedRecordTransform;if(!m&&!h){k=this.get(t);if(k!==undefined&&(k!==null||a)){n=this[t];if(SC.instanceOf(n,SC.RecordAttribute)){k=n.fromType(this,t,k)}l[i]=k}else{if(!a){j[i]=NO}}}else{if(h){k=this.get(t);if(k&&k.normalize){k.normalize()}}else{if(m){k=r[i];if(k!==undefined){l[i]=k}else{o=p.get("defaultValue");if(SC.typeOf(o)===SC.T_FUNCTION){l[i]=o(this,t,o)}else{l[i]=o}}}}}}}}for(t in l){if(!j[t]){SC.debug("%@:  Deleting key from underlying data hash due to normalization:  %@",this,t);delete l[t]}}return this},unknownProperty:function(b,d){if(d!==undefined){var c=this.get("storeKey"),f=SC.Store.recordTypeFor(c);if(f.ignoreUnknownProperties===YES){this[b]=d;return d}var a=this.get("primaryKey");this.writeAttribute(b,d);if(b===a){SC.Store.replaceIdFor(c,d)}}return this.readAttribute(b)},commitRecord:function(h,f,i){var c=this.get("store"),g,d,b=this.get("storeKey"),a=c.parentStoreKeyExists();d=f||(SC.none(f)&&SC.none(a));if(d){c.commitRecord(undefined,undefined,this.get("storeKey"),h,i)}else{if(a){g=c.materializeRecord(a);g.commitRecord(h,f,i)}}return this},isError:function(){return !!(this.get("status")&SC.Record.ERROR)}.property("status").cacheable(),errorValue:function(){return this.get("isError")?SC.val(this.get("errorObject")):null}.property("isError").cacheable(),errorObject:function(){if(this.get("isError")){var a=this.get("store");return a.readError(this.get("storeKey"))||SC.Record.GENERIC_ERROR}else{return null}}.property("isError").cacheable(),set:function(a,c){var b=this[a];if(b&&b.isProperty&&b.get&&!b.get("isEditable")){return this}return arguments.callee.base.apply(this,arguments)},toString:function(){var a=this.get("store").readDataHash(this.get("storeKey"));return"%@(%@) %@".fmt(this.constructor.toString(),SC.inspect(a),this.statusString())},statusString:function(){var b=[],a=this.get("status");for(var c in SC.Record){if(c.match(/[A-Z_]$/)&&SC.Record[c]===a){b.push(c)}}return b.join(" ")},registerNestedRecord:function(g,f,h){var c,d,b,a,i;if(SC.none(h)){h=f}if(g&&g.get&&g.get("isRecord")){a=g}else{i=this._materializeNestedRecordType(g,f);a=this.createNestedRecord(i,g)}if(a){this.isParentRecord=YES;c=this.get("store");d=this.get("storeKey");b=a.get("storeKey");c.registerChildToParent(d,b,h)}return a},_materializeNestedRecordType:function(d,c){var a,f,b;if(SC.typeOf(d)===SC.T_HASH){a=this.get("nestedRecordNamespace");if(d.type&&!SC.none(a)){f=a[d.type]}}if(!f&&c&&this[c]){f=this[c].get("typeClass")}if(!f||!SC.kindOf(f,SC.Record)){throw"SC.Child: Error during transform: Invalid record type."}return f},createNestedRecord:function(i,g){var b,h,a,d,c=null,f=null;SC.run(function(){g=g||{};f=g[i.prototype.primaryKey];b=this.get("store");if(SC.none(b)){throw"Error: during the creation of a child record: NO STORE ON PARENT!"}if(!h&&(d=i.prototype.primaryKey)){h=g[d];a=h?b.storeKeyExists(i,h):null;if(a){b.writeDataHash(a,g);c=b.materializeRecord(a)}else{c=b.createRecord(i,g);if(SC.none(h)){a=c.get("storeKey");h="cr"+a;SC.Store.replaceIdFor(a,h);g=b.readEditableDataHash(a);g[d]=h}}}if(SC.none(f)&&this.generateIdForChild){this.generateIdForChild(c)}},this);return c},_nestedRecordKey:0,generateIdForChild:function(a){}});SC.Record.mixin({ignoreUnknownProperties:NO,CLEAN:1,DIRTY:2,EMPTY:256,ERROR:4096,READY:512,READY_CLEAN:513,READY_DIRTY:514,READY_NEW:515,DESTROYED:1024,DESTROYED_CLEAN:1025,DESTROYED_DIRTY:1026,BUSY:2048,BUSY_LOADING:2052,BUSY_CREATING:2056,BUSY_COMMITTING:2064,BUSY_REFRESH:2080,BUSY_REFRESH_CLEAN:2081,BUSY_REFRESH_DIRTY:2082,BUSY_DESTROYING:2112,BAD_STATE_ERROR:SC.$error("Internal Inconsistency"),RECORD_EXISTS_ERROR:SC.$error("Record Exists"),NOT_FOUND_ERROR:SC.$error("Not found "),BUSY_ERROR:SC.$error("Busy"),GENERIC_ERROR:SC.$error("Generic Error"),_nextChildKey:0,attr:function(a,b){return SC.RecordAttribute.attr(a,b)},fetch:function(b,a){return SC.FetchedAttribute.attr(b,a)},toMany:function(d,b){b=b||{};var c=b.nested||b.isNested;var a;this._throwUnlessRecordTypeDefined(d,"toMany");if(c){a=SC.ChildrenAttribute.attr(d,b)}else{a=SC.ManyAttribute.attr(d,b)}return a},toOne:function(d,b){b=b||{};var c=b.nested||b.isNested;var a;this._throwUnlessRecordTypeDefined(d,"toOne");if(c){a=SC.ChildAttribute.attr(d,b)}else{a=SC.SingleAttribute.attr(d,b)}return a},_throwUnlessRecordTypeDefined:function(b,a){if(!b){throw"Attempted to create "+a+" attribute with undefined recordType. Did you forget to sc_require a dependency?"}},storeKeysById:function(){var b=SC.keyFor("storeKey",SC.guidFor(this)),a=this[b];if(!a){a=this[b]={}}return a},storeKeyFor:function(c){var b=this.storeKeysById(),a=b[c];if(!a){a=SC.Store.generateStoreKey();SC.Store.idsByStoreKey[a]=c;SC.Store.recordTypesByStoreKey[a]=this;b[c]=a}return a},storeKeyExists:function(c){var b=this.storeKeysById(),a=b[c];return a},find:function(a,b){return a.find(this,b)},extend:function(){var a=SC.Object.extend.apply(this,arguments);if(SC.Query){SC.Query._scq_didDefineRecordType(a)}return a}});sc_require("data_sources/data_source");sc_require("models/record");SC.FixturesDataSource=SC.DataSource.extend({simulateRemoteResponse:NO,latency:50,cancel:function(a,b){return NO},fetch:function(a,b){if(b.get("location")!==SC.Query.LOCAL){throw SC.$error("SC.Fixture data source can only fetch local queries")}if(!b.get("recordType")&&!b.get("recordTypes")){throw SC.$error("SC.Fixture data source can only fetch queries with one or more record types")}if(this.get("simulateRemoteResponse")){this.invokeLater(this._fetch,this.get("latency"),a,b)}else{this._fetch(a,b)}},_fetch:function(a,c){var d=c.get("recordType"),b=c.get("recordTypes")||[d];b.forEach(function(f){if(SC.typeOf(f)===SC.T_STRING){f=SC.objectForPropertyPath(f)}if(f){this.loadFixturesFor(a,f)}},this);a.dataSourceDidFetchQuery(c)},retrieveRecords:function(a,c){var d=this.get("latency"),b=this.hasFixturesFor(c);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._retrieveRecords,d,a,c)}else{this._retrieveRecords(a,c)}return b},_retrieveRecords:function(a,b){b.forEach(function(d){var c=[],h=SC.Store.recordTypeFor(d),g=a.idFor(d),f=this.fixtureForStoreKey(a,d);c.push(d);a.dataSourceDidComplete(d,f,g)},this)},updateRecords:function(a,c,f){var d=this.get("latency"),b=this.hasFixturesFor(c);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._updateRecords,d,a,c)}else{this._updateRecords(a,c)}return b},_updateRecords:function(a,b){b.forEach(function(c){var d=a.readDataHash(c);this.setFixtureForStoreKey(a,c,d);a.dataSourceDidComplete(c)},this)},createRecords:function(a,b,d){var c=this.get("latency");if(this.get("simulateRemoteResponse")){this.invokeLater(this._createRecords,c,a,b)}else{this._createRecords(a,b)}return YES},_createRecords:function(a,b){b.forEach(function(f){var h=a.idFor(f),g=a.recordTypeFor(f),d=a.readDataHash(f),c=this.fixturesFor(g);if(!h){h=this.generateIdFor(g,d,a,f)}this._invalidateCachesFor(g,f,h);c[h]=d;a.dataSourceDidComplete(f,null,h)},this)},destroyRecords:function(a,c,f){var d=this.get("latency"),b=this.hasFixturesFor(c);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._destroyRecords,d,a,c)}else{this._destroyRecords(a,c)}return b},_destroyRecords:function(a,b){b.forEach(function(d){var g=a.idFor(d),f=a.recordTypeFor(d),c=this.fixturesFor(f);this._invalidateCachesFor(f,d,g);if(g){delete c[g]}a.dataSourceDidDestroy(d)},this)},loadFixturesFor:function(a,h,c){var b=[],f,d,g;f=this.fixturesFor(h);for(d in f){g=h.storeKeyFor(d);if(a.peekStatus(g)===SC.Record.EMPTY){b.push(f[d])}if(c){c.push(g)}}if(b&&b.length>0){a.loadRecords(h,b)}return this},generateIdFor:function(d,b,a,c){return"@id%@".fmt(SC.Store.generateStoreKey())},fixtureForStoreKey:function(a,c){var f=a.idFor(c),d=a.recordTypeFor(c),b=this.fixturesFor(d);return b?b[f]:null},setFixtureForStoreKey:function(a,d,c){var g=a.idFor(d),f=a.recordTypeFor(d),b=this.fixturesFor(f);this._invalidateCachesFor(f,d,g);b[g]=c;return this},fixturesFor:function(i){if(!this._fixtures){this._fixtures={}}var g=this._fixtures[SC.guidFor(i)];if(g){return g}var f=i?i.FIXTURES:null,b=f?f.length:0,c=i?i.prototype.primaryKey:"guid",a,d,h;this._fixtures[SC.guidFor(i)]=g={};for(a=0;a<b;a++){d=f[a];h=d[c];if(!h){h=this.generateIdFor(i,d)}g[h]=d}return g},fixturesLoadedFor:function(c){if(!this._fixtures){return NO}var a=[],b=this._fixtures[SC.guidFor(c)];return b?YES:NO},reset:function(){this._fixtures=null;return this},hasFixturesFor:function(b){var a=NO;b.forEach(function(d){if(a!==SC.MIXED_STATE){var f=SC.Store.recordTypeFor(d),c=f?f.FIXTURES:null;if(c&&c.length&&c.length>0){if(a===NO){a=YES}}else{if(a===YES){a=SC.MIXED_STATE}}}},this);return a},_invalidateCachesFor:function(d,b,c){var a=this._storeKeyCache;if(a){delete a[SC.guidFor(d)]}return this}});SC.Record.fixtures=SC.FixturesDataSource.create();SC.RelationshipSupport={_srs_inverseDidRelinquishRelationships:function(d,c,a,b){c.forEach(function(f){this._srs_inverseDidRelinquishRelationship(d,f,a,b)},this)},_srs_inverseDidRelinquishRelationship:function(i,h,g,b){var f=i.storeKeyFor(h),c=this.readDataHash(f),a=g.inverse,d=i.prototype;if(!c||!a){return}if(SC.instanceOf(d[a],SC.SingleAttribute)){delete c[a]}else{if(SC.instanceOf(d[a],SC.ManyAttribute)&&SC.typeOf(c[a])===SC.T_ARRAY){c[a].removeObject(b)}}this.pushRetrieve(i,h,c,undefined,true)},_srs_inverseDidAddRelationships:function(d,c,a,b){c.forEach(function(f){this._srs_inverseDidAddRelationship(d,f,a,b)},this)},_srs_inverseDidAddRelationship:function(b,a,j,l){var k=b.storeKeyFor(a),h=this.readDataHash(k),d=this.peekStatus(k),g=b.prototype,i=j.inverse,m=g[i],c=g[g.primaryKey],f=false;m=(m&&m.get&&m.get("key")||m.key)||i;if((d===SC.Record.EMPTY)&&(SC.typeOf(j.lazilyInstantiate)===SC.T_FUNCTION&&j.lazilyInstantiate()||SC.typeOf(j.lazilyInstantiate)!==SC.T_FUNCTION&&j.lazilyInstantiate)){if(!SC.none(c)&&c.typeClass&&SC.typeOf(c.typeClass())===SC.T_CLASS){f=true}h={};h[g.primaryKey]=a}if(!h||!i){return}if(SC.instanceOf(g[i],SC.SingleAttribute)){h[m]=l}else{if(SC.instanceOf(g[i],SC.ManyAttribute)){h[m]=h[m]||[];if(h[m].indexOf(l)<0){h[m].push(l)}}}this.pushRetrieve(b,a,h,undefined,!f)},_srs_pushIterator:function(d,b,j,g){var f=d.prototype,h,c,i,a;if(typeof j==="undefined"){j=d.storeKeyFor(b)}c=this.readDataHash(j)||{};for(i in f){h=f[i];if(h&&h.typeClass&&h.inverse&&h.isMaster){a=h.typeClass();if(SC.typeOf(a)!==SC.T_CLASS){continue}g.apply(this,[a,c,h,h.get&&h.get("key")||i])}}},pushDestroy:function(a,f,d,c){var b;this._srs_pushIterator(f,d,c,function(g,h,j,i){b=[h[i]||null].flatten().compact().uniq();this._srs_inverseDidRelinquishRelationships(g,b,j,d)});return a(f,d,c)}.enhance(),pushRetrieve:function(b,i,h,c,f,g){if(!g){var d,a;this._srs_pushIterator(i,h,f,function(j,k,m,l){d=[k[l]||null].flatten().compact().uniq();a=[c[l]||null].flatten().compact().uniq();this._srs_inverseDidRelinquishRelationships(j,d.filter(function(n){return a.indexOf(n)===-1}),m,h);this._srs_inverseDidAddRelationships(j,a,m,h)})}f=f||i.storeKeyFor(h);return b(i,h,c,f)}.enhance()};sc_require("models/record");SC.RecordAttribute=SC.Object.extend({isRecordAttribute:YES,defaultValue:null,type:String,key:null,isRequired:NO,isEditable:YES,useIsoDate:YES,aggregate:NO,lazilyInstantiate:NO,typeClass:function(){var a=this.get("type");if(SC.typeOf(a)===SC.T_STRING){a=SC.requiredObjectForPropertyPath(a)}return a}.property("type").cacheable(),transform:function(){var a=this.get("typeClass")||String,c=SC.RecordAttribute.transforms,b;while(a&&!(b=c[SC.guidFor(a)])){if(a.superclass.hasOwnProperty("create")){a=a.superclass}else{a=SC.T_FUNCTION}}return b}.property("typeClass").cacheable(),toType:function(f,k,j){var c=this.get("transform"),h=this.get("typeClass"),b;if(c&&c.to){j=c.to(j,this,h,f,k);if(!SC.none(j)&&(b=c.observesChildren)){var d,g=b.length,a={record:f,key:k};for(d=0;d<g;d++){j.addObserver(b[d],this,this._SCRA_childObserver,a)}}}return j},_SCRA_childObserver:function(d,b,c,a){this.call(a.record,a.key,d);a.record.notifyPropertyChange(a.key)},fromType:function(a,c,f){var b=this.get("transform"),d=this.get("typeClass");if(b&&b.from){f=b.from(f,this,d,a,c)}return f},call:function(a,b,c){var d=this.get("key")||b,f;if((c!==undefined)&&this.get("isEditable")){f=this.fromType(a,b,c);a.writeAttribute(d,f)}c=a.readAttribute(d);if(SC.none(c)&&(c=this.get("defaultValue"))){if(typeof c===SC.T_FUNCTION){c=c(a,b,this)}}c=this.toType(a,b,c);return c},apply:function(b,a){return this.call.apply(b,a)},isProperty:YES,isCacheable:YES,dependentKeys:[],init:function(){arguments.callee.base.apply(this,arguments);this.cacheKey="__cache__recattr__"+SC.guidFor(this);this.lastSetValueKey="__lastValue__recattr__"+SC.guidFor(this)}});SC.RecordAttribute.mixin({attr:function(a,b){if(!b){b={}}if(!b.type){b.type=a||String}return this.create(b)},transforms:{},registerTransform:function(a,b){SC.RecordAttribute.transforms[SC.guidFor(a)]=b}});SC.RecordAttribute.registerTransform(Boolean,{to:function(a){return SC.none(a)?null:!!a}});SC.RecordAttribute.registerTransform(Number,{to:function(a){return SC.none(a)?null:Number(a)}});SC.RecordAttribute.registerTransform(String,{to:function(a){if(!(typeof a===SC.T_STRING)&&!SC.none(a)&&a.toString){a=a.toString()}return a}});SC.RecordAttribute.registerTransform(Array,{to:function(a){if(!SC.isArray(a)&&!SC.none(a)){a=[]}return a},observesChildren:["[]"]});SC.RecordAttribute.registerTransform(Object,{to:function(a){if(!(typeof a==="object")&&!SC.none(a)){a={}}return a}});SC.RecordAttribute.registerTransform(SC.Record,{to:function(f,a,d,c){var b=c.get("store");if(SC.none(f)||(f==="")){return null}else{return b.find(d,f)}},from:function(a){return a?a.get("id"):null}});SC.RecordAttribute.registerTransform(SC.T_FUNCTION,{to:function(f,a,d,c){d=d.apply(c);var b=c.get("store");return b.find(d,f)},from:function(a){return a.get("id")}});SC.RecordAttribute.registerTransform(Date,{to:function(j,a){if(SC.none(j)){return j}var c;j=j.toString()||"";if(a.get("useIsoDate")){var f="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",i=j.match(new RegExp(f)),h=0,b=new Date(i[1],0,1),g;if(i[3]){b.setMonth(i[3]-1)}if(i[5]){b.setDate(i[5])}if(i[7]){b.setHours(i[7])}if(i[8]){b.setMinutes(i[8])}if(i[10]){b.setSeconds(i[10])}if(i[12]){b.setMilliseconds(Number("0."+i[12])*1000)}if(i[14]){h=(Number(i[16])*60)+Number(i[17]);h*=((i[15]==="-")?1:-1)}h-=b.getTimezoneOffset();g=(Number(b)+(h*60*1000));c=new Date();c.setTime(Number(g))}else{c=new Date(Date.parse(j))}return c},_dates:{},_zeropad:function(a){return((a<0)?"-":"")+((a<10)?"0":"")+Math.abs(a)},from:function(b){if(SC.none(b)){return null}var a=this._dates[b.getTime()];if(a){return a}var d=this._zeropad,c=0-b.getTimezoneOffset()/60;c=(c===0)?"Z":"%@:00".fmt(d(c));this._dates[b.getTime()]=a="%@-%@-%@T%@:%@:%@%@".fmt(d(b.getFullYear()),d(b.getMonth()+1),d(b.getDate()),d(b.getHours()),d(b.getMinutes()),d(b.getSeconds()),c);return a}});if(SC.DateTime&&!SC.RecordAttribute.transforms[SC.guidFor(SC.DateTime)]){SC.RecordAttribute.registerTransform(SC.DateTime,{to:function(c,a){if(SC.none(c)||SC.instanceOf(c,SC.DateTime)){return c}if(SC.none(c)||SC.instanceOf(c,Date)){return SC.DateTime.create(c.getTime())}var b=a.get("format");return SC.DateTime.parse(c,b?b:SC.DateTime.recordFormat)},from:function(b,a){if(SC.none(b)){return b}var c=a.get("format");return b.toFormattedString(c?c:SC.DateTime.recordFormat)}})}SC.RecordAttribute.registerTransform(SC.Set,{to:function(f,a,d,b,c){return SC.Set.create(f)},from:function(f,a,d,b,c){return f.toArray()},observesChildren:["[]"]});sc_require("models/record");sc_require("models/record_attribute");SC.ChildAttribute=SC.RecordAttribute.extend({isNestedRecordTransform:YES,toType:function(b,d,f){var c=null,a,g=this.get("typeClass");if(!b){throw"SC.Child: Error during transform: Unable to retrieve parent record."}if(!SC.none(f)){c=b.registerNestedRecord(f,d)}return c},fromType:function(b,f,g){var a,c,d;if(b){if(SC.none(g)){b.writeAttribute(f,g);d=g}else{d=b.registerNestedRecord(g,f);if(d){a=d.get("storeKey");c=d.get("store");b.writeAttribute(f,c.readDataHash(a))}else{if(g){b.writeAttribute(f,g)}}}}return d},call:function(a,c,d){var f=this.get("key")||c,b,g=SC.keyFor("__kid__",SC.guidFor(this));if(d!==undefined){d=this.fromType(a,c,d)}else{d=a.readAttribute(f);if(SC.none(d)&&(d=this.get("defaultValue"))){if(typeof d===SC.T_FUNCTION){d=this.defaultValue(a,c,this);if(a.attributes()){a.writeAttribute(f,d,true)}}}else{d=this.toType(a,c,d)}}return d}});sc_require("models/record");SC.ChildRecord=SC.Record.extend({});SC.ChildRecord.extend=function(){return SC.Record.extend.apply(this,arguments)};SC.ChildArray=SC.Object.extend(SC.Enumerable,SC.Array,{defaultRecordType:null,record:null,propertyName:null,children:null,store:function(){return this.getPath("record.store")}.property("record").cacheable(),storeKey:function(){return this.getPath("record.storeKey")}.property("record").cacheable(),readOnlyChildren:function(){return this.get("record").readAttribute(this.get("propertyName"))}.property(),editableChildren:function(){var a=this.get("store"),d=this.get("storeKey"),c=this.get("propertyName"),b,f;b=a.readEditableProperty(d,c);if(!b){f=a.readEditableDataHash(d);b=f[c]=[]}return b}.property(),length:function(){var a=this.get("readOnlyChildren");return a?a.length:0}.property("readOnlyChildren"),objectAt:function(b){var h=this._records,f=this.get("readOnlyChildren"),i,c,d=this.get("propertyName"),g=this.get("record");var a=f?f.length:0;if(!f){return undefined}if(h&&(c=h[b])){return c}if(!h){this._records=h=[]}if(b>=a){return undefined}i=f.objectAt(b);if(!i){return undefined}h[b]=c=g.registerNestedRecord(i,d,d+"."+b);return c},replace:function(k,a,j){var b=this.get("editableChildren"),h=j?(j.get?j.get("length"):j.length):0,g=this.get("record"),d,f=this.get("propertyName"),i,c;d=this._processRecordsToHashes(j);b.replace(k,a,d);if(d!==this._prevChildren){this._performRecordPropertyChange(null,false);this.arrayContentWillChange(k,a,h);this._childrenContentDidChange(k,a,h)}g.recordDidChange(f);return this},_processRecordsToHashes:function(c){var b,a;c=c||[];c.forEach(function(f,d){if(f.isNestedRecord){b=f.get("store");a=f.storeKey;c[d]=b.readDataHash(a)}});return c},normalize:function(){this.forEach(function(b,a){if(b.normalize){b.normalize()}})},recordPropertyDidChange:function(a){this._performRecordPropertyChange(a,true);return this},_performRecordPropertyChange:function(g,i){if(g&&!g.contains(this.get("propertyName"))){return this}var b=this.get("readOnlyChildren"),a=0,c=0;var d=this._prevChildren,h=this._childrenContentDidChange;i=SC.none(i)?true:i;if(b===d){return this}if(d){d.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:h});a=d.get("length")}if(b){b.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:h});c=b.get("length")}this._prevChildren=b;if(i){this.arrayContentWillChange(0,a,c);this._childrenContentDidChange(0,a,c)}return this},_childrenContentDidChange:function(c,a,b){this._records=null;this.arrayContentDidChange(c,a,b)},init:function(){arguments.callee.base.apply(this,arguments);this.recordPropertyDidChange()}});sc_require("models/record");sc_require("models/record_attribute");sc_require("models/child_attribute");sc_require("system/child_array");SC.ChildrenAttribute=SC.ChildAttribute.extend({toType:function(b,d,f){var h=this.get("key")||d,g=SC.keyFor("__kidsArray__",SC.guidFor(this)),c=b[g],i=this.get("typeClass"),a;if(!c){c=SC.ChildArray.create({record:b,propertyName:h,defaultRecordType:i});b[g]=c;a=b.get("relationships");if(!a){b.set("relationships",a=[])}a.push(c)}return c},fromType:function(b,f,g){var a,c,h=SC.keyFor("__kidsArray__",SC.guidFor(this)),d=b[h];if(b){b.writeAttribute(f,g);if(d){d=d.recordPropertyDidChange()}}return d},call:function(a,c,d){var f=this.get("key")||c,b,g=SC.keyFor("__kid__",SC.guidFor(this));if(d!==undefined){d=this.fromType(a,c,d)}else{d=a.readAttribute(f);if(SC.none(d)&&(d=this.get("defaultValue"))){if(typeof d===SC.T_FUNCTION){d=this.defaultValue(a,c,this);if(a.attributes()){if(d instanceof Array){d=this.toType(a,c,d).replace(0,d.length,d)}else{a.writeAttribute(f,d,true)}}}}else{d=this.toType(a,c,d)}}return d}});sc_require("models/record");sc_require("models/record_attribute");SC.FetchedAttribute=SC.RecordAttribute.extend({paramValueKey:"link",paramOwnerKey:"owner",paramRelKey:"rel",queryKey:null,isEditable:NO,toType:function(d,j,h){var i=d.get("store");if(!i){return null}var b=this.get("paramValueKey"),a=this.get("paramOwnerKey"),g=this.get("paramRelKey"),f=this.get("queryKey")||this.get("typeClass"),c={};if(b){c[b]=h}if(a){c[a]=d}if(g){c[g]=this.get("key")||j}return i.findAll(f,c)},fromType:function(a,b,c){return c}});SC.ManyArray=SC.Object.extend(SC.Enumerable,SC.Array,{recordType:null,record:null,propertyName:null,manyAttribute:null,store:function(){return this.get("record").get("store")}.property("record").cacheable(),storeKey:function(){return this.get("record").get("storeKey")}.property("record").cacheable(),readOnlyStoreIds:function(){return this.get("record").readAttribute(this.get("propertyName"))}.property(),editableStoreIds:function(){var a=this.get("store"),d=this.get("storeKey"),c=this.get("propertyName"),b,f;b=a.readEditableProperty(d,c);if(!b){f=a.readEditableDataHash(d);b=f[c]=[]}if(b!==this._prevStoreIds){this.recordPropertyDidChange()}return b}.property(),isEditable:function(){var a=this.manyAttribute;return a?a.get("isEditable"):NO}.property("manyAttribute").cacheable(),inverse:function(){var a=this.manyAttribute;return a?a.get("inverse"):null}.property("manyAttribute").cacheable(),isMaster:function(){var a=this.manyAttribute;return a?a.get("isMaster"):null}.property("manyAttribute").cacheable(),orderBy:function(){var a=this.manyAttribute;return a?a.get("orderBy"):null}.property("manyAttribute").cacheable(),length:function(){var a=this.get("readOnlyStoreIds");return a?a.get("length"):0}.property("readOnlyStoreIds"),objectAt:function(a){var h=this._records,g=this.get("readOnlyStoreIds"),c=this.get("store"),i=this.get("recordType"),f,d,b;if(!g||!c){return undefined}if(h&&(d=h[a])){return d}if(!h){this._records=h=[]}b=g.objectAt(a);if(b){f=c.storeKeyFor(i,b);if(c.readStatus(f)===SC.Record.EMPTY){c.retrieveRecord(i,null,f)}h[a]=d=c.materializeRecord(f)}return d},replace:function(o,d,n){if(!this.get("isEditable")){throw"%@.%@[] is not editable".fmt(this.get("record"),this.get("propertyName"))}var c=this.get("editableStoreIds"),l=n?(n.get?n.get("length"):n.length):0,j=this.get("record"),f=this.get("propertyName"),h,p,a,b,g,m,k;a=[];for(h=0;h<l;h++){a[h]=n.objectAt(h).get("id")}g=this.get("inverse");if(g&&d>0){b=SC.ManyArray._toRemove;if(b){SC.ManyArray._toRemove=null}else{b=[]}for(h=0;h<d;h++){b[h]=this.objectAt(o+h)}}c.replace(o,d,a);if(g){for(h=0;h<d;h++){k=b[h];m=k?k[g]:null;if(m&&m.inverseDidRemoveRecord){m.inverseDidRemoveRecord(k,g,j,f)}}if(b){b.length=0;if(!SC.ManyArray._toRemove){SC.ManyArray._toRemove=b}}for(h=0;h<l;h++){k=n.objectAt(h);m=k?k[g]:null;if(m&&m.inverseDidAddRecord){m.inverseDidAddRecord(k,g,j,f)}}}if(j&&(!g||this.get("isMaster"))){j.recordDidChange(f)}this.enumerableContentDidChange(o,d,l-d);return this},removeInverseRecord:function(c){if(!c){return this}var f=c.get("id"),d=this.get("editableStoreIds"),a=(d&&f)?d.indexOf(f):-1,b;if(a>=0){d.removeAt(a);if(this.get("isMaster")&&(b=this.get("record"))){b.recordDidChange(this.get("propertyName"))}}return this},addInverseRecord:function(d){if(!d){return this}var h=d.get("id"),f=this.get("editableStoreIds"),g=this.get("orderBy"),b=f.get("length"),a,c;if(g){a=this._findInsertionLocation(d,0,b,g)}else{a=b}f.insertAt(a,d.get("id"));if(this.get("isMaster")&&(c=this.get("record"))){c.recordDidChange(this.get("propertyName"))}return this},_findInsertionLocation:function(h,d,c,g){var b=d+Math.floor((c-d)/2),f=this.objectAt(b),a=this._compare(h,f,g);if(a<0){if(b===0){return b}else{return this._findInsertionLocation(h,0,b,g)}}else{if(a>0){if(b>=c){return b}else{return this._findInsertionLocation(h,b,c,g)}}else{return b}}},_compare:function(g,f,j){var i=SC.typeOf(j),h,d,c;if(i===SC.T_FUNCTION){h=j(g,f)}else{if(i===SC.T_STRING){h=SC.compare(g,f)}else{c=j.get("length");h=0;for(d=0;(h===0)&&(d<c);d++){h=SC.compare(g,f)}}}return h},recordPropertyDidChange:function(d){if(d&&!d.contains(this.get("propertyName"))){return this}var h=this.get("readOnlyStoreIds"),a,b;var c=this._prevStoreIds,g=this._storeIdsContentDidChange;if(h===c){return this}if(c){c.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:g});a=c.get("length")}else{a=0}if(h){h.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:g});b=h.get("length")}else{b=0}this.arrayContentWillChange(0,a,b);this._prevStoreIds=h;this._storeIdsContentDidChange(0,a,b)},_storeIdsContentDidChange:function(c,a,b){this._records=null;this.arrayContentDidChange(c,a,b)},unknownProperty:function(b,c){var a;if(SC.typeOf(b)===SC.T_STRING){a=this.reducedProperty(b,c)}return a===undefined?arguments.callee.base.apply(this,arguments):a},init:function(){arguments.callee.base.apply(this,arguments);this.recordPropertyDidChange()}});sc_require("models/record");sc_require("models/record_attribute");sc_require("system/many_array");SC.ManyAttribute=SC.RecordAttribute.extend({inverse:null,isMaster:YES,orderBy:null,toType:function(b,d,g){var f=this.get("typeClass"),i=this.get("key")||d,h=SC.keyFor("__manyArray__",SC.guidFor(this)),c=b[h],a;if(!c){c=SC.ManyArray.create({recordType:f,record:b,propertyName:i,manyAttribute:this});b[h]=c;a=b.get("relationships");if(!a){b.set("relationships",a=[])}a.push(c)}return c},fromType:function(b,f,g){var c=[];if(!SC.isArray(g)){throw"Expects toMany attribute to be an array"}var a=g.get("length");for(var d=0;d<a;d++){c[d]=g.objectAt(d).get("id")}return c},inverseDidRemoveRecord:function(a,b,c,d){var f=a.get(b);if(f){f.removeInverseRecord(c)}},inverseDidAddRecord:function(a,b,c,d){var f=a.get(b);if(f){f.addInverseRecord(c)}}});sc_require("models/record");sc_require("models/record_attribute");SC.SingleAttribute=SC.RecordAttribute.extend({inverse:null,isMaster:YES,call:function(c,j,b){var a=this.get("key")||j,i,h,k,g,f,d;if(b!==undefined&&this.get("isEditable")){if(b&&!SC.kindOf(b,SC.Record)){throw"%@ is not an instance of SC.Record".fmt(b)}i=this.get("inverse");if(i){k=this._scsa_call(c,j)}d=this.fromType(c,j,b);c.writeAttribute(a,d,!this.get("isMaster"));f=b;if(i&&(k!==b)){if(k&&(g=k[i])){g.inverseDidRemoveRecord(k,i,c,j)}if(b&&(g=b[i])){g.inverseDidAddRecord(b,i,c,j)}}}else{f=this._scsa_call(c,j,b)}return f},_scsa_call:SC.RecordAttribute.prototype.call,inverseDidRemoveRecord:function(c,g,h,i){var b=this.get("inverse"),f=this._scsa_call(c,g),d=this.get("isMaster"),a;c.writeAttribute(this.get("key")||g,null,!d);c.notifyPropertyChange(g);if((f!==h)||(i!==b)){if(f&&(a=f[b])){a.inverseDidRemoveRecord(f,b,c,g)}}},inverseDidAddRecord:function(a,i,c,h){var f=this.get("inverse"),j=this._scsa_call(a,i),g=this.get("isMaster"),d,b;b=this.fromType(a,i,c);a.writeAttribute(this.get("key")||i,b,!g);a.notifyPropertyChange(i);if((j!==c)||(h!==f)){if(j&&(d=j[f])){d.inverseDidRemoveRecord(j,f,a,i)}}}});sc_require("models/record");SC.Store=SC.Object.extend({name:null,nestedStores:null,dataSource:null,isNested:NO,commitRecordsAutomatically:NO,from:function(a){this.set("dataSource",a);return this},_getDataSource:function(){var a=this.get("dataSource");if(typeof a===SC.T_STRING){a=SC.requiredObjectForPropertyPath(a);if(a.isClass){a=a.create()}this.set("dataSource",a)}return a},cascade:function(a){var b=SC.A(arguments);a=SC.CascadeDataSource.create({dataSources:b});return this.from(a)},chain:function(b,c){if(!b){b={}}b.parentStore=this;if(c){if(SC.typeOf(c)!=="class"){throw new Error("%@ is not a valid class".fmt(c))}if(!SC.kindOf(c,SC.NestedStore)){throw new Error("%@ is not a type of SC.NestedStore".fmt(c))}}else{c=SC.NestedStore}b.childRecords=this.childRecords?SC.clone(this.childRecords):{};b.parentRecords=this.parentRecords?SC.clone(this.parentRecords):{};var a=c.create(b),d=this.nestedStores;if(!d){d=this.nestedStores=[]}d.push(a);return a},willDestroyNestedStore:function(a){if(this.nestedStores){this.nestedStores.removeObject(a)}return this},hasNestedStore:function(a){while(a&&(a!==this)){a=a.get("parentStore")}return a===this},dataHashes:null,statuses:null,revisions:null,editables:null,changelog:null,recordErrors:null,queryErrors:null,childRecords:null,parentRecords:null,storeKeyEditState:function(b){var c=this.editables,a=this.locks;return(c&&c[b])?SC.Store.EDITABLE:SC.Store.LOCKED},readDataHash:function(a){return this.dataHashes[a]},readEditableDataHash:function(b){var a=this.dataHashes[b];if(!a){return a}var c=this.editables;if(!c){c=this.editables=[]}if(!c[b]){c[b]=1;a=this.dataHashes[b]=SC.clone(a,YES)}return a},readEditableProperty:function(c,a){var f=this.readEditableDataHash(c),d=this.editables[c],b=f[a];if(d===1){d=this.editables[c]={}}if(!d[a]){b=f[a];if(b&&b.isCopyable){b=f[a]=b.copy(YES)}d[a]=YES}return b},writeDataHash:function(c,f,a){if(f){this.dataHashes[c]=f}if(a){this.statuses[c]=a}var d=this.editables;if(!d){d=this.editables=[]}d[c]=1;var b=this;this._propagateToChildren(c,function(g){b.writeDataHash(g,null,a)});return this},removeDataHash:function(b,a){this.dataHashes[b]=null;this.statuses[b]=a||SC.Record.EMPTY;var c=this.editables;if(c){c[b]=0}return this},readStatus:function(a){this.readDataHash(a);return this.statuses[a]||SC.Record.EMPTY},peekStatus:function(a){return this.statuses[a]||SC.Record.EMPTY},writeStatus:function(b,a){return this.writeDataHash(b,null,a)},dataHashDidChange:function(f,b,a,i){if(!b){b=SC.Store.generateStoreKey()}var c,g,h,j;c=SC.typeOf(f)===SC.T_ARRAY;if(c){g=f.length}else{g=1;j=f}var d=this;for(h=0;h<g;h++){if(c){j=f[h]}this.revisions[j]=b;this._notifyRecordPropertyChange(j,a,i);this._propagateToChildren(j,function(k){d.dataHashDidChange(k,null,a,i)})}return this},_notifyRecordPropertyChange:function(n,f,m){var a=this.records,h=this.get("nestedStores"),i=SC.Store,c,b,g,l,k,d,o;g=h?h.length:0;for(l=0;l<g;l++){k=h[l];d=k.peekStatus(n);b=k.storeKeyEditState(n);if(b===i.INHERITED){k._notifyRecordPropertyChange(n,f,m)}else{if(d&SC.Record.BUSY){if(k.get("hasChanges")){throw i.CHAIN_CONFLICT_ERROR}k.reset()}}}var j=this.recordPropertyChanges;if(!j){j=this.recordPropertyChanges={storeKeys:SC.CoreSet.create(),records:SC.CoreSet.create(),hasDataChanges:SC.CoreSet.create(),propertyForStoreKeys:{}}}j.storeKeys.add(n);if(a&&(c=a[n])){j.records.push(n);if(!f){j.hasDataChanges.push(n)}if(m){if(!(o=j.propertyForStoreKeys[n])){o=j.propertyForStoreKeys[n]=SC.CoreSet.create()}if(o!=="*"){o.add(m)}}else{j.propertyForStoreKeys[n]="*"}}this.invokeOnce(this.flush);return this},flush:function(){if(!this.recordPropertyChanges){return this}var j=this.recordPropertyChanges,i=j.storeKeys,m=j.hasDataChanges,a=j.records,g=j.propertyForStoreKeys,d=SC.CoreSet.create(),c,b,f,k,h,l,n;i.forEach(function(o){if(a.contains(o)){f=m.contains(o)?NO:YES;c=this.records[o];n=g?g[o]:null;if(n==="*"){n=null}a.remove(o);if(c){c.storeDidChangeProperties(f,n)}}b=SC.Store.recordTypeFor(o);d.add(b)},this);if(i.get("length")>0){this._notifyRecordArrays(i,d)}i.clear();m.clear();a.clear();this.recordPropertyChanges.propertyForStoreKeys={};return this},reset:function(){this.dataHashes={};this.revisions={};this.statuses={};this.chainedChanges=this.locks=this.editables=null;this.changelog=null;this.recordErrors=null;this.queryErrors=null;var c=this.get("dataSource");if(c&&c.reset){c.reset()}var a=this.records,b;if(a){for(b in a){if(!a.hasOwnProperty(b)){continue}this._notifyRecordPropertyChange(parseInt(b,10),NO)}}this.set("hasChanges",NO)},commitChangesFromNestedStore:function(k,v,d){if(!d){this._verifyLockRevisions(v,k.locks)}var q=v.length,p,g,c,m,f,b,j,a,r,t,h,n,l;b=this.revisions;c=this.dataHashes;m=this.statuses;f=this.editables;j=this.parentRecords?this.parentRecords:this.parentRecords={};a=this.childRecords?this.childRecords:this.childRecords={};if(!f){f=this.editables=[]}r=k.dataHashes;h=k.revisions;t=k.statuses;n=k.parentRecords||{};l=k.childRecords||{};for(p=0;p<q;p++){g=v[p];c[g]=r[g];m[g]=t[g];b[g]=h[g];j[g]=n[g];a[g]=l[g];f[g]=0;this._notifyRecordPropertyChange(g,NO)}var o=this.changelog,u=k.changelog;if(u){if(!o){o=this.changelog=SC.CoreSet.create()}o.addEach(u)}this.changelog=o;if(!this.get("parentStore")){this.flush()}return this},_verifyLockRevisions:function(g,j){var a=g.length,c=this.revisions,f,h,d,b;if(j&&c){for(f=0;f<a;f++){h=g[f];d=j[h]||1;b=c[h]||1;if(d<b){throw SC.Store.CHAIN_CONFLICT_ERROR}}}return this},find:function(b,a){if(SC.typeOf(b)===SC.T_STRING){b=SC.objectForPropertyPath(b)}if((arguments.length===1)&&!(b&&b.get&&b.get("isRecord"))){if(!b){throw new Error("SC.Store#find() must pass recordType or query")}if(!b.isQuery){b=SC.Query.local(b)}return this._findQuery(b,YES,YES)}else{return this._findRecord(b,a)}},findAll:function(c,a,b){SC.Logger.warn("SC.Store#findAll() will be removed in a future version of SproutCore.  Use SC.Store#find() instead");if(!c||!c.isQuery){c=SC.Query.local(c,a,b)}return this._findQuery(c,YES,YES)},_findQuery:function(g,a,f){var b=this._scst_recordArraysByQuery,d=SC.guidFor(g),c,h;if(!b){b=this._scst_recordArraysByQuery={}}c=b[d];if(!c&&a){b[d]=c=SC.RecordArray.create({store:this,query:g});h=this.get("recordArrays");if(!h){this.set("recordArrays",h=SC.Set.create())}h.add(c);if(f){this.refreshQuery(g)}}this.flush();return c},_findRecord:function(c,b){var a;if(c&&c.get&&c.get("isRecord")){a=c.get("storeKey")}else{a=b?c.storeKeyFor(b):null}if(a&&(this.readStatus(a)===SC.Record.EMPTY)){a=this.retrieveRecord(c,b)}return a?this.materializeRecord(a):null},recordArrayWillDestroy:function(b){var a=this._scst_recordArraysByQuery,c=this.get("recordArrays");if(a){delete a[SC.guidFor(b.get("query"))]}if(c){c.remove(b)}return this},refreshQuery:function(d){if(!d){throw new Error("refreshQuery() requires a query")}var a=this._scst_recordArraysByQuery,c=a?a[SC.guidFor(d)]:null,b=this._getDataSource();if(b&&b.fetch){if(c){c.storeWillFetchQuery(d)}b.fetch.call(b,this,d)}return this},_notifyRecordArrays:function(b,a){var c=this.get("recordArrays");if(!c){return this}c.forEach(function(d){if(d){d.storeDidChangeStoreKeys(b,a)}},this);return this},recordsFor:function(g){var d=[],a=g.storeKeysById(),f,c,b;for(f in a){c=a[f];if(this.readStatus(c)!==SC.RECORD_EMPTY){d.push(c)}}if(d.length>0){b=SC.RecordArray.create({store:this,storeKeys:d})}else{b=d}return b},_TMP_REC_ATTRS:{},materializeRecord:function(d){var a=this.records,c,f,b;if(!a){a=this.records={}}c=a[d];if(c){return c}f=SC.Store.recordTypeFor(d);if(!f){return null}b=this._TMP_REC_ATTRS;b.storeKey=d;b.store=this;c=a[d]=f.create(b);return c},createRecord:function(b,d,a){var j,k,c,i=SC.Record,f,h,g;if(!a&&(j=b.prototype.primaryKey)){a=d[j];h=b.prototype[j]?b.prototype[j].defaultValue:null;if(!a&&SC.typeOf(h)===SC.T_FUNCTION){a=d[j]=h()}}k=a?b.storeKeyFor(a):SC.Store.generateStoreKey();c=this.readStatus(k);if((c&i.BUSY)||(c&i.READY)||(c===i.DESTROYED_DIRTY)){throw a?i.RECORD_EXISTS_ERROR:i.BAD_STATE_ERROR}else{if(!a&&(c===SC.DESTROYED_CLEAN||c===SC.ERROR)){throw i.BAD_STATE_ERROR}}this.writeDataHash(k,(d?d:{}),i.READY_NEW);SC.Store.replaceRecordTypeFor(k,b);this.dataHashDidChange(k);f=this.changelog;if(!f){f=SC.Set.create()}f.add(k);this.changelog=f;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}g=this.materializeRecord(k);if(g){g.propagateToAggregates()}return g},createRecords:function(d,j,a){var h=[],c,b,f,g=j.length,i;f=SC.typeOf(d)===SC.T_ARRAY;if(!f){c=d}for(i=0;i<g;i++){if(f){c=d[i]||SC.Record}b=a?a[i]:undefined;h.push(this.createRecord(c,j[i],b))}return h},unloadRecord:function(h,g,f,c){if(f===undefined){f=h.storeKeyFor(g)}var b=this.readStatus(f),a=SC.Record;c=c||a.EMPTY;if((b===a.BUSY_DESTROYING)||(b&a.DESTROYED)){return this}else{if(b&a.BUSY){throw a.BUSY_ERROR}else{b=c}}this.removeDataHash(f,b);this.dataHashDidChange(f);var d=this;this._propagateToChildren(f,function(i){d.unloadRecord(null,null,i,c)});return this},unloadRecords:function(d,a,h,f){var i,g,j,b,c,k;if(h===undefined){g=SC.typeOf(d)===SC.T_ARRAY;if(!g){c=d}if(a===undefined){i=g?d.length:1;for(j=0;j<i;j++){if(g){c=d[j]}h=this.storeKeysFor(c);this.unloadRecords(undefined,undefined,h,f)}}else{i=a.length;for(j=0;j<i;j++){if(g){c=d[j]||SC.Record}b=a?a[j]:undefined;this.unloadRecord(c,b,undefined,f)}}}else{i=h.length;for(j=0;j<i;j++){k=h?h[j]:undefined;this.unloadRecord(undefined,undefined,k,f)}}return this},destroyRecord:function(h,g,f){if(f===undefined){f=h.storeKeyFor(g)}var b=this.readStatus(f),c,a=SC.Record;if((b===a.BUSY_DESTROYING)||(b&a.DESTROYED)){return this}else{if(b===a.EMPTY){throw a.NOT_FOUND_ERROR}else{if(b&a.BUSY){throw a.BUSY_ERROR}else{if(b===a.READY_NEW){b=a.DESTROYED_CLEAN}else{b=a.DESTROYED_DIRTY}}}}this.writeStatus(f,b);this.dataHashDidChange(f);c=this.changelog;if(!c){c=this.changelog=SC.Set.create()}((b&a.DIRTY)?c.add(f):c.remove(f));this.changelog=c;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}var d=this;this._propagateToChildren(f,function(i){d.destroyRecord(null,null,i)});return this},destroyRecords:function(d,a,g){var h,f,i,b,c,j;if(g===undefined){h=a.length;f=SC.typeOf(d)===SC.T_ARRAY;if(!f){c=d}for(i=0;i<h;i++){if(f){c=d[i]||SC.Record}b=a?a[i]:undefined;this.destroyRecord(c,b,undefined)}}else{h=g.length;for(i=0;i<h;i++){j=g?g[i]:undefined;this.destroyRecord(undefined,undefined,j)}}return this},registerChildToParent:function(c,h,g){var f,b,d,i,a;b=this.childRecords||{};f=this.parentRecords||{};d=b[h];if(d){i=f[d];delete i[h]}a=f[c]||{};a[h]=g||YES;f[c]=a;b[h]=c;this.writeStatus(h,this.statuses[c]);this.childRecords=b;this.parentRecords=f},materializeParentRecord:function(c){var b,a;if(SC.none(c)){return null}a=this.childRecords;b=a?this.childRecords[c]:null;if(SC.none(b)){return null}return this.materializeRecord(b)},parentStoreKeyExists:function(b){if(SC.none(b)){return}var a=this.childRecords||{};return a[b]},_propagateToChildren:function(d,c){if(SC.none(this.parentRecords)){return}var b=this.parentRecords[d]||{};if(SC.none(c)){return}for(var a in b){if(b.hasOwnProperty(a)){c(parseInt(a,10))}}},recordDidChange:function(i,h,g,d,c){if(g===undefined){g=i.storeKeyFor(h)}var b=this.readStatus(g),f,a=SC.Record;if(b&a.BUSY){throw a.BUSY_ERROR}else{if(!(b&a.READY)){throw a.NOT_FOUND_ERROR}else{if(b!=a.READY_NEW){this.writeStatus(g,a.READY_DIRTY)}}}this.dataHashDidChange(g,null,c,d);f=this.changelog;if(!f){f=this.changelog=SC.Set.create()}f.add(g);this.changelog=f;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}return this},recordsDidChange:function(d,a,g){var h,f,i,b,c,j;if(g===undefined){h=a.length;f=SC.typeOf(d)===SC.T_ARRAY;if(!f){c=d}for(i=0;i<h;i++){if(f){c=d[i]||SC.Record}b=a?a[i]:undefined;j=g?g[i]:undefined;this.recordDidChange(c,b,j)}}else{h=g.length;for(i=0;i<h;i++){j=g?g[i]:undefined;this.recordDidChange(undefined,undefined,j)}}return this},retrieveRecords:function(g,n,b,c,r){var m=this._getDataSource(),i=SC.typeOf(g)===SC.T_ARRAY,l=SC.typeOf(r)===SC.T_ARRAY,p=(!b)?n.length:b.length,t=[],q=SC.Store.generateStoreKey(),h=SC.Record,a,k,f,o,j,d;if(!i){a=g}for(k=0;k<p;k++){if(b){f=b[k]}else{if(i){a=g[k]}f=a.storeKeyFor(n[k])}d=l?r[k]:r;o=this.readStatus(f);if((o==h.EMPTY)||(o==h.ERROR)||(o==h.DESTROYED_CLEAN)){this.writeStatus(f,h.BUSY_LOADING);this.dataHashDidChange(f,q,YES);t.push(f);this._setCallbackForStoreKey(f,d,l,b)}else{if(c){if(o&h.READY){this.writeStatus(f,h.BUSY_REFRESH|(o&3));this.dataHashDidChange(f,q,YES);t.push(f);this._setCallbackForStoreKey(f,d,l,b)}else{if((o==h.BUSY_DESTROYING)||(o==h.BUSY_CREATING)||(o==h.BUSY_COMMITTING)){throw h.BUSY_ERROR}else{if(o==h.DESTROYED_DIRTY){throw h.BAD_STATE_ERROR}}}}}}j=NO;if(m){j=m.retrieveRecords.call(m,this,t,n)}if(!j){p=t.length;q=SC.Store.generateStoreKey();for(k=0;k<p;k++){f=t[k];o=this.readStatus(f);if(o===h.BUSY_LOADING){this.writeStatus(f,h.ERROR);this.dataHashDidChange(f,q,YES)}else{if(o&h.BUSY_REFRESH){this.writeStatus(f,h.READY|(o&3));this.dataHashDidChange(f,q,YES)}}}t.length=0}return t},_TMP_RETRIEVE_ARRAY:[],_callback_queue:{},_setCallbackForStoreKey:function(d,f,b,c){var a=this._callback_queue;if(b){a[d]={callback:f,otherKeys:c}}else{a[d]=f}},_retreiveCallbackForStoreKey:function(c){var a=this._callback_queue,f=a[c],d,b;if(f){if(SC.typeOf(f)===SC.T_FUNCTION){f.call();delete a[c]}else{if(SC.typeOf(f)==SC.T_HASH){f.completed=YES;b=f.storeKeys;b.forEach(function(g){if(!a[g].completed){d=YES}});if(d){f.callback.call();b.forEach(function(g){delete a[g]})}}}}},_cancelCallback:function(b){var a=this._callback_queue;if(a[b]){delete a[b]}},retrieveRecord:function(h,g,b,c,f){var d=this._TMP_RETRIEVE_ARRAY,a;if(b){d[0]=b;b=d;g=null}else{d[0]=g;g=d}a=this.retrieveRecords(h,g,b,c,f);d.length=0;return a[0]},refreshRecord:function(d,c,a,b){return !!this.retrieveRecord(d,c,a,YES,b)},refreshRecords:function(b,c,d,f){var a=this.retrieveRecords(b,c,d,YES,f);return a&&a.length>0},commitRecords:function(g,o,b,r,v){var n=this._getDataSource(),i=SC.typeOf(g)===SC.T_ARRAY,l=SC.typeOf(v)===SC.T_ARRAY,c=[],k=[],m=[],t=SC.Store.generateStoreKey(),h=SC.Record,a,j,f,p,w,u,q,d;if(!g&&!o&&!b){b=this.changelog}q=b?b.get("length"):(o?o.get("length"):0);for(j=0;j<q;j++){if(b){f=b[j]}else{if(i){a=g[j]||SC.Record}else{a=g}f=a.storeKeyFor(o[j])}d=l?v[j]:v;p=this.readStatus(f);if(p==h.ERROR){throw h.NOT_FOUND_ERROR}else{if(p==h.READY_NEW){this.writeStatus(f,h.BUSY_CREATING);this.dataHashDidChange(f,t,YES);c.push(f);this._setCallbackForStoreKey(f,d,l,b)}else{if(p==h.READY_DIRTY){this.writeStatus(f,h.BUSY_COMMITTING);this.dataHashDidChange(f,t,YES);k.push(f);this._setCallbackForStoreKey(f,d,l,b)}else{if(p==h.DESTROYED_DIRTY){this.writeStatus(f,h.BUSY_DESTROYING);this.dataHashDidChange(f,t,YES);m.push(f);this._setCallbackForStoreKey(f,d,l,b)}else{if(p==h.DESTROYED_CLEAN){this.dataHashDidChange(f,t,YES)}}}}}}if(n&&(q>0||r)){u=n.commitRecords.call(n,this,c,k,m,r)}if(u&&!g&&!o){if(b===this.changelog){this.changelog=null}else{this.changelog.removeEach(b)}}return u},commitRecord:function(h,g,b,c,f){var d=this._TMP_RETRIEVE_ARRAY,a;if(g===undefined&&b===undefined){return NO}if(b!==undefined){d[0]=b;b=d;g=null}else{d[0]=g;g=d}a=this.commitRecords(h,g,b,c,f);d.length=0;return a},cancelRecords:function(f,b,j){var a=this._getDataSource(),h=SC.typeOf(f)===SC.T_ARRAY,l=SC.Record,k=[],g,i,m,c,d,n;i=(j===undefined)?b.length:j.length;for(m=0;m<i;m++){if(h){d=f[m]||SC.Record}else{d=f||SC.Record}c=b?b[m]:undefined;if(j===undefined){n=d.storeKeyFor(c)}else{n=j?j[m]:undefined}if(n){g=this.readStatus(n);if((g==l.EMPTY)||(g==l.ERROR)){throw l.NOT_FOUND_ERROR}k.push(n);this._cancelCallback(n)}}if(a){a.cancel.call(a,this,k)}return this},cancelRecord:function(f,d,b){var c=this._TMP_RETRIEVE_ARRAY,a;if(b!==undefined){c[0]=b;b=c;d=null}else{c[0]=d;d=c}a=this.cancelRecords(f,d,b);c.length=0;return this},loadRecord:function(h,d,g){var a=SC.Record,c,b,f;h=h||SC.Record;b=h.prototype.primaryKey;g=g||d[b];c=f=h.storeKeyFor(g);if(this.readStatus(f)&a.BUSY){this.dataSourceDidComplete(f,d,g)}else{this.pushRetrieve(h,g,d,f)}return c},loadRecords:function(d,n,a){var g=SC.typeOf(d)===SC.T_ARRAY,h=n.get("length"),i=[],j=SC.Record,c,b,l,k,f,m;if(!g){c=d||SC.Record;l=c.prototype.primaryKey}for(k=0;k<h;k++){f=n.objectAt(k);if(g){c=d.objectAt(k)||SC.Record;l=c.prototype.primaryKey}b=(a)?a.objectAt(k):f[l];i[k]=this.loadRecord(c,f,b)}return i},readError:function(a){var b=this.recordErrors;return b?b[a]:undefined},readQueryError:function(a){var b=this.queryErrors;return b?b[SC.guidFor(a)]:undefined},dataSourceDidCancel:function(c){var b=this.readStatus(c),a=SC.Record;if(!(b&a.BUSY)){throw a.BAD_STATE_ERROR}switch(b){case a.BUSY_LOADING:b=a.EMPTY;break;case a.BUSY_CREATING:b=a.READY_NEW;break;case a.BUSY_COMMITTING:b=a.READY_DIRTY;break;case a.BUSY_REFRESH_CLEAN:b=a.READY_CLEAN;break;case a.BUSY_REFRESH_DIRTY:b=a.READY_DIRTY;break;case a.BUSY_DESTROYING:b=a.DESTROYED_DIRTY;break;default:throw a.BAD_STATE_ERROR}this.writeStatus(c,b);this.dataHashDidChange(c,null,YES);this._cancelCallback(c);return this},dataSourceDidComplete:function(h,g,f){var c=this.readStatus(h),b=SC.Record,d;if(!(c&b.BUSY)){throw b.BAD_STATE_ERROR}if(c===b.BUSY_DESTROYING){throw b.BAD_STATE_ERROR}else{c=b.READY_CLEAN}this.writeStatus(h,c);if(g){this.writeDataHash(h,g,c)}if(f){SC.Store.replaceIdFor(h,f)}d=g||f?NO:YES;this.dataHashDidChange(h,null,d);var a=this.materializeRecord(h);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(h);return this},dataSourceDidDestroy:function(d){var c=this.readStatus(d),b=SC.Record;if(!(c&b.BUSY)){throw b.BAD_STATE_ERROR}else{c=b.DESTROYED_CLEAN}this.removeDataHash(d,c);this.dataHashDidChange(d);var a=this.materializeRecord(d);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(d);return this},dataSourceDidError:function(f,d){var c=this.readStatus(f),g=this.recordErrors,b=SC.Record;if(!(c&b.BUSY)){throw b.BAD_STATE_ERROR}else{c=b.ERROR}if(d&&d.isError){if(!g){g=this.recordErrors=[]}g[f]=d}this.writeStatus(f,c);this.dataHashDidChange(f,null,YES);var a=this.materializeRecord(f);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(f);return this},pushRetrieve:function(g,f,c,d){var b=SC.Record,a;if(d===undefined){d=g.storeKeyFor(f)}a=this.readStatus(d);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.READY_CLEAN;if(c===undefined){this.writeStatus(d,a)}else{this.writeDataHash(d,c,a)}if(f&&this.idFor(d)!==f){SC.Store.replaceIdFor(d,f)}this.dataHashDidChange(d);return d}return NO},pushDestroy:function(f,d,c){var b=SC.Record,a;if(c===undefined){c=f.storeKeyFor(d)}a=this.readStatus(c);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.DESTROYED_CLEAN;this.removeDataHash(c,a);this.dataHashDidChange(c);return c}return NO},pushError:function(h,g,c,d){var b=SC.Record,a,f=this.recordErrors;if(d===undefined){d=h.storeKeyFor(g)}a=this.readStatus(d);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.ERROR;if(c&&c.isError){if(!f){f=this.recordErrors=[]}f[d]=c}this.writeStatus(d,a);this.dataHashDidChange(d,null,YES);return d}return NO},loadQueryResults:function(c,a){if(c.get("location")===SC.Query.LOCAL){throw new Error("Cannot load query results for a local query")}var b=this._findQuery(c,YES,NO);if(b){b.set("storeKeys",a)}this.dataSourceDidFetchQuery(c);return this},dataSourceDidFetchQuery:function(a){return this._scstore_dataSourceDidFetchQuery(a,YES)},_scstore_dataSourceDidFetchQuery:function(d,a){var c=this._findQuery(d,a,NO),b=this.get("nestedStores"),f=b?b.get("length"):0;if(c){c.storeDidFetchQuery(d)}while(--f>=0){b[f]._scstore_dataSourceDidFetchQuery(d,NO)}return this},dataSourceDidCancelQuery:function(a){return this._scstore_dataSourceDidCancelQuery(a,YES)},_scstore_dataSourceDidCancelQuery:function(d,a){var c=this._findQuery(d,a,NO),b=this.get("nestedStores"),f=b?b.get("length"):0;if(c){c.storeDidCancelQuery(d)}while(--f>=0){b[f]._scstore_dataSourceDidCancelQuery(d,NO)}return this},dataSourceDidErrorQuery:function(b,a){var c=this.queryErrors;if(a&&a.isError){if(!c){c=this.queryErrors={}}c[SC.guidFor(b)]=a}return this._scstore_dataSourceDidErrorQuery(b,YES)},_scstore_dataSourceDidErrorQuery:function(d,a){var c=this._findQuery(d,a,NO),b=this.get("nestedStores"),f=b?b.get("length"):0;if(c){c.storeDidErrorQuery(d)}while(--f>=0){b[f]._scstore_dataSourceDidErrorQuery(d,NO)}return this},init:function(){arguments.callee.base.apply(this,arguments);this.reset()},toString:function(){var b=this.get("name");if(!b){return arguments.callee.base.apply(this,arguments)}else{var a=arguments.callee.base.apply(this,arguments);return"%@ (%@)".fmt(b,a)}},idFor:function(a){return SC.Store.idFor(a)},recordTypeFor:function(a){return SC.Store.recordTypeFor(a)},storeKeyFor:function(b,a){return b.storeKeyFor(a)},storeKeyExists:function(b,a){return b.storeKeyExists(a)},storeKeysFor:function(g){var a=[],f=g&&g.isEnumerable,c,d,b;if(!this.statuses){return a}for(d in SC.Store.recordTypesByStoreKey){c=SC.Store.recordTypesByStoreKey[d];if(f){b=g.contains(c)}else{b=c===g}if(b&&this.statuses[d]){a.push(parseInt(d,10))}}return a},storeKeys:function(){var a=[],b;if(!this.statuses){return a}for(b in this.statuses){if(this.statuses[b]!=SC.Record.EMPTY){a.push(parseInt(b,10))}}return a},statusString:function(a){var b=this.materializeRecord(a);return b.statusString()}});SC.Store.mixin({CHAIN_CONFLICT_ERROR:new Error("Nested Store Conflict"),NO_PARENT_STORE_ERROR:new Error("Parent Store Required"),NESTED_STORE_UNSUPPORTED_ERROR:new Error("Unsupported In Nested Store"),NESTED_STORE_RETRIEVE_DIRTY_ERROR:new Error("Cannot Retrieve Dirty Record in Nested Store"),EDITABLE:"editable",LOCKED:"locked",INHERITED:"inherited",idsByStoreKey:[],recordTypesByStoreKey:{},queriesByStoreKey:[],nextStoreKey:1,generateStoreKey:function(){return this.nextStoreKey++},idFor:function(a){return this.idsByStoreKey[a]},queryFor:function(a){return this.queriesByStoreKey[a]},recordTypeFor:function(a){return this.recordTypesByStoreKey[a]},replaceIdFor:function(c,a){var d=this.idsByStoreKey[c],f,b;if(d!==a){f=this.recordTypeFor(c);if(!f){throw new Error("replaceIdFor: storeKey %@ does not exist".fmt(c))}this.idsByStoreKey[c]=a;b=f.storeKeysById();delete b[d];b[a]=c}return this},replaceRecordTypeFor:function(a,b){this.recordTypesByStoreKey[a]=b;return this}});SC.Store.prototype.nextStoreIndex=1;SC.Store._getDefaultStore=function(){var a=this._store;if(!a){this._store=a=SC.Store.create()}return a};SC.Store.updateRecords=function(g,h,i,c){SC.Logger.warn("SC.Store.updateRecords() is deprecated.  Use loadRecords() instead");var d=this._getDefaultStore(),b=g.length,a,f;if(!i){i=[];for(a=0;a<b;a++){i[a]=g[a].recordType}}f=d.loadRecords(i,g);b=f.length;for(a=0;a<b;a++){f[a]=d.materializeRecord(f[a])}return f};SC.Store.find=function(a,b){return this._getDefaultStore().find(b,a)};SC.Store.findAll=function(a,b){return this._getDefaultStore().findAll(a,b)};sc_require("system/store");SC.NestedStore=SC.Store.extend({hasChanges:NO,parentStore:null,isNested:YES,lockOnRead:YES,locks:null,chainedChanges:null,find:function(a){if(a&&a.isQuery&&a.get("location")!==SC.Query.LOCAL){throw"SC.Store#find() can only accept LOCAL queries in nested stores"}return arguments.callee.base.apply(this,arguments)},commitChanges:function(b){if(this.get("hasChanges")){var a=this.get("parentStore");a.commitChangesFromNestedStore(this,this.chainedChanges,b)}this.reset();return this},discardChanges:function(){var c,g;if((c=this.records)&&(g=this.locks)){var b=this.get("parentStore"),i=b.revisions;var h=this.revisions,f,d,a;for(f in c){if(!c.hasOwnProperty(f)){continue}if(!(d=g[f])){continue}a=i[f];if((a!==d)||(h[f]>a)){this._notifyRecordPropertyChange(parseInt(f,10))}}}this.reset();this.flush();return this},destroy:function(){this.discardChanges();var a=this.get("parentStore");if(a){a.willDestroyNestedStore(this)}arguments.callee.base.apply(this,arguments);return this},reset:function(){var c,d,a;var b=this.get("parentStore");if(!b){throw SC.Store.NO_PARENT_STORE_ERROR}this.dataHashes=SC.beget(b.dataHashes);this.revisions=SC.beget(b.revisions);this.statuses=SC.beget(b.statuses);this.childRecords=b.childRecords?SC.beget(b.childRecords):{};this.parentRecords=b.parentRecords?SC.beget(b.parentRecords):{};this.chainedChanges=this.locks=this.editables=null;this.changelog=null;this.set("hasChanges",NO)},refreshQuery:function(b){var a=this.get("parentStore");if(a){a.refreshQuery(b)}return this},readError:function(b){var a=this.get("parentStore");return a?a.readError(b):null},readQueryError:function(b){var a=this.get("parentStore");return a?a.readQueryError(b):null},storeKeyEditState:function(b){var c=this.editables,a=this.locks;return(c&&c[b])?SC.Store.EDITABLE:(a&&a[b])?SC.Store.LOCKED:SC.Store.INHERITED},_lock:function(k){var l=this.locks,g,i,d,a,m,h,f,j;if(l&&l[k]){return this}if(!l){l=this.locks=[]}i=this.editables;if(i){i[k]=0}var b=this.get("parentStore"),c;while(b&&(c=b.storeKeyEditState(k))===SC.Store.INHERITED){b=b.get("parentStore")}if(b&&c===SC.Store.EDITABLE){d=this.childRecords[k];if(d){this._lock(d);a=this.parentRecords[d];if(a){m=a[k];h=m?SC.tupleForPropertyPath(m,this.dataHashes[d]):null;if(h){f=h[0];j=h[1]}this.dataHashes[k]=f&&j?f[j]:null}}else{this.dataHashes[k]=SC.clone(b.dataHashes[k],YES)}if(!i){i=this.editables=[]}i[k]=1}else{this.dataHashes[k]=b.dataHashes[k]}this.statuses[k]=this.statuses[k];g=this.revisions[k]=this.revisions[k];l[k]=g||1;return this},readDataHash:function(a){if(this.get("lockOnRead")){this._lock(a)}return this.dataHashes[a]},readEditableDataHash:function(a){this._lock(a);return arguments.callee.base.apply(this,arguments)},writeDataHash:function(d,g,b){var c=this.locks,h=NO,a;if(g){this.dataHashes[d]=g}else{this._lock(d);h=YES}if(b){this.statuses[d]=b}else{if(!h){this.statuses[d]=(this.statuses[d]||SC.Record.READY_NEW)}}if(!h){a=this.revisions[d]=this.revisions[d];if(!c){c=this.locks=[]}if(!c[d]){c[d]=a||1}}var f=this.editables;if(!f){f=this.editables=[]}f[d]=1;return this},removeDataHash:function(c,a){var b=this.locks;if(!b){b=this.locks=[]}if(!b[c]){b[c]=this.revisions[c]||1}return arguments.callee.base.apply(this,arguments)},dataHashDidChange:function(d,b,a,i){if(!b){b=SC.Store.generateStoreKey()}var c,f,h,j;c=SC.typeOf(d)===SC.T_ARRAY;if(c){f=d.length}else{f=1;j=d}var g=this.chainedChanges;if(!g){g=this.chainedChanges=SC.Set.create()}for(h=0;h<f;h++){if(c){j=d[h]}this._lock(j);this.revisions[j]=b;g.add(j);this._notifyRecordPropertyChange(j,a,i)}this.setIfChanged("hasChanges",YES);return this},commitChangesFromNestedStore:function(f,g,a){arguments.callee.base.apply(this,arguments);var b=this.get("parentStore"),j=b.revisions,c;var l=this.locks,h=this.chainedChanges,d,k;if(!l){l=this.locks=[]}if(!h){h=this.chainedChanges=SC.Set.create()}d=g.length;for(c=0;c<d;c++){k=g[c];if(!l[k]){l[k]=j[k]||1}h.add(k)}this.setIfChanged("hasChanges",h.get("length")>0);this.flush();return this},queryFor:function(c,a,b){return this.get("parentStore").queryFor(c,a,b)},findAll:function(f,b,d,c,a){if(!a){a=this}return this.get("parentStore").findAll(f,b,d,c,a)},retrieveRecords:function(g,n,b,c){var a=this.get("parentStore"),l,d,q,p=(!b)?n.length:b.length,j=SC.Record,o;if(c){for(l=0;l<p;l++){d=!b?a.storeKeyFor(g,n[l]):b[l];o=this.peekStatus(d);if(o&j.DIRTY){throw SC.Store.NESTED_STORE_RETRIEVE_DIRTY_ERROR}else{var h=this.dataHashes,k=this.revisions,i=this.statuses,m=this.editables,t=this.locks;var f=NO;var r=NO;if(h&&h.hasOwnProperty(d)){delete h[d];f=YES}if(k&&k.hasOwnProperty(d)){delete k[d];f=YES}if(m){delete m[d]}if(t){delete t[d]}if(i&&i.hasOwnProperty(d)){delete i[d];if(!f){r=YES}f=YES}if(f){this._notifyRecordPropertyChange(d,r)}}}}return a.retrieveRecords(g,n,b,c)},commitRecords:function(a,b,c){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},commitRecord:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},cancelRecords:function(a,b,c){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},cancelRecord:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidCancel:function(a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidComplete:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidDestroy:function(a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidError:function(b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushRetrieve:function(d,c,a,b){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushDestroy:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushError:function(d,c,a,b){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR}});sc_require("models/record");SC.RecordArray=SC.Object.extend(SC.Enumerable,SC.Array,{store:null,query:null,storeKeys:null,status:SC.Record.EMPTY,isEditable:function(){var a=this.get("query");return a?a.get("isEditable"):YES}.property("query").cacheable(),length:function(){this.flush();var a=this.get("storeKeys");return a?a.get("length"):0}.property("storeKeys").cacheable(),_scra_records:null,objectAt:function(a){this.flush();var g=this._scra_records,f=this.get("storeKeys"),b=this.get("store"),d,c;if(!f||!b){return undefined}if(g&&(c=g[a])){return c}if(!g){this._scra_records=g=[]}d=f.objectAt(a);if(d){if(b.peekStatus(d)===SC.Record.EMPTY){b.retrieveRecord(null,null,d)}g[a]=c=b.materializeRecord(d)}return c},forEach:function(i,d){this.flush();var f=this._scra_records,b=this.get("storeKeys"),g=this.get("store"),c=b?b.get("length"):0,h,j,a;if(!b||!g){return this}if(!f){f=this._scra_records=[]}if(!d){d=this}for(h=0;h<c;h++){a=f[h];if(!a){a=f[h]=g.materializeRecord(b.objectAt(h))}i.call(d,a,h,this)}return this},replace:function(b,h,g){this.flush();var f=this.get("storeKeys"),a=g?(g.get?g.get("length"):g.length):0,c,d;if(!f){throw"Unable to edit an SC.RecordArray that does not have its storeKeys property set."}if(!this.get("isEditable")){throw SC.RecordArray.NOT_EDITABLE}d=[];for(c=0;c<a;c++){d[c]=g.objectAt(c).get("storeKey")}f.replace(b,h,d);return this},contains:function(a){return this.indexOf(a)>=0},indexOf:function(b,a){if(!SC.kindOf(b,SC.Record)){SC.Logger.warn("Using indexOf on %@ with an object that is not an SC.Record".fmt(b));return -1}this.flush();var d=b.get("storeKey"),c=this.get("storeKeys");return c?c.indexOf(d,a):-1},lastIndexOf:function(b,a){if(!SC.kindOf(b,SC.Record)){SC.Logger.warn("Using lastIndexOf on %@ with an object that is not an SC.Record".fmt(b));return -1}this.flush();var d=b.get("storeKey"),c=this.get("storeKeys");return c?c.lastIndexOf(d,a):-1},add:function(a){if(!SC.kindOf(a,SC.Record)){return this}if(this.indexOf(a)<0){this.pushObject(a)}return this},remove:function(a){if(!SC.kindOf(a,SC.Record)){return this}this.removeObject(a);return this},find:function(a,b,c){if(b&&b.isQuery){return this.get("store").find(b.queryWithScope(this))}else{return a.apply(this,SC.$A(arguments).slice(1))}}.enhance(),refresh:function(){this.get("store").refreshQuery(this.get("query"));return this},reload:function(){this.flush(YES);return this},destroy:function(){if(!this.get("isDestroyed")){this.get("store").recordArrayWillDestroy(this)}arguments.callee.base.apply(this,arguments)},storeWillFetchQuery:function(c){var b=this.get("status"),a=SC.Record;if((b===a.EMPTY)||(b===a.ERROR)){b=a.BUSY_LOADING}if(b&a.READY){b=a.BUSY_REFRESH}this.setIfChanged("status",b);return this},storeDidFetchQuery:function(a){this.setIfChanged("status",SC.Record.READY_CLEAN);return this},storeDidCancelQuery:function(c){var b=this.get("status"),a=SC.Record;if(b===a.BUSY_LOADING){b=a.EMPTY}else{if(b===a.BUSY_REFRESH){b=a.READY_CLEAN}}this.setIfChanged("status",b);return this},storeDidErrorQuery:function(a){this.setIfChanged("status",SC.Record.ERROR);return this},storeDidChangeStoreKeys:function(b,a){var c=this.get("query");if(c.get("location")!==SC.Query.LOCAL){return this}if(!c.containsRecordTypes(a)){return this}var d=this._scq_changedStoreKeys;if(!d){d=this._scq_changedStoreKeys=SC.IndexSet.create()}d.addEach(b);this.set("needsFlush",YES);if(this.get("storeKeys")){this.flush()}return this},flush:function(a){if(this._insideFlush){this.set("needsFlush",YES);return this}if(!this.get("needsFlush")&&!a){return this}this.set("needsFlush",NO);var k=this.get("query"),n=this.get("store");if(!n||!k||k.get("location")!==SC.Query.LOCAL){return this}this._insideFlush=YES;var i=this.get("storeKeys"),g=this._scq_changedStoreKeys,h=NO,l=SC.Record,q=[],b=new Date(),d,f,c,r,p,j;var m=i;if(i&&!a){if(g){g.forEach(function(t){if(q.length>0||new Date()-b>SC.RecordArray.QUERY_MATCHING_THRESHOLD){q.push(t);return}f=n.peekStatus(t);if(!(f&l.EMPTY)&&!((f&l.DESTROYED)||(f===l.BUSY_DESTROYING))){d=n.materializeRecord(t);j=!!(d&&k.contains(d))}else{j=NO}if(j){if(i.indexOf(t)<0){if(!h){i=i.copy()}i.pushObject(t)}}else{if(i.indexOf(t)>=0){if(!h){i=i.copy()}i.removeObject(t)}}},this);h=YES}}else{if(p=k.get("scope")){r=p.flush().get("storeKeys")}else{if(c=k.get("expandedRecordTypes")){r=SC.IndexSet.create();c.forEach(function(t){r.addEach(n.storeKeysFor(t))})}}i=[];r.forEach(function(t){if(q.length>0||new Date()-b>SC.RecordArray.QUERY_MATCHING_THRESHOLD){q.push(t);return}f=n.peekStatus(t);if(!(f&l.EMPTY)&&!((f&l.DESTROYED)||(f===l.BUSY_DESTROYING))){d=n.materializeRecord(t);if(d&&k.contains(d)){i.push(t)}}});h=YES}if(q.length>0){var o=this;window.setTimeout(function(){SC.run(function(){if(!o||o.get("isDestroyed")){return}o.set("needsFlush",YES);o._scq_changedStoreKeys=SC.IndexSet.create().addEach(q);o.flush()})},1)}if(g){g.clear()}if(h){if(i&&(i===m)){i=i.copy()}i=SC.Query.orderStoreKeys(i,k,n);if(SC.compare(m,i)!==0){this.set("storeKeys",SC.clone(i))}}this._insideFlush=NO;return this},needsFlush:YES,isError:function(){return !!(this.get("status")&SC.Record.ERROR)}.property("status").cacheable(),errorValue:function(){return this.get("isError")?SC.val(this.get("errorObject")):null}.property("isError").cacheable(),errorObject:function(){if(this.get("isError")){var a=this.get("store");return a.readQueryError(this.get("query"))||SC.Record.GENERIC_ERROR}else{return null}}.property("isError").cacheable(),propertyWillChange:function(b){if(b==="storeKeys"){var c=this.get("storeKeys");var a=c?c.get("length"):0;this.arrayContentWillChange(0,a,0)}return arguments.callee.base.apply(this,arguments)},_storeKeysDidChange:function(){var g=this.get("storeKeys");var d=this._prevStoreKeys,b,c,h=this._storeKeysContentDidChange,a=this._storeKeysStateDidChange;if(g===d){return}if(d){d.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:this._storeKeysContentDidChange});b=d.get("length")}else{b=0}this._prevStoreKeys=g;if(g){g.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:this._storeKeysContentDidChange});c=g.get("length")}else{c=0}this._storeKeysContentDidChange(0,b,c)}.observes("storeKeys"),addArrayObservers:function(){this.flush();return SC.Array.addArrayObservers.apply(this,arguments)},_storeKeysContentDidChange:function(c,a,b){if(this._scra_records){this._scra_records.length=0}this.arrayContentDidChange(c,a,b)},init:function(){arguments.callee.base.apply(this,arguments);this._storeKeysDidChange()}});SC.RecordArray.mixin({NOT_EDITABLE:SC.Error.desc("SC.RecordArray is not editable"),QUERY_MATCHING_THRESHOLD:100});Function.prototype.handleEvents=function(){this.isEventHandler=YES;this.events=arguments;return this};Function.prototype.stateObserves=function(){this.isStateObserveHandler=YES;this.args=SC.A(arguments);return this};SC.StatechartDelegate={isStatechartDelegate:YES,statechartUpdateLocationForState:function(b,a,c){SC.routes.set("location",a)},statechartAcquireLocationForState:function(a,b){return SC.routes.get("location")},statechartBindStateToRoute:function(b,d,a,c){SC.routes.add(a,d,c)},statechartShouldStateHandleTriggeredRoute:function(a,c,b){return YES},statechartStateCancelledHandlingTriggeredRoute:function(a,c,b){}};SC.StatePathMatcher=SC.Object.extend({state:null,expression:null,tokens:null,init:function(){arguments.callee.base.apply(this,arguments);this._parseExpression()},_parseExpression:function(){var j=this.expression?this.expression.split("."):[],b=j.length,g=0,c,f=null,d,h=[];for(;g<b;g+=1){c=j[g];if(c.indexOf("~")>=0){c=c.split("~");if(c.length>2){throw"Invalid use of '~' at part %@".fmt(g)}d=SC.StatePathMatcher._ExpandToken.create({start:c[0],end:c[1]})}else{if(c==="this"){if(h.length>0){throw"Invalid use of 'this' at part %@".fmt(g)}d=SC.StatePathMatcher._ThisToken.create()}else{d=SC.StatePathMatcher._BasicToken.create({value:c})}}d.owner=this;h.push(d)}this.set("tokens",h);var a=SC.clone(h);this._chain=f=a.pop();while(d=a.pop()){f.nextToken=d;f=d}},lastPart:function(){var c=this.get("tokens"),a=c?c.length:0,b=a>0?c[a-1]:null;return b.get("lastPart")}.property("tokens").cacheable(),match:function(a){this._stack=a.split(".");if(SC.empty(a)||SC.typeOf(a)!==SC.T_STRING){return NO}return this._chain.match()},_pop:function(){this._lastPopped=this._stack.pop();return this._lastPopped}});SC.StatePathMatcher._Token=SC.Object.extend({type:null,owner:null,nextToken:null,lastPart:null,match:function(){return NO}});SC.StatePathMatcher._BasicToken=SC.StatePathMatcher._Token.extend({type:"basic",value:null,lastPart:function(){return this.value}.property("value").cacheable(),match:function(){var a=this.owner._pop(),b=this.nextToken;if(this.value!==a){return NO}return b?b.match():YES}});SC.StatePathMatcher._ExpandToken=SC.StatePathMatcher._Token.extend({type:"expand",start:null,end:null,lastPart:function(){return this.end}.property("end").cacheable(),match:function(){var d=this.start,a=this.end,b,c=this.nextToken;b=this.owner._pop();if(b!==a){return NO}while(b=this.owner._pop()){if(b===d){return c?c.match():YES}}return NO}});SC.StatePathMatcher._ThisToken=SC.StatePathMatcher._Token.extend({type:"this",lastPart:"this",match:function(){var f=this.owner.state,c=f.get("substates"),a=c.length,d=0,b;b=this.owner._lastPopped;if(!b||this.owner._stack.length!==0){return NO}for(;d<a;d+=1){if(c[d].get("name")===b){return YES}}return NO}});SC.Async=SC.Object.extend({func:null,arg1:null,arg2:null,tryToPerform:function(d){var c=this.get("func"),b=this.get("arg1"),a=this.get("arg2"),f=SC.typeOf(c);if(f===SC.T_STRING){d.tryToPerform(c,b,a)}else{if(f===SC.T_FUNCTION){c.apply(d,[b,a])}}}});SC.Async.mixin({perform:function(c,b,a){return SC.Async.create({func:c,arg1:b,arg2:a})}});SC.State=SC.Object.extend({name:null,parentState:null,historyState:null,initialSubstate:null,substatesAreConcurrent:NO,substates:null,statechart:null,stateIsInitialized:NO,currentSubstates:null,enteredSubstates:null,representRoute:null,trace:function(){var a=this.getPath("statechart.statechartTraceKey");return this.getPath("statechart.%@".fmt(a))}.property().cacheable(),owner:function(){var c=this.get("statechart"),b=c?c.get("statechartOwnerKey"):null,a=c?c.get(b):null;return a?a:c}.property().cacheable(),statechartDelegate:function(){return this.getPath("statechart.statechartDelegate")}.property().cacheable(),location:function(b,c){var d=this.get("statechart"),a=this.get("statechartDelegate");if(c!==undefined){a.statechartUpdateLocationForState(d,c,this)}return a.statechartAcquireLocationForState(d,this)}.property().idempotent(),init:function(){arguments.callee.base.apply(this,arguments);this._registeredEventHandlers={};this._registeredStringEventHandlers={};this._registeredRegExpEventHandlers=[];this._registeredStateObserveHandlers={};this._registeredSubstatePaths={};this._registeredSubstates=[];this._isEnteringState=NO;this._isExitingState=NO;var b=this.get("statechart"),c=b?b.get("statechartOwnerKey"):null,a=b?b.get("statechartTraceKey"):null;if(b){b.addObserver(c,this,"_statechartOwnerDidChange");b.addObserver(a,this,"_statechartTraceDidChange")}},destroy:function(){var c=this.get("statechart"),d=c?c.get("statechartOwnerKey"):null,a=c?c.get("statechartTraceKey"):null;if(c){c.removeObserver(d,this,"_statechartOwnerDidChange");c.removeObserver(a,this,"_statechartTraceDidChange")}var b=this.get("substates");if(b){b.forEach(function(f){f.destroy()})}this._teardownAllStateObserveHandlers();this.set("substates",null);this.set("currentSubstates",null);this.set("enteredSubstates",null);this.set("parentState",null);this.set("historyState",null);this.set("initialSubstate",null);this.set("statechart",null);this.notifyPropertyChange("trace");this.notifyPropertyChange("owner");this._registeredEventHandlers=null;this._registeredStringEventHandlers=null;this._registeredRegExpEventHandlers=null;this._registeredStateObserveHandlers=null;this._registeredSubstatePaths=null;this._registeredSubstates=null;arguments.callee.base.apply(this,arguments)},initState:function(){if(this.get("stateIsInitialized")){return}this._registerWithParentStates();this._setupRouteHandling();var m=null,l=null,b=null,n=[],k=NO,j=this.get("initialSubstate"),g=this.get("substatesAreConcurrent"),d=this.get("statechart"),c=0,h=0,f=NO,a=null;this.set("substates",n);if(SC.kindOf(j,SC.HistoryState)&&j.isClass){a=this.createSubstate(j);this.set("initialSubstate",a);if(SC.none(a.get("defaultState"))){this.stateLogError("Initial substate is invalid. History state requires the name of a default state to be set");this.set("initialSubstate",null);a=null}}for(m in this){l=this[m];f=SC.typeOf(l)===SC.T_FUNCTION;if(f&&l.isEventHandler){this._registerEventHandler(m,l);continue}if(f&&l.isStateObserveHandler){this._registerStateObserveHandler(m,l);continue}if(f&&l.statePlugin){l=l.apply(this)}if(SC.kindOf(l,SC.State)&&l.isClass&&this[m]!==this.constructor){b=this._addSubstate(m,l);if(m===j){this.set("initialSubstate",b);k=YES}else{if(a&&a.get("defaultState")===m){a.set("defaultState",b);k=YES}}}}if(!SC.none(j)&&!k){this.stateLogError("Unable to set initial substate %@ since it did not match any of state's %@ substates".fmt(j,this))}if(n.length===0){if(!SC.none(j)){this.stateLogWarning("Unable to make %@ an initial substate since state %@ has no substates".fmt(j,this))}}else{if(n.length>0){b=this._addEmptyInitialSubstateIfNeeded();if(!b&&j&&g){this.set("initialSubstate",null);this.stateLogWarning("Can not use %@ as initial substate since substates are all concurrent for state %@".fmt(j,this))}}}this.notifyPropertyChange("substates");this.set("currentSubstates",[]);this.set("enteredSubstates",[]);this.set("stateIsInitialized",YES)},_setupRouteHandling:function(){var b=this.get("representRoute"),c=this.get("statechart"),a=this.get("statechartDelegate");if(!b){return}if(this.get("isConcurrentState")){this.stateLogError("State %@ cannot handle route '%@' since state is concurrent".fmt(this,b));return}a.statechartBindStateToRoute(c,this,b,this.routeTriggered)},routeTriggered:function(g){if(this._isEnteringState){return}var f=this.get("statechart"),b=this.get("statechartDelegate"),d=this.get("location");var a={state:this,location:d,params:g,handler:this.routeTriggered};var c=this.createStateRouteHandlerContext(a);if(b.statechartShouldStateHandleTriggeredRoute(f,this,c)){if(this.get("trace")&&d){this.stateLogTrace("will handle route '%@'".fmt(d))}this.handleTriggeredRoute(c)}else{b.statechartStateCancelledHandlingTriggeredRoute(f,this,c)}},createStateRouteHandlerContext:function(a){return SC.StateRouteHandlerContext.create(a)},handleTriggeredRoute:function(a){this.gotoState(this,a)},_addEmptyInitialSubstateIfNeeded:function(){var c=this.get("initialSubstate"),b=this.get("substatesAreConcurrent");if(c||b){return null}var a=this.createSubstate(SC.EmptyState);this.set("initialSubstate",a);this.get("substates").push(a);this[a.get("name")]=a;a.initState();this.stateLogWarning("state %@ has no initial substate defined. Will default to using an empty state as initial substate".fmt(this));return a},_addSubstate:function(c,d,a){var b=this.get("substates");a=SC.clone(a)||{};a.name=c;d=this.createSubstate(d,a);b.push(d);this[c]=d;d.initState();return d},addSubstate:function(c,f,b){if(SC.empty(c)){this.stateLogError("Can not add substate. name required");return null}if(this[c]!==undefined){this.stateLogError("Can not add substate '%@'. Already a defined property".fmt(c));return null}if(!this.get("stateIsInitialized")){this.stateLogError("Can not add substate '%@'. this state is not yet initialized".fmt(c));return null}var a=arguments.length;if(a===1){f=SC.State}else{if(a===2&&SC.typeOf(f)===SC.T_HASH){b=f;f=SC.State}}var d=SC.kindOf(f,SC.State)&&f.isClass;if(!d){this.stateLogError("Can not add substate '%@'. must provide a state class".fmt(c));return null}f=this._addSubstate(c,f,b);this._addEmptyInitialSubstateIfNeeded();this.notifyPropertyChange("substates");return f},createSubstate:function(b,a){a=a||{};return b.create({parentState:this,statechart:this.get("statechart")},a)},_registerEventHandler:function(b,f){var d=f.events,g=null,a=d.length,c=0;this._registeredEventHandlers[b]=f;for(;c<a;c+=1){g=d[c];if(SC.typeOf(g)===SC.T_STRING){this._registeredStringEventHandlers[g]={name:b,handler:f};continue}if(g instanceof RegExp){this._registeredRegExpEventHandlers.push({name:b,handler:f,regexp:g});continue}this.stateLogError("Invalid event %@ for event handler %@ in state %@".fmt(g,b,this))}},_registerStateObserveHandler:function(d,g){var f=0,c=g.args,b=c.length,a,h=YES;for(;f<b;f+=1){a=c[f];if(SC.typeOf(a)!==SC.T_STRING||SC.empty(a)){this.stateLogError("Invalid argument %@ for state observe handler %@ in state %@".fmt(a,d,this));h=NO}}if(!h){return}this._registeredStateObserveHandlers[d]=g.args},_registerWithParentStates:function(){var a=this.get("parentState");while(!SC.none(a)){a._registerSubstate(this);a=a.get("parentState")}},_registerSubstate:function(b){var c=b.pathRelativeTo(this);if(SC.none(c)){return}this._registeredSubstates.push(b);var a=this._registeredSubstatePaths;if(a[b.get("name")]===undefined){a[b.get("name")]={}}var d=a[b.get("name")];d[c]=b},pathRelativeTo:function(b){var c=this.get("name"),a=this.get("parentState");while(!SC.none(a)&&a!==b){c="%@.%@".fmt(a.get("name"),c);a=a.get("parentState")}if(a!==b&&b!==this){this.stateLogError("Can not generate relative path from %@ since it not a parent state of %@".fmt(b,this));return null}return c},getSubstate:function(g,i,f){if(!g){return null}var b=SC.typeOf(g);if(b===SC.T_OBJECT){return this._registeredSubstates.indexOf(g)>-1?g:null}if(b!==SC.T_STRING){this.stateLogError("Can not find matching subtype. value must be an object or string: %@".fmt(g));return null}var d=SC.StatePathMatcher.create({state:this,expression:g}),c=[],h;if(d.get("tokens").length===0){return null}var k=this._registeredSubstatePaths[d.get("lastPart")];if(!k){return this._notifySubstateNotFound(i,f,g)}for(h in k){if(d.match(h)){c.push(k[h])}}if(c.length===1){return c[0]}if(c.length>1){var j=[];for(h in k){j.push(h)}if(i){return this._notifySubstateNotFound(i,f,g,j)}var a="Can not find substate matching '%@' in state %@. Ambiguous with the following: %@";this.stateLogError(a.fmt(g,this.get("fullPath"),j.join(", ")))}return this._notifySubstateNotFound(i,f,g)},_notifySubstateNotFound:function(d,c,b,a){return d?d.call(c||this,this,b,a):null},getState:function(a){if(a===this.get("name")){return this}if(SC.kindOf(a,SC.State)){return a}return this.getSubstate(a,this._handleSubstateNotFound)},_handleSubstateNotFound:function(d,c,a){var b=this.get("parentState");if(b){return b.getState(c)}if(a){var f="Can not find state matching '%@'. Ambiguous with the following: %@";this.stateLogError(f.fmt(c,a.join(", ")))}return null},gotoState:function(c,a){var b=this.getState(c);if(!b){var d="can not go to state %@ from state %@. Invalid value.";this.stateLogError(d.fmt(c,this));return}var f=this.findFirstRelativeCurrentState(b);this.get("statechart").gotoState(b,f,false,a)},gotoHistoryState:function(d,a,b){var c=this.getState(d);if(!c){var f="can not go to history state %@ from state %@. Invalid value.";this.stateLogError(f.fmt(d,this));return}var g=this.findFirstRelativeCurrentState(c);this.get("statechart").gotoHistoryState(c,g,a,b)},resumeGotoState:function(){this.get("statechart").resumeGotoState()},stateIsCurrentSubstate:function(a){if(SC.typeOf(a)===SC.T_STRING){a=this.get("statechart").getState(a)}var b=this.get("currentSubstates");return !!b&&b.indexOf(a)>=0},stateIsEnteredSubstate:function(b){if(SC.typeOf(b)===SC.T_STRING){b=this.get("statechart").getState(b)}var a=this.get("enteredSubstates");return !!a&&a.indexOf(b)>=0},isRootState:function(){return this.getPath("statechart.rootState")===this}.property(),isCurrentState:function(){return this.stateIsCurrentSubstate(this)}.property("currentSubstates").cacheable(),isConcurrentState:function(){return this.getPath("parentState.substatesAreConcurrent")}.property(),isEnteredState:function(){return this.stateIsEnteredSubstate(this)}.property("enteredSubstates").cacheable(),hasSubstates:function(){return this.getPath("substates.length")>0}.property("substates"),hasCurrentSubstates:function(){var a=this.get("currentSubstates");return !!a&&a.get("length")>0}.property("currentSubstates").cacheable(),hasEnteredSubstates:function(){var a=this.get("enteredSubstates");return !!a&&a.get("length")>0}.property("enteredSubstates").cacheable(),findFirstRelativeCurrentState:function(b){if(this.get("isCurrentState")){return this}var a=this.get("currentSubstates")||[],d=a.get("length"),c=this.get("parentState");if(d===0){return c?c.findFirstRelativeCurrentState():null}if(d>1){b=this.getSubstate(b);if(b){return b.findFirstRelativeCurrentState()}}return a[0]},reenter:function(){if(this.get("isEnteredState")){this.gotoState(this)}else{SC.Logger.error("Can not re-enter state %@ since it is not an entered state in the statechart".fmt(this))}},tryToHandleEvent:function(a,f,d){var c=this.get("trace"),j=this.get("statechart"),h;if(this._registeredEventHandlers[a]){this.stateLogWarning("state %@ can not handle event '%@' since it is a registered event handler".fmt(this,a));return NO}if(this._registeredStateObserveHandlers[a]){this.stateLogWarning("state %@ can not handle event '%@' since it is a registered state observe handler".fmt(this,a));return NO}if(SC.typeOf(this[a])===SC.T_FUNCTION){if(c){this.stateLogTrace("will handle event '%@'".fmt(a))}j.stateWillTryToHandleEvent(this,a,a);h=(this[a](f,d)!==NO);j.stateDidTryToHandleEvent(this,a,a,h);return h}var k=this._registeredStringEventHandlers[a];if(k){if(c){this.stateLogTrace("%@ will handle event '%@'".fmt(k.name,a))}j.stateWillTryToHandleEvent(this,a,k.name);h=(k.handler.call(this,a,f,d)!==NO);j.stateDidTryToHandleEvent(this,a,k.name,h);return h}var g=this._registeredRegExpEventHandlers.length,b=0;for(;b<g;b+=1){k=this._registeredRegExpEventHandlers[b];if(a.match(k.regexp)){if(c){this.stateLogTrace("%@ will handle event '%@'".fmt(k.name,a))}j.stateWillTryToHandleEvent(this,a,k.name);h=(k.handler.call(this,a,f,d)!==NO);j.stateDidTryToHandleEvent(this,a,k.name,h);return h}}if(SC.typeOf(this["unknownEvent"])===SC.T_FUNCTION){if(c){this.stateLogTrace("unknownEvent will handle event '%@'".fmt(a))}j.stateWillTryToHandleEvent(this,a,"unknownEvent");h=(this.unknownEvent(a,f,d)!==NO);j.stateDidTryToHandleEvent(this,a,"unknownEvent",h);return h}return NO},enterState:function(a){},stateWillBecomeEntered:function(a){this._isEnteringState=YES},stateDidBecomeEntered:function(a){this._setupAllStateObserveHandlers();this._isEnteringState=NO},exitState:function(a){},stateWillBecomeExited:function(a){this._isExitingState=YES;this._teardownAllStateObserveHandlers()},stateDidBecomeExited:function(a){this._isExitingState=NO},_setupAllStateObserveHandlers:function(){this._configureAllStateObserveHandlers("addObserver")},_teardownAllStateObserveHandlers:function(){this._configureAllStateObserveHandlers("removeObserver")},_configureAllStateObserveHandlers:function(b){var h,j,g,a,k,d,c,f;for(h in this._registeredStateObserveHandlers){j=this._registeredStateObserveHandlers[h];for(c=0;c<j.length;c+=1){k=j[c];d=h;a=k.indexOf(".");if(a<0){this[b](k,this,d)}else{if(k.indexOf("*")===0){this[b](k.slice(1),this,d)}else{f=null;if(a===0){f=this;k=k.slice(1)}else{if(a===4&&k.slice(0,5)==="this."){f=this;k=k.slice(5)}else{if(a<0&&k.length===4&&k==="this"){f=this;k=""}}}SC.Observers[b](k,this,d,f)}}}}},performAsync:function(c,b,a){return SC.Async.perform(c,b,a)},respondsToEvent:function(d){if(this._registeredEventHandlers[d]){return false}if(SC.typeOf(this[d])===SC.T_FUNCTION){return true}if(this._registeredStringEventHandlers[d]){return true}if(this._registeredStateObserveHandlers[d]){return false}var a=this._registeredRegExpEventHandlers.length,b=0,c;for(;b<a;b+=1){c=this._registeredRegExpEventHandlers[b];if(d.match(c.regexp)){return true}}return SC.typeOf(this["unknownEvent"])===SC.T_FUNCTION},fullPath:function(){var a=this.getPath("statechart.rootState");if(!a){return this.get("name")}return this.pathRelativeTo(a)}.property("name","parentState").cacheable(),toString:function(){return this.get("fullPath")},_enteredSubstatesDidChange:function(){this.notifyPropertyChange("enteredSubstates")}.observes("*enteredSubstates.[]"),_currentSubstatesDidChange:function(){this.notifyPropertyChange("currentSubstates")}.observes("*currentSubstates.[]"),_statechartTraceDidChange:function(){this.notifyPropertyChange("trace")},_statechartOwnerDidChange:function(){this.notifyPropertyChange("owner")},stateLogTrace:function(b){var a=this.get("statechart");a.statechartLogTrace("%@: %@".fmt(this,b))},stateLogWarning:function(b){var a=this.get("statechart");a.statechartLogWarning(b)},stateLogError:function(b){var a=this.get("statechart");a.statechartLogError(b)}});SC.State.plugin=function(c){var a=SC.A(arguments);a.shift();var b=function(){var d=SC.objectForPropertyPath(c);if(!d){console.error("SC.State.plugin: Unable to determine path %@".fmt(c));return undefined}if(!d.isClass||!d.kindOf(SC.State)){console.error("SC.State.plugin: Unable to extend. %@ must be a class extending from SC.State".fmt(c));return undefined}return d.extend.apply(d,a)};b.statePlugin=YES;return b};SC.State.design=SC.State.extend;sc_require("system/state");SC.EMPTY_STATE_NAME="__EMPTY_STATE__";SC.EmptyState=SC.State.extend({name:SC.EMPTY_STATE_NAME,enterState:function(){var a="No initial substate was defined for state %@. Entering default empty state";this.stateLogWarning(a.fmt(this.get("parentState")))}});sc_require("system/state");SC.HistoryState=SC.Object.extend({isRecursive:NO,defaultState:null,statechart:null,parentState:null,state:function(){var b=this.get("defaultState"),a=this.getPath("parentState.historyState");return !!a?a:b}.property().cacheable(),parentHistoryStateDidChange:function(){this.notifyPropertyChange("state")}.observes("*parentState.historyState")});SC.StateRouteHandlerContext=SC.Object.extend({state:null,location:null,params:null,handler:null,retry:function(){var b=this.get("state"),c=this.get("params"),a=this.get("handler");if(SC.typeOf(a)===SC.T_STRING){a=b[a]}if(SC.typeOf(a)===SC.T_FUNCTION){a.apply(b,[c])}}});sc_require("system/state");sc_require("mixins/statechart_delegate");SC.StatechartManager={isResponderContext:YES,isStatechart:YES,statechartIsInitialized:NO,name:null,rootState:null,rootStateExample:SC.State,initialState:null,statesAreConcurrent:NO,monitorIsActive:NO,monitor:null,statechartTraceKey:"trace",trace:NO,statechartOwnerKey:"owner",owner:null,autoInitStatechart:YES,suppressStatechartWarnings:NO,delegate:null,statechartDelegate:function(){var a=this.get("delegate");return this.delegateFor("isStatechartDelegate",a)}.property("delegate"),initMixin:function(){if(this.get("autoInitStatechart")){this.initStatechart()}},destroyMixin:function(){var b=this.get("rootState"),a=this.get("statechartTraceKey");this.removeObserver(a,this,"_statechartTraceDidChange");b.destroy();this.set("rootState",null)},initStatechart:function(){if(this.get("statechartIsInitialized")){return}this._gotoStateLocked=NO;this._sendEventLocked=NO;this._pendingStateTransitions=[];this._pendingSentEvents=[];this.sendAction=this.sendEvent;if(this.get("monitorIsActive")){this.set("monitor",SC.StatechartMonitor.create({statechart:this}))}var a=this.get("statechartTraceKey");this.addObserver(a,this,"_statechartTraceDidChange");this._statechartTraceDidChange();var d=this.get("allowStatechartTracing"),c=this.get("rootState"),f;if(d){this.statechartLogTrace("BEGIN initialize statechart")}if(!c){c=this._constructRootStateClass()}else{if(SC.typeOf(c)===SC.T_FUNCTION&&c.statePlugin){c=c.apply(this)}}if(!(SC.kindOf(c,SC.State)&&c.isClass)){f="Unable to initialize statechart. Root state must be a state class";this.statechartLogError(f);throw f}c=this.createRootState(c,{statechart:this,name:SC.ROOT_STATE_NAME});this.set("rootState",c);c.initState();if(SC.kindOf(c.get("initialSubstate"),SC.EmptyState)){f="Unable to initialize statechart. Root state must have an initial substate explicilty defined";this.statechartLogError(f);throw f}if(!SC.empty(this.get("initialState"))){var b="initialState";this.set(b,c.get(this.get(b)))}this.set("statechartIsInitialized",YES);this.gotoState(c);if(d){this.statechartLogTrace("END initialize statechart")}},createRootState:function(b,a){if(!a){a={}}b=b.create(a);return b},currentStates:function(){return this.getPath("rootState.currentSubstates")}.property().cacheable(),firstCurrentState:function(){var a=this.get("currentStates");return a?a.objectAt(0):null}.property("currentStates").cacheable(),currentStateCount:function(){return this.getPath("currentStates.length")}.property("currentStates").cacheable(),stateIsCurrentState:function(a){return this.get("rootState").stateIsCurrentSubstate(a)},enteredStates:function(){return this.getPath("rootState.enteredSubstates")}.property().cacheable(),stateIsEntered:function(a){return this.get("rootState").stateIsEnteredSubstate(a)},doesContainState:function(a){return !SC.none(this.getState(a))},getState:function(b){var a=this.get("rootState");return a===b?a:a.getSubstate(b)},gotoState:function(b,l,m,c){if(!this.get("statechartIsInitialized")){this.statechartLogError("can not go to state %@. statechart has not yet been initialized".fmt(b));return}if(this.get("isDestroyed")){this.statechartLogError("can not go to state %@. statechart is destroyed".fmt(this));return}var j=this._processGotoStateArgs(arguments);b=j.state;l=j.fromCurrentState;m=j.useHistory;c=j.context;var o=null,k=[],n=[],g=this.get("allowStatechartTracing"),a=this.get("rootState"),i=b,f=l,d;b=this.getState(b);if(SC.none(b)){this.statechartLogError("Can not to goto state %@. Not a recognized state in statechart".fmt(i));return}if(this._gotoStateLocked){this._pendingStateTransitions.push({state:b,fromCurrentState:l,useHistory:m,context:c});return}this._gotoStateLocked=YES;if(l){l=this.getState(l);if(SC.none(l)||!l.get("isCurrentState")){d="Can not to goto state %@. %@ is not a recognized current state in statechart";this.statechartLogError(d.fmt(i,f));this._gotoStateLocked=NO;return}}else{l=b.findFirstRelativeCurrentState();if(!l){l=this.get("firstCurrentState")}}if(g){this.statechartLogTrace("BEGIN gotoState: %@".fmt(b));d="starting from current state: %@";d=d.fmt(l?l:"---");this.statechartLogTrace(d);d="current states before: %@";d=d.fmt(this.getPath("currentStates.length")>0?this.get("currentStates"):"---");this.statechartLogTrace(d)}if(!SC.none(l)){k=this._createStateChain(l)}n=this._createStateChain(b);o=this._findPivotState(k,n);if(o){if(g){this.statechartLogTrace("pivot state = %@".fmt(o))}if(o.get("substatesAreConcurrent")&&o!==b){this.statechartLogError("Can not go to state %@ from %@. Pivot state %@ has concurrent substates.".fmt(b,l,o));this._gotoStateLocked=NO;return}}var h=[];this._traverseStatesToExit(k.shift(),k,o,h);if(o!==b){this._traverseStatesToEnter(n.pop(),n,o,m,h)}else{this._traverseStatesToExit(o,[],null,h);this._traverseStatesToEnter(o,null,null,m,h)}this._gotoStateActions=h;this._executeGotoStateActions(b,h,null,c)},gotoStateActive:function(){return this._gotoStateLocked}.property(),gotoStateSuspended:function(){return this._gotoStateLocked&&!!this._gotoStateSuspendedPoint}.property(),resumeGotoState:function(){if(!this.get("gotoStateSuspended")){this.statechartLogError("Can not resume goto state since it has not been suspended");return}var a=this._gotoStateSuspendedPoint;this._executeGotoStateActions(a.gotoState,a.actions,a.marker,a.context)},_executeGotoStateActions:function(h,g,b,c){var f=null,a=g.length,d=null;b=SC.none(b)?0:b;for(;b<a;b+=1){this._currentGotoStateAction=f=g[b];switch(f.action){case SC.EXIT_STATE:d=this._exitState(f.state,c);break;case SC.ENTER_STATE:d=this._enterState(f.state,f.currentState,c);break}if(SC.kindOf(d,SC.Async)){this._gotoStateSuspendedPoint={gotoState:h,actions:g,marker:b+1,context:c};d.tryToPerform(f.state);return}}this.beginPropertyChanges();this.notifyPropertyChange("currentStates");this.notifyPropertyChange("enteredStates");this.endPropertyChanges();if(this.get("allowStatechartTracing")){this.statechartLogTrace("current states after: %@".fmt(this.get("currentStates")));this.statechartLogTrace("END gotoState: %@".fmt(h))}this._cleanupStateTransition()},_cleanupStateTransition:function(){this._currentGotoStateAction=null;this._gotoStateSuspendedPoint=null;this._gotoStateActions=null;this._gotoStateLocked=NO;this._flushPendingStateTransition()},_exitState:function(d,b){var c;if(d.get("currentSubstates").indexOf(d)>=0){c=d.get("parentState");while(c){c.get("currentSubstates").removeObject(d);c=c.get("parentState")}}c=d;while(c){c.get("enteredSubstates").removeObject(d);c=c.get("parentState")}if(this.get("allowStatechartTracing")){this.statechartLogTrace("<-- exiting state: %@".fmt(d))}d.set("currentSubstates",[]);d.stateWillBecomeExited(b);var a=this.exitState(d,b);d.stateDidBecomeExited(b);if(this.get("monitorIsActive")){this.get("monitor").pushExitedState(d)}d._traverseStatesToExit_skipState=NO;return a},exitState:function(b,a){return b.exitState(a)},_enterState:function(d,f,b){var c=d.get("parentState");if(c&&!d.get("isConcurrentState")){c.set("historyState",d)}if(f){c=d;while(c){c.get("currentSubstates").pushObject(d);c=c.get("parentState")}}c=d;while(c){c.get("enteredSubstates").pushObject(d);c=c.get("parentState")}if(this.get("allowStatechartTracing")){this.statechartLogTrace("--> entering state: %@".fmt(d))}d.stateWillBecomeEntered(b);var a=this.enterState(d,b);d.stateDidBecomeEntered(b);if(this.get("monitorIsActive")){this.get("monitor").pushEnteredState(d)}return a},enterState:function(b,a){if(b.enterStateByRoute&&SC.kindOf(a,SC.StateRouteHandlerContext)){return b.enterStateByRoute(a)}else{return b.enterState(a)}},gotoHistoryState:function(g,f,c,d){if(!this.get("statechartIsInitialized")){this.statechartLogError("can not go to state %@'s history state. Statechart has not yet been initialized".fmt(g));return}var b=this._processGotoStateArgs(arguments);g=b.state;f=b.fromCurrentState;c=b.useHistory;d=b.context;g=this.getState(g);if(!g){this.statechartLogError("Can not to goto state %@'s history state. Not a recognized state in statechart".fmt(g));return}var a=g.get("historyState");if(!c){if(a){this.gotoState(a,f,d)}else{this.gotoState(g,f,d)}}else{this.gotoState(g,f,YES,d)}},sendEvent:function(b,h,g){if(this.get("isDestroyed")){this.statechartLogError("can send event %@. statechart is destroyed".fmt(b));return}var c=NO,m=NO,j=this.get("currentStates").slice(),l={},k=0,f=0,a=null,d=this.get("allowStatechartTracing");if(this._sendEventLocked||this._goStateLocked){this._pendingSentEvents.push({event:b,arg1:h,arg2:g});return}this._sendEventLocked=YES;if(d){this.statechartLogTrace("BEGIN sendEvent: '%@'".fmt(b))}k=j.get("length");for(;f<k;f+=1){m=NO;a=j[f];if(!a.get("isCurrentState")){continue}while(!m&&a){if(!l[a.get("fullPath")]){m=a.tryToHandleEvent(b,h,g);l[a.get("fullPath")]=YES}if(!m){a=a.get("parentState")}else{c=YES}}}this._sendEventLocked=NO;if(d){if(!c){this.statechartLogTrace("No state was able handle event %@".fmt(b))}this.statechartLogTrace("END sendEvent: '%@'".fmt(b))}var n=this._flushPendingSentEvents();return c?this:(n?this:null)},stateWillTryToHandleEvent:function(c,b,a){this._stateHandleEventInfo={state:c,event:b,handler:a}},stateDidTryToHandleEvent:function(c,b,a,d){this._stateHandleEventInfo=null},_createStateChain:function(b){var a=[];while(b){a.push(b);b=b.get("parentState")}return a},_findPivotState:function(c,b){if(c.length===0||b.length===0){return null}var a=c.find(function(f,d){if(b.indexOf(f)>=0){return YES}});return a},_traverseStatesToExit:function(b,l,d,j){if(!b||b===d){return}var f=this.get("allowStatechartTracing");if(b.get("substatesAreConcurrent")){var g=0,h=b.get("currentSubstates"),k=h.length,c=null;for(;g<k;g+=1){c=h[g];if(c._traverseStatesToExit_skipState===YES){continue}var a=this._createStateChain(c);this._traverseStatesToExit(a.shift(),a,b,j)}}j.push({action:SC.EXIT_STATE,state:b});if(b.get("isCurrentState")){b._traverseStatesToExit_skipState=YES}this._traverseStatesToExit(l.shift(),l,d,j)},_traverseStatesToEnter:function(b,f,j,h,d){if(!b){return}var c=this.get("allowStatechartTracing");if(j){if(b!==j){this._traverseStatesToEnter(f.pop(),f,j,h,d)}else{this._traverseStatesToEnter(f.pop(),f,null,h,d)}}else{if(!f||f.length===0){var i={action:SC.ENTER_STATE,state:b,currentState:NO};d.push(i);var g=b.get("initialSubstate"),a=b.get("historyState");if(b.get("substatesAreConcurrent")){this._traverseConcurrentStatesToEnter(b.get("substates"),null,h,d)}else{if(b.get("hasSubstates")&&a&&h){this._traverseStatesToEnter(a,null,null,h,d)}else{if(g){if(SC.kindOf(g,SC.HistoryState)){if(!h){h=g.get("isRecursive")}g=g.get("state")}this._traverseStatesToEnter(g,null,null,h,d)}else{i.currentState=YES}}}}else{if(f.length>0){d.push({action:SC.ENTER_STATE,state:b});var k=f.pop();this._traverseStatesToEnter(k,f,null,h,d);if(b.get("substatesAreConcurrent")){this._traverseConcurrentStatesToEnter(b.get("substates"),k,h,d)}}}}},respondsTo:function(d){var b=this.get("currentStates"),a=b.get("length"),c=0,f=null;for(;c<a;c+=1){f=b.objectAt(c);while(f){if(f.respondsToEvent(d)){return true}f=f.get("parentState")}}return SC.typeOf(this[d])===SC.T_FUNCTION},tryToPerform:function(d,c,b){if(!this.respondsTo(d)){return NO}if(SC.typeOf(this[d])===SC.T_FUNCTION){var a=this[d](c,b);if(a!==NO){return YES}}return !!this.sendEvent(d,c,b)},invokeStateMethod:function(l,k,c){if(l==="unknownEvent"){this.statechartLogError("can not invoke method unkownEvent");return}k=SC.A(arguments);k.shift();var g=k.length,n=g>0?k[g-1]:null,m=SC.typeOf(n)===SC.T_FUNCTION?k.pop():null,f=this.get("currentStates"),d=0,b=null,j={},a,o=undefined,h=0;g=f.get("length");for(;d<g;d+=1){b=f.objectAt(d);while(b){if(j[b.get("fullPath")]){break}j[b.get("fullPath")]=YES;a=b[l];if(SC.typeOf(a)===SC.T_FUNCTION&&!a.isEventHandler){o=a.apply(b,k);if(m){m.call(this,b,o)}h+=1;break}b=b.get("parentState")}}return h===1?o:undefined},_traverseConcurrentStatesToEnter:function(d,c,g,b){var f=0,a=d.length,h=null;for(;f<a;f+=1){h=d[f];if(h!==c){this._traverseStatesToEnter(h,null,null,g,b)}}},_flushPendingStateTransition:function(){if(!this._pendingStateTransitions){this.statechartLogError("Unable to flush pending state transition. _pendingStateTransitions is invalid");return}var a=this._pendingStateTransitions.shift();if(!a){return}this.gotoState(a.state,a.fromCurrentState,a.useHistory,a.context)},_flushPendingSentEvents:function(){var a=this._pendingSentEvents.shift();if(!a){return null}return this.sendEvent(a.event,a.arg1,a.arg2)},_monitorIsActiveDidChange:function(){if(this.get("monitorIsActive")&&SC.none(this.get("monitor"))){this.set("monitor",SC.StatechartMonitor.create())}}.observes("monitorIsActive"),_processGotoStateArgs:function(b){var d={state:null,fromCurrentState:null,useHistory:false,context:null},a=null,c=null;b=SC.$A(b);b=b.filter(function(f){return !(f===undefined)});a=b.length;if(a<1){return d}d.state=b[0];if(a===2){c=b[1];switch(SC.typeOf(c)){case SC.T_BOOL:d.useHistory=c;break;case SC.T_HASH:case SC.T_OBJECT:if(!SC.kindOf(c,SC.State)){d.context=c}break;default:d.fromCurrentState=c}}else{if(a===3){c=b[1];if(SC.typeOf(c)===SC.T_BOOL){d.useHistory=c;d.context=b[2]}else{d.fromCurrentState=c;c=b[2];if(SC.typeOf(c)===SC.T_BOOL){d.useHistory=c}else{d.context=c}}}else{d.fromCurrentState=b[1];d.useHistory=b[2];d.context=b[3]}}return d},_constructRootStateClass:function(){var d="rootStateExample",f=this.get(d),b=this.get("initialState"),c=this.get("statesAreConcurrent"),a=0,j,h,g,i={};if(SC.typeOf(f)===SC.T_FUNCTION&&f.statePlugin){f=f.apply(this)}if(!(SC.kindOf(f,SC.State)&&f.isClass)){this._logStatechartCreationError("Invalid root state example");return null}if(c&&!SC.empty(b)){this._logStatechartCreationError("Can not assign an initial state when states are concurrent")}else{if(c){i.substatesAreConcurrent=YES}else{if(SC.typeOf(b)===SC.T_STRING){i.initialSubstate=b}else{this._logStatechartCreationError("Must either define initial state or assign states as concurrent");return null}}}for(j in this){if(j===d){continue}h=this[j];g=SC.typeOf(h)===SC.T_FUNCTION;if(g&&h.statePlugin){h=h.apply(this)}if(SC.kindOf(h,SC.State)&&h.isClass&&this[j]!==this.constructor){i[j]=h;a+=1}}if(a===0){this._logStatechartCreationError("Must define one or more states");return null}return f.extend(i)},_logStatechartCreationError:function(a){SC.Logger.error("Unable to create statechart for %@: %@.".fmt(this,a))},statechartLogTrace:function(a){SC.Logger.info("%@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogError:function(a){SC.Logger.error("ERROR %@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogWarning:function(a){if(this.get("suppressStatechartWarnings")){return}SC.Logger.warn("WARN %@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogPrefix:function(){var b=SC._object_className(this.constructor),a=this.get("name"),c;if(SC.empty(a)){c="%@<%@>".fmt(b,SC.guidFor(this))}else{c="%@<%@, %@>".fmt(b,a,SC.guidFor(this))}return c}.property().cacheable(),allowStatechartTracing:function(){var a=this.get("statechartTraceKey");return this.get(a)}.property().cacheable(),_statechartTraceDidChange:function(){this.notifyPropertyChange("allowStatechartTracing")},details:function(){var b={initialized:this.get("statechartIsInitialized")};if(this.get("name")){b.name=this.get("name")}if(!this.get("statechartIsInitialized")){return b}b["current-states"]=[];this.get("currentStates").forEach(function(g){b["current-states"].push(g.get("fullPath"))});var a={active:this.get("gotoStateActive"),suspended:this.get("gotoStateSuspended")};if(this._gotoStateActions){a["transition-sequence"]=[];var f=this._gotoStateActions,c=function(h){var g=h.action===SC.ENTER_STATE?"enter":"exit";return"%@ %@".fmt(g,h.state.get("fullPath"))};f.forEach(function(g){a["transition-sequence"].push(c(g))});a["current-transition"]=c(this._currentGotoStateAction)}b["state-transition"]=a;if(this._stateHandleEventInfo){var d=this._stateHandleEventInfo;b["handling-event"]={state:d.state.get("fullPath"),event:d.event,handler:d.handler}}else{b["handling-event"]=false}return b}.property(),toStringWithDetails:function(){var b="",c=this.toString(),a=this.get("details");b+=c+"\n";b+=this._hashToString(a,2);return b},_hashToString:function(d,a){var f="";for(var b in d){var c=d[b];if(c instanceof Array){f+=this._arrayToString(b,c,a)+"\n"}else{if(c instanceof Object){f+="%@%@:\n".fmt(" ".mult(a),b);f+=this._hashToString(c,a+2)}else{f+="%@%@: %@\n".fmt(" ".mult(a),b,c)}}}return f},_arrayToString:function(b,d,a){if(d.length===0){return"%@%@: []".fmt(" ".mult(a),b)}var c="%@%@: [\n".fmt(" ".mult(a),b);d.forEach(function(g,f){c+="%@%@\n".fmt(" ".mult(a+2),g)},this);c+=" ".mult(a)+"]";return c}};SC.mixin(SC.StatechartManager,SC.StatechartDelegate,SC.DelegateSupport);SC.ROOT_STATE_NAME="__ROOT_STATE__";SC.EXIT_STATE=0;SC.ENTER_STATE=1;SC.Statechart=SC.Object.extend(SC.StatechartManager,{autoInitStatechart:NO});SC.Statechart.design=SC.Statechart.extend;var Handlebars={};Handlebars.VERSION="1.0.beta.2";Handlebars.helpers={};Handlebars.partials={};Handlebars.registerHelper=function(b,c,a){if(a){c.not=a}this.helpers[b]=c};Handlebars.registerPartial=function(a,b){this.partials[a]=b};Handlebars.registerHelper("helperMissing",function(a){if(arguments.length===2){return undefined}else{throw new Error("Could not find property '"+a+"'")}});Handlebars.registerHelper("blockHelperMissing",function(g,d){var a=d.inverse||function(){},k=d.fn;var c="";var h=Object.prototype.toString.call(g);if(h==="[object Function]"){g=g()}if(g===true){return k(this)}else{if(g===false||g==null){return a(this)}else{if(h==="[object Array]"){if(g.length>0){for(var f=0,b=g.length;f<b;f++){c=c+k(g[f])}}else{c=a(this)}return c}else{return k(g)}}}});Handlebars.registerHelper("each",function(g,d){var h=d.fn,a=d.inverse;var c="";if(g&&g.length>0){for(var f=0,b=g.length;f<b;f++){c=c+h(g[f])}}else{c=a(this)}return c});Handlebars.registerHelper("if",function(b,a){if(!b||Handlebars.Utils.isEmpty(b)){return a.inverse(this)}else{return a.fn(this)}});Handlebars.registerHelper("unless",function(c,b){var d=b.fn,a=b.inverse;b.fn=a;b.inverse=d;return Handlebars.helpers["if"].call(this,c,b)});Handlebars.registerHelper("with",function(b,a){return a.fn(b)});Handlebars.registerHelper("log",function(a){Handlebars.log(a)});var handlebars=(function(){var g={trace:function c(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,param:27,STRING:28,INTEGER:29,BOOLEAN:30,hashSegments:31,hashSegment:32,ID:33,EQUALS:34,pathSegments:35,SEP:36,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"STRING",29:"INTEGER",30:"BOOLEAN",33:"ID",34:"EQUALS",36:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[25,2],[25,1],[27,1],[27,1],[27,1],[27,1],[26,1],[31,2],[31,1],[32,3],[32,3],[32,3],[32,3],[21,1],[35,3],[35,1]],performAction:function b(h,k,l,o,n,j,m){var i=j.length-1;switch(n){case 1:return j[i-1];break;case 2:this.$=new o.ProgramNode(j[i-2],j[i]);break;case 3:this.$=new o.ProgramNode(j[i]);break;case 4:this.$=new o.ProgramNode([]);break;case 5:this.$=[j[i]];break;case 6:j[i-1].push(j[i]);this.$=j[i-1];break;case 7:this.$=new o.InverseNode(j[i-2],j[i-1],j[i]);break;case 8:this.$=new o.BlockNode(j[i-2],j[i-1],j[i]);break;case 9:this.$=j[i];break;case 10:this.$=j[i];break;case 11:this.$=new o.ContentNode(j[i]);break;case 12:this.$=new o.CommentNode(j[i]);break;case 13:this.$=new o.MustacheNode(j[i-1][0],j[i-1][1]);break;case 14:this.$=new o.MustacheNode(j[i-1][0],j[i-1][1]);break;case 15:this.$=j[i-1];break;case 16:this.$=new o.MustacheNode(j[i-1][0],j[i-1][1]);break;case 17:this.$=new o.MustacheNode(j[i-1][0],j[i-1][1],true);break;case 18:this.$=new o.PartialNode(j[i-1]);break;case 19:this.$=new o.PartialNode(j[i-2],j[i-1]);break;case 20:break;case 21:this.$=[[j[i-2]].concat(j[i-1]),j[i]];break;case 22:this.$=[[j[i-1]].concat(j[i]),null];break;case 23:this.$=[[j[i-1]],j[i]];break;case 24:this.$=[[j[i]],null];break;case 25:j[i-1].push(j[i]);this.$=j[i-1];break;case 26:this.$=[j[i]];break;case 27:this.$=j[i];break;case 28:this.$=new o.StringNode(j[i]);break;case 29:this.$=new o.IntegerNode(j[i]);break;case 30:this.$=new o.BooleanNode(j[i]);break;case 31:this.$=new o.HashNode(j[i]);break;case 32:j[i-1].push(j[i]);this.$=j[i-1];break;case 33:this.$=[j[i]];break;case 34:this.$=[j[i-2],j[i]];break;case 35:this.$=[j[i-2],new o.StringNode(j[i])];break;case 36:this.$=[j[i-2],new o.IntegerNode(j[i])];break;case 37:this.$=[j[i-2],new o.BooleanNode(j[i])];break;case 38:this.$=new o.IdNode(j[i]);break;case 39:j[i-2].push(j[i]);this.$=j[i-2];break;case 40:this.$=[j[i]];break}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,33:[1,25],35:24},{17:26,21:23,33:[1,25],35:24},{17:27,21:23,33:[1,25],35:24},{17:28,21:23,33:[1,25],35:24},{21:29,33:[1,25],35:24},{1:[2,1]},{6:30,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,31],21:23,33:[1,25],35:24},{10:32,20:[1,33]},{10:34,20:[1,33]},{18:[1,35]},{18:[2,24],21:40,25:36,26:37,27:38,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,38],28:[2,38],29:[2,38],30:[2,38],33:[2,38],36:[1,46]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],36:[2,40]},{18:[1,47]},{18:[1,48]},{18:[1,49]},{18:[1,50],21:51,33:[1,25],35:24},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:52,33:[1,25],35:24},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:40,26:53,27:54,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,23]},{18:[2,26],28:[2,26],29:[2,26],30:[2,26],33:[2,26]},{18:[2,31],32:55,33:[1,56]},{18:[2,27],28:[2,27],29:[2,27],30:[2,27],33:[2,27]},{18:[2,28],28:[2,28],29:[2,28],30:[2,28],33:[2,28]},{18:[2,29],28:[2,29],29:[2,29],30:[2,29],33:[2,29]},{18:[2,30],28:[2,30],29:[2,30],30:[2,30],33:[2,30]},{18:[2,33],33:[2,33]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],34:[1,57],36:[2,40]},{33:[1,58]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,59]},{18:[1,60]},{18:[2,21]},{18:[2,25],28:[2,25],29:[2,25],30:[2,25],33:[2,25]},{18:[2,32],33:[2,32]},{34:[1,57]},{21:61,28:[1,62],29:[1,63],30:[1,64],33:[1,25],35:24},{18:[2,39],28:[2,39],29:[2,39],30:[2,39],33:[2,39],36:[2,39]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,34],33:[2,34]},{18:[2,35],33:[2,35]},{18:[2,36],33:[2,36]},{18:[2,37],33:[2,37]}],defaultActions:{16:[2,1],37:[2,23],53:[2,21]},parseError:function d(i,h){throw new Error(i)},parse:function f(q){var z=this,m=[0],I=[null],u=[],J=this.table,i="",t=0,G=0,k=0,o=2,w=1;this.lexer.setInput(q);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}}var j=this.lexer.yylloc;u.push(j);if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError}function y(p){m.length=m.length-2*p;I.length=I.length-p;u.length=u.length-p}function x(){var p;p=z.lexer.lex()||1;if(typeof p!=="number"){p=z.symbols_[p]||p}return p}var F,B,l,E,K,v,D={},A,H,h,n;while(true){l=m[m.length-1];if(this.defaultActions[l]){E=this.defaultActions[l]}else{if(F==null){F=x()}E=J[l]&&J[l][F]}if(typeof E==="undefined"||!E.length||!E[0]){if(!k){n=[];for(A in J[l]){if(this.terminals_[A]&&A>2){n.push("'"+this.terminals_[A]+"'")}}var C="";if(this.lexer.showPosition){C="Parse error on line "+(t+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+n.join(", ")}else{C="Parse error on line "+(t+1)+": Unexpected "+(F==1?"end of input":("'"+(this.terminals_[F]||F)+"'"))}this.parseError(C,{text:this.lexer.match,token:this.terminals_[F]||F,line:this.lexer.yylineno,loc:j,expected:n})}if(k==3){if(F==w){throw new Error(C||"Parsing halted.")}G=this.lexer.yyleng;i=this.lexer.yytext;t=this.lexer.yylineno;j=this.lexer.yylloc;F=x()}while(1){if((o.toString()) in J[l]){break}if(l==0){throw new Error(C||"Parsing halted.")}y(1);l=m[m.length-1]}B=F;F=o;l=m[m.length-1];E=J[l]&&J[l][o];k=3}if(E[0] instanceof Array&&E.length>1){throw new Error("Parse Error: multiple actions possible at state: "+l+", token: "+F)}switch(E[0]){case 1:m.push(F);I.push(this.lexer.yytext);u.push(this.lexer.yylloc);m.push(E[1]);F=null;if(!B){G=this.lexer.yyleng;i=this.lexer.yytext;t=this.lexer.yylineno;j=this.lexer.yylloc;if(k>0){k--}}else{F=B;B=null}break;case 2:H=this.productions_[E[1]][1];D.$=I[I.length-H];D._$={first_line:u[u.length-(H||1)].first_line,last_line:u[u.length-1].last_line,first_column:u[u.length-(H||1)].first_column,last_column:u[u.length-1].last_column};v=this.performAction.call(D,i,G,t,this.yy,E[1],I,u);if(typeof v!=="undefined"){return v}if(H){m=m.slice(0,-1*H*2);I=I.slice(0,-1*H);u=u.slice(0,-1*H)}m.push(this.productions_[E[1]][0]);I.push(D.$);u.push(D._$);h=J[m[m.length-2]][m[m.length-1]];m.push(h);break;case 3:return true}}return true}};var a=(function(){var k=({EOF:1,parseError:function m(p,o){if(this.yy.parseError){this.yy.parseError(p,o)}else{throw new Error(p)}},setInput:function(o){this._input=o;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};return this},input:function(){var p=this._input[0];this.yytext+=p;this.yyleng++;this.match+=p;this.matched+=p;var o=p.match(/\n/);if(o){this.yylineno++}this._input=this._input.slice(1);return p},unput:function(o){this._input=o+this._input;return this},more:function(){this._more=true;return this},pastInput:function(){var o=this.matched.substr(0,this.matched.length-this.match.length);return(o.length>20?"...":"")+o.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var o=this.match;if(o.length<20){o+=this._input.substr(0,20-o.length)}return(o.substr(0,20)+(o.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var o=this.pastInput();var p=new Array(o.length+1).join("-");return o+this.upcomingInput()+"\n"+p+"^"},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var t,q,p,o;if(!this._more){this.yytext="";this.match=""}var u=this._currentRules();for(var r=0;r<u.length;r++){q=this._input.match(this.rules[u[r]]);if(q){o=q[0].match(/\n.*/g);if(o){this.yylineno+=o.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-1:this.yylloc.last_column+q[0].length};this.yytext+=q[0];this.match+=q[0];this.matches=q;this.yyleng=this.yytext.length;this._more=false;this._input=this._input.slice(q[0].length);this.matched+=q[0];t=this.performAction.call(this,this.yy,this,u[r],this.conditionStack[this.conditionStack.length-1]);if(t){return t}else{return}}}if(this._input===""){return this.EOF}else{this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function h(){var o=this.next();if(typeof o!=="undefined"){return o}else{return this.lex()}},begin:function i(o){this.conditionStack.push(o)},popState:function n(){return this.conditionStack.pop()},_currentRules:function l(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}});k.performAction=function j(t,p,r,o){var q=o;switch(r){case 0:this.begin("mu");if(p.yytext){return 14}break;case 1:return 14;break;case 2:return 24;break;case 3:return 16;break;case 4:return 20;break;case 5:return 19;break;case 6:return 19;break;case 7:return 23;break;case 8:return 23;break;case 9:p.yytext=p.yytext.substr(3,p.yyleng-5);this.begin("INITIAL");return 15;break;case 10:return 22;break;case 11:return 34;break;case 12:return 33;break;case 13:return 33;break;case 14:return 36;break;case 15:break;case 16:this.begin("INITIAL");return 18;break;case 17:this.begin("INITIAL");return 18;break;case 18:p.yytext=p.yytext.substr(1,p.yyleng-2).replace(/\\"/g,'"');return 28;break;case 19:return 30;break;case 20:return 30;break;case 21:return 29;break;case 22:return 33;break;case 23:p.yytext=p.yytext.substr(1,p.yyleng-2);return 33;break;case 24:return"INVALID";break;case 25:return 5;break}};k.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^\{\{>/,/^\{\{#/,/^\{\{\//,/^\{\{\^/,/^\{\{\s*else\b/,/^\{\{\{/,/^\{\{&/,/^\{\{![\s\S]*?\}\}/,/^\{\{/,/^=/,/^\.(?=[} ])/,/^\.\./,/^[/.]/,/^\s+/,/^\}\}\}/,/^\}\}/,/^"(\\["]|[^"])*"/,/^true(?=[}\s])/,/^false(?=[}\s])/,/^[0-9]+(?=[}\s])/,/^[a-zA-Z0-9_$-]+(?=[=}\s/.])/,/^\[.*\]/,/^./,/^$/];k.conditions={mu:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:false},INITIAL:{rules:[0,1,25],inclusive:true}};return k})();g.lexer=a;return g})();Handlebars.Parser=handlebars;Handlebars.parse=function(a){Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(a)};Handlebars.print=function(a){return new Handlebars.PrintVisitor().accept(a)};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(b,a){}};Handlebars.log=function(b,a){Handlebars.logger.log(b,a)};(function(){Handlebars.AST={};Handlebars.AST.ProgramNode=function(c,b){this.type="program";this.statements=c;if(b){this.inverse=new Handlebars.AST.ProgramNode(b)}};Handlebars.AST.MustacheNode=function(d,c,b){this.type="mustache";this.id=d[0];this.params=d.slice(1);this.hash=c;this.escaped=!b};Handlebars.AST.PartialNode=function(c,b){this.type="partial";this.id=c;this.context=b};var a=function(b,c){if(b.original!==c.original){throw new Handlebars.Exception(b.original+" doesn't match "+c.original)}};Handlebars.AST.BlockNode=function(c,b,d){a(c.id,d);this.type="block";this.mustache=c;this.program=b};Handlebars.AST.InverseNode=function(c,b,d){a(c.id,d);this.type="inverse";this.mustache=c;this.program=b};Handlebars.AST.ContentNode=function(b){this.type="content";this.string=b};Handlebars.AST.HashNode=function(b){this.type="hash";this.pairs=b};Handlebars.AST.IdNode=function(g){this.type="ID";this.original=g.join(".");var d=[],h=0;for(var f=0,b=g.length;f<b;f++){var c=g[f];if(c===".."){h++}else{if(c==="."||c==="this"){this.isScoped=true}else{d.push(c)}}}this.parts=d;this.string=d.join(".");this.depth=h;this.isSimple=(d.length===1)&&(h===0)};Handlebars.AST.StringNode=function(b){this.type="STRING";this.string=b};Handlebars.AST.IntegerNode=function(b){this.type="INTEGER";this.integer=b};Handlebars.AST.BooleanNode=function(b){this.type="BOOLEAN";this.bool=b};Handlebars.AST.CommentNode=function(b){this.type="comment";this.comment=b}})();Handlebars.Exception=function(b){var a=Error.prototype.constructor.apply(this,arguments);for(var c in a){if(a.hasOwnProperty(c)){this[c]=a[c]}}};Handlebars.Exception.prototype=new Error;Handlebars.SafeString=function(a){this.string=a};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};(function(){var c={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var d=/&(?!\w+;)|[<>"'`]/g;var b=/[&<>"'`]/;var a=function(f){return c[f]||"&amp;"};Handlebars.Utils={escapeExpression:function(f){if(f instanceof Handlebars.SafeString){return f.toString()}else{if(f==null||f===false){return""}}if(!b.test(f)){return f}return f.replace(d,a)},isEmpty:function(f){if(typeof f==="undefined"){return true}else{if(f===null){return true}else{if(f===false){return true}else{if(Object.prototype.toString.call(f)==="[object Array]"&&f.length===0){return true}else{return false}}}}}}})();Handlebars.Compiler=function(){};Handlebars.JavaScriptCompiler=function(){};(function(g,f){g.OPCODE_MAP={appendContent:1,getContext:2,lookupWithHelpers:3,lookup:4,append:5,invokeMustache:6,appendEscaped:7,pushString:8,truthyOrFallback:9,functionOrFallback:10,invokeProgram:11,invokePartial:12,push:13,assignToHash:15,pushStringParam:16};g.MULTI_PARAM_OPCODES={appendContent:1,getContext:1,lookupWithHelpers:2,lookup:1,invokeMustache:3,pushString:1,truthyOrFallback:1,functionOrFallback:1,invokeProgram:3,invokePartial:1,push:1,assignToHash:1,pushStringParam:1};g.DISASSEMBLE_MAP={};for(var j in g.OPCODE_MAP){var h=g.OPCODE_MAP[j];g.DISASSEMBLE_MAP[h]=j}g.multiParamSize=function(i){return g.MULTI_PARAM_OPCODES[g.DISASSEMBLE_MAP[i]]};g.prototype={compiler:g,disassemble:function(){var u=this.opcodes,r,n;var q=[],w,m,x;for(var t=0,o=u.length;t<o;t++){r=u[t];if(r==="DECLARE"){m=u[++t];x=u[++t];q.push("DECLARE "+m+" = "+x)}else{w=g.DISASSEMBLE_MAP[r];var v=g.multiParamSize(r);var k=[];for(var p=0;p<v;p++){n=u[++t];if(typeof n==="string"){n='"'+n.replace("\n","\\n")+'"'}k.push(n)}w=w+" "+k.join(" ");q.push(w)}}return q.join("\n")},guid:0,compile:function(i,l){this.children=[];this.depths={list:[]};this.options=l;var m=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};if(m){for(var k in m){this.options.knownHelpers[k]=m[k]}}return this.program(i)},accept:function(i){return this[i.type](i)},program:function(n){var m=n.statements,p;this.opcodes=[];for(var o=0,k=m.length;o<k;o++){p=m[o];this[p.type](p)}this.isSimple=k===1;this.depths.list=this.depths.list.sort(function(l,i){return l-i});return this},compileProgram:function(n){var k=new this.compiler().compile(n,this.options);var o=this.guid++;this.usePartial=this.usePartial||k.usePartial;this.children[o]=k;for(var p=0,m=k.depths.list.length;p<m;p++){depth=k.depths.list[p];if(depth<2){continue}else{this.addDepth(depth-1)}}return o},block:function(p){var m=p.mustache;var o,q,k,l;var n=this.setupStackForMustache(m);var i=this.compileProgram(p.program);if(p.program.inverse){l=this.compileProgram(p.program.inverse);this.declare("inverse",l)}this.opcode("invokeProgram",i,n.length,!!m.hash);this.declare("inverse",null);this.opcode("append")},inverse:function(l){var k=this.setupStackForMustache(l.mustache);var i=this.compileProgram(l.program);this.declare("inverse",i);this.opcode("invokeProgram",null,k.length,!!l.mustache.hash);this.opcode("append")},hash:function(o){var n=o.pairs,q,p;this.opcode("push","{}");for(var m=0,k=n.length;m<k;m++){q=n[m];p=q[1];this.accept(p);this.opcode("assignToHash",q[0])}},partial:function(i){var k=i.id;this.usePartial=true;if(i.context){this.ID(i.context)}else{this.opcode("push","depth0")}this.opcode("invokePartial",k.original);this.opcode("append")},content:function(i){this.opcode("appendContent",i.string)},mustache:function(i){var k=this.setupStackForMustache(i);this.opcode("invokeMustache",k.length,i.id.original,!!i.hash);if(i.escaped){this.opcode("appendEscaped")}else{this.opcode("append")}},ID:function(n){this.addDepth(n.depth);this.opcode("getContext",n.depth);this.opcode("lookupWithHelpers",n.parts[0]||null,n.isScoped||false);for(var m=1,k=n.parts.length;m<k;m++){this.opcode("lookup",n.parts[m])}},STRING:function(i){this.opcode("pushString",i.string)},INTEGER:function(i){this.opcode("push",i.integer)},BOOLEAN:function(i){this.opcode("push",i.bool)},comment:function(){},pushParams:function(m){var k=m.length,l;while(k--){l=m[k];if(this.options.stringParams){if(l.depth){this.addDepth(l.depth)}this.opcode("getContext",l.depth||0);this.opcode("pushStringParam",l.string)}else{this[l.type](l)}}},opcode:function(i,m,l,k){this.opcodes.push(g.OPCODE_MAP[i]);if(m!==undefined){this.opcodes.push(m)}if(l!==undefined){this.opcodes.push(l)}if(k!==undefined){this.opcodes.push(k)}},declare:function(i,k){this.opcodes.push("DECLARE");this.opcodes.push(i);this.opcodes.push(k)},addDepth:function(i){if(i===0){return}if(!this.depths[i]){this.depths[i]=true;this.depths.list.push(i)}},setupStackForMustache:function(i){var k=i.params;this.pushParams(k);if(i.hash){this.hash(i.hash)}this.ID(i.id);return k}};f.prototype={nameLookup:function(l,i,k){if(/^[0-9]+$/.test(i)){return l+"["+i+"]"}else{if(f.isValidJavaScriptVariableName(i)){return l+"."+i}else{return l+"['"+i+"']"}}},appendToBuffer:function(i){if(this.environment.isSimple){return"return "+i+";"}else{return"buffer += "+i+";"}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(i,k,m,l){this.environment=i;this.options=k||{};this.name=this.environment.name;this.isChild=!!m;this.context=m||{programs:[],aliases:{self:"this"},registers:{list:[]}};this.preamble();this.stackSlot=0;this.stackVars=[];this.compileChildren(i,k);var o=i.opcodes,n;this.i=0;for(b=o.length;this.i<b;this.i++){n=this.nextOpcode(0);if(n[0]==="DECLARE"){this.i=this.i+2;this[n[1]]=n[2]}else{this.i=this.i+n[1].length;this[n[0]].apply(this,n[1])}}return this.createFunctionContext(l)},nextOpcode:function(r){var o=this.environment.opcodes,m=o[this.i+r],l,p;var q,i;if(m==="DECLARE"){l=o[this.i+1];p=o[this.i+2];return["DECLARE",l,p]}else{l=g.DISASSEMBLE_MAP[m];q=g.multiParamSize(m);i=[];for(var k=0;k<q;k++){i.push(o[this.i+k+1+r])}return[l,i]}},eat:function(i){this.i=this.i+i.length},preamble:function(){var i=[];if(!this.isChild){var k=this.namespace;var l="helpers = helpers || "+k+".helpers;";if(this.environment.usePartial){l=l+" partials = partials || "+k+".partials;"}i.push(l)}else{i.push("")}if(!this.environment.isSimple){i.push(", buffer = "+this.initializeBuffer())}else{i.push("")}this.lastContext=0;this.source=i},createFunctionContext:function(q){var r=this.stackVars;if(!this.isChild){r=r.concat(this.context.registers.list)}if(r.length>0){this.source[1]=this.source[1]+", "+r.join(", ")}if(!this.isChild){var m=[];for(var p in this.context.aliases){this.source[1]=this.source[1]+", "+p+"="+this.context.aliases[p]}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"}if(!this.environment.isSimple){this.source.push("return buffer;")}var t=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var o=0,k=this.environment.depths.list.length;o<k;o++){t.push("depth"+this.environment.depths.list[o])}if(q){t.push(this.source.join("\n  "));return Function.apply(this,t)}else{var n="function "+(this.name||"")+"("+t.join(",")+") {\n  "+this.source.join("\n  ")+"}";Handlebars.log(Handlebars.logger.DEBUG,n+"\n\n");return n}},appendContent:function(i){this.source.push(this.appendToBuffer(this.quotedString(i)))},append:function(){var i=this.popStack();this.source.push("if("+i+" || "+i+" === 0) { "+this.appendToBuffer(i)+" }");if(this.environment.isSimple){this.source.push("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){var k=this.nextOpcode(1),i="";this.context.aliases.escapeExpression="this.escapeExpression";if(k[0]==="appendContent"){i=" + "+this.quotedString(k[1][0]);this.eat(k)}this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+i))},getContext:function(i){if(this.lastContext!==i){this.lastContext=i}},lookupWithHelpers:function(l,m){if(l){var i=this.nextStack();this.usingKnownHelper=false;var k;if(!m&&this.options.knownHelpers[l]){k=i+" = "+this.nameLookup("helpers",l,"helper");this.usingKnownHelper=true}else{if(m||this.options.knownHelpersOnly){k=i+" = "+this.nameLookup("depth"+this.lastContext,l,"context")}else{k=i+" = "+this.nameLookup("helpers",l,"helper")+" || "+this.nameLookup("depth"+this.lastContext,l,"context")}}k+=";";this.source.push(k)}else{this.pushStack("depth"+this.lastContext)}},lookup:function(k){var i=this.topStack();this.source.push(i+" = ("+i+" === null || "+i+" === undefined || "+i+" === false ? "+i+" : "+this.nameLookup(i,k,"context")+");")},pushStringParam:function(i){this.pushStack("depth"+this.lastContext);this.pushString(i)},pushString:function(i){this.pushStack(this.quotedString(i))},push:function(i){this.pushStack(i)},invokeMustache:function(l,k,i){this.populateParams(l,this.quotedString(k),"{}",null,i,function(m,o,n){if(!this.usingKnownHelper){this.context.aliases.helperMissing="helpers.helperMissing";this.context.aliases.undef="void 0";this.source.push("else if("+n+"=== undef) { "+m+" = helperMissing.call("+o+"); }");if(m!==n){this.source.push("else { "+m+" = "+n+"; }")}}})},invokeProgram:function(l,m,k){var i=this.programExpression(this.inverse);var n=this.programExpression(l);this.populateParams(m,null,n,i,k,function(o,q,p){if(!this.usingKnownHelper){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";this.source.push("else { "+o+" = blockHelperMissing.call("+q+"); }")}})},populateParams:function(q,l,v,r,z,y){var m=z||this.options.stringParams||r||this.options.data;var k=this.popStack(),x;var o=[],n,p,w;if(m){this.register("tmp1",v);w="tmp1"}else{w="{ hash: {} }"}if(m){var u=(z?this.popStack():"{}");this.source.push("tmp1.hash = "+u+";")}if(this.options.stringParams){this.source.push("tmp1.contexts = [];")}for(var t=0;t<q;t++){n=this.popStack();o.push(n);if(this.options.stringParams){this.source.push("tmp1.contexts.push("+this.popStack()+");")}}if(r){this.source.push("tmp1.fn = tmp1;");this.source.push("tmp1.inverse = "+r+";")}if(this.options.data){this.source.push("tmp1.data = data;")}o.push(w);this.populateCall(o,k,l||k,y)},populateCall:function(m,p,o,i){var l=["depth0"].concat(m).join(", ");var n=["depth0"].concat(o).concat(m).join(", ");var k=this.nextStack();if(this.usingKnownHelper){this.source.push(k+" = "+p+".call("+l+");")}else{this.context.aliases.functionType='"function"';this.source.push("if(typeof "+p+" === functionType) { "+k+" = "+p+".call("+l+"); }")}i.call(this,k,n,p);this.usingKnownHelper=false},invokePartial:function(i){this.pushStack("self.invokePartial("+this.nameLookup("partials",i,"partial")+", '"+i+"', "+this.popStack()+", helpers, partials);")},assignToHash:function(i){var k=this.popStack();var l=this.topStack();this.source.push(l+"['"+i+"'] = "+k+";")},compiler:f,compileChildren:function(k,o){var q=k.children,t,r;for(var p=0,m=q.length;p<m;p++){t=q[p];r=new this.compiler();this.context.programs.push("");var n=this.context.programs.length;t.index=n;t.name="program"+n;this.context.programs[n]=r.compile(t,o,this.context)}},programExpression:function(m){if(m==null){return"self.noop"}var q=this.environment.children[m],p=q.depths.list;var o=[q.index,q.name,"data"];for(var n=0,k=p.length;n<k;n++){depth=p[n];if(depth===1){o.push("depth0")}else{o.push("depth"+(depth-1))}}if(p.length===0){return"self.program("+o.join(", ")+")"}else{o.shift();return"self.programWithDepth("+o.join(", ")+")"}},register:function(i,k){this.useRegister(i);this.source.push(i+" = "+k+";")},useRegister:function(i){if(!this.context.registers[i]){this.context.registers[i]=true;this.context.registers.list.push(i)}},pushStack:function(i){this.source.push(this.nextStack()+" = "+i+";");return"stack"+this.stackSlot},nextStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return"stack"+this.stackSlot},popStack:function(){return"stack"+this.stackSlot--},topStack:function(){return"stack"+this.stackSlot},quotedString:function(i){return'"'+i.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}};var a=("break case catch continue default delete do else finally for function if in instanceof new return switch this throw try typeof var void while with null true false").split(" ");var d=f.RESERVED_WORDS={};for(var c=0,b=a.length;c<b;c++){d[a[c]]=true}f.isValidJavaScriptVariableName=function(i){if(!f.RESERVED_WORDS[i]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(i)){return true}return false}})(Handlebars.Compiler,Handlebars.JavaScriptCompiler);Handlebars.precompile=function(d,c){c=c||{};var b=Handlebars.parse(d);var a=new Handlebars.Compiler().compile(b,c);return new Handlebars.JavaScriptCompiler().compile(a,c)};Handlebars.compile=function(b,a){a=a||{};var d;function c(){var h=Handlebars.parse(b);var g=new Handlebars.Compiler().compile(h,a);var f=new Handlebars.JavaScriptCompiler().compile(g,a,undefined,true);return Handlebars.template(f)}return function(g,f){if(!d){d=c()}return d.call(this,g,f)}};Handlebars.VM={template:function(a){var b={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(d,f,g){var c=this.programs[d];if(g){return Handlebars.VM.program(f,g)}else{if(c){return c}else{c=this.programs[d]=Handlebars.VM.program(f);return c}}},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(d,c){c=c||{};return a.call(b,Handlebars,d,c.helpers,c.partials,c.data)}},programWithDepth:function(b,d,c){var a=Array.prototype.slice.call(arguments,2);return function(g,f){f=f||{};return b.apply(this,[g,f.data||d].concat(a))}},program:function(a,b){return function(d,c){c=c||{};return a(d,c.data||b)}},noop:function(){return""},invokePartial:function(a,b,d,f,c){if(a===undefined){throw new Handlebars.Exception("The partial "+b+" could not be found")}else{if(a instanceof Function){return a(d,{helpers:f,partials:c})}else{if(!Handlebars.compile){throw new Handlebars.Exception("The partial "+b+" could not be compiled when running in vm mode")}else{c[b]=Handlebars.compile(a);return c[b](d,{helpers:f,partials:c})}}}}};Handlebars.template=Handlebars.VM.template;sc_require("handlebars");SC.Handlebars={};SC.Handlebars.Compiler=function(){};SC.Handlebars.Compiler.prototype=SC.beget(Handlebars.Compiler.prototype);SC.Handlebars.Compiler.prototype.compiler=SC.Handlebars.Compiler;SC.Handlebars.JavaScriptCompiler=function(){};SC.Handlebars.JavaScriptCompiler.prototype=SC.beget(Handlebars.JavaScriptCompiler.prototype);SC.Handlebars.JavaScriptCompiler.prototype.compiler=SC.Handlebars.JavaScriptCompiler;SC.Handlebars.JavaScriptCompiler.prototype.nameLookup=function(c,a,b){if(b==="context"){return"SC.get("+c+", "+this.quotedString(a)+")"}else{return Handlebars.JavaScriptCompiler.prototype.nameLookup.call(this,c,a,b)}};SC.Handlebars.Compiler.prototype.mustache=function(a){if(a.params.length||a.hash){return Handlebars.Compiler.prototype.mustache.call(this,a)}else{var b=new Handlebars.AST.IdNode(["bind"]);if(a.escaped){a.hash=a.hash||new Handlebars.AST.HashNode([]);a.hash.pairs.push(["escaped",new Handlebars.AST.StringNode("true")])}a=new Handlebars.AST.MustacheNode([b].concat([a.id]),a.hash,!a.escaped);return Handlebars.Compiler.prototype.mustache.call(this,a)}};SC.Handlebars.compile=function(f){var c=Handlebars.parse(f);var d={data:true,stringParams:true};var b=new SC.Handlebars.Compiler().compile(c,d);var a=new SC.Handlebars.JavaScriptCompiler().compile(b,d,undefined,true);return Handlebars.template(a)};Handlebars.registerHelper("helperMissing",function(c,b){var a;a="%@ Handlebars error: Could not find property '%@' on object %@.";throw a.fmt(b.data.view,c,this)});sc_require("ext/handlebars");(function(){var a=function(m,n,j,b){var f=n.data,k=n.fn,d=n.inverse,l=f.view;if(this.isObservable){var g=l.createChildView(SC._BindableSpan,{preserveContext:j,shouldDisplayFunc:b,displayTemplate:k,inverseTemplate:d,property:m,previousContext:this,tagName:(n.hash.tagName||"span"),isEscaped:n.hash.escaped});var i,h;l.get("childViews").push(g);i=function(){if(g.get("layer")){g.rerender()}else{this.removeObserver(m,h)}};h=function(){this.invokeOnce(i)};this.addObserver(m,h);var c=g.renderContext(g.get("tagName"));g.renderToContext(c);return new Handlebars.SafeString(c.join())}else{return SC.getPath(this,m)}};Handlebars.registerHelper("bind",function(c,b){return a.call(this,c,b,false,function(d){return !SC.none(d)})});Handlebars.registerHelper("boundIf",function(c,b){if(b){return a.call(this,c,b,true,function(d){if(SC.typeOf(d)===SC.T_ARRAY){if(d.length!==0){return true}return false}else{return !!d}})}else{throw"Cannot use boundIf helper without a block."}})})();Handlebars.registerHelper("with",function(b,a){return Handlebars.helpers.bind.call(a.contexts[0],b,a)});Handlebars.registerHelper("if",function(b,a){return Handlebars.helpers.boundIf.call(a.contexts[0],b,a)});Handlebars.registerHelper("unless",function(c,b){var d=b.fn,a=b.inverse;b.fn=a;b.inverse=d;return Handlebars.helpers.boundIf.call(b.contexts[0],c,b)});Handlebars.registerHelper("bindAttr",function(g){var f=g.hash;var b=g.data.view;var d=[];var c=jQuery.uuid++;var i=f["class"];if(i!=null){var a=SC.Handlebars.bindClasses(this,i,b,c);d.push('class="'+a.join(" ")+'"');delete f["class"]}var h=SC.keys(f);h.forEach(function(j){var n=f[j];var m=this.getPath(n);var l,k;l=function l(){var o=this.getPath(n);var q=b.$("[data-handlebars-id='"+c+"']");if(q.length===0){this.removeObserver(n,k);return}var p=q.attr(j);if(o===NO&&p){q.removeAttr(j)}else{if(o===YES&&p!==j){q.attr(j,j)}else{if(p!==o){q.attr(j,o)}}}};k=function(){this.invokeOnce(l)};this.addObserver(n,k);if(m===YES){m=j}if(m!==NO){d.push(j+'="'+m+'"')}},this);d.push('data-handlebars-id="'+c+'"');return new Handlebars.SafeString(d.join(" "))});SC.Handlebars.bindClasses=function(b,i,h,a){var g=[],f,j,c;var d=function(k){var l=b.getPath(k);if(l===YES){return SC.String.dasherize(k.split(".").get("lastObject"))}else{if(l!==NO&&l!==undefined&&l!==null){return l}else{return null}}};i.split(" ").forEach(function(n){var m;var l,k;l=function(){f=d(n);c=a?h.$("[data-handlebars-id='"+a+"']"):h.$();if(c.length===0){b.removeObserver(n,k)}else{if(m){c.removeClass(m)}if(f){c.addClass(f);m=f}else{m=null}}};k=function(){this.invokeOnce(l)};b.addObserver(n,k);j=d(n);if(j){g.push(j);m=j}});return g};sc_require("ext/handlebars");Handlebars.registerHelper("collection",function(l,m){var k=m.fn;var g=m.data;var d=m.inverse;var f=m.hash;var h,a;h=l?SC.getPath(this,l)||SC.getPath(l):SC.TemplateCollectionView;var j={};if(f){var c={},i;for(var b in f){if(f.hasOwnProperty(b)){i=b.match(/^item(.)(.*)$/);if(i){c[i[1].toLowerCase()+i[2]]=f[b];delete f[b]}}}j=SC.clone(f);j.itemViewOptions=c}if(k){j.itemViewTemplate=k}if(d){j.inverseTemplate=d}if(h.isClass){a=h.extend(j)}else{a=SC.mixin(h,j)}m.fn=function(){return""};return Handlebars.helpers.view.call(this,a,m)});Handlebars.registerHelper("each",function(b,a){a.hash.contentBinding=SC.Binding.from("*"+b,this).oneWay();a.hash.itemContextProperty="content";return Handlebars.helpers.collection.call(this,null,a)});sc_require("ext/handlebars");Handlebars.registerHelper("loc",function(a){return SC.String.loc(a)});sc_require("ext/handlebars");SC.Handlebars.ViewHelper=SC.Object.create({helper:function(m,n,o){var c=o.inverse;var f=o.data;var k=f.view;var j=o.fn;var d=o.hash;var b;if(n.isClass||n.isObject){b=n;if(!b){throw"Null or undefined object was passed to the #view helper. Did you mean to pass a property path string?"}}else{if(n.charAt(0)==="."){b=SC.objectForPropertyPath(n.slice(1),k)}else{b=SC.getPath(m,n);if(!b){b=SC.getPath(n)}}if(!b){throw"Unable to find view at path '"+n+"'"}}if(d.id){d.layerId=d.id}var l={id:d.id,"class":d["class"],classBinding:d.classBinding};delete d.id;delete d["class"];delete d.classBinding;if(b.isClass){b=b.extend(d)}else{SC.mixin(b,d)}var h=f.view;var i=h.get("childViews");var g=h.createChildView(b);if(j){g.template=j}i.pushObject(g);var a=SC.RenderContext(g.get("tagName"));this.applyAttributes(l,g,a);g.applyAttributesToContext(a);g.render(a,YES);return new Handlebars.SafeString(a.join())},applyAttributes:function(a,g,b){var f=a.id;var d=a["class"];if(d){b.addClass(d.split(" "))}if(f){g.set("layerId",f);b.id(f)}var c=a.classBinding;if(c){SC.Handlebars.bindClasses(g,c,g).forEach(function(h){b.setClass(h,YES)})}}});Handlebars.registerHelper("view",function(b,a){return SC.Handlebars.ViewHelper.helper(this,b,a)});sc_require("handlebars");sc_require("ext/handlebars");sc_require("ext/handlebars/bind");sc_require("ext/handlebars/collection");sc_require("ext/handlebars/localization");sc_require("ext/handlebars/view");SC.TEMPLATES=SC.Object.create();SC.TemplateView=SC.CoreView.extend({acceptsFirstResponder:YES,templateName:null,templates:SC.TEMPLATES,template:function(b,d){if(d!==undefined){return d}var a=this.get("templateName"),c=this.get("templates").get(a);if(!c){return function(){return""}}return c}.property("templateName").cacheable(),context:function(a,b){if(b!==undefined){return b}return this}.property().cacheable(),render:function(b){var f,a,c=this.get("template"),d=this.get("context");this._didRenderChildViews=YES;f={view:this,isRenderData:true};a=c(d,{data:f});b.push(a)},update:function(){},mouseDown:function(){if(this.mouseUp){return YES}return NO}});sc_require("views/template");SC.Button=SC.TemplateView.extend(SC.ActionSupport,{classNames:["sc-button"],mouseDown:function(){this.set("isActive",true);this._isMouseDown=YES},mouseExited:function(){this.set("isActive",false)},mouseEntered:function(){if(this._isMouseDown){this.set("isActive",true)}},rootResponder:function(){var a=this.get("pane");return a.get("rootResponder")}.property("pane").cacheable(),mouseUp:function(a){if(this.get("isActive")){this.fireAction();this.set("isActive",false)}this._isMouseDown=NO},touchStart:function(a){this.mouseDown(a)},touchEnd:function(a){this.mouseUp(a)}});sc_require("views/template");SC.Checkbox=SC.TemplateView.extend({title:null,value:null,displayTitle:function(){var a=this.get("title");return a?SC.String.loc(a):null}.property("title").cacheable(),classNames:["sc-checkbox"],template:SC.Handlebars.compile('<label><input type="checkbox">{{displayTitle}}</label>'),didCreateLayer:function(){var a=this;this.$("input").bind("change",function(){a.domValueDidChange(this)})},domValueDidChange:function(a){this.set("value",$(a).prop("checked"))},value:function(a,b){if(b!==undefined){this.$("input").prop("checked",b)}else{b=this.$("input").prop("checked")}return b}.property()});SC.CheckboxSupport={didCreateLayer:function(){this.$("input").change(jQuery.proxy(function(){SC.RunLoop.begin();this.notifyPropertyChange("value");SC.RunLoop.end()},this))},value:function(a,b){if(b!==undefined){this.$("input").prop("checked",b)}else{b=this.$("input").prop("checked")}return b}.property().idempotent()};sc_require("views/template");SC.TextFieldSupport={$input:function(){return this.$("input")},_value:null,value:function(b,c){var a=this.$input();if(c!==undefined){if(this._value!==c){this._value=c}if(a.val()!==c){a.val(c)}}else{if(a.length>0){c=this._value=a.val()}else{c=this._value}}return c}.property().idempotent(),didCreateLayer:function(){var b=this.$input(),a=this;b.val(this._value);if(SC.browser.isIE){SC.Event.add(b,"focusin",this,this.focusIn);SC.Event.add(b,"focusout",this,this.focusOut)}else{SC.Event.add(b,"focus",this,this.focusIn);SC.Event.add(b,"blur",this,this.focusOut)}},willDestroyLayerMixin:function(){var a=this.$input();if(SC.browser.isIE){SC.Event.remove(a,"focusin",this,this.focusIn);SC.Event.remove(a,"focusout",this,this.focusOut)}else{SC.Event.remove(a,"focus",this,this.focusIn);SC.Event.remove(a,"blur",this,this.focusOut)}},focusIn:function(a){this.becomeFirstResponder();this.tryToPerform("focus",a)},focusOut:function(a){this.resignFirstResponder();this.tryToPerform("blur",a)},touchStart:function(a){a.allowDefault();return YES},touchEnd:function(a){a.allowDefault();return YES},willLoseFirstResponder:function(){this.notifyPropertyChange("value")},domValueDidChange:function(a){this.set("value",a.val())},keyUp:function(a){this.domValueDidChange(this.$input());if(a.keyCode===SC.Event.KEY_RETURN){return this.tryToPerform("insertNewline",a)}else{if(a.keyCode===SC.Event.KEY_ESC){return this.tryToPerform("cancel",a)}}},selectStart:function(){return true}};SC.TextField=SC.TemplateView.extend(SC.TextFieldSupport,{classNames:["sc-text-field"],isMultiline:NO,template:function(){return SC.Handlebars.compile(this.get("isMultiline")?"<textarea></textarea>":'<input type="text">')}.property("isMultiline").cacheable(),$input:function(){var a=this.get("isMultiline")?"textarea":"input";return this.$(a)}});SC.TemplatePane=SC.Object.extend({});SC.TemplatePane.mixin({append:function(a){var b=SC.MainPane.extend({childViews:["contentView"],contentView:SC.TemplateView.design(a),touchStart:function(c){c.allowDefault()},touchesDragged:function(c,d){c.allowDefault()},touchEnd:function(c){c.allowDefault()}});b=b.create().append();b.awake();return b}});sc_require("views/template");SC._BindableSpan=SC.TemplateView.extend({tagName:"span",shouldDisplayFunc:null,preserveContext:NO,displayTemplate:null,inverseTemplate:null,property:null,render:function(d){var i=this.get("isEscaped");var a=this.get("shouldDisplayFunc"),g=this.get("property"),f=this.get("preserveContext"),b=this.get("previousContext");var c=this.get("inverseTemplate"),h=this.get("displayTemplate");var j;if(g===""){j=b}else{j=b.getPath(g)}if(a(j)){this.set("template",h);if(f){this.set("context",b)}else{if(h){this.set("context",j)}else{if(j==null){j=""}else{j=String(j)}if(i){j=Handlebars.Utils.escapeExpression(j)}d.push(j);return}}}else{if(c){this.set("template",c);if(f){this.set("context",b)}else{this.set("context",j)}}else{this.set("template",function(){return""})}}return arguments.callee.base.apply(this,arguments)},rerender:function(){var b,a,f,g;f=this.get("childViews");a=f.get("length");for(b=a-1;b>=0;b--){g=f[b];g.$().remove();g.removeFromParent();g.destroy()}var c=this.renderContext(this.get("tagName"));var d;this.renderToContext(c);d=c.element();this.$().replaceWith(d);this.set("layer",d);this._notifyDidCreateLayer()}});sc_require("views/template");SC.TemplateCollectionView=SC.TemplateView.extend({tagName:"ul",content:null,template:SC.Handlebars.compile(""),emptyView:null,init:function(){var a=arguments.callee.base.apply(this,arguments);this._sctcv_contentDidChange();return a},didCreateLayer:function(){if(this._sctcv_layerCreated){return}this._sctcv_layerCreated=true;var a=this.get("content");if(a){this.arrayContentDidChange(0,0,a.get("length"))}},itemView:"SC.TemplateView",itemViewTemplate:null,itemViewTemplateName:null,inverseTemplate:function(b,d){if(d!==undefined){return d}var a=this.get("inverseTemplateName"),c=this.get("templates").get(a);if(!c){return function(){return""}}return c}.property("inverseTemplateName").cacheable(),inverseTemplateName:null,itemContext:null,itemViewClass:function(){var c=this.get("itemView");var a=this.get("itemViewTemplate");var d=this.get("itemViewTemplateName");var b={};if(SC.typeOf(c)===SC.T_STRING){c=SC.objectForPropertyPath(c)}if(!a&&d){a=this.get("templates").get(d)}if(a){b.template=a}if(c.prototype.tagName===SC.TemplateView.prototype.tagName){b.tagName=this.get("itemTagName")}return c.extend(b)}.property("itemView").cacheable(),_sctcv_contentDidChange:function(){this.$().empty();var c=this._content,a=0;var d=this.get("content"),b=0;if(c){c.removeArrayObservers({target:this,willChange:"arrayContentWillChange",didChange:"arrayContentDidChange"});a=c.get("length")}if(d){d.addArrayObservers({target:this,willChange:"arrayContentWillChange",didChange:"arrayContentDidChange"});b=d.get("length")}this.arrayContentWillChange(0,a,b);this._content=this.get("content");this.arrayContentDidChange(0,a,b)}.observes("content"),arrayContentWillChange:function(i,d,g){if(!this.get("layer")){return}var c=this.get("emptyView");if(c){c.$().remove();c.removeFromParent()}var f=this.get("childViews"),h,b,a;a=f.get("length");for(b=i+d-1;b>=i;b--){h=f[b];h.$().remove();h.removeFromParent();h.destroy()}},arrayContentDidChange:function(f,m,v){if(!this.get("layer")){return}var n=this.get("content"),g=this.get("itemViewClass"),p=this.get("childViews"),a=[],t,u,i,q,h,r,l,k,o;if(n){var j=n.slice(f,f+v);i=this.get("itemViewOptions")||{};q=this.$();h=q.find("li")[f-1]||null;o=j.get("length");var d={id:i.id,"class":i["class"],classBinding:i.classBinding};t=function(w){arguments.callee.base.apply(this,arguments);SC.Handlebars.ViewHelper.applyAttributes(d,this,w)};i=SC.clone(i);delete i.id;delete i["class"];delete i.classBinding;for(k=0;k<o;k++){r=j.objectAt(k);u=this.createChildView(g.extend(i,{content:r,render:t,tagName:i.tagName||g.prototype.tagName}));var c=u.get("contextProperty");if(c){u.set("context",u.get(c))}l=u.createLayer().$();if(!h){q.append(l)}else{l.insertAfter(h)}h=l;a.push(u)}p.replace(f,0,a)}var b=this.get("inverseTemplate");if(p.get("length")===0&&b){u=this.createChildView(SC.TemplateView.extend({template:b,content:this}));this.set("emptyView",u);u.createLayer().$().appendTo(q);this.childViews=[u]}this.invokeLast("invalidateFrame")},itemTagName:function(){switch(this.get("tagName")){case"dl":return"dt";case"ul":case"ol":return"li";case"table":case"thead":case"tbody":case"tfoot":return"tr";case"select":return"option";default:return SC.TemplateView.prototype.tagName}}.property("tagName"),invalidateFrame:function(){this.notifyPropertyChange("frame")}});
/*!
 * ==========================================================================
 * SproutCore -- JavaScript Application Framework
 * Copyright 2008-2011 Apple Inc. All rights reserved.
 * Copyright 2006-2011, Strobe Inc. and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a 
 * copy of this software and associated documentation files (the "Software"), 
 * to deal in the Software without restriction, including without limitation 
 * the rights to use, copy, modify, merge, publish, distribute, sublicense, 
 * and/or sell copies of the Software, and to permit persons to whom the 
 * Software is furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in 
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE 
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
 * DEALINGS IN THE SOFTWARE.
 * 
 * SproutCore and the SproutCore logo are trademarks of Strobe Inc.
 * 
 * For more information about SproutCore, visit http://www.sproutcore.com
 * 
 * ==========================================================================
 */
SC.EmptyTheme=SC.BaseTheme.create({name:"sc-empty"});SC.Theme.addTheme(SC.EmptyTheme);SC.AceTheme=SC.BaseTheme.create({name:"ace",description:"A SproutCore built-in theme by Alex Iskander and contributors. Only supports browsers that implement CSS3."});SC.Theme.addTheme(SC.AceTheme);SC.AceTheme.PointLeft=SC.AceTheme.subtheme("point-left","point-left");SC.AceTheme.PointRight=SC.AceTheme.subtheme("point-right","point-right");SC.AceTheme.Capsule=SC.AceTheme.subtheme("capsule","capsule");SC.AceTheme.Dark=SC.AceTheme.subtheme("dark");SC.defaultTheme="ace";sc_require("theme");SC.AceTheme.Dark.PointLeft=SC.AceTheme.Dark.subtheme("point-left","point-left");SC.AceTheme.Dark.PointRight=SC.AceTheme.Dark.subtheme("point-right","point-right");SC.AceTheme.Dark.PointRight=SC.AceTheme.Dark.subtheme("capsule","capsule");SC.AceTheme.SourceList=SC.AceTheme.subtheme("source-list");sc_require("theme");SC.AceTheme.Popover=SC.AceTheme.Dark.subtheme("popover");SC.AceTheme.addTheme(SC.AceTheme.Popover);SC.AceTheme.SolidPopover=SC.AceTheme.Popover.subtheme("solid");SC.AceTheme.addTheme(SC.AceTheme.SolidPopover.create({name:"solid-popover"}));sc_require("resources/picker/popover/popover");SC.AceTheme.Popover.pickerRenderDelegate=SC.RenderDelegate.create({className:"picker",render:function(f,b){var a=f.get("preferType");var d=f.get("pointerPos");var c=f.get("pointerPosY");if(a==SC.PICKER_POINTER||a==SC.PICKER_MENU_POINTER){b.addClass(d)}},update:function(f,d){var a=f.get("preferType");var c=f.get("pointerPos");var b=f.get("pointerPosY");if(a==SC.PICKER_POINTER||a==SC.PICKER_MENU_POINTER){d.addClass(c)}}});SC.AceTheme.Popover.workspaceRenderDelegate=SC.RenderDelegate.create({className:"workspace",render:function(b,a){a.setClass({"top-toolbar":b.get("hasTopToolbar"),"bottom-toolbar":b.get("hasBottomToolbar")});a=a.begin("div").addClass("popover-background");this.includeSlices(b,a,SC.NINE_SLICE);a.push("<div class = 'sc-pointer'></div>");a=a.end()},update:function(b,a){a.setClass({"top-toolbar":b.get("hasTopToolbar"),"bottom-toolbar":b.get("hasBottomToolbar")})}});Planner=SC.Application.create({NAMESPACE:"Planner",VERSION:"0.1.0",store:SC.Store.create({commitRecordsAutomatically:YES,}).from("Planner.DataSource")});sc_require("core");Planner.Calendar=SC.Object.create({init:function(){arguments.callee.base.apply(this,arguments);this.set("monthnum",(new Date()).getMonth());this.set("yearnum",(new Date()).getFullYear());this.updateValues()},monthnum:0,yearnum:0,monthName:function(){return SC.DateTime.monthNames[this.get("monthnum")]+" "+this.get("yearnum")}.property(),dayValues:[],updateValues:function(){var a=new Date(this.get("yearnum"),this.get("monthnum"));if(a.getDay()==0||a.getDay()==6){while(a.getDay()!=1){a.setDate(a.getDate()+1)}}else{while(a.getDay()!=1){a.setDate(a.getDate()-1)}}var f=[];for(var d=0;d<6;d++){var c=[];for(var b=0;b<7;b++){c[b]=a.getDate();a.setDate(a.getDate()+1)}f[d]=c}this.set("dayValues",f)}.observes("monthnum"),nextMonth:function(){var a=new Date(this.get("yearnum"),this.get("monthnum")+1);this.set("yearnum",a.getFullYear());this.set("monthnum",a.getMonth())},prevMonth:function(){var a=new Date(this.get("yearnum"),this.get("monthnum")-1);this.set("yearnum",a.getFullYear());this.set("monthnum",a.getMonth())},retrieve:function(a,b){return this.get("dayValues")[a][b]}.property("dayValues"),month:function(){return SC.DateTime.monthNames[this.get("monthnum")]}.property("monthnum"),numCols:function(){return this.get("dayValues")[0].length}.property("dayValues"),numRows:function(){return this.get("dayValues").length}.property("dayValues"),topOffset:0.25,colWidth:function(){return 1/this.get("numCols")}.property("numCols"),rowHeight:function(){return(1-this.get("topOffset"))/this.get("numRows")}.property("topOffset","numRows"),});Planner.CourseViewController=SC.Object.extend({});sc_require("core");Planner.currentUser=SC.ObjectController.create({username:"",firstName:"",lastName:"",isStudent:true,fullName:function(){return"%@ %@".fmt(this.get("firstName"),this.get("lastName"))}.property(),loginGreeting:function(){return"Hi, %@".fmt(this.get("firstName"))}.observes("firstName").property(),loginError:"Base Error",loginStatus:"Base Status",accountCreationError:"Base Error",checkLoginStatus:function(){SC.Request.getUrl("/isLoggedIn/").notify(this,"didRecieveLoginStatus").send()},didRecieveLoginStatus:function(a){if(SC.ok(a)){data=JSON.parse(a.body());if(data.status/100===1){this.didRecieveLoginData(a)}else{Planner.statechart.gotoState("LOGGED_OUT")}}},sendLogin:function(c,b){var a="username="+c+"&password="+b;SC.Request.postUrl("/login/",a).notify(this,"didRecieveLoginData").send();Planner.statechart.gotoState("LOGIN_LOADING")},didRecieveLoginData:function(a){if(SC.ok(a)){var b=JSON.parse(a.body());if(b.status==101){Planner.statechart.gotoState("LOGGED_IN");Planner.store.find(Planner.EVENT_QUERY);this.set("username",b.username);this.set("firstName",b.firstName);this.set("lastName",b.lastName);this.set("isStudent",true);Planner.courses.set("content",Planner.store.find(Planner.COURSE_QUERY));Planner.pollManager.start()}else{if(b.status==102){this.set("isStudent",false)}else{if(b.status==301){Planner.statechart.invokeStateMethod("showError","Invalid Username",1,2)}else{if(b.status==302){Planner.statechart.invokeStateMethod("showError","Invalid Password",2)}}}}}return YES},sendLogout:function(){SC.Request.getUrl("/logout/").notify(this,"didRecieveLogoutData").send();Planner.pollManager.stop();Planner.statechart.invokeStateMethod("logout")},didRecieveLogoutData:function(a){this.set("username","");this.set("firstName","");this.set("lastName","");Planner.courses.set("content",[])},sendNewAccount:function(g,c,f,d,b){var a="username=%@&password=%@&firstname=%@&lastname=%@&email=%@".fmt(g,c,f,d,b);SC.Request.postUrl("/register/",a).notify(this,"didRecieveAccountCreationStatus").send()},didRecieveAccountCreationStatus:function(a){if(SC.ok(a)){var b=JSON.parse(a.body());if(b.status!==undefined){Planner.statechart.invokeStateMethod("showStatus",b.status)}else{if(b.error!==undefined){Planner.statechart.invokeStateMethod("showError",b.error)}}}},sendForgotPassword:function(b){var a="email=%@".fmt(b);SC.Request.postUrl("/forgotPassword/",a).notify(this,"didRecieveForgotPasswordStatus").send()},didRecieveForgotPasswordStatus:function(a){if(SC.ok(a)){var b=JSON.parse(a.body());if(b.error){Planner.statechart.invokeStateMethod("showError",b.error)}else{if(b.status){Planner.statechart.gotoState("PROVIDING_CREDENTIALS");Planner.statechart.invokeStateMethod("showStatus",b.status)}}return YES}}});Planner.courses=SC.ArrayController.create({content:[],});sc_require("core");Planner.MonthController=SC.Object.create({monthBinding:"Planner.Calendar.monthnum",yearBinding:"Planner.Calendar.yearnum"});Planner.pollManager=SC.Object.create({start:function(){if(!this.running){this.running=YES;this.poll()}},poll:function(){if(this.request){this.request.cancel()}if(this.timer){this.timer.invalidate()}this.request=Planner.pollRequest.send();this.timer=this.invokeLater(this.poll,5000)},stop:function(){if(this.running){this.running=NO;if(this.request){this.request.cancel()}if(this.timer){this.timer.invalidate()}this.timer=this.request=null}},pollDidRespond:function(d){if(SC.ok(d)){var f=d.get("body");var c=Planner.store.loadRecords(Planner.Assignment,f.assignments);for(var h=0;h<c.length;h++){var b=Planner.store.find(Planner.Assignment,Planner.store.idFor(c[h]));b.get("course").get("assignments").addInverseRecord(b)}var g=Planner.store.loadRecords(Planner.Test,f.tests);for(var h=0;h<g.length;h++){var k=Planner.store.find(Planner.Test,Planner.store.idFor(g[h]));k.get("course").get("tests").addInverseRecord(k)}var j=Planner.store.loadRecords(Planner.Note,f.notes);for(var h=0;h<j.length;h++){var l=Planner.store.find(Planner.Note,Planner.store.idFor(j[h]));l.get("course").get("notes").addInverseRecord(l)}var m=Planner.store.loadRecords(Planner.Task,f.tasks);for(var h=0;h<m.length;h++){var a=Planner.store.find(Planner.Task,Planner.store.idfor(m[h]));a.get("course").get("tasks").addInverseRecord(a)}if(c.length+g.length+j.length+m.length>0){Planner.WeekController.updateAllCells()}}}});Planner.pollRequest=SC.Request.getUrl("/poll/").json().notify(Planner.pollManager,"pollDidRespond");sc_require("core");Planner.WeekCellController=SC.Object.extend({init:function(){arguments.callee.base.apply(this,arguments);this.set("view",Planner.WeekCellView.create({dayNum:this.get("date").get("dayOfWeek")-1,periodNum:this.get("period"),controller:this,events:[],eventsCreated:[],eventViews:[]}));var a=SC.Query.local(Planner.Course,{conditions:"period = %@",parameters:[this.get("period")]});this.set("course",Planner.store.find(a).firstObject());Planner.getPath("plannerPage.plannerPane.mainView.WeekView").appendChild(this.get("view"));this.updateEvents()},period:0,date:SC.DateTime.create(),view:SC.View.design(),course:"",events:[],updateEvents:function(){var b=this.get("course").get("events");var a=[];for(var c=0;c<b.length;c++){if(Planner.Utility.datesAreEqual(b[c].get("date"),this.get("date"))){a.push(b[c])}}this.set("events",a)},updateView:function(){this.get("view").set("events",this.get("events"))}.observes("events"),});Planner.WeekController=SC.Object.create({topOffset:0.08,leftOffset:0.015,numPeriods:function(){return this.get("courses").get("length")}.property("courses"),numDays:5,headerHeight:function(){return this.get("topOffset")/2.5}.property("topOffset"),headerTopSet:function(){return this.get("topOffset")-this.get("headerHeight")}.property("topOffset","headerHeight"),tabHeight:function(){return this.get("height")/4.5}.property("height"),tabWidth:function(){return this.get("leftOffset")*0.9}.property("leftOffset"),width:function(){return(1-this.get("leftOffset"))/this.get("numDays")-0.0009}.property("numDays","leftOffset"),height:function(){return(1-this.get("topOffset"))/this.get("numPeriods")-0.0009}.property("numPeriods","topOffset"),hasZero:function(){return this.get("numPeriods")===7}.property("numPeriods"),weeknum:0,nextWeek:function(){this.set("weeknum",this.get("weeknum")+1)},prevWeek:function(){this.set("weeknum",this.get("weeknum")-1)},cells:[],getController:function(a,b){return this.get("cells")[a][b]}.property(),updateAllCells:function(){for(var b=0;b<this.get("cells").get("length");b++){for(var a=0;a<this.get("cells").objectAt(b).get("length");a++){this.get("cells")[b][a].updateEvents()}}},title:"",header0:"",header1:"",header2:"",header3:"",header4:"",coursesBinding:SC.Binding.from("Planner.courses"),create:function(){var b=SC.DateTime.create();b=b.adjust({day:b.get("day")+(this.get("weeknum")*7)});if(b.get("dayOfWeek")===0){b=b.adjust({day:b.get("day")+1})}else{while(b.get("dayOfWeek")>1){b=b.adjust({day:b.get("day")-1})}}title=SC.LabelView.create({textAlign:SC.ALIGN_CENTER,layout:{width:0.5,left:0.25,height:0.2},classNames:["title"],valueBinding:"Planner.WeekController.title"}),Planner.getPath("plannerPage.plannerPane.mainView.WeekView").appendChild(title);var g=[];for(var l=0;l<this.get("numPeriods");l++){periodNumber=Planner.courses.objectAt(l).get("period");periodTab=Planner.PeriodTab.create({periodNum:periodNumber});Planner.getPath("plannerPage.plannerPane.mainView.WeekView").appendChild(periodTab);var k=[];for(var j=0;j<this.get("numDays");j++){if(l==0){bindingString="Planner.WeekController.header"+j;dayHeader=Planner.HeaderTab.create({dayNum:j,valueBinding:bindingString});Planner.getPath("plannerPage.plannerPane.mainView.WeekView").appendChild(dayHeader)}controller=Planner.WeekCellController.create({date:b.adjust({day:b.get("day")+j}),period:periodNumber});k[j]=controller}g[l]=k}this.set("cells",g);var h=this.get("cells")[0][0].get("date");this.set("title","Week of %@/%@".fmt(h.get("month"),h.get("day")));for(var f=0;f<=4;f++){var a=h.adjust({day:h.get("day")+f});this.set("header"+f,"%@ %@".fmt(SC.DateTime.dayNames[a.get("dayOfWeek")],a.get("day")))}}.observes("weeknum"),});sc_require("core");Planner.Course=SC.Record.extend({guid:SC.Record.attr(Number),period:SC.Record.attr(Number),name:SC.Record.attr(String),teacher:SC.Record.attr(String),assignments:SC.Record.toMany("Planner.Assignment",{inverse:"course",isMaster:NO,}),tests:SC.Record.toMany("Planner.Test",{inverse:"course",isMaster:NO,}),notes:SC.Record.toMany("Planner.Note",{inverse:"course",isMaster:NO,}),tasks:SC.Record.toMany("Planner.Task",{inverse:"course",isMaster:NO,}),events:function(){return this.get("assignments").toArray().concat(this.get("tests").toArray()).concat(this.get("notes").toArray()).concat(this.get("tasks").toArray())}.property(),sideCourseDisplay:function(){return"%@\n\twith %@".fmt(this.get("name"),this.get("teacher"))}.property(),});sc_require("core");Planner.Event=SC.Record.extend({name:SC.Record.attr(String),date:SC.Record.attr(SC.DateTime,{format:"%Y-%m-%d",useIsoDate:YES}),});Planner.Note=Planner.Event.extend({file:SC.Record.attr(String),description:SC.Record.attr(String),course:SC.Record.toOne("Planner.Course",{inverse:"notes",isMaster:YES,}),});Planner.Test=Planner.Event.extend({description:SC.Record.attr(String),course:SC.Record.toOne("Planner.Course",{inverse:"tests",isMaster:YES,}),});Planner.Task=Planner.Event.extend({isComplete:SC.Record.attr(Boolean),course:SC.Record.toOne("Planner.Course",{inverse:"tasks",isMaster:YES,}),});Planner.Assignment=Planner.Task.extend({date:function(){return this.get("dateAssigned")}.property(),description:SC.Record.attr(String),dateAssigned:SC.Record.attr(SC.DateTime,{format:"%Y-%m-%d"}),dateDue:SC.Record.attr(SC.DateTime,{format:"%Y-%m-%d"}),course:SC.Record.toOne("Planner.Course",{inverse:"assignments",isMaster:YES,}),});sc_require("models/course");sc_require("models/event");Planner.COURSE_QUERY=SC.Query.local(Planner.Course);Planner.EVENT_QUERY=SC.Query.local(Planner.Event);Planner.DataSource=SC.DataSource.extend({fetch:function(a,b){if(b==Planner.COURSE_QUERY){SC.Request.getUrl("/courses/").notify(this,"didFetchCourses",a,b).send();return YES}else{if(b==Planner.EVENT_QUERY){SC.Request.getUrl("/events/").notify(this,"didFetchEvents",a,b).send();return YES}}return NO},didFetchCourses:function(b,a,d){if(SC.ok(b)){var c=JSON.parse(b.body());a.loadRecords(Planner.Course,c);a.dataSourceDidFetchQuery(d);Planner.WeekController.create();Planner.getPath("plannerPage.plannerPane.sideView.courses").updateCourses()}else{a.dataSourceDidErrorQuery(d,b)}},didFetchEvents:function(b,a,d){if(SC.ok(b)){var c=JSON.parse(b.body());a.loadRecords(Planner.Assignment,c.assignments);a.loadRecords(Planner.Test,c.tests);a.loadRecords(Planner.Note,c.notes);a.loadRecords(Planner.Task,c.tasks);a.dataSourceDidFetchQuery(d)}else{a.dataSourceDidErrorQuery(d,b)}},retrieveRecord:function(a,c){if(SC.kindOf(a.recordTypeFor(c),Planner.Course)){var b="/course/"+a.idFor(c);SC.Request.getUrl(b).notify(this,"didRetrieveData",a,c).send();return YES}else{if(SC.kindOf(a.recordTypeFor(c),Planner.Assignment)){var b="/assignment/"+a.idFor(c);SC.Request.getUrl(b).notify(this,"didRetrieveData",a,c).send();return YES}else{if(SC.kindOf(a.recordTypeFor(c),Planner.Test)){var b="/test/"+a.idFor(c);SC.Request.getUrl(b).notify(this,"didRetrieveData",a,c).send();return YES}else{if(SC.kindOf(a.recordTypeFor(c),Planner.Note)){var b="/note/"+a.idFor(c);SC.Request.getUrl(b).notify(this,"didRetrieveData",a,c).send();return YES}else{if(SC.kindOf(a.recordTypeFor(c),Planner.Task)){var b="/task/"+a.idFor(c);SC.Request.getUrl(b).notify(this,"didRetrieveData",a,c).send();return YES}}}}}return NO},didRetrieveData:function(b,a,c){if(SC.ok(b)){var d=JSON.parse(b.body());a.loadRecord(a.recordTypeFor(c),d)}else{a.dataSourceDidError(c,b)}},createRecord:function(a,b){if(SC.kindOf(a.recordTypeFor(b)),Planner.Assignment){SC.Request.postUrl("/assignment/create/").notify(this,"didCreateAssignment",a,b).send(a.readDataHash(b));return YES}if(SC.kindOf(a.recordTypeFor(b)),Planner.Test){SC.Request.postUrl("/test/create/",a,b).notify(this,"didCreateTest").send(a.readDataHash(b));return YES}if(SC.kindOf(a.recordTypeFor(b)),Planner.Note){SC.Request.postUrl("/note/create/",a,b).notify(this,"didCreateNote").send(a.readDataHash(b));return YES}if(SC.kindOf(a.recordTypeFor(b)),Planner.Task){SC.Request.postUrl("/task/create/",a,b).notify(this,"didCreateTask").send(a.readDataHash(b));return YES};return NO},didCreateCourse:function(b,a,c){},didCreateAssignment:function(b,a,c){if(SC.ok(b)){a.dataSourceDidComplete(c,null)}else{a.dataSourceDidError(c,b)}},didCreateTest:function(b,a,c){if(SC.ok(b)){a.dataSourceDidComplete(c,null)}else{a.dataSourceDidError(c,b)}},didCreateNote:function(b,a,c){if(SC.ok(b)){a.dataSourceDidComplete(c,null)}else{a.dataSourceDidError(c,b)}},didCreateTask:function(b,a,c){if(SC.ok(b)){a.dataSourceDidComplete(c,null)}else{a.dataSourceDidError(c,b)}},updateRecord:function(b,c){if(Planner.currentUser.get("isStudent")){if(SC.kindOf(b.recordTypeFor(c),Planner.Assignment)){var d=b.find(Planner.Assignment,b.idFor(c));var a="isComplete="+d.get("isComplete");SC.Request.postUrl("/assignment/"+b.idFor(c)+"/update/",a).notify(this,"didUpdateEvent",b,c).send();return YES}else{if(SC.kindOf(b.recordTypeFor(c),Planner.Task)){var a="isComplete="+b.find(Planner.Task,b.idFor(c)).get("isComplete");SC.Request.postUrl("/task/"+b.idFor(c)+"/update/",a).notify(this,"didUpdateEvent",b,c).send();return YES}}}return NO},didUpdateEvent:function(b,a,c){if(SC.ok(b)&&JSON.parse(b.get("body")).status==200){a.dataSourceDidComplete(c,null)}},destroyRecord:function(a,b){return NO}});sc_require("core");Planner.User=SC.Record.extend({firstName:SC.Record.attr(String),lastName:SC.Record.attr(String),fullName:function(){return"%@ %@".fmt(this.get("firstName"),this.get("lastName"))}.property(),courses:SC.Record.toMany("Planner.Course"),loginGreeting:function(){return"Hi, %@".fmt(this.get("firstName"))}.property()});sc_require("core");Planner.WeekCell=SC.Record.extend({period:SC.Record.attr(Number),date:SC.Record.attr(SC.DateTime),events:SC.Record.toMany("Planner.Event",{inverse:"course",isMaster:YES})});Planner.DateCell=SC.ButtonView.extend({classNames:["date-cell"],textAlign:SC.ALIGN_CENTER,retrieve:function(a){return Planner.Calendar.get(a)},init:function(){arguments.callee.base.apply(this,arguments);this.set("title",Planner.Calendar.retrieve(this.get("rowNum"),this.get("dayNum")));this.adjust({width:this.retrieve("colWidth"),height:this.retrieve("rowHeight"),top:this.retrieve("topOffset")+this.get("rowNum")*this.retrieve("rowHeight"),left:this.get("dayNum")*this.retrieve("colWidth"),})}});Planner.CalendarView=SC.View.extend({childViews:["backArrow","monthName","nextArrow",],backArrow:SC.LabelView.design({textAlign:SC.ALIGN_CENTER,title:"<",mouseUp:function(){Planner.Calendar.prevMonth()},layout:{width:0.2,height:Planner.Calendar.get("topOffset")}}),monthName:SC.LabelView.design({classNames:["month-name"],textAlign:SC.ALIGN_CENTER,valueBinding:"Planner.Calendar.monthName",layout:{width:0.5,height:Planner.Calendar.get("topOffset"),centerX:1e-9},init:function(){arguments.callee.base.apply(this,arguments);$("#"+this.get("layerId")).css("font-size",(((Planner.Calendar.get("topOffset"))*450)+100)+"%")},}),nextArrow:SC.LabelView.design({textAlign:SC.ALIGN_CENTER,title:">",mouseUp:function(){Planner.Calendar.nextMonth()},layout:{width:0.2,height:Planner.Calendar.get("topOffset"),right:10}}),datesBinding:"Planner.Calendar.dayValues",currentDates:[],build:function(){this.get("currentDates").forEach(function(c){c.destroy()});for(var a=0;a<this.get("dates").get("length");a++){for(var b=0;b<this.get("dates").objectAt(0).get("length");b++){dateCell=Planner.DateCell.create({rowNum:a,dayNum:b});this.appendChild(dateCell);this.get("currentDates").push(dateCell)}}}.observes("dates"),});Planner.Utility=SC.Object.create({toId:function(a){return"#"+a.get("layer").id},isComplete:function(a){if(SC.none(a)){return false}if(!SC.none(a.length)){return a.length>0}return YES},datesAreEqual:function(a,b){if(a!=null&&b!=null){return a.get("year")==b.get("year")&&a.get("month")==b.get("month")&&a.get("day")==b.get("day")}},getType:function(a){if(SC.kindOf(a,Planner.Assignment)){return"assignment"}if(SC.kindOf(a,Planner.Test)){return"test"}if(SC.kindOf(a,Planner.Note)){return"note"}if(SC.kindOf(a,Planner.Task)){return"task"}},isEmail:function(a){return a.match(/.+@.+\..+/)},hide:function(a){a.forEach(function(b){$(b.get("layer")).css("display","none")})},show:function(a){a.forEach(function(b){$(b.get("layer")).css("display","block")})},enableFields:function(a){if(a==="login"){this._getLoginFields().forEach(function(b){b.set("isEditable",YES);b.set("focused",NO)})}if(a==="planner"){this._getPlannerFields().forEach(function(b){b.set("isEditable",YES);b.set("focused",NO)})}},disableFields:function(a){if(a==="login"){this._getLoginFields().forEach(function(b){b.set("isEditable",NO);b.set("focused",NO)})}if(a==="planner"){this._getPlannerFields().forEach(function(b){b.set("isEditable",NO);b.set("focused",NO)})}},_getLoginFields:function(){return[Planner.getPath("loginPage.loginPane.loginBin.username"),Planner.getPath("loginPage.loginPane.loginBin.password"),Planner.getPath("loginPage.loginPane.forgotAccountBin.email"),Planner.getPath("loginPage.loginPane.createAccountBin.username"),Planner.getPath("loginPage.loginPane.createAccountBin.password"),Planner.getPath("loginPage.loginPane.createAccountBin.passwordConfirmation"),Planner.getPath("loginPage.loginPane.createAccountBin.firstname"),Planner.getPath("loginPage.loginPane.createAccountBin.lastname"),Planner.getPath("loginPage.loginPane.createAccountBin.email")]},_getPlannerFields:function(){return[]},});sc_require("utility");date=SC.DateTime.create();function getSup(b){if(b>10&&b<20){return"th"}var a=b%10;if(a==1){return"st"}else{if(a==2){return"nd"}else{if(a==3){return"rd"}else{return"th"}}}}Planner.BrownButton=SC.ButtonView.extend({classNames:["brownButton"],textAlign:SC.ALIGN_CENTER,}),Planner.UtilItem=SC.ButtonView.extend({classNames:["utilItem"],textAlign:SC.ALIGN_CENTER,}),Planner.Wrapper=SC.View.extend({backgroundColor:"transparent"}),Planner.LoginView=SC.View.extend({layout:{width:326,height:300,centerX:0,centerY:0,zIndex:100},}),Planner.LoginHeader=SC.LabelView.extend({textAlign:SC.ALIGN_CENTER,layout:{width:200,height:30,centerX:0,centerY:-170},}),Planner.LoginError=SC.LabelView.extend({classNames:["loginError"],textAlign:SC.ALIGN_CENTER,}),Planner.LoginStatus=SC.LabelView.extend({classNames:["loginStatus"],textAlign:SC.ALIGN_CENTER}),Planner.LoginTextField=SC.TextFieldView.extend({classNames:["login-text-field"],spellCheckEnabled:NO,shouldRenderBorder:NO,fieldDidFocus:function(a){if(this.get("isEditable")==YES){Planner.statechart.sendEvent("fieldFocused")}},keyDown:function(a){arguments.callee.base.apply(this,arguments);if(a.keyCode===13){Planner.statechart.sendEvent("checkInfo")}else{if(this.get("isEditable")===YES){Planner.statechart.sendEvent("fieldFocused")}}}}),Planner.CourseNumTab=SC.LabelView.extend({layout:{width:0.125,left:0},classNames:["course-num-tab"],render:function(){arguments.callee.base.apply(this,arguments)},value:function(){return this.get("parentView").get("course").get("period")}.property(),});Planner.CourseView=SC.View.extend({layout:{width:0.96,centerX:1e-10},init:function(){arguments.callee.base.apply(this,arguments);this.adjust({height:(0.9/this.get("numCourses")),top:0.025+(0.9/this.get("numCourses"))*(this.get("num"))+(0.01)*this.get("num")})},childViews:["numTab","descBin"],numTab:Planner.CourseNumTab.design({}),descBin:SC.View.design({layout:{width:0.86,left:0.13},classNames:["course-desc-view"],childViews:["courseName","teacherName"],courseName:SC.LabelView.design({classNames:["course-name"],layout:{left:0.05,top:0.15},value:function(){return this.get("parentView").get("parentView").get("course").get("name")}.property()}),teacherName:SC.LabelView.design({classNames:["teacher-name"],layout:{left:0.15,top:0.6},value:function(){return"with "+this.get("parentView").get("parentView").get("course").get("teacher")}.property()})})});sc_require("resources/views");Planner.Today=Planner.Wrapper.extend({classNames:["today"],layout:{width:0.5}});Planner.Tomorrow=Planner.Wrapper.extend({classNames:["tomorrow"],layout:{width:0.5,left:0.5}});Planner.DayView=Planner.Wrapper.extend({classNames:["day-view"],childViews:["today","tomorrow"],today:Planner.Today.create({}),tomorrow:Planner.Tomorrow.create({}),});loginViewManager=SC.Object.create({date:YES,bookMark:YES,copyrightInfo:YES,loginBin:YES,createAccountButton:YES,forgotAccountButton:YES,forgotPasswordBin:YES,createAccountBin:YES,loginHeader:YES,createAccountBin:YES,rememberedAccountButton:YES});sc_require("utility");Planner.CheckImage=SC.ImageView.extend({layout:{width:0.07,height:0.8,left:0.02,top:0.13},classNames:["pointer"],useCanvas:NO,render:function(){arguments.callee.base.apply(this,arguments);if(this.get("parentView").get("content").get("isComplete")){this.set("value","/static/planner/en/87b64922c95183758fc88550f088ad514fb39c1d/source/resources/img/check.png")}else{this.set("value","/static/planner/en/87b64922c95183758fc88550f088ad514fb39c1d/source/resources/img/uncheck.png")}},mouseDown:function(){var a=this.get("parentView").get("content");var b=a.get("isComplete");if(a.get("status")&SC.Record.BUSY){Planner.store.dataSourceDidCancel(Planner.store.storeKeyFor(Planner.Assignment,a.get("guid")))}a.set("isComplete",!b);this.switchComplete(b)},switchComplete:function(a){if(a){this.set("value","/static/planner/en/87b64922c95183758fc88550f088ad514fb39c1d/source/resources/img/uncheck.png")}if(!a){this.set("value","/static/planner/en/87b64922c95183758fc88550f088ad514fb39c1d/source/resources/img/check.png")}}});Planner.EventView=Planner.Wrapper.extend({layout:{width:0.95,height:0.17,top:0.05,left:0.025},classNames:["event-wrapper"],init:function(){arguments.callee.base.apply(this,arguments);Planner.Utility.hide([this]);this.updateClass();this.updatePosition();this.createIcon();$("#"+this.get("layerId")).fadeIn(300)},updateClass:function(){this.get("classNames").push(this.get("type"))}.observes("type"),createIcon:function(){type=this.get("type");if(type=="assignment"){checkBox=Planner.CheckImage.create({});this.appendChild(checkBox)}}.observes("type"),childViews:["title"],title:SC.LabelView.design({layout:{width:0.9,height:0.9,left:0.1,top:0.07},value:function(){return this.get("parentView").get("content").get("name")}.property(),render:function(){arguments.callee.base.apply(this,arguments)}}),updatePosition:function(){this.adjust({top:0.05+(this.get("eventIndex")*0.21)})}.observes("eventIndex")}),Planner.WeekCellView=SC.View.extend({classNames:["week-cell"],retrieve:function(a){return Planner.WeekController.get(a)},init:function(){arguments.callee.base.apply(this,arguments);this.adjust({height:this.retrieve("height"),width:this.retrieve("width"),left:this.retrieve("leftOffset")+(this.get("dayNum")*this.retrieve("width")),});if(Planner.WeekController.get("hasZero")){this.adjust({top:this.retrieve("topOffset")+(this.get("periodNum")*this.retrieve("height")),})}else{this.adjust({top:this.retrieve("topOffset")+((this.get("periodNum")-1)*this.retrieve("height")),})}var b=this.get("dayNum")==this.retrieve("numDays")-1;var a=this.get("periodNum")==this.retrieve("courses").get("length");if(a&&!b){this.get("classNames").push("top-left-bottom")}else{if(b&&!a){this.get("classNames").push("top-left-right")}else{if(!a&&!b){this.get("classNames").push("top-left")}}}},controller:function(){return Planner.WeekController.getController(this.get("periodNum"),this.get("dayNum"))}.property(),updateEvents:function(){eventOrder=["test","note","assignment","tasks"];for(var g=0;g<this.get("events").get("length");g++){e=this.get("events").objectAt(g);alreadyExists=false;for(var d=0;d<this.get("eventsCreated").length;d++){if(e==this.get("eventsCreated")[d]){alreadyExists=true;SC.info(e+" already exists");break}}if(!alreadyExists){var f=Planner.Utility.getType(e);var m=eventOrder.indexOf(f);var h=0;var j=-1;for(var c=0;c<this.get("eventViews").length;c++){if(m<this.get("eventViews")[c].get("superOrder")){h=c;j=c;break}if(this.get("eventViews")[c+1]!=undefined){if(m==this.get("eventViews")[c].get("superOrder")&&m!==this.get("eventViews")[c+1].get("superOrder")){h=c;j=c;break}}}if(j==-1){if(this.get("eventViews").length>0){h=(this.get("eventViews")[(this.get("eventViews").length-1)].get("eventIndex")+1)}}if(j>=0){for(var b=j;b<this.get("eventViews").length;b++){this.get("eventViews")[b].set("eventIndex",(this.get("eventViews")[b].get("eventIndex")+1))}}newView=Planner.EventView.create({content:e,eventIndex:h,superOrder:m,type:f});this.get("eventsCreated").push(e);this.get("eventViews").insertAt(h,newView);this.appendChild(newView)}}}.observes("events")}),Planner.PeriodTab=SC.LabelView.extend({classNames:["period-tab"],textAlign:SC.ALIGN_CENTER,retrieve:function(a){return Planner.WeekController.get(a)},value:function(){return this.get("periodNum")}.property("periodNum"),init:function(){arguments.callee.base.apply(this,arguments);this.adjust({width:this.retrieve("tabWidth"),height:this.retrieve("tabHeight"),});if(Planner.WeekController.get("hasZero")){this.adjust({top:this.retrieve("topOffset")+(this.get("periodNum")*this.retrieve("height")),})}else{this.adjust({top:this.retrieve("topOffset")+((this.get("periodNum")-1)*this.retrieve("height")),})}},render:function(){arguments.callee.base.apply(this,arguments);$("#"+this.get("layerId")).css("font-size",$("#"+this.get("layerId")).css("height"))}}),Planner.HeaderTab=SC.LabelView.extend({classNames:["header-tab"],retrieve:function(a){return Planner.WeekController.get(a)},init:function(){arguments.callee.base.apply(this,arguments);this.adjust({width:this.retrieve("width"),height:this.retrieve("headerHeight"),top:this.retrieve("headerTopSet"),left:this.retrieve("leftOffset")+(this.get("dayNum")*this.retrieve("width")),})}});Planner.WeekView=Planner.Wrapper.extend({layout:{width:0.98,height:0.98,left:0.01,top:0.01},classNames:["week-view"],});sc_require("utility");Planner.statechart=SC.Statechart.create({trace:YES,initialState:"LOADED",LOADED:SC.State.design({enterState:function(){current=SC.browser.current;if(current=="firefox"){$(Planner.getPath("loginPage.loginPane.loginBin.submit").get("layer")).addClass("firefox")}Planner.currentUser.checkLoginStatus()},exitState:function(){}}),LOGGED_OUT:SC.State.plugin("Planner.LOGGED_OUT"),LOGGED_IN:SC.State.design({firstLoad:true,enterState:function(){if(this.firstLoad==true){$("#"+Planner.getPath("loginPage.loginPane.bookmark").get("layer").id).animate({translateY:"-=35"},500);Planner.Utility.hide([Planner.getPath("loginPage.loginPane.forgotAccountBin"),Planner.getPath("loginPage.loginPane.createAccountBin")]);$(Planner.getPath("loginPage.loginPane.createAccountButton").get("layer")).fadeToggle(300);$(Planner.getPath("loginPage.loginPane.forgotAccountButton").get("layer")).fadeToggle(300);$(Planner.getPath("loginPage.loginPane.loginBin").get("layer")).fadeToggle(500);SC.Timer.schedule({action:function(){Planner.getPath("loginPage.loginPane").remove();Planner.getPath("plannerPage.plannerPane").append();Planner.getPath("loginPage.loginPane.loginBin.username").set("value","");Planner.getPath("loginPage.loginPane.loginBin.password").set("value","");Planner.statechart.invokeStateMethod("startUp")},interval:500});this.set("firstLoad",false)}else{Planner.getPath("plannerPage.plannerPane").append();SC.Timer.schedule({action:function(){Planner.statechart.invokeStateMethod("startUp")},interval:200})}},startUp:function(){$("#"+Planner.getPath("plannerPage.plannerPane.bookmark").get("layer").id).animate({translateY:"+=35"},500);$(Planner.getPath("plannerPage.plannerPane.sideView").get("layer")).fadeIn(500);$(Planner.getPath("plannerPage.plannerPane.mainView").get("layer")).fadeIn(500)},logout:function(){$("#"+Planner.getPath("plannerPage.plannerPane.bookmark").get("layer").id).animate({translateY:"-=90"},1000);$("#"+Planner.getPath("plannerPage.plannerPane.util").get("layer").id).animate({translateY:"-=55"},750);$(Planner.getPath("plannerPage.plannerPane.sideView").get("layer")).fadeOut(500);$(Planner.getPath("plannerPage.plannerPane.mainView").get("layer")).fadeOut(500);SC.Timer.schedule({action:function(){Planner.statechart.gotoState("LOGGED_OUT")},interval:1000});this.set("firstLoad",true)},exitState:function(){Planner.getPath("plannerPage.plannerPane").remove()},initialSubstate:"VIEWING_PLANNER",VIEWING_PLANNER:SC.State.design({substatesAreConcurrent:YES,MAIN_VIEW:SC.State.design({initialSubstate:"WEEK_PLANNER",gotoDay:function(){SC.info(this.get("currentSubstates"));if(this.get("currentPlannerView")!="day"){this.gotoState("DAY_PLANNER")}},gotoWeek:function(){if(this.get("currentPlannerView")!="week"){this.gotoState("WEEK_PLANNER")}},gotoMonth:function(){if(this.get("currentPlannerView")!="month"){this.gotoState("MONTH_PLANNER")}},currentPlannerView:function(){if(Planner.statechart.currentStates().filterProperty("name","DAY_PLANNER").get("length")!=0){return"day"}if(Planner.statechart.currentStates().filterProperty("name","WEEK_PLANNER").get("length")!=0){return"week"}if(Planner.statechart.currentStates().filterProperty("name","MONTH_PLANNER").get("length")!=0){return"month"}}.property(),DAY_PLANNER:SC.State.design({enterState:function(){$("#"+Planner.getPath("plannerPage.plannerPane.mainView.DayView").get("layerId")).fadeIn(700)},exitState:function(){$("#"+Planner.getPath("plannerPage.plannerPane.mainView.DayView").get("layerId")).fadeOut(700)}}),WEEK_PLANNER:SC.State.design({enterState:function(){$("#"+Planner.getPath("plannerPage.plannerPane.mainView.WeekView").get("layerId")).fadeIn(700)},exitState:function(){$("#"+Planner.getPath("plannerPage.plannerPane.mainView.WeekView").get("layerId")).fadeOut(700)}}),MONTH_PLANNER:SC.State.design({enterState:function(){},exitState:function(){}}),}),SIDE_VIEW:SC.State.design({initialSubstate:"COURSES",COURSES:SC.State.design({}),ASSIGNMENTS:SC.State.design({}),TESTS:SC.State.design({}),NOTES:SC.State.design({}),ASSIGNMENT:SC.State.design({}),TEST:SC.State.design({}),NOTE:SC.State.design({}),FEEDBACK:SC.State.design({}),ABOUT:SC.State.design({})}),BOOKMARK:SC.State.design({initialSubstate:"CLOSED",CLOSED:SC.State.design({toggleUtil:function(){Planner.Animation.oneUp(Planner.getPath("plannerPage.plannerPane.bookmark"),Planner.getPath("plannerPage.plannerPane.sideView"));Planner.Animation.oneUp(Planner.getPath("plannerPage.plannerPane.util"),Planner.getPath("plannerPage.plannerPane.bookmark"));Planner.Animation.oneUp(Planner.getPath("plannerPage.plannerPane.util.logout"),Planner.getPath("plannerPage.plannerPane.util"));Planner.Animation.oneUp(Planner.getPath("plannerPage.plannerPane.util.settings"),Planner.getPath("plannerPage.plannerPane.util"));$("#"+Planner.getPath("plannerPage.plannerPane.bookmark").get("layer").id).animate({translateY:"+=60"},500);$("#"+Planner.getPath("plannerPage.plannerPane.bookmark").get("layer").id).animate({translateY:"-=5"},100);$("#"+Planner.getPath("plannerPage.plannerPane.util").get("layer").id).animate({translateY:"+=60"},500);$("#"+Planner.getPath("plannerPage.plannerPane.util").get("layer").id).animate({translateY:"-=5"},100);this.gotoState("OPEN")}}),OPEN:SC.State.design({toggleUtil:function(){$("#"+Planner.getPath("plannerPage.plannerPane.bookmark").get("layer").id).animate({translateY:"-=55"},500);$("#"+Planner.getPath("plannerPage.plannerPane.util").get("layer").id).animate({translateY:"-=55"},500);this.gotoState("CLOSED")},logoutPressed:function(){Planner.currentUser.sendLogout()}}),})}),COURSE_SIGNUP:SC.State.design({})}),});Planner.Animation=SC.Object.create({SwitchBookmark:function(b,a){if(!a){$("#"+Planner.getPath("loginPage.loginPane.bookmark").get("layer").id).animate({translateY:"-=35"},500)}SC.Timer.schedule({target:this,action:function(){$("#"+Planner.getPath("loginPage.loginPane.bookmark").get("layer").id).animate({translateY:"+=35"},500);Planner.getPath("loginPage.loginPane.bookmark").set("value",b)},interval:300})},LoginCardSwitch:function(f,g){var d,c;switch(f){case 1:d=Planner.getPath("loginPage.loginPane.loginBin");c=Planner.getPath("loginPage.loginPane.createAccountBin");$(Planner.Utility.toId(d)).animate({translateX:"-=330"},500);$(Planner.Utility.toId(c)).animate({translateX:"+=20"},500);SC.Timer.schedule({action:function(){Planner.Animation.oneUp(d,c);$(Planner.Utility.toId(d)).animate({translateX:"+=330"},500);$(Planner.Utility.toId(c)).animate({translateX:"-=20"},500)},interval:500});break;case 2:c=Planner.getPath("loginPage.loginPane.loginBin");d=Planner.getPath("loginPage.loginPane.createAccountBin");$(Planner.Utility.toId(d)).animate({translateX:"+=330"},500);$(Planner.Utility.toId(c)).animate({translateX:"-=20"},500);SC.Timer.schedule({action:function(){Planner.Animation.oneUp(d,c);$(Planner.Utility.toId(d)).animate({translateX:"-=330"},500);$(Planner.Utility.toId(c)).animate({translateX:"+=20"},500)},interval:500});break}$("#"+Planner.getPath("loginPage.loginPane.loginHeader").get("layer").id).fadeToggle(700);$("#"+Planner.getPath("loginPage.loginPane.createAccountButton").get("layer").id).slideToggle(1000);$("#"+Planner.getPath("loginPage.loginPane.forgotAccountButton").get("layer").id).slideToggle(1000);$("#"+Planner.getPath("loginPage.loginPane.rememberedAccountButton").get("layer").id).slideToggle(1000)},oneUp:function(b,a){newIndex=Number($(a.get("layer")).css("z-index"))+1;$(b.get("layer")).css("z-index",newIndex)}});function Matrix(){}var Sylvester={version:"0.1.3",precision:0.000001};Matrix.prototype={e:function(d,c){return d<1||d>this.elements.length||c<1||c>this.elements[0].length?null:this.elements[d-1][c-1]},map:function(j){var i=[],p=this.elements.length,o=p,n,m,l=this.elements[0].length,k;do{n=o-p,m=l,i[n]=[];do{k=l-m,i[n][k]=j(this.elements[n][k],n+1,k+1)}while(--m)}while(--p);return Matrix.create(i)},multiply:function(C){if(!C.elements){return this.map(function(a){return a*C})}var B=C.modulus?!0:!1,A=C.elements||C;typeof A[0][0]=="undefined"&&(A=Matrix.create(A).elements);if(!this.canMultiplyFromLeft(A)){return null}var z=this.elements.length,y=z,x,w,v=A[0].length,u,t=this.elements[0].length,r=[],q,p,o;do{x=y-z,r[x]=[],w=v;do{u=v-w,q=0,p=t;do{o=t-p,q+=this.elements[x][o]*A[o][u]}while(--p);r[x][u]=q}while(--w)}while(--z);var A=Matrix.create(r);return B?A.col(1):A},x:function(b){return this.multiply(b)},canMultiplyFromLeft:function(d){var c=d.elements||d;return typeof c[0][0]=="undefined"&&(c=Matrix.create(c).elements),this.elements[0].length==c.length},setElements:function(u){var t,r=u.elements||u;if(typeof r[0][0]!="undefined"){var q=r.length,p=q,o,n,m;this.elements=[];do{t=p-q,o=r[t].length,n=o,this.elements[t]=[];do{m=n-o,this.elements[t][m]=r[t][m]}while(--o)}while(--q);return this}var l=r.length,k=l;this.elements=[];do{t=k-l,this.elements.push([r[t]])}while(--l);return this}},Matrix.create=function(d){var c=new Matrix;return c.setElements(d)},$M=Matrix.create,function(G){if(!G.cssHooks){throw"jQuery 1.4.3+ is needed for this plugin to work"}var F="transform",E,D,C,B,A,z=F.charAt(0).toUpperCase()+F.slice(1),y=["Moz","Webkit","O","MS"],x=document.createElement("div");if(F in x.style){D=F,C=x.style.perspective!==undefined}else{for(var w=0;w<y.length;w++){E=y[w]+z;if(E in x.style){D=E,y[w]+"Perspective" in x.style?C=!0:B=!0;break}}}D||(A="filter" in x.style,D="filter"),x=null,G.support[F]=D;var v=D,u={rotateX:{defaultValue:0,matrix:function(b){return C?$M([[1,0,0,0],[0,Math.cos(b),Math.sin(-b),0],[0,Math.sin(b),Math.cos(b),0],[0,0,0,1]]):$M([[1,0,0],[0,1,0],[0,0,1]])}},rotateY:{defaultValue:0,matrix:function(b){return C?$M([[Math.cos(b),0,Math.sin(b),0],[0,1,0,0],[Math.sin(-b),0,Math.cos(b),0],[0,0,0,1]]):$M([[1,0,0],[0,1,0],[0,0,1]])}},rotateZ:{defaultValue:0,matrix:function(b){return C?$M([[Math.cos(b),Math.sin(-b),0,0],[Math.sin(b),Math.cos(b),0,0],[0,0,1,0],[0,0,0,1]]):$M([[Math.cos(b),Math.sin(-b),0],[Math.sin(b),Math.cos(b),0],[0,0,1]])}},scale:{defaultValue:1,matrix:function(b){return C?$M([[b,0,0,0],[0,b,0,0],[0,0,b,0],[0,0,0,1]]):$M([[b,0,0],[0,b,0],[0,0,1]])}},translateX:{defaultValue:0,matrix:function(b){return C?$M([[1,0,0,0],[0,1,0,0],[0,0,1,0],[b,0,0,1]]):$M([[1,0,0],[0,1,0],[b,0,1]])}},translateY:{defaultValue:0,matrix:function(b){return C?$M([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,b,0,1]]):$M([[1,0,0],[0,1,0],[0,b,1]])}},translateZ:{defaultValue:0,matrix:function(b){return C?$M([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,b,1]]):$M([[1,0,0],[0,1,0],[0,0,1]])}}},t=function(a){var i=G(a).data("transforms"),g;C?g=$M([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]):g=$M([[1,0,0],[0,1,0],[0,0,1]]);for(var f in u){g=g.x(u[f].matrix(i[f]||u[f].defaultValue))}C?(s="matrix3d(",s+=g.e(1,1).toFixed(10)+","+g.e(1,2).toFixed(10)+","+g.e(1,3).toFixed(10)+","+g.e(1,4).toFixed(10)+",",s+=g.e(2,1).toFixed(10)+","+g.e(2,2).toFixed(10)+","+g.e(2,3).toFixed(10)+","+g.e(2,4).toFixed(10)+",",s+=g.e(3,1).toFixed(10)+","+g.e(3,2).toFixed(10)+","+g.e(3,3).toFixed(10)+","+g.e(3,4).toFixed(10)+",",s+=g.e(4,1).toFixed(10)+","+g.e(4,2).toFixed(10)+","+g.e(4,3).toFixed(10)+","+g.e(4,4).toFixed(10),s+=")"):B?(s="matrix(",s+=g.e(1,1).toFixed(10)+","+g.e(1,2).toFixed(10)+",",s+=g.e(2,1).toFixed(10)+","+g.e(2,2).toFixed(10)+",",s+=g.e(3,1).toFixed(10)+"px,"+g.e(3,2).toFixed(10)+"px",s+=")"):A&&(s="progid:DXImageTransform.Microsoft.",s+="Matrix(",s+="M11="+g.e(1,1).toFixed(10)+",",s+="M12="+g.e(1,2).toFixed(10)+",",s+="M21="+g.e(2,1).toFixed(10)+",",s+="M22="+g.e(2,2).toFixed(10)+",",s+="SizingMethod='auto expand'",s+=")",a.style.top=g.e(3,1),a.style.left=g.e(3,2)),a.style[v]=s},r=function(a){return G.fx.step[a]=function(b){G.cssHooks[a].set(b.elem,b.now+b.unit)},{get:function(i,h,g){var b=G(i).data("transforms");return b===undefined&&(b={},G(i).data("transforms",b)),b[a]||u[a].defaultValue},set:function(i,h){var g=G(i).data("transforms");g===undefined&&(g={});var b=u[a];typeof b.apply=="function"?g[a]=b.apply(g[a]||b.defaultValue,h):g[a]=h,G(i).data("transforms",g),t(i)}}};if(v){for(var q in u){G.cssHooks[q]=r(q),G.cssNumber[q]=!0}}}(jQuery);sc_require("statechart");sc_require("utility");Planner.LOGGED_OUT=SC.State.design({enterState:function(){Planner.getPath("loginPage.loginPane").append()},firstLoad:true,exitState:function(){this.set("firstLoad",true)},initialSubstate:"LOGGING_IN",LOGGING_IN:SC.State.design({initialSubstate:"PROVIDING_CREDENTIALS",enterState:function(){if(this.parentState.firstLoad==true){Planner.Utility.show([Planner.getPath("loginPage.loginPane.forgotAccountBin"),Planner.getPath("loginPage.loginPane.createAccountBin"),Planner.getPath("loginPage.loginPane.createAccountButton"),Planner.getPath("loginPage.loginPane.forgotAccountButton"),Planner.getPath("loginPage.loginPane.loginBin")]);Planner.Utility.enableFields("login");Planner.Utility.hide([Planner.getPath("loginPage.loginPane.loginHeader"),Planner.getPath("loginPage.loginPane.rememberedAccountButton"),]);Planner.Animation.oneUp(Planner.getPath("loginPage.loginPane.loginBin"),Planner.getPath("loginPage.loginPane.createAccountBin"));if(this.historyState!="LOGGED_OUT.LOGGING_IN.LOGIN_LOADING"){$(Planner.getPath("loginPage.loginPane.date").get("layer")).fadeToggle(1500)}Planner.Utility.show([Planner.getPath("loginPage.loginPane.loginBin.submit")]);Planner.Animation.SwitchBookmark("Planner Login",true);this.parentState.set("firstLoad","false");return YES}else{Planner.Animation.LoginCardSwitch(1);Planner.Animation.SwitchBookmark("Planner Login")}},fieldFocused:function(){this.gotoState("PROVIDING_CREDENTIALS")},PROVIDING_CREDENTIALS:SC.State.design({checkInfo:function(){username=Planner.getPath("loginPage.loginPane.loginBin.username").value;password=Planner.getPath("loginPage.loginPane.loginBin.password").value;isUsername=Planner.Utility.isComplete(username);isPassword=Planner.Utility.isComplete(password);neither="Please supply a Username & Password";noUsername="Please supply a Username";noPassword="Please supply a Password";if(!isUsername&&!isPassword){this.showError(neither,1,2);return YES}if(!isUsername){this.showError(noUsername,1);return YES}if(!isPassword){this.showError(noPassword,2);return YES}if(isUsername&&isPassword){Planner.Utility.disableFields("login");Planner.currentUser.sendLogin(username,password);return YES}return YES},createAccount:function(){this.gotoState("CREATING_ACCOUNT")},forgotPassword:function(){this.gotoState("FORGOT_PASSWORD")},showError:function(b,a){this.gotoState("LOGIN_ERROR");Planner.statechart.invokeStateMethod("showError",b,a)},showStatus:function(a){this.gotoState("LOGIN_STATUS");Planner.statechart.invokeStateMethod("showStatus",a)}}),LOGIN_ERROR:SC.State.design({showError:function(b,a,c){Planner.Utility.hide([Planner.getPath("loginPage.loginPane.createAccountBin")]);$("#"+Planner.getPath("loginPage.loginPane.loginBin").get("layer").id).animate({translateX:"-=5"},100);$("#"+Planner.getPath("loginPage.loginPane.loginBin").get("layer").id).animate({translateX:"+=10"},100);$("#"+Planner.getPath("loginPage.loginPane.loginBin").get("layer").id).animate({translateX:"-=10"},100);$("#"+Planner.getPath("loginPage.loginPane.loginBin").get("layer").id).animate({translateX:"+=10"},100);$("#"+Planner.getPath("loginPage.loginPane.loginBin").get("layer").id).animate({translateX:"-=10"},100);$("#"+Planner.getPath("loginPage.loginPane.loginBin").get("layer").id).animate({translateX:"+=5"},100);if(a||c){if(a==1){$(Planner.getPath("loginPage.loginPane.loginBin.username").get("layer")).css("border-color","red")}if(a==2){$(Planner.getPath("loginPage.loginPane.loginBin.password").get("layer")).css("border-color","red")}}SC.RunLoop.begin();Planner.currentUser.set("loginError",b);SC.RunLoop.end();$(Planner.getPath("loginPage.loginPane.loginBin.submit").get("layer")).fadeOut();$(Planner.getPath("loginPage.loginPane.loginBin.error").get("layer")).fadeIn();Planner.Utility.enableFields("login")},exitState:function(){Planner.Utility.show([Planner.getPath("loginPage.loginPane.createAccountBin")]);$(Planner.getPath("loginPage.loginPane.loginBin.error").get("layer")).fadeOut();$(Planner.getPath("loginPage.loginPane.loginBin.submit").get("layer")).fadeIn();$(Planner.getPath("loginPage.loginPane.loginBin.username").get("layer")).css("border-color","maroon");$(Planner.getPath("loginPage.loginPane.loginBin.password").get("layer")).css("border-color","maroon")},createAccount:function(){this.gotoState("CREATING_ACCOUNT")},forgotPassword:function(){this.gotoState("FORGOT_PASSWORD")},}),LOGIN_STATUS:SC.State.design({showStatus:function(a){SC.RunLoop.begin();Planner.currentUser.set("loginStatus",a);SC.RunLoop.end();$(Planner.getPath("loginPage.loginPane.loginBin.submit").get("layer")).fadeOut();$(Planner.getPath("loginPage.loginPane.loginBin.status").get("layer")).fadeIn();Planner.Utility.enableFields("login")},exitState:function(){$(Planner.getPath("loginPage.loginPane.loginBin.status").get("layer")).fadeOut();$(Planner.getPath("loginPage.loginPane.loginBin.submit").get("layer")).fadeIn()}}),LOGIN_LOADING:SC.State.design({enterState:function(){$(Planner.getPath("loginPage.loginPane.loginBin.submit").get("layer")).fadeToggle();$(Planner.getPath("loginPage.loginPane.loginBin.spinner").get("layer")).fadeToggle()},exitState:function(){$(Planner.getPath("loginPage.loginPane.loginBin.spinner").get("layer")).fadeToggle()},showError:function(b,a){this.gotoState("LOGIN_ERROR");Planner.statechart.invokeStateMethod("showError",b,a)},}),FORGOT_PASSWORD:SC.State.design({enterState:function(){Planner.Animation.SwitchBookmark("Password Recovery");Planner.Utility.enableFields("login");$(Planner.getPath("loginPage.loginPane.createAccountButton").get("layer")).slideToggle(1000);$(Planner.getPath("loginPage.loginPane.forgotAccountButton").get("layer")).slideToggle(1000);$("#"+Planner.getPath("loginPage.loginPane.forgotAccountBin").get("layer").id).animate({translateY:"+=45"},1000);Planner.getPath("loginPage.loginPane.forgotAccountBin.email").$input()[0].focus();Planner.getPath("loginPage.loginPane.loginBin.submit").set("action","loginInfo")},exitState:function(){Planner.Animation.SwitchBookmark("Planner Login");Planner.Utility.enableFields("login");$(Planner.getPath("loginPage.loginPane.createAccountButton").get("layer")).slideToggle(1000);$(Planner.getPath("loginPage.loginPane.forgotAccountButton").get("layer")).slideToggle(1000);$("#"+Planner.getPath("loginPage.loginPane.forgotAccountBin").get("layer").id).animate({translateY:"-=45"},1000);SC.Timer.schedule({action:function(){Planner.getPath("loginPage.loginPane.forgotAccountBin.email").set("hint","Your Email");Planner.getPath("loginPage.loginPane.forgotAccountBin.send").set("title","Send Email")},interval:700});Planner.getPath("loginPage.loginPane.loginBin.submit").set("action","checkInfo")},checkInfo:function(){Planner.getPath("loginPage.loginPane.forgotAccountBin.send").set("title","Send Email");email=Planner.getPath("loginPage.loginPane.forgotAccountBin.email").value;noEmail="Please provide an email...";notEmail="Please provide a valid email";if(!Planner.Utility.isComplete(email)){this.showError(noEmail,true);return YES}isEmail=Planner.Utility.isEmail(email);if(!isEmail){this.showError(notEmail,true);return YES}Planner.Utility.disableFields("login");Planner.getPath("loginPage.loginPane.forgotAccountBin.send").set("title","Loading...");Planner.currentUser.sendForgotPassword(email)},showError:function(a,b){if(!b){Planner.getPath("loginPage.loginPane.forgotAccountBin.send").set("title","Try Again")}Planner.Utility.enableFields("login");Planner.getPath("loginPage.loginPane.forgotAccountBin.email").set("value","");Planner.getPath("loginPage.loginPane.forgotAccountBin.email").set("hint",a)},loginInfo:function(){this.gotoState("PROVIDING_CREDENTIALS");Planner.statechart.invokeStateMethod("checkInfo")}}),}),CREATING_ACCOUNT:SC.State.design({enterState:function(){Planner.Animation.LoginCardSwitch(2);Planner.Animation.SwitchBookmark("Planner Registration")},exitState:function(){Planner.Utility._getLoginFields().forEach(function(a){$(a.get("layer")).css("border-color","maroon")})},alreadyHaveAccount:function(){this.gotoState("LOGGING_IN")},fieldFocused:function(){this.gotoState("REGISTERING")},initialSubstate:"REGISTERING",REGISTERING:SC.State.design({checkInfo:function(){username=Planner.getPath("loginPage.loginPane.createAccountBin.username").value;password=Planner.getPath("loginPage.loginPane.createAccountBin.password").value;passwordConfirmation=Planner.getPath("loginPage.loginPane.createAccountBin.passwordConfirmation").value;firstname=Planner.getPath("loginPage.loginPane.createAccountBin.firstname").value;lastname=Planner.getPath("loginPage.loginPane.createAccountBin.lastname").value;email=Planner.getPath("loginPage.loginPane.createAccountBin.email").value;noFName="Please provide a First Name";noLName="Please provide a Last Name";noEmail="Please provide an Email";noUsername="Please provide a Username";noPassword="Please provide a Password";noPasswordConfirmation="Please confirm your Password";if(!Planner.Utility.isComplete(firstname)){this.showError(noFName,1);return YES}if(!Planner.Utility.isComplete(lastname)){this.showError(noLName,2);return YES}if(!Planner.Utility.isComplete(email)){this.showError(noEmail,3);return YES}if(!Planner.Utility.isComplete(username)){this.showError(noUsername,4);return YES}if(!Planner.Utility.isComplete(password)){this.showError(noPassword,5);return YES}if(!Planner.Utility.isComplete(passwordConfirmation)){this.showError(noPasswordConfirmation,6);return YES}usernameCheck=(username.length>=3&&username.length<=10);passwordCheck=(password.length>=5&&password.length<=10);passwords=(password===passwordConfirmation);isEmail=email.match(/.+@.+\..{2,4}/);if(usernameCheck&&passwordCheck&&passwords&&isEmail){Planner.currentUser.sendNewAccount(username,password,firstname,lastname,email);this.gotoState("CREATION_LOADING");Planner.Utility.disableFields("login");return YES}badEmail="Please provide a valid email";usernameShort="Username must be 3 characters or more";usernameLong="Username must be 10 characters or less";passwordShort="Password must be 5 characters or more";passwordLong="Password must be 10 characters or less";passwordsDif="Passwords do not match";if(!isEmail){this.showError(badEmail,3);return YES}if(!usernameCheck){if(username.length<3){this.showError(usernameShort,4);return YES}else{if(username.length>10){this.showError(usernameLong),4;return YES}}}if(!passwordCheck||!passwords){if(password.length<5){this.showError(passwordShort,5);return YES}else{if(password.length>10){this.showError(passwordLong,5);return YES}else{if(!passwords){this.showError(passwordsDif,6);return YES}}}}},showError:function(b,a){this.gotoState("CREATION_ERROR");Planner.statechart.invokeStateMethod("showError",b,a)}}),CREATION_ERROR:SC.State.design({showError:function(b,a){if(a){if(a==1){$(Planner.getPath("loginPage.loginPane.createAccountBin.firstname").get("layer")).css("border-color","red")}else{if(a==2){$(Planner.getPath("loginPage.loginPane.createAccountBin.lastname").get("layer")).css("border-color","red")}else{if(a==3){$(Planner.getPath("loginPage.loginPane.createAccountBin.email").get("layer")).css("border-color","red")}else{if(a==4){$(Planner.getPath("loginPage.loginPane.createAccountBin.username").get("layer")).css("border-color","red")}else{if(a==5){$(Planner.getPath("loginPage.loginPane.createAccountBin.password").get("layer")).css("border-color","red")}else{if(a==6){$(Planner.getPath("loginPage.loginPane.createAccountBin.passwordConfirmation").get("layer")).css("border-color","red")}}}}}}}SC.RunLoop.begin();Planner.currentUser.set("accountCreationError",b);SC.RunLoop.end();$(Planner.getPath("loginPage.loginPane.createAccountBin.submit").get("layer")).fadeOut();$(Planner.getPath("loginPage.loginPane.createAccountBin.error").get("layer")).fadeIn();Planner.Utility.enableFields("login")},exitState:function(){$(Planner.getPath("loginPage.loginPane.createAccountBin.error").get("layer")).fadeOut();$(Planner.getPath("loginPage.loginPane.createAccountBin.submit").get("layer")).fadeIn()},}),CREATION_LOADING:SC.State.design({enterState:function(){$(Planner.getPath("loginPage.loginPane.createAccountBin.submit").get("layer")).fadeToggle();$(Planner.getPath("loginPage.loginPane.createAccountBin.spinner").get("layer")).fadeToggle()},exitState:function(){$(Planner.getPath("loginPage.loginPane.createAccountBin.spinner").get("layer")).fadeToggle()},showError:function(b,a){this.gotoState("CREATION_ERROR");Planner.statechart.invokeStateMethod("showError",b,a)},showStatus:function(a){SC.Timer.schedule({action:this.reset(),interval:700});Planner.statechart.gotoState("LOGGING_IN");Planner.statechart.invokeStateMethod("showStatus",a)},reset:function(){$(Planner.getPath("loginPage.loginPane.createAccountBin.submit").get("layer")).fadeToggle();Planner.Utility._getLoginFields().forEach(function(a){a.set("value","")});Planner.Utility.enableFields()}}),}),});Planner.Theme=SC.BaseTheme.create({name:"planner"});SC.Theme.addTheme(Planner.Theme);SC.defaultTheme="planner";Planner.loginPage=SC.Page.design({loginPane:SC.MainPane.design({classNames:["loginPane"],childViews:["date","bookmark","copyrightInfo","loginHeader","loginBin","createAccountBin","forgotAccountBin","forgotAccountButton","createAccountButton","rememberedAccountButton",],date:SC.LabelView.design({classNames:["date"],layout:{width:0.2,height:40,top:4,left:16},value:date.toFormattedString("%A, %B %D")+getSup(date.get("day"))}),bookmark:SC.LabelView.design({classNames:["bookmark"],textAlign:SC.ALIGN_CENTER,layout:{width:0.125,height:35,top:-45,right:20},value:"Planner Login",}),copyrightInfo:SC.LabelView.design({classNames:["copyrightInfo"],layout:{width:0.25,height:12,bottom:5,left:5},value:"Planner Software  Nick Landolfi and Sam Calvert; 2012-2013"}),loginBin:Planner.LoginView.design({classNames:["loginBin"],childViews:["bearImage","username","password","submit","error","status","spinner"],bearImage:SC.ImageView.design({layout:{height:160,width:160,centerX:0},canLoadInBackground:NO,value:"/static/planner/en/87b64922c95183758fc88550f088ad514fb39c1d/source/resources/img/banner.png",}),username:Planner.LoginTextField.design({textAlign:SC.ALIGN_CENTER,hint:"Username",textAlign:SC.ALIGN_CENTER,layout:{height:35,width:175,centerX:0,centerY:25},}),password:Planner.LoginTextField.design({hint:"Password",textAlign:SC.ALIGN_CENTER,type:"password",layout:{height:35,width:175,centerX:0,centerY:68},}),submit:SC.ButtonView.design({classNames:["submit"],textAlign:SC.ALIGN_CENTER,layout:{height:35,width:90,centerX:0,centerY:115},title:"Login",action:"checkInfo",}),error:Planner.LoginError.design({layout:{width:275,height:30,centerX:0,centerY:120},valueBinding:"Planner.currentUser.loginError",}),status:Planner.LoginStatus.design({layout:{width:275,height:30,centerX:0,centerY:120},valueBinding:"Planner.currentUser.loginStatus",}),spinner:SC.ImageView.design({classNames:["spinner"],layout:{height:30,width:30,centerX:0,centerY:117},useCanvas:NO,value:"/static/planner/en/87b64922c95183758fc88550f088ad514fb39c1d/source/resources/img/ajax-loader.gif",})}),createAccountBin:Planner.LoginView.design({classNames:["createAccountBin"],childViews:["firstname","lastname","email","username","password","passwordConfirmation","submit","error","spinner"],firstname:Planner.LoginTextField.design({hint:"First Name",layout:{height:30,width:250,centerX:0,centerY:-120},}),lastname:Planner.LoginTextField.design({hint:"Last Name",layout:{height:30,width:250,centerX:0,centerY:-80},}),email:Planner.LoginTextField.design({hint:"Email",layout:{height:30,width:250,centerX:0,centerY:-40},}),username:Planner.LoginTextField.design({hint:"Username",layout:{height:30,width:250,centerX:0,centerY:0},}),password:Planner.LoginTextField.design({hint:"Password",isPassword:YES,layout:{height:30,width:250,centerX:0,centerY:40},}),passwordConfirmation:Planner.LoginTextField.design({hint:"Confirm Password",isPassword:YES,layout:{height:30,width:250,centerX:0,centerY:80},}),submit:SC.ButtonView.design({classNames:["submit"],textAlign:SC.ALIGN_CENTER,layout:{height:30,width:150,centerX:0,centerY:122},title:"Create Account",action:"checkInfo",}),error:Planner.LoginError.design({layout:{width:275,height:30,centerX:0,centerY:125},valueBinding:"Planner.currentUser.accountCreationError",}),spinner:SC.ImageView.design({classNames:["spinner"],layout:{height:30,width:30,centerX:0,centerY:125},useCanvas:NO,value:"/static/planner/en/87b64922c95183758fc88550f088ad514fb39c1d/source/resources/img/ajax-loader.gif",})}),forgotAccountBin:Planner.Wrapper.design({classNames:["forgotPasswordBin"],childViews:["email","send"],layout:{width:300,height:30,centerY:130,centerX:0},email:SC.TextFieldView.design({classNames:["emailInput"],hint:"Your Email",spellCheckEnabled:NO,shouldRenderBorder:NO,layout:{height:24,width:200,centerX:-49},keyDown:function(a){arguments.callee.base.apply(this,arguments);if(a.keyCode===13){Planner.statechart.sendEvent("checkInfo")}}}),send:Planner.BrownButton.design({classNames:["sendEmailButton"],layout:{width:90,height:24,centerX:97},title:"Send Email",action:"checkInfo"}),}),loginHeader:Planner.Wrapper.design({childViews:["loginTitle","rule"],loginTitle:Planner.LoginHeader.design({classNames:["loginHeader"],value:"Registration"}),rule:SC.LabelView.design({classNames:["loginRule"],textAlign:SC.ALIGN_CENTER,layout:{width:500,height:50,centerX:0,centerY:-170},value:"________________"}),}),createAccountButton:Planner.BrownButton.design({layout:{width:150,height:20,centerX:-80,centerY:170,zIndex:2},title:"Create an Account",action:"createAccount",}),forgotAccountButton:Planner.BrownButton.design({layout:{width:150,height:20,centerX:80,centerY:170,zIndex:2},title:"Forgot Password?",action:"forgotPassword"}),rememberedAccountButton:Planner.BrownButton.design({layout:{width:250,height:20,centerX:0,centerY:170,zIndex:1},title:"Already have an Account?",action:"alreadyHaveAccount",}),}),});Planner.plannerPage=SC.Page.design({plannerPane:SC.MainPane.design({classNames:["plannerPane"],childViews:["date","bookmark","util","sideHeader","sideView","mainView","calendar","navBar","feedback"],date:SC.LabelView.design({classNames:["date"],layout:{width:260,height:40,top:4,left:16,zIndex:1},tagName:"h1",value:date.toFormattedString("%A, %B %D")+getSup(date.get("day"))}),sideHeader:Planner.Wrapper.design({layout:{width:0.25,height:0.2,top:0.07,right:0.017},childViews:["loginTitle","rule"],loginTitle:SC.LabelView.design({classNames:["sideHeader"],textAlign:SC.ALIGN_CENTER,value:"Classes"}),rule:SC.LabelView.design({classNames:["sideRule"],textAlign:SC.ALIGN_CENTER,layout:{width:0.9,left:0.05},value:"____________________________________"}),}),sideView:SC.View.design({layout:{width:0.25,height:0.45,right:0.017,top:0.12,zIndex:0},classNames:["sideView"],childViews:["courses"],courses:Planner.Wrapper.create({courses:function(){return Planner.courses}.property("Planner.courses"),courseViews:[],updateCourses:function(){for(var a=0;a<this.get("courses").get("length");a++){courseView=Planner.CourseView.create({course:this.get("courses").objectAt(a),numCourses:this.get("courses").get("length"),num:a});this.appendChild(courseView);this.get("courseViews").push(courseView)}}.observes("courses")}),}),mainView:SC.View.design({classNames:["mainView"],layout:{width:0.7,height:0.92,left:0.015,top:0.065},childViews:["DayView","WeekView"],DayView:Planner.DayView.design({}),WeekView:Planner.WeekView.design({}),}),calendar:Planner.CalendarView.create({classNames:["calendar"],layout:{width:0.21,height:0.32,right:0.036,top:0.66}}),bookmark:SC.LabelView.design({classNames:["bookmark"],layout:{width:0.125,height:35,top:-45,right:20,zIndex:1},mouseDown:function(){Planner.statechart.invokeStateMethod("toggleUtil")},textAlign:SC.ALIGN_CENTER,valueBinding:SC.Binding.from("Planner.currentUser.loginGreeting"),}),util:SC.View.design({layout:{width:0.125,height:100,top:-100,right:20,zIndex:100},classNames:["util"],childViews:["logout","settings"],logout:Planner.UtilItem.design({layout:{width:0.999,height:25,centerY:35},title:"Logout",action:"logoutPressed",}),settings:Planner.UtilItem.design({layout:{width:0.999,height:25,centerY:10},title:"Settings"})}),feedback:Planner.BrownButton.create({mouseUp:function(){alert("yea, it works..")},layout:{width:0.21,top:0.58,height:0.036,right:0.036},title:"Give us Feedback"}),navBar:Planner.Wrapper.design({classNames:["nav-bar"],childViews:["leftArrow","left","center","right","rightArrow"],layout:{width:0.19,height:0.04,top:0.01,left:0.4},leftArrow:Planner.BrownButton.design({classNames:["left-arrow"],layout:{width:0.104,left:0},title:"<",action:"prev"}),left:Planner.BrownButton.design({classNames:["left"],layout:{width:0.263,left:0.104},title:"Day",action:"gotoDay",}),center:Planner.BrownButton.design({classNames:["center"],layout:{width:0.263,left:0.367},title:"Week",action:"gotoWeek"}),right:Planner.BrownButton.design({classNames:["right"],layout:{width:0.263,left:0.63},title:"Month",action:"gotoMonth"}),rightArrow:Planner.BrownButton.design({classNames:["right-arrow"],layout:{width:0.104,left:0.893},title:">",action:"next"}),})})});Planner.main=function main(){var a=Planner.statechart;SC.RootResponder.responder.set("defaultResponder",a);a.initStatechart()};function main(){Planner.main()};